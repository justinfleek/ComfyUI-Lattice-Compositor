# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#                                                                  // clangd
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#
# clangd configuration for Buck2 + Nix projects.
#
# compile_commands.json is generated by:
#   buck2 bxl prelude//cxx/tools/compilation_database.bxl:generate
#
# The shell hook auto-generates it on entry.
#
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

CompileFlags:
  # Treat .cu files as C++ (clang handles CUDA natively)
  Add:
    - "-xc++"
    - "-std=c++23"
  Remove:
    # Remove flags clangd doesn't understand
    - "-fzero-call-used-regs=*"
    - "-mllvm"
    - "-polly*"

Diagnostics:
  # Suppress noisy warnings in headers
  Suppress:
    - "pp_including_mainfile_in_preamble"
  ClangTidy:
    Add:
      - modernize-*
      - bugprone-*
      - performance-*
      - readability-identifier-naming
    Remove:
      - modernize-use-trailing-return-type
      - readability-identifier-length

InlayHints:
  Enabled: true
  ParameterNames: true
  DeducedTypes: true
  Designators: true

Hover:
  ShowAKA: true
