{"version":3,"file":"designer-icUNrL3Y.js","sources":["../../src/core/config.ts","../../src/core/state.ts","../../src/core/timing.ts","../../src/utils/colors.ts","../../src/utils/designer.ts"],"sourcesContent":["/**\n * Configuration constants for the ComfyUI Enhanced Links and Nodes extension.\n * Contains sacred geometry constants, animation timing, and default settings.\n *\n * @module core/config\n */\n\n// =============================================================================\n// Mathematical Constants\n// =============================================================================\n\n/** The golden ratio (Ï†) - used for aesthetically pleasing proportions */\nexport const PHI = 1.618033988749895;\n\n/** Sacred geometry constants for pattern generation */\nexport const SACRED = Object.freeze({\n    /** Base pattern foundation - used for trinity-based patterns */\n    TRINITY: 3,\n    /** Flow and crystalline structures */\n    HARMONY: 7,\n    /** Complex pattern completion cycles */\n    COMPLETION: 12,\n    /** Fibonacci sequence for growth patterns */\n    FIBONACCI: Object.freeze([1, 1, 2, 3, 5, 8, 13, 21]),\n    /** Quantum effects base */\n    QUANTUM: 5,\n    /** Infinite pattern cycles */\n    INFINITY: 8,\n});\n\n// =============================================================================\n// Animation Configuration\n// =============================================================================\n\n/** Animation timing and performance constants */\nexport const ANIMATION = Object.freeze({\n    /** Target frame interval in ms (~60fps) */\n    RAF_THROTTLE: 1000 / 60,\n    /** Maximum size of particle pool */\n    PARTICLE_POOL_SIZE: 1000,\n    /** Smoothing factor for delta time */\n    SMOOTH_FACTOR: 0.95,\n    /** Maximum delta time cap (seconds) */\n    MAX_DELTA: 1 / 30,\n    /** Default transition speed for phase animations */\n    TRANSITION_SPEED: (2 * Math.PI) / 15,\n    /** Faster transition speed for more responsive animations */\n    FAST_TRANSITION_SPEED: (2 * Math.PI) / 10,\n});\n\n// =============================================================================\n// Default Settings\n// =============================================================================\n\n/** Default settings for link animations */\nexport const LINK_DEFAULTS = Object.freeze({\n    'ðŸ”— Enhanced Links.Animate': 9, // Classic Flow\n    'ðŸ”— Enhanced Links.Animation.Speed': 1, // Normal speed\n    'ðŸ”— Enhanced Links.Color.Mode': 'default', // Default colors\n    'ðŸ”— Enhanced Links.Color.Accent': '#9d00ff', // Purple\n    'ðŸ”— Enhanced Links.Color.Secondary': '#fb00ff', // Pink\n    'ðŸ”— Enhanced Links.Color.Primary': '#ffb300', // Orange\n    'ðŸ”— Enhanced Links.Color.Scheme': 'default', // Original colors\n    'ðŸ”— Enhanced Links.Direction': 1, // Forward\n    'ðŸ”— Enhanced Links.Glow.Intensity': 10, // Medium glow\n    'ðŸ”— Enhanced Links.Link.Style': 'spline', // Spline style\n    'ðŸ”— Enhanced Links.Marker.Enabled': true, // Markers enabled\n    'ðŸ”— Enhanced Links.Marker.Effects': 'none', // No effects\n    'ðŸ”— Enhanced Links.Marker.Glow': 10, // Medium glow\n    'ðŸ”— Enhanced Links.Marker.Color': '#00fff7', // Cyan\n    'ðŸ”— Enhanced Links.Marker.Color.Mode': 'default', // Default colors\n    'ðŸ”— Enhanced Links.Marker.Size': 3, // Large size\n    'ðŸ”— Enhanced Links.Marker.Shape': 'arrow', // Arrow shape\n    'ðŸ”— Enhanced Links.Particle.Density': 0.5, // Minimal\n    'ðŸ”— Enhanced Links.Quality': 1, // Basic (Fast)\n    'ðŸ”— Enhanced Links.Link.Shadow.Enabled': true, // Link shadows\n    'ðŸ”— Enhanced Links.Marker.Shadow.Enabled': true, // Marker shadows\n    'ðŸ”— Enhanced Links.Thickness': 3, // Medium thickness\n    'ðŸ”— Enhanced Links.UI & Ã†motion Studio About': 0, // Closed panel\n    'ðŸ”— Enhanced Links.Static.Mode': false, // Animated mode\n    'ðŸ”— Enhanced Links.Pause.During.Render': true, // Pause during render\n});\n\n/** Default settings for node animations */\nexport const NODE_DEFAULTS = Object.freeze({\n    'ðŸ“¦ Enhanced Nodes.Animate': 1, // Gentle Pulse\n    'ðŸ“¦ Enhanced Nodes.Animation.Glow': 0.5, // Medium glow\n    'ðŸ“¦ Enhanced Nodes.Animation.Size': 1, // Normal size\n    'ðŸ“¦ Enhanced Nodes.Animation.Speed': 1, // Normal speed\n    'ðŸ“¦ Enhanced Nodes.Animations.Enabled': true, // Animations on\n    'ðŸ“¦ Enhanced Nodes.Color.Accent': '#0088ff', // Deep blue\n    'ðŸ“¦ Enhanced Nodes.Color.Mode': 'default', // Default colors\n    'ðŸ“¦ Enhanced Nodes.Color.Particle': '#ffff00', // Yellow\n    'ðŸ“¦ Enhanced Nodes.Color.Primary': '#44aaff', // Bright blue\n    'ðŸ“¦ Enhanced Nodes.Color.Scheme': 'default', // Original colors\n    'ðŸ“¦ Enhanced Nodes.Color.Secondary': '#88ccff', // Light blue\n    'ðŸ“¦ Enhanced Nodes.Direction': 1, // Forward\n    'ðŸ“¦ Enhanced Nodes.End Animation.Enabled': false, // No end animation\n    'ðŸ“¦ Enhanced Nodes.Glow': 0.5, // Medium glow\n    'ðŸ“¦ Enhanced Nodes.Glow.Show': true, // Show glow\n    'ðŸ“¦ Enhanced Nodes.Intensity': 1.0, // Normal intensity\n    'ðŸ“¦ Enhanced Nodes.Particle.Color.Mode': 'default', // Default particle colors\n    'ðŸ“¦ Enhanced Nodes.Particle.Density': 1, // Normal density\n    'ðŸ“¦ Enhanced Nodes.Particle.Glow': 0.5, // Medium particle glow\n    'ðŸ“¦ Enhanced Nodes.Particle.Intensity': 1.0, // Normal intensity\n    'ðŸ“¦ Enhanced Nodes.Particle.Show': true, // Show particles\n    'ðŸ“¦ Enhanced Nodes.Particle.Size': 1.0, // Normal size\n    'ðŸ“¦ Enhanced Nodes.Particle.Speed': 1, // Normal speed\n    'ðŸ“¦ Enhanced Nodes.Quality': 2, // Balanced\n    'ðŸ“¦ Enhanced Nodes.Static.Mode': false, // Animated mode\n    'ðŸ“¦ Enhanced Nodes.Pause.During.Render': true, // Pause during render\n    'ðŸ“¦ Enhanced Nodes.Text.Animation.Enabled': false, // No text animation\n    'ðŸ“¦ Enhanced Nodes.Text.Color': '#00ffff', // Cyan\n    'ðŸ“¦ Enhanced Nodes.UI & Ã†motion Studio About': 0, // Closed panel\n});\n\n/** Combined configuration object for backward compatibility */\nexport const CONFIG = Object.freeze({\n    PHI,\n    SACRED,\n    ANIMATION,\n});\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport type LinkSettingKey = keyof typeof LINK_DEFAULTS;\nexport type NodeSettingKey = keyof typeof NODE_DEFAULTS;\nexport type SettingKey = LinkSettingKey | NodeSettingKey;\n","/**\n * State management factories for the ComfyUI Enhanced Links and Nodes extension.\n * Provides state creation and management for link and node animations.\n *\n * @module core/state\n */\n\nimport type { LinkState, NodeState } from './types';\n\n// =============================================================================\n// Link State Factory\n// =============================================================================\n\n/**\n * Creates a new link animation state object.\n * Contains all state needed for link animation rendering.\n *\n * @returns Fresh link state object\n */\nexport function createLinkState(): LinkState {\n    return {\n        isRunning: false,\n        phase: 0,\n        lastFrame: performance.now(),\n        animationFrame: null,\n        particlePool: new Map(),\n        activeParticles: new Set(),\n        totalTime: 0,\n        speedMultiplier: 1,\n        linkPositions: new Map(),\n        lastNodePositions: new Map(),\n        staticPhase: Math.PI / 4,\n        lastAnimStyle: null,\n        lastLinkStyle: null,\n        forceUpdate: false,\n        forceRedraw: false,\n        lastRenderState: null,\n        lastSettings: null,\n    };\n}\n\n// =============================================================================\n// Node State Factory\n// =============================================================================\n\n/**\n * Creates a new node animation state object.\n * Contains all state needed for node animation rendering.\n *\n * @returns Fresh node state object\n */\nexport function createNodeState(): NodeState {\n    return {\n        isRunning: false,\n        phase: 0,\n        particlePhase: 0,\n        lastFrame: performance.now(),\n        lastRAFTime: 0,\n        animationFrame: null,\n        totalTime: 0,\n        speedMultiplier: 1,\n        staticPhase: Math.PI / 4,\n        forceUpdate: false,\n        forceRedraw: false,\n        lastRenderState: null,\n        nodeEffects: new Map(),\n        isAnimating: false,\n        frameSkipCount: 0,\n        maxFrameSkips: 3,\n        lastAnimStyle: null,\n        particlePool: new Map(),\n        activeParticles: new Set(),\n        playCompletionAnimation: false,\n        completionPhase: 0,\n        completingNodes: new Set(),\n        disabledCompletionNodes: new Set(),\n        primaryCompletionNode: null,\n    };\n}\n\n// =============================================================================\n// State Reset Utilities\n// =============================================================================\n\n/**\n * Resets link state to initial values while preserving object references.\n *\n * @param state - Link state to reset\n */\nexport function resetLinkState(state: LinkState): void {\n    state.isRunning = false;\n    state.phase = 0;\n    state.lastFrame = performance.now();\n    state.animationFrame = null;\n    state.particlePool.clear();\n    state.activeParticles.clear();\n    state.totalTime = 0;\n    state.speedMultiplier = 1;\n    state.linkPositions.clear();\n    state.lastNodePositions.clear();\n    state.staticPhase = Math.PI / 4;\n    state.lastAnimStyle = null;\n    state.lastLinkStyle = null;\n    state.forceUpdate = false;\n    state.forceRedraw = false;\n    state.lastRenderState = null;\n    state.lastSettings = null;\n}\n\n/**\n * Resets node state to initial values while preserving object references.\n *\n * @param state - Node state to reset\n */\nexport function resetNodeState(state: NodeState): void {\n    state.isRunning = false;\n    state.phase = 0;\n    state.particlePhase = 0;\n    state.lastFrame = performance.now();\n    state.lastRAFTime = 0;\n    state.animationFrame = null;\n    state.totalTime = 0;\n    state.speedMultiplier = 1;\n    state.staticPhase = Math.PI / 4;\n    state.forceUpdate = false;\n    state.forceRedraw = false;\n    state.lastRenderState = null;\n    state.nodeEffects.clear();\n    state.isAnimating = false;\n    state.frameSkipCount = 0;\n    state.maxFrameSkips = 3;\n    state.lastAnimStyle = null;\n    state.particlePool.clear();\n    state.activeParticles.clear();\n    state.playCompletionAnimation = false;\n    state.completionPhase = 0;\n    state.completingNodes.clear();\n    state.disabledCompletionNodes.clear();\n    state.primaryCompletionNode = null;\n}\n\n// =============================================================================\n// State Utilities\n// =============================================================================\n\n/**\n * Marks the state for forced update on next frame.\n *\n * @param state - State object to mark\n */\nexport function markForUpdate(state: LinkState | NodeState): void {\n    state.forceUpdate = true;\n    state.forceRedraw = true;\n}\n\n/**\n * Clears force update flags from state.\n *\n * @param state - State object to clear\n */\nexport function clearUpdateFlags(state: LinkState | NodeState): void {\n    state.forceUpdate = false;\n    state.forceRedraw = false;\n}\n","/**\n * Animation timing utilities for the ComfyUI Enhanced Links and Nodes extension.\n * Provides timing management, animation controllers, and frame timing.\n *\n * @module core/timing\n */\n\nimport { ANIMATION } from './config';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/** Timing manager state for tracking frame deltas */\nexport interface TimingState {\n    /** Smoothed delta time between frames */\n    smoothDelta: number;\n    /** Total frame count */\n    frameCount: number;\n    /** Timestamp of last frame */\n    lastTime: number;\n}\n\n/** Animation controller for phase-based animations */\nexport interface AnimationControllerState {\n    /** Target phase for smooth transitions */\n    targetPhase: number;\n    /** Smoothing factor (0-1) */\n    smoothFactor: number;\n    /** Last phase update timestamp */\n    lastPhaseUpdate: number;\n    /** Animation direction (1 = forward, -1 = reverse) */\n    direction: number;\n    /** Phase transition speed (radians per second) */\n    transitionSpeed: number;\n}\n\n/** Particle controller state for independent particle timing */\nexport interface ParticleControllerState {\n    /** Current particle phase */\n    phase: number;\n    /** Last update timestamp */\n    lastUpdate: number;\n    /** Animation direction */\n    direction: number;\n    /** Transition speed */\n    transitionSpeed: number;\n}\n\n// =============================================================================\n// Timing Manager\n// =============================================================================\n\n/**\n * Creates a timing manager for tracking frame deltas.\n * Uses exponential smoothing to prevent jerky animations.\n *\n * @returns TimingState object with update method\n */\nexport function createTimingManager(): TimingState & {\n    update(currentTime: number): number;\n    reset(): void;\n} {\n    const state: TimingState = {\n        smoothDelta: 0,\n        frameCount: 0,\n        lastTime: performance.now(),\n    };\n\n    return {\n        ...state,\n        get smoothDelta() {\n            return state.smoothDelta;\n        },\n        get frameCount() {\n            return state.frameCount;\n        },\n        get lastTime() {\n            return state.lastTime;\n        },\n\n        /**\n         * Update timing and return smoothed delta time\n         * @param currentTime - Current timestamp from performance.now()\n         * @returns Smoothed delta time in seconds\n         */\n        update(currentTime: number): number {\n            const rawDelta = Math.min(\n                (currentTime - state.lastTime) / 1000,\n                ANIMATION.MAX_DELTA\n            );\n            state.lastTime = currentTime;\n            state.frameCount++;\n            state.smoothDelta =\n                state.smoothDelta * ANIMATION.SMOOTH_FACTOR +\n                rawDelta * (1 - ANIMATION.SMOOTH_FACTOR);\n            return state.smoothDelta;\n        },\n\n        /**\n         * Reset timing state\n         */\n        reset(): void {\n            state.smoothDelta = 0;\n            state.frameCount = 0;\n            state.lastTime = performance.now();\n        },\n    };\n}\n\n// =============================================================================\n// Animation Controller\n// =============================================================================\n\n/**\n * Creates an animation controller for phase-based animations.\n * Handles smooth transitions and direction changes.\n *\n * @param transitionSpeed - Speed of phase transitions (default from config)\n * @returns Animation controller object\n */\nexport function createAnimationController(\n    transitionSpeed = ANIMATION.TRANSITION_SPEED\n): AnimationControllerState & {\n    update(\n        currentTime: number,\n        delta: number,\n        phase: number,\n        getDirection: () => number,\n        getSpeed: () => number\n    ): number;\n    reset(): void;\n} {\n    const state: AnimationControllerState = {\n        targetPhase: 0,\n        smoothFactor: ANIMATION.SMOOTH_FACTOR,\n        lastPhaseUpdate: 0,\n        direction: 1,\n        transitionSpeed,\n    };\n\n    return {\n        ...state,\n        get targetPhase() {\n            return state.targetPhase;\n        },\n        get direction() {\n            return state.direction;\n        },\n\n        /**\n         * Update animation phase with smooth transitions\n         *\n         * @param currentTime - Current timestamp\n         * @param delta - Delta time in seconds\n         * @param phase - Current phase value\n         * @param getDirection - Function to get current direction\n         * @param getSpeed - Function to get current speed multiplier\n         * @returns Updated phase value\n         */\n        update(\n            currentTime: number,\n            delta: number,\n            phase: number,\n            getDirection: () => number,\n            getSpeed: () => number\n        ): number {\n            const direction = getDirection();\n            const speed = Math.max(0.01, getSpeed());\n\n            // Handle direction changes\n            if (state.direction !== direction) {\n                state.direction = direction;\n                state.targetPhase = phase + Math.PI * 2 * state.direction;\n            }\n\n            // Update phase at ~60fps\n            if (currentTime - state.lastPhaseUpdate >= ANIMATION.RAF_THROTTLE) {\n                const phaseStep = state.transitionSpeed * delta * speed;\n\n                // Smooth transition to target phase\n                if (Math.abs(state.targetPhase - phase) > 0.01) {\n                    phase += Math.sign(state.targetPhase - phase) * phaseStep;\n                } else {\n                    // Continuous phase progression\n                    phase += phaseStep * state.direction;\n                    state.targetPhase = phase;\n                }\n\n                state.lastPhaseUpdate = currentTime;\n            }\n\n            return phase;\n        },\n\n        reset(): void {\n            state.targetPhase = 0;\n            state.lastPhaseUpdate = 0;\n            state.direction = 1;\n        },\n    };\n}\n\n// =============================================================================\n// Particle Controller\n// =============================================================================\n\n/**\n * Creates a particle controller for independent particle timing.\n * Similar to animation controller but optimized for particle effects.\n *\n * @param transitionSpeed - Speed of particle phase transitions\n * @returns Particle controller object\n */\nexport function createParticleController(\n    transitionSpeed = ANIMATION.FAST_TRANSITION_SPEED\n): ParticleControllerState & {\n    update(\n        currentTime: number,\n        delta: number,\n        getDirection: () => number,\n        getSpeed: () => number\n    ): number;\n    reset(): void;\n} {\n    const state: ParticleControllerState = {\n        phase: 0,\n        lastUpdate: 0,\n        direction: 1,\n        transitionSpeed,\n    };\n\n    return {\n        ...state,\n        get phase() {\n            return state.phase;\n        },\n        get direction() {\n            return state.direction;\n        },\n\n        /**\n         * Update particle phase\n         *\n         * @param currentTime - Current timestamp\n         * @param delta - Delta time in seconds\n         * @param getDirection - Function to get current direction\n         * @param getSpeed - Function to get current speed multiplier\n         * @returns Updated particle phase\n         */\n        update(\n            currentTime: number,\n            delta: number,\n            getDirection: () => number,\n            getSpeed: () => number\n        ): number {\n            const direction = getDirection();\n            const speed = Math.max(0.01, getSpeed());\n\n            if (state.direction !== direction) {\n                state.direction = direction;\n            }\n\n            if (currentTime - state.lastUpdate >= ANIMATION.RAF_THROTTLE) {\n                state.phase += state.transitionSpeed * delta * speed * state.direction;\n                state.lastUpdate = currentTime;\n            }\n\n            return state.phase;\n        },\n\n        reset(): void {\n            state.phase = 0;\n            state.lastUpdate = 0;\n            state.direction = 1;\n        },\n    };\n}\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\n/**\n * Creates a requestAnimationFrame loop with proper cleanup.\n *\n * @param callback - Function to call each frame with delta time\n * @returns Cleanup function to stop the loop\n */\nexport function createAnimationLoop(\n    callback: (delta: number, time: number) => void\n): () => void {\n    let animationFrameId: number | null = null;\n    let lastTime = performance.now();\n    let running = true;\n\n    const loop = (currentTime: number) => {\n        if (!running) return;\n\n        const delta = Math.min((currentTime - lastTime) / 1000, ANIMATION.MAX_DELTA);\n        lastTime = currentTime;\n\n        callback(delta, currentTime);\n\n        animationFrameId = requestAnimationFrame(loop);\n    };\n\n    animationFrameId = requestAnimationFrame(loop);\n\n    return () => {\n        running = false;\n        if (animationFrameId !== null) {\n            cancelAnimationFrame(animationFrameId);\n        }\n    };\n}\n\n/**\n * Throttles a function to run at most once per animation frame.\n *\n * @param fn - Function to throttle\n * @returns Throttled function\n */\nexport function throttleRAF<T extends (...args: unknown[]) => void>(\n    fn: T\n): (...args: Parameters<T>) => void {\n    let queued = false;\n    let lastArgs: Parameters<T> | null = null;\n\n    return (...args: Parameters<T>) => {\n        lastArgs = args;\n        if (!queued) {\n            queued = true;\n            requestAnimationFrame(() => {\n                queued = false;\n                if (lastArgs) {\n                    fn(...lastArgs);\n                }\n            });\n        }\n    };\n}\n","/**\n * Color utility functions for the ComfyUI Enhanced Links and Nodes extension.\n * This module provides hex/HSL conversion, color validation, alpha handling,\n * and color scheme enhancements.\n *\n * @module utils/colors\n */\n\nimport type { Color, ColorScheme, HexColor } from '@/core/types';\n\n// =============================================================================\n// Configuration\n// =============================================================================\n\n/** Default color used when no valid color is provided */\nexport const DEFAULT_COLOR = '#00ffff'; // Cyan\n\n/** Pre-defined color palettes for different animation styles */\nexport const ANIMATION_COLORS = Object.freeze({\n    gentlePulse: Object.freeze({\n        primary: '#44aaff', // Bright blue\n        secondary: '#88ccff', // Light blue\n        accent: '#0088ff', // Deep blue\n    }),\n    neonNexus: Object.freeze({\n        primary: '#00ff88', // Neon green\n        secondary: '#00ffcc', // Cyan\n        accent: '#00ff44', // Bright green\n    }),\n    cosmicRipple: Object.freeze({\n        primary: '#ff00ff', // Magenta\n        secondary: '#aa00ff', // Purple\n        accent: '#ff40ff', // Light magenta\n    }),\n    flowerOfLife: Object.freeze({\n        primary: '#ffcc00', // Golden\n        secondary: '#ff8800', // Orange\n        accent: '#ffaa00', // Amber\n    }),\n});\n\nexport type AnimationStyle = keyof typeof ANIMATION_COLORS;\n\n// =============================================================================\n// Validation\n// =============================================================================\n\n/**\n * Validates and normalizes a hex color string.\n *\n * @param color - The color string to validate\n * @returns The validated hex color with # prefix, or null if invalid\n *\n * @example\n * validateHexColor('#ff0000') // '#ff0000'\n * validateHexColor('ff0000')  // '#ff0000'\n * validateHexColor('#fff')    // null (shorthand not supported)\n * validateHexColor(null)      // null\n */\nexport function validateHexColor(color: unknown): HexColor | null {\n    if (!color || typeof color !== 'string') return null;\n\n    // Add # prefix if missing\n    const normalized = color.startsWith('#') ? color : `#${color}`;\n\n    // Validate 6-digit hex format\n    if (!/^#[0-9A-Fa-f]{6}$/i.test(normalized)) return null;\n\n    return normalized.toLowerCase() as HexColor;\n}\n\n// =============================================================================\n// HSL Conversion\n// =============================================================================\n\n/**\n * Converts a hex color to HSL values.\n *\n * @param hex - A valid hex color string (with or without #)\n * @returns Tuple of [hue (0-360), saturation (0-100), lightness (0-100)]\n *\n * @example\n * hex2Hsl('#ff0000') // [0, 100, 50] (red)\n * hex2Hsl('#00ff00') // [120, 100, 50] (green)\n */\nexport function hex2Hsl(hex: string): [number, number, number] {\n    const validated = validateHexColor(hex);\n    if (!validated) {\n        console.warn('Invalid hex color for HSL conversion:', hex);\n        return [0, 0, 50]; // Default to gray\n    }\n\n    const r = parseInt(validated.slice(1, 3), 16) / 255;\n    const g = parseInt(validated.slice(3, 5), 16) / 255;\n    const b = parseInt(validated.slice(5, 7), 16) / 255;\n\n    const max = Math.max(r, g, b);\n    const min = Math.min(r, g, b);\n    let h = 0;\n    let s = 0;\n    const l = (max + min) / 2;\n\n    if (max !== min) {\n        const d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n        switch (max) {\n            case r:\n                h = (g - b) / d + (g < b ? 6 : 0);\n                break;\n            case g:\n                h = (b - r) / d + 2;\n                break;\n            case b:\n                h = (r - g) / d + 4;\n                break;\n        }\n        h /= 6;\n    }\n\n    return [h * 360, s * 100, l * 100];\n}\n\n/**\n * Converts HSL values to a hex color string.\n *\n * @param h - Hue (0-360)\n * @param s - Saturation (0-100)\n * @param l - Lightness (0-100)\n * @returns Hex color string with # prefix\n *\n * @example\n * hsl2Hex(0, 100, 50)   // '#ff0000' (red)\n * hsl2Hex(120, 100, 50) // '#00ff00' (green)\n */\nexport function hsl2Hex(h: number, s: number, l: number): HexColor {\n    // Normalize lightness to 0-1 range\n    const lNorm = l / 100;\n    const a = (s * Math.min(lNorm, 1 - lNorm)) / 100;\n\n    const f = (n: number): string => {\n        const k = (n + h / 30) % 12;\n        const color = lNorm - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);\n        return Math.round(255 * color)\n            .toString(16)\n            .padStart(2, '0');\n    };\n\n    return `#${f(0)}${f(8)}${f(4)}` as HexColor;\n}\n\n/**\n * Converts a hex color to RGB values.\n *\n * @param hex - A valid hex color string\n * @returns Object with r, g, b values (0-255) or null if invalid\n */\nexport function hexToRgb(\n    hex: string\n): { r: number; g: number; b: number } | null {\n    const validated = validateHexColor(hex);\n    if (!validated) return null;\n\n    return {\n        r: parseInt(validated.slice(1, 3), 16),\n        g: parseInt(validated.slice(3, 5), 16),\n        b: parseInt(validated.slice(5, 7), 16),\n    };\n}\n\n// =============================================================================\n// Alpha Handling\n// =============================================================================\n\n/**\n * Adds an alpha (transparency) value to a color.\n *\n * Handles hex colors, HSL colors, and already-rgba colors.\n * Returns a CSS rgba() or hsla() string.\n *\n * @param color - The base color (hex, hsl, or rgba)\n * @param alpha - Alpha value from 0 (transparent) to 1 (opaque)\n * @returns CSS color string with alpha applied\n *\n * @example\n * withAlpha('#ff0000', 0.5)       // 'rgba(255, 0, 0, 0.5)'\n * withAlpha('hsl(0, 100%, 50%)', 0.5) // 'hsla(0, 100%, 50%, 0.5)'\n * withAlpha(null, 0.5)            // 'rgba(0, 255, 255, 0.5)' (default cyan)\n */\nexport function withAlpha(color: Color | null | undefined, alpha: number): string {\n    // Clamp alpha to valid range\n    const validAlpha = Math.max(0, Math.min(1, alpha));\n\n    // Handle null/undefined - return default cyan\n    if (!color) {\n        return `rgba(0, 255, 255, ${validAlpha})`;\n    }\n\n    // Handle hex colors\n    if (typeof color === 'string' && color.startsWith('#')) {\n        const rgb = hexToRgb(color);\n        if (rgb) {\n            return `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${validAlpha})`;\n        }\n        // Invalid hex - return default\n        return `rgba(0, 255, 255, ${validAlpha})`;\n    }\n\n    // Handle HSL colors\n    if (typeof color === 'string' && color.startsWith('hsl(')) {\n        return color.replace(/hsl\\((.*)\\)/, `hsla($1, ${validAlpha})`);\n    }\n\n    // Handle HSLA colors - update existing alpha\n    if (typeof color === 'string' && color.startsWith('hsla(')) {\n        return color.replace(/hsla\\(([^,]+),([^,]+),([^,]+),[^)]+\\)/, `hsla($1,$2,$3, ${validAlpha})`);\n    }\n\n    // Handle existing RGBA - update alpha\n    if (typeof color === 'string' && color.startsWith('rgba(')) {\n        return color.replace(/rgba\\(([^,]+),([^,]+),([^,]+),[^)]+\\)/, `rgba($1,$2,$3, ${validAlpha})`);\n    }\n\n    // Return as-is for other formats\n    return color;\n}\n\n// =============================================================================\n// Color Enhancement\n// =============================================================================\n\n/**\n * Applies a color scheme enhancement to a base color.\n *\n * @param color - The base color to enhance\n * @param scheme - The enhancement scheme to apply\n * @returns Enhanced color as hex string\n *\n * @example\n * enhanceColor('#808080', 'saturated') // More saturated gray\n * enhanceColor('#ff0000', 'bright')    // Brighter red\n * enhanceColor('#00ff00', 'muted')     // Muted green\n */\nexport function enhanceColor(color: Color, scheme: ColorScheme): Color {\n    // Default scheme returns the color unchanged\n    if (scheme === 'default') return color;\n\n    // Validate the input color\n    const validated = validateHexColor(color);\n    if (!validated) return color;\n\n    // Convert to HSL for manipulation\n    const [h, s, l] = hex2Hsl(validated);\n\n    // Apply enhancement based on scheme\n    switch (scheme) {\n        case 'saturated':\n            return hsl2Hex(h, Math.min(s * 1.3, 100), l);\n\n        case 'vivid':\n            return hsl2Hex(h, Math.min(s * 1.4, 100), Math.min(l * 1.1, 100));\n\n        case 'contrast':\n            return hsl2Hex(\n                h,\n                Math.min(s * 1.2, 100),\n                l > 50 ? Math.min(l * 1.2, 100) : Math.max(l * 0.8, 0)\n            );\n\n        case 'bright':\n            return hsl2Hex(h, s, Math.min(l * 1.25, 100));\n\n        case 'muted':\n            return hsl2Hex(h, Math.max(s * 0.7, 0), Math.min(l * 1.1, 100));\n\n        default:\n            return validated;\n    }\n}\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\n/**\n * Gets the complementary color (180 degrees opposite on the color wheel).\n *\n * @param color - Base hex color\n * @returns Complementary hex color\n */\nexport function getComplementaryColor(color: string): HexColor {\n    const [h, s, l] = hex2Hsl(color);\n    return hsl2Hex((h + 180) % 360, s, l);\n}\n\n/**\n * Creates an HSL color string for use in CSS.\n *\n * @param h - Hue (0-360)\n * @param s - Saturation (0-100)\n * @param l - Lightness (0-100)\n * @returns CSS hsl() color string\n */\nexport function hsl(h: number, s: number, l: number): string {\n    return `hsl(${h}, ${s}%, ${l}%)`;\n}\n\n/**\n * Creates an HSLA color string for use in CSS.\n *\n * @param h - Hue (0-360)\n * @param s - Saturation (0-100)\n * @param l - Lightness (0-100)\n * @param a - Alpha (0-1)\n * @returns CSS hsla() color string\n */\nexport function hsla(h: number, s: number, l: number, a: number): string {\n    return `hsla(${h}, ${s}%, ${l}%, ${Math.max(0, Math.min(1, a))})`;\n}\n\n/**\n * Gets the animation colors for a specific animation style.\n *\n * @param style - Animation style name or number (1-4)\n * @returns Color palette for the animation style\n */\nexport function getAnimationColors(\n    style: AnimationStyle | number\n): (typeof ANIMATION_COLORS)[AnimationStyle] {\n    if (typeof style === 'number') {\n        switch (style) {\n            case 1:\n                return ANIMATION_COLORS.gentlePulse;\n            case 2:\n                return ANIMATION_COLORS.neonNexus;\n            case 3:\n                return ANIMATION_COLORS.cosmicRipple;\n            case 4:\n                return ANIMATION_COLORS.flowerOfLife;\n            default:\n                return ANIMATION_COLORS.gentlePulse;\n        }\n    }\n    return ANIMATION_COLORS[style] || ANIMATION_COLORS.gentlePulse;\n}\n","/**\n * Utility for creating the Ã†motion Studio Splash / Pattern Designer Window.\n * Ported from JS with XSS security fixes.\n */\n\n// Generate a random nonce for CSP\nconst generateNonce = (): string => {\n    if (typeof window !== 'undefined' && window.crypto) {\n        if (typeof window.crypto.randomUUID === 'function') {\n            return window.crypto.randomUUID();\n        }\n        if (typeof window.crypto.getRandomValues === 'function') {\n            const array = new Uint8Array(16);\n            window.crypto.getRandomValues(array);\n            return Array.from(array, (byte) => byte.toString(16).padStart(2, '0')).join('');\n        }\n    }\n    // Fail securely if no crypto API is available\n    throw new Error(\"Secure random number generation is not available.\");\n};\n\nexport const createPatternDesignerWindow = (): HTMLDivElement => {\n    // Capture focus before opening to restore it later\n    const previousFocus = document.activeElement as HTMLElement;\n\n    const modal = document.createElement('div');\n    modal.setAttribute('role', 'dialog');\n    modal.setAttribute('aria-modal', 'true');\n    modal.setAttribute('aria-labelledby', 'designer-title');\n    modal.style.cssText = `\n        position: fixed;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        background-color: #0a0a0a;\n        padding: 10px;\n        border-radius: 8px;\n        z-index: 9999;\n        box-shadow: 0 0 20px rgba(0,0,0,0.5);\n        width: 90vw;\n        height: 90vh;\n        display: flex;\n        flex-direction: column;\n    `;\n\n    const titleBar = document.createElement('div');\n    titleBar.style.cssText = `\n        padding: 10px;\n        margin-bottom: 10px;\n        cursor: move;\n        background-color: #2a2a2a;\n        border-radius: 4px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    `;\n\n    const title = document.createElement('span');\n    title.id = 'designer-title';\n    title.textContent = 'About Ã†motion Studio';\n    title.style.cssText = `\n        color: #e0e0e0;\n        font-weight: bold;\n        font-family: 'Orbitron', sans-serif;\n    `;\n    titleBar.appendChild(title);\n\n    // Make window draggable\n    let isDragging = false;\n    let currentX: number;\n    let currentY: number;\n    let initialX: number;\n    let initialY: number;\n\n    const onMouseMove = (e: MouseEvent) => {\n        if (isDragging) {\n            e.preventDefault();\n            currentX = e.clientX - initialX;\n            currentY = e.clientY - initialY;\n            modal.style.left = currentX + 'px';\n            modal.style.top = currentY + 'px';\n        }\n    };\n\n    const onMouseUp = () => {\n        isDragging = false;\n    };\n\n    // Use addEventListener instead of overwriting onmousemove/onmouseup\n    // to prevent conflicts with other extensions or core UI.\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n\n    // Handle Escape key to close the modal\n    const onKeyDown = (e: KeyboardEvent) => {\n        if (e.key === 'Escape') {\n            closeButton.click();\n        }\n    };\n    document.addEventListener('keydown', onKeyDown);\n\n    const closeButton = document.createElement('button');\n    closeButton.textContent = 'Ã—';\n    closeButton.setAttribute('aria-label', 'Close');\n    closeButton.setAttribute('title', 'Close');\n    closeButton.style.cssText = `\n        background: none;\n        border: none;\n        color: #e0e0e0;\n        font-size: 20px;\n        cursor: pointer;\n        transition: color 0.2s ease;\n    `;\n\n    closeButton.onclick = () => {\n        // Cleanup event listeners when closing\n        document.removeEventListener('mousemove', onMouseMove);\n        document.removeEventListener('mouseup', onMouseUp);\n        document.removeEventListener('keydown', onKeyDown);\n        modal.remove();\n\n        // Restore focus\n        if (previousFocus && typeof previousFocus.focus === 'function') {\n            previousFocus.focus();\n        }\n    };\n\n    closeButton.onmouseenter = () => { closeButton.style.color = '#ffffff'; };\n    closeButton.onmouseleave = () => { closeButton.style.color = '#e0e0e0'; };\n    titleBar.appendChild(closeButton);\n\n    modal.appendChild(titleBar);\n\n    const iframe = document.createElement('iframe');\n    iframe.style.cssText = `\n        flex: 1;\n        border: none;\n        border-radius: 4px;\n        background-color: #1a1a1a;\n    `;\n\n    const nonce = generateNonce();\n\n    // Embed the complete HTML content\n    // NOTE: Styles are now injected safely via onload handler instead of template interpolation\n    // to prevent potential XSS vulnerabilities.\n    const htmlContent = `\n        <html lang=\"en\">\n            <head>\n            <meta charset=\"UTF-8\" />\n            <meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'none'; script-src 'nonce-${nonce}'; style-src 'nonce-${nonce}' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; img-src 'self' data:; connect-src 'none';\" />\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n            <title>Ã†motion Studio</title>\n            <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" />\n            <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin />\n            <link\n                href=\"https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Montserrat:wght@300;400;700&display=swap\"\n                rel=\"stylesheet\"\n            />\n                <style id=\"injected-styles\" nonce=\"${nonce}\">\n                /* Styles will be injected here programmatically */\n                </style>\n                <style nonce=\"${nonce}\">\n                * {\n                    box-sizing: border-box;\n                        margin: 0;\n                    padding: 0;\n                }\n\n                body {\n                    background: linear-gradient(135deg, #0a0a0a, #1a1a1a);\n                    font-family: 'Montserrat', sans-serif;\n                    overflow: hidden;\n                    color: #e0e0e0;\n                }\n\n                #overlay {\n                    position: fixed;\n                    top: 0;\n                    left: 0;\n                    width: 100vw;\n                    height: 100vh;\n                    background: radial-gradient(circle, rgba(0, 255, 255, 0.2), rgba(255, 0, 255, 0.2));\n                    z-index: 1000;\n                    pointer-events: none;\n                    animation: fadeOut 1.5s ease-out forwards;\n                }\n\n                @keyframes fadeOut {\n                    from { opacity: 0.8; }\n                    to { opacity: 0; }\n                }\n\n                #splash {\n                        width: 100%;\n                    height: 100vh;\n                    position: relative;\n                    display: flex;\n                    flex-direction: column;\n                    align-items: center;\n                    justify-content: flex-start;\n                    padding-top: 40px;\n                    overflow-y: auto;\n                    background: radial-gradient(circle at center, rgba(40,40,40,0.2) 0%, rgba(0,0,0,0.4) 100%);\n                    animation: splashEntrance 1s ease-out forwards;\n                }\n\n                @keyframes splashEntrance {\n                    from {\n                        opacity: 0;\n                        transform: scale(0.95);\n                    }\n                    to {\n                        opacity: 1;\n                        transform: scale(1);\n                    }\n                }\n\n                #centerTitle {\n                    font-size: 3rem;\n                    font-weight: bold;\n                    text-transform: uppercase;\n                    letter-spacing: 4px;\n                    -webkit-text-stroke: 2px var(--text-color);\n                    color: white;\n                    text-shadow: 0 0 10px var(--text-glow);\n                    animation: textGlow 6s ease-in-out infinite; \n                    font-family: 'Orbitron', sans-serif;\n                    margin-bottom: 1rem;\n                    --text-color: #00ffff;\n                    --text-glow: rgba(0, 255, 255, 0.8);\n                }\n\n                @keyframes textGlow {\n                    0% {\n                        -webkit-text-stroke: 2px rgba(0, 255, 255, 1);\n                        text-shadow:\n                            0 0 10px rgba(0, 255, 255, 0.8),\n                            0 0 20px rgba(0, 255, 255, 0.4);\n                    }\n                    50% {\n                        -webkit-text-stroke: 2px rgba(0, 255, 255, 0.5);\n                        text-shadow:\n                            0 0 15px rgba(0, 255, 255, 0.4),\n                            0 0 25px rgba(0, 255, 255, 0.2);\n                    }\n                    100% {\n                        -webkit-text-stroke: 2px rgba(0, 255, 255, 1);\n                        text-shadow:\n                            0 0 10px rgba(0, 255, 255, 0.8),\n                            0 0 20px rgba(0, 255, 255, 0.4);\n                    }\n                }\n\n                #ballsContainer {\n                    position: relative;\n                    width: 100%;\n                    height: 45vh;  \n                    margin-top: 0; \n                    perspective: 1000px;\n                }\n\n                #ballsContainer:has(.ball-link:hover) .ball-link {\n                    animation-play-state: paused;\n                }\n\n                .ball-link {\n                    position: absolute;\n                    left: 50%;\n                    top: 50%;\n                    transform: translate(-50%, -50%);\n                    text-decoration: none;\n                    color: inherit;\n                    transition: transform 0.3s ease;\n                    animation: orbitalMotion 20s linear infinite;\n                    transform-origin: 50% 160px;\n                }\n\n                .ball-link:nth-child(1) { animation-delay: 0s; }\n                .ball-link:nth-child(2) { animation-delay: -5s; }\n                .ball-link:nth-child(3) { animation-delay: -10s; }\n                .ball-link:nth-child(4) { animation-delay: -15s; }\n\n                @keyframes orbitalMotion {\n                    0% {\n                        transform: translate(-50%, -50%) rotate(0deg) translateY(-160px) rotate(0deg) scale(0.7);\n                    }\n                    25% {\n                        transform: translate(-50%, -50%) rotate(-90deg) translateY(-160px) rotate(90deg) scale(1);\n                    }\n                    50% {\n                        transform: translate(-50%, -50%) rotate(-180deg) translateY(-160px) rotate(180deg) scale(1.3);\n                    }\n                    75% {\n                        transform: translate(-50%, -50%) rotate(-270deg) translateY(-160px) rotate(270deg) scale(1);\n                    }\n                    100% {\n                        transform: translate(-50%, -50%) rotate(-360deg) translateY(-160px) rotate(360deg) scale(0.7);\n                    }\n                }\n\n                .ball-link:hover {\n                    transform: translate(-50%, -50%) scale(1.1);\n                }\n\n                .sphere-container {\n                    width: 90px;\n                    height: 90px;\n                    position: relative;\n                    transform-style: preserve-3d;\n                    animation: hoverEffect 3s ease-in-out infinite;\n                    animation-play-state: running !important;\n                }\n\n                .sphere {\n                    position: absolute;\n                    width: 100%;\n                    height: 100%;\n                    border-radius: 50%;\n                    cursor: pointer;\n                    pointer-events: auto;\n                }\n\n                .logo {\n                    position: absolute;\n                    top: 53%; \n                    left: 50%;\n                    transform: translate(-50%, -50%);\n                    filter: drop-shadow(0 0 2px rgba(255,255,255,0.5));\n                    z-index: 1;\n                    pointer-events: none;\n                }\n\n                @keyframes hoverEffect {\n                    0% { transform: translateY(0); }\n                    50% { transform: translateY(-10px); }\n                    100% { transform: translateY(0); }\n                }\n\n                .sphere-container.youtube,\n                .sphere-container.github,\n                .sphere-container.discord,\n                .sphere-container.website {\n                    width: 90px;\n                    height: 90px;\n                }\n\n                .logo svg {\n                    width: 30px;\n                    height: 30px;\n                    transition: all 0.3s ease;\n                }\n\n                .sphere {\n                    transition: all 0.3s ease;\n                }\n\n                .sphere::after {\n                    content: '';\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    bottom: 0;\n                    border-radius: 50%;\n                    background: radial-gradient(circle at 30% 30%,\n                        rgba(255, 255, 255, 0.3) 0%,\n                        rgba(255, 255, 255, 0.1) 50%,\n                        rgba(0, 0, 0, 0.1) 100%);\n                    pointer-events: none;\n                }\n\n                .sphere-youtube {\n                    background: radial-gradient(circle at 30% 30%,\n                        rgba(255, 0, 0, 0.8) 0%,\n                        rgba(255, 0, 0, 0.2) 60%,\n                        rgba(255, 0, 0, 0) 100%);\n                    box-shadow: 0 0 30px rgba(255, 0, 0, 0.3);\n                }\n\n                .sphere-github {\n                    background: radial-gradient(circle at 30% 30%,\n                        rgba(51, 51, 51, 0.8) 0%,\n                        rgba(51, 51, 51, 0.2) 60%,\n                        rgba(51, 51, 51, 0) 100%);\n                    box-shadow: 0 0 30px rgba(51, 51, 51, 0.3);\n                }\n\n                .sphere-discord {\n                    background: radial-gradient(circle at 30% 30%,\n                        rgba(88, 101, 242, 0.8) 0%,\n                        rgba(88, 101, 242, 0.2) 60%,\n                        rgba(88, 101, 242, 0) 100%);\n                    box-shadow: 0 0 30px rgba(88, 101, 242, 0.3);\n                }\n\n                .sphere-website {\n                    background: radial-gradient(circle at 30% 30%,\n                        rgba(255, 0, 255, 0.8) 0%,\n                        rgba(255, 0, 255, 0.2) 60%,\n                        rgba(255, 0, 255, 0) 100%);\n                    box-shadow: 0 0 30px rgba(255, 0, 255, 0.3);\n                }\n\n                #about {\n                    margin-top: 5px;\n                    padding: 12px;\n                    font-size: 0.8rem;\n                    max-width: 550px;\n                    color: white;\n                    text-align: center;\n                    line-height: 1.4;\n                    background: rgba(255,255,255,0.05);\n                    border-radius: 15px;\n                    backdrop-filter: blur(10px);\n                    border: 1px solid rgba(255, 255, 255, 0.18);\n                    transition: transform 0.3s ease;\n                    --text-color: #00ffff;\n                }\n\n                #aboutContent {\n                    margin-bottom: 12px;\n                }\n\n                #aboutContent p {\n                    margin-bottom: 0.5em;\n                    line-height: 1.3;\n                    color: white;\n                    text-shadow: 0 0 10px rgba(0, 255, 255, 0.3);\n                    transition: text-shadow 0.3s ease;\n                    font-size: 0.95rem;\n                    letter-spacing: -0.01em;\n                    font-weight: 400;\n                }\n\n                #aboutContent p:hover {\n                    text-shadow: 0 0 15px #00ffff;\n                }\n\n                #rainbowText {\n                    font-size: 1rem;\n                    margin-top: 10px;\n                    font-weight: bold;\n                    text-align: center;\n                    font-family: 'Orbitron', sans-serif;\n                    letter-spacing: 0.02em;\n                    padding-top: 2px;\n                    color: #ff00ff;\n                }\n\n                @keyframes rainbowWave {\n                    0% { transform: translateY(0); color: #ff00ff; }\n                    20% { transform: translateY(-5px); color: #ff40ff; }\n                    40% { transform: translateY(0); color: #ff00ff; }\n                    60% { transform: translateY(-5px); color: #ff40ff; }\n                    80% { transform: translateY(0); color: #ff00ff; }\n                    100% { transform: translateY(0); color: #ff00ff; }\n                }\n\n                .sphere-container.youtube .logo svg {\n                    width: 45px;\n                    height: 35px;\n                    filter: drop-shadow(0 0 2px rgba(255,255,255,0.6));\n                }\n\n                .sphere-container.github .logo svg,\n                .sphere-container.discord .logo svg,\n                .sphere-container.website .logo svg {\n                    width: 40px;\n                    height: 40px;\n                    filter: drop-shadow(0 0 2px rgba(255,255,255,0.6));\n                }\n            </style>\n        </head>\n        <body>\n            <div id=\"overlay\"></div>\n            <div id=\"splash\">\n                <div id=\"centerTitle\">Ã†motion Studio</div>\n                <div id=\"ballsContainer\">\n                    <a class=\"ball-link\" href=\"https://www.youtube.com/@aemotionstudio/videos\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"YouTube Channel\" title=\"YouTube Channel\">\n                        <div class=\"sphere-container youtube\">\n                            <div class=\"sphere sphere-youtube\"></div>\n                            <div class=\"logo\">\n                                <svg viewBox=\"0 0 71.412065 50\" width=\"45\" height=\"35\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"white\">\n                                    <path d=\"M69.912,7.82a8.977,8.977,0,0,0-6.293-6.293C58.019,0,35.706,0,35.706,0S13.393,0,7.793,1.527A8.977,8.977,0,0,0,1.5,7.82C0,13.42,0,25,0,25S0,36.58,1.5,42.18a8.977,8.977,0,0,0,6.293,6.293C13.393,50,35.706,50,35.706,50s22.313,0,27.913-1.527a8.977,8.977,0,0,0,6.293-6.293C71.412,36.58,71.412,25,71.412,25S71.412,13.42,69.912,7.82ZM28.564,35.714V14.286L47.471,25Z\"/>\n                                </svg>\n                            </div>\n                        </div>\n                    </a>\n                    <a class=\"ball-link\" href=\"https://github.com/AEmotionStudio/\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"GitHub Repository\" title=\"GitHub Repository\">\n                        <div class=\"sphere-container github\">\n                            <div class=\"sphere sphere-github\"></div>\n                            <div class=\"logo\">\n                                <svg viewBox=\"0 0 98 96\" width=\"40\" height=\"40\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"white\">\n                                    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 5.052 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z\"/>\n                                </svg>\n                            </div>\n                        </div>\n                    </a>\n                    <a class=\"ball-link\" href=\"https://discord.gg/UzC9353mfp\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Join Discord Server\" title=\"Join Discord Server\">\n                        <div class=\"sphere-container discord\">\n                            <div class=\"sphere sphere-discord\"></div>\n                            <div class=\"logo\">\n                                <svg viewBox=\"0 0 127.14 96.36\" width=\"40\" height=\"40\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"white\">\n                                    <path d=\"M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z\"/>\n                                </svg>\n                            </div>\n                        </div>\n                    </a>\n                    <a class=\"ball-link\" href=\"https://aemotionstudio.org/\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Visit Website\" title=\"Visit Website\">\n                        <div class=\"sphere-container website\">\n                            <div class=\"sphere sphere-website\"></div>\n                            <div class=\"logo\">\n                                <svg viewBox=\"0 0 512 512\" width=\"40\" height=\"40\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"white\">\n                                    <path d=\"M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zm0 464c-114.7 0-208-93.31-208-208S141.3 48 256 48s208 93.31 208 208S370.7 464 256 464zM256 336c44.13 0 80-35.88 80-80c0-44.13-35.88-80-80-80c-44.13 0-80 35.88-80 80C176 291.9 211.9 328 256 328zM256 208c26.47 0 48 21.53 48 48s-21.53 48-48 48s-48-21.53-48-48S229.5 208 256 208zM256 128c70.75 0 128 57.25 128 128s-57.25 128-128 128s-128-57.25-128-128S185.3 128 256 128z\"/>\n                                </svg>\n                            </div>\n                        </div>\n                    </a>\n                </div>\n                <div id=\"about\">\n                    <div id=\"aboutContent\">\n                        <p>\n                            Ã†motion Studio is a cutting-edge art collective that pushes the boundaries of creativity and technology.\n                        </p>\n                        <p>\n                            Our mission is to provide spaces where artists, engineers, AI enthusiasts, and art lovers can explore, create, and experience the future of digital art and digital performances together.\n                        </p>\n                        <p>\n                            As both founder and lead artist, Ã†motion is actively seeking partners, artists, engineers, and developers to join in expanding the studio's vision. Whether you're interested in collaboration, investment opportunities, or commissioning work, let's create something extraordinary together.\n                        </p>\n                    </div>\n                    <p id=\"rainbowText\">Click the links above for more!</p>\n                </div>\n            </div>\n            <script nonce=\"${nonce}\">\n                document.addEventListener(\"DOMContentLoaded\", () => {\n                    console.log(\"Ã†motion Studio splash page loaded with enhanced CSS spheres and dynamic about text.\");\n                    addRainbowEffect();\n\n                    const overlay = document.getElementById(\"overlay\");\n                    if (overlay) {\n                        overlay.addEventListener(\"animationend\", () => {\n                            overlay.remove();\n                        });\n                    }\n                });\n\n                function addRainbowEffect() {\n                    const rainbowElem = document.getElementById(\"rainbowText\");\n                    const text = rainbowElem.textContent;\n                    rainbowElem.innerHTML = \"\";\n                    text.split(\"\").forEach((char, index) => {\n                        const span = document.createElement(\"span\");\n                        span.textContent = char === \" \" ? \"\\u00A0\" : char;\n                        span.style.whiteSpace = \"pre\";\n                        span.style.animation = \\`rainbowWave 2s infinite\\`;\n                        span.style.animationDelay = \\`\\${index * 0.1}s\\`;\n                        rainbowElem.appendChild(span);\n                    });\n                }\n                </script>\n            </body>\n        </html>\n    `;\n\n    // Inject styles safely after iframe loads\n    iframe.onload = () => {\n        try {\n            const doc = iframe.contentDocument;\n            if (doc) {\n                const injectedStyles = doc.getElementById('injected-styles');\n                const parentStyles = document.querySelector('style');\n                if (injectedStyles && parentStyles) {\n                    injectedStyles.textContent = parentStyles.textContent;\n                }\n            }\n        } catch (e) {\n            console.error(\"Error injecting styles into pattern designer window:\", e);\n        }\n    };\n\n    iframe.srcdoc = htmlContent;\n    modal.appendChild(iframe);\n\n    titleBar.onmousedown = (e) => {\n        isDragging = true;\n\n        const rect = modal.getBoundingClientRect();\n        modal.style.transform = 'none';\n        modal.style.left = rect.left + 'px';\n        modal.style.top = rect.top + 'px';\n\n        initialX = e.clientX - rect.left;\n        initialY = e.clientY - rect.top;\n    };\n\n    // Focus the close button after the modal is added to the DOM\n    setTimeout(() => {\n        closeButton.focus();\n    }, 10);\n\n    return modal;\n};\n"],"names":[],"mappings":"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AIgF,KAAK,uBAAuB,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qDASpF,KAAK;AAAA;AAAA;AAAA,gCAG1B,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAqXR,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgC9B,SAAO,SAAS,MAAM;AAClB,QAAI;AACA,YAAM,MAAM,OAAO;AACnB,UAAI,KAAK;AACL,cAAM,iBAAiB,IAAI,eAAe,iBAAiB;AAC3D,cAAM,eAAe,SAAS,cAAc,OAAO;AACnD,YAAI,kBAAkB,cAAc;AAChC,yBAAe,cAAc,aAAa;AAAA,QAC9C;AAAA,MACJ;AAAA,IACJ,SAAS,GAAG;AACR,cAAQ,MAAM,wDAAwD,CAAC;AAAA,IAC3E;AAAA,EACJ;AAEA,SAAO,SAAS;AAChB,QAAM,YAAY,MAAM;AAExB,WAAS,cAAc,CAAC,MAAM;AAC1B,iBAAa;AAEb,UAAM,OAAO,MAAM,sBAAA;AACnB,UAAM,MAAM,YAAY;AACxB,UAAM,MAAM,OAAO,KAAK,OAAO;AAC/B,UAAM,MAAM,MAAM,KAAK,MAAM;AAE7B,eAAW,EAAE,UAAU,KAAK;AAC5B,eAAW,EAAE,UAAU,KAAK;AAAA,EAChC;AAGA,aAAW,MAAM;AACb,gBAAY,MAAA;AAAA,EAChB,GAAG,EAAE;AAEL,SAAO;AACX;"}