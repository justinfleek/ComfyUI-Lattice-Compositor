# BUG-120: NestedCompLayer.setFPS() No Validation - Division by Zero

## Summary
The `setFPS(fps)` method accepts the fps parameter without validation and stores it as `parentFPS`. This value is used as a divisor in `calculateNestedFrame()` when frame rate override is enabled, causing division by zero when fps=0.

## Severity: MEDIUM

## Location
- File: /ui/src/engine/layers/NestedCompLayer.ts
- Lines: 149-151 (setFPS), 229 (division)
- Functions: setFPS, calculateNestedFrame

## The Bug
```typescript
// Lines 149-151
setFPS(fps: number): void {
  this.parentFPS = fps;  // No validation!
}

// Line 229 in calculateNestedFrame():
if (this.nestedCompData.overrideFrameRate && this.nestedCompData.frameRate) {
  const parentFps = this.parentFPS;
  const childFps = this.nestedCompData.frameRate;
  nestedFrame = layerFrame * stretchFactor * (childFps / parentFps);
  //                                          ^^^^^^^^^^^^^^^^^^^^
  // If parentFps=0: division by zero!
}
```

## Proof of Failure
```typescript
const nestedLayer = new NestedCompLayer(layerData);
nestedLayer.setRenderContext(context);

// Set frame rate override to trigger the division code path
nestedLayer.setFrameRateOverride(true, 30);

// Attack: set parentFPS to 0
nestedLayer.setFPS(0);

// Evaluate a frame
nestedLayer.evaluateFrame(10);
// In calculateNestedFrame:
// parentFps = 0
// nestedFrame = layerFrame * stretchFactor * (30 / 0)
// nestedFrame = layerFrame * stretchFactor * Infinity
// nestedFrame = Infinity

// Math.floor(Infinity) = Infinity
// Clamping at line 256-259 produces:
// clampedFrame = Math.max(0, Math.min(Infinity, frameCount - 1))
// clampedFrame = frameCount - 1

// While this doesn't crash, Infinity propagating could cause issues
// in other contexts where this value is used.

// Attack 2: NaN
nestedLayer.setFPS(NaN);
// nestedFrame = layerFrame * stretchFactor * (30 / NaN) = NaN
// Math.max(0, Math.min(NaN, frameCount-1)) = NaN
// renderComposition called with NaN frame
```

## Impact
- Division by zero produces Infinity in frame calculations
- NaN fps produces NaN frame values
- Could cause invalid frame requests to nested compositions
- Medium severity: SYSTEMIC-003 pattern (fps=0 division by zero)

## Related
- BUG-116: VideoLayer.setFPS same pattern
- BUG-090: BaseLayer.setCompositionFps same pattern
- BUG-102: LatticeEngine.setCompositionFPS same pattern
- SYSTEMIC-003: Division by zero / fps=0 pattern
- 14A: Numeric inputs - 0, NaN testing

## Suggested Fix
```typescript
setFPS(fps: number): void {
  if (!Number.isFinite(fps) || fps <= 0) {
    console.warn('NestedCompLayer.setFPS: Invalid fps, using 16');
    fps = 16;
  }
  this.parentFPS = fps;
}
```
