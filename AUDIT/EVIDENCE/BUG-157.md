# BUG-157: LightLayer.setColorTemperature() No Validation

## Summary
setColorTemperature() passes kelvin value directly to kelvinToRGB() without validation. Values ≤0 cause Math.log(0)=-Infinity or Math.log(negative)=NaN, corrupting light color.

## Severity: LOW

## Location
- File: /ui/src/engine/layers/LightLayer.ts
- Lines: 643-648
- Function: setColorTemperature()

## Crash Path Trace
```
Function: setColorTemperature(kelvin: number)

Line 646: const rgb = kelvinToRGB(kelvin);
  → kelvinToRGB() at lines 179-214:

  Line 180: const temp = kelvin / 100;
    - kelvin=0 → temp=0
    - kelvin=-100 → temp=-1

  Line 194-195 (when temp <= 66):
    g = temp;  // g=0 or g=-1
    g = 99.4708025861 * Math.log(g) - 161.1195681661;
    - Math.log(0) = -Infinity
    - Math.log(-1) = NaN

  Line 200: g = Math.max(0, Math.min(255, g));
    - Math.max(0, NaN) = NaN (SYSTEMIC-005)

  Line 208-209 (when temp <= 19 is false but temp-10 <= 0):
    b = 138.5177312231 * Math.log(temp - 10) - 305.0447927307;
    - temp=5 → Math.log(-5) = NaN

Line 647: this.light.color.setRGB(rgb.r, rgb.g, rgb.b);
  - rgb.g = NaN → light color corrupted

Result: SILENT CORRUPTION - light color becomes NaN
```

## Code Evidence
```typescript
// Lines 643-648
setColorTemperature(kelvin: number): void {
  this.lightData.colorTemperature = kelvin;  // No validation
  this.lightData.useColorTemperature = true;
  const rgb = kelvinToRGB(kelvin);  // Triggers Math.log issues
  this.light.color.setRGB(rgb.r, rgb.g, rgb.b);
}

// Lines 193-196 in kelvinToRGB()
if (temp <= 66) {
  g = temp;
  g = 99.4708025861 * Math.log(g) - 161.1195681661;  // Math.log(0)=-Inf, Math.log(-1)=NaN
}
```

## Impact
- kelvin=0: Math.log(0) = -Infinity → color channels corrupt
- kelvin negative: Math.log(negative) = NaN → color channels NaN
- Light renders with undefined color (black/white/garbage)
- Extends BUG-081 (kelvinToRGB NaN) to public API entry point

## Suggested Fix
```typescript
setColorTemperature(kelvin: number): void {
  if (!Number.isFinite(kelvin) || kelvin < 1000 || kelvin > 40000) {
    console.warn(`setColorTemperature: invalid kelvin ${kelvin}`);
    return;
  }
  // ...
}
```
