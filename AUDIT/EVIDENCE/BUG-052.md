# BUG-052: Infinite Loop in bakePhysicsToKeyframes with sampleInterval=0

## Summary
The `bakePhysicsToKeyframes` function uses a for-loop that increments by `sampleInterval`. When `sampleInterval=0`, the loop variable never changes, causing an infinite loop that freezes the application.

## Severity: MEDIUM

## Location
- File: /ui/src/stores/actions/physicsActions.ts
- Lines: 464
- Function: bakePhysicsToKeyframes

## The Bug
```typescript
// Line 451-453: sampleInterval comes from options with default 1
const startFrame = options.startFrame ?? 0;
const endFrame = options.endFrame ?? comp.settings.frameCount - 1;
const sampleInterval = options.sampleInterval ?? 1;

// Line 464: The problematic loop
for (let frame = startFrame; frame <= endFrame; frame += sampleInterval) {
  const state = engine.evaluateFrame(frame);
  // ...
}
```

## Proof of Failure
```typescript
// Call with sampleInterval=0
await bakePhysicsToKeyframes(store, layerId, { sampleInterval: 0 });

// What happens:
// frame = 0
// Loop condition: 0 <= 100 → true
// Loop body executes...
// frame += 0 → frame = 0
// Loop condition: 0 <= 100 → true
// Loop body executes...
// frame += 0 → frame = 0
// ... INFINITE LOOP

// Browser hangs, must force-kill tab
```

## Two Vectors
1. **Direct call**: User explicitly passes `{ sampleInterval: 0 }`
2. **Computed value**: A calculation produces 0 (e.g., `Math.floor(0.5)`)

## Impact
- Application freezes completely
- User loses unsaved work
- Browser tab must be force-killed
- Medium severity because requires explicit parameter, but catastrophic when triggered

## Suggested Fix
Validate sampleInterval before the loop:
```typescript
export async function bakePhysicsToKeyframes(
  store: PhysicsStore,
  layerId: string,
  options: BakeOptions = {}
): Promise<BakeResult> {
  // ...

  const sampleInterval = options.sampleInterval ?? 1;

  // FIX: Validate sampleInterval
  if (!Number.isFinite(sampleInterval) || sampleInterval <= 0) {
    throw new Error(`Invalid sampleInterval: ${sampleInterval}. Must be > 0.`);
  }

  // Or use Math.max to ensure minimum of 1
  const safeSampleInterval = Math.max(1, sampleInterval);

  for (let frame = startFrame; frame <= endFrame; frame += safeSampleInterval) {
    // ...
  }
}
```
