# BUG-021: Infinite Loop with Infinity/Large frequencyBands or displayedSamples

## Summary
The audio visualizer loops use user-provided `frequencyBands` and `displayedSamples` parameters as loop bounds without validation. Setting these to `Infinity` or extremely large values causes infinite loops that hang the browser.

## Severity: MEDIUM

## Location
- File: /ui/src/services/effects/audioVisualizer.ts
- Lines: 141, 248, 272, 360, 380, 394, 429, 440
- Functions: renderAudioSpectrum, renderAudioWaveform, generateSpectrumData, generateWaveformData

## The Bug
```typescript
// Line 141 (renderAudioSpectrum)
for (let i = 0; i < frequencyBands; i++) {
  // If frequencyBands = Infinity, this never terminates
}

// Line 360 (renderAudioWaveform)
for (let i = 0; i < displayedSamples; i++) {
  // If displayedSamples = Infinity, this never terminates
}
```

No validation of these parameters before use:
```typescript
const {
  frequencyBands = 64,  // Default is safe, but user can override
  // ...
} = params;
```

## Proof of Failure
```typescript
const params = {
  frequencyBands: Infinity,  // Or Number.MAX_VALUE
  // ...
};

renderAudioSpectrum(input, params, 0);
// Loop at line 141 runs forever
// Browser tab hangs/crashes
```

## Impact
- Browser tab hangs indefinitely
- Must force-kill tab/process
- Could be triggered by malformed project file
- DoS vector if projects are shared

## Related Edge Cases
- `frequencyBands = NaN` → `i < NaN` is always false → loop never executes (silent failure)
- `frequencyBands = -1` → `i < -1` is false → loop never executes
- `frequencyBands = 1e10` → Loop runs 10 billion times → effective hang

## Suggested Fix
```typescript
const frequencyBands = Math.min(Math.max(1, params.frequencyBands || 64), 1024);
const displayedSamples = Math.min(Math.max(1, params.displayedSamples || 200), 4096);
```
