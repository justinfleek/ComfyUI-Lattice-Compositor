# BUG-100: GPUParticleSystem.dispose() Incomplete Cleanup

## Summary
The `dispose()` method doesn't clean up all subsystems. `spatialHash`, `flockingSystem`, `collisionSystem`, `subEmitterSystem`, and `modulationSystem` are not disposed, potentially causing memory leaks.

## Severity: LOW

## Location
- File: /ui/src/engine/particles/GPUParticleSystem.ts
- Lines: 1659-1698
- Function: dispose

## The Bug
```typescript
// Lines 1659-1698
dispose(): void {
  // Dispose Three.js resources
  this.instancedGeometry?.dispose();
  this.material?.dispose();
  this.sizeOverLifetimeTexture?.dispose();
  this.opacityOverLifetimeTexture?.dispose();
  this.colorOverLifetimeTexture?.dispose();

  // Dispose trail system
  this.trailSystem?.dispose();
  this.trailSystem = null;

  // Dispose connection system
  this.connectionSystem?.dispose();
  this.connectionSystem = null;

  // Dispose GPU physics resources
  this.gpuPhysics?.dispose();
  this.gpuPhysics = null;

  // Dispose extracted subsystems
  this.textureSystem?.dispose();
  this.textureSystem = null;
  this.audioSystem?.clear();
  this.audioSystem = null;
  this.frameCacheSystem?.clearCache();
  this.frameCacheSystem = null;

  // Clear collections
  this.emitters.clear();
  this.forceFields.clear();
  this.subEmitters.clear();
  this.eventHandlers.clear();

  // MISSING:
  // - this.spatialHash (SpatialHashGrid)
  // - this.flockingSystem (ParticleFlockingSystem)
  // - this.collisionSystem (ParticleCollisionSystem)
  // - this.subEmitterSystem (ParticleSubEmitter)
  // - this.modulationSystem (ParticleModulationCurves)
}
```

## Proof of Leak
```typescript
const system = new GPUParticleSystem(config);
system.initialize(renderer);
system.initializeFlocking({ enabled: true, ... });
system.initializeCollisions({ enabled: true, ... });

// Dispose
system.dispose();

// After dispose:
// - flockingSystem still has internal arrays
// - collisionSystem still has internal arrays
// - spatialHash still has grid data (Map of arrays)
// - modulationSystem may have texture references
// - subEmitterSystem may have queued events

// If system was holding references:
// - These objects remain in memory until GC
// - Repeated create/dispose cycles leak memory
```

## Impact
- Memory leak on repeated create/dispose cycles
- Low severity: Most are plain JS objects (no GPU resources)
- flockingSystem and collisionSystem may have larger data structures

## Related
- BUG-094: BaseLayer.dispose() similar incomplete cleanup
- 14J: Lifecycle/Cleanup category

## Suggested Fix
```typescript
dispose(): void {
  // ... existing disposal code ...

  // Dispose remaining subsystems
  if (this.spatialHash) {
    this.spatialHash.clear();
    this.spatialHash = null;
  }

  if (this.flockingSystem) {
    this.flockingSystem.dispose?.();
    this.flockingSystem = null;
  }

  if (this.collisionSystem) {
    this.collisionSystem.dispose?.();
    this.collisionSystem = null;
  }

  if (this.subEmitterSystem) {
    this.subEmitterSystem.dispose?.();
    this.subEmitterSystem = null;
  }

  if (this.modulationSystem) {
    this.modulationSystem.dispose?.();
    this.modulationSystem = null;
  }

  // Clear remaining Maps
  this.particleEmitters.clear();
  this.particleInitialValues.clear();
}
```
