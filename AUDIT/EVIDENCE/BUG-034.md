# BUG-034: convertAudioToKeyframes NaN Options Bypass Defaults

## Summary
The `convertAudioToKeyframes` function uses destructuring with default values, but NaN values bypass these defaults. The destructuring syntax `{ value = default }` only applies the default when the value is undefined, not when it's NaN.

## Severity: MEDIUM

## Location
- File: /ui/src/stores/actions/audioActions.ts
- Lines: 464-468
- Function: `convertAudioToKeyframes`

## The Bug
Destructuring defaults don't protect against NaN values.

## Code Evidence
```typescript
// Lines 451-468
export function convertAudioToKeyframes(
  store: ConvertAudioToKeyframesStore,
  options: {
    name?: string;
    amplitudeScale?: number;  // User could pass NaN
    smoothing?: number;       // User could pass NaN
  } = {}
): AudioAmplitudeResult | null {
  // ...
  
  const {
    name = 'Audio Amplitude',
    amplitudeScale = 100,  // Only applies if undefined, NOT if NaN
    smoothing = 0          // Same problem
  } = options;

  // Line 482
  const channelData = extractChannelAmplitudes(buffer, frameCount, fps, smoothing);
  //                                                                     ^^^^^^^^^
  //                                                                     smoothing could be NaN

  // Line 485-500
  const bothChannelsProperty = createAmplitudeProperty(
    'Both Channels',
    channelData.both,
    amplitudeScale  // Could be NaN
  );
}
```

## Crash Path Trace
```
1. API call: convertAudioToKeyframes(store, { amplitudeScale: NaN, smoothing: NaN })
2. Line 464-468: Destructuring extracts values
3. amplitudeScale = NaN (default 100 NOT applied because NaN !== undefined)
4. smoothing = NaN (default 0 NOT applied)
5. Line 482: extractChannelAmplitudes(..., smoothing=NaN)
6. Line 567: if (smoothing > 0) is false (NaN > 0 = false)
   Fortunately this skips applySmoothing, but still wrong behavior
7. Line 485: createAmplitudeProperty(..., amplitudeScale=NaN)
8. Line 604: value = amp * NaN = NaN
9. All keyframes have NaN values
```

## JavaScript Proof
```javascript
function test({ scale = 100 } = {}) {
  console.log('scale:', scale);
}

test({ scale: undefined }); // scale: 100 (default applied)
test({ scale: NaN });       // scale: NaN (default NOT applied!)
test({ scale: 50 });        // scale: 50
```

## Impact
- NaN options create NaN keyframe values
- Animation data is corrupted silently
- User may not realize their options were invalid
- No error or warning displayed

## Suggested Fix
```typescript
const {
  name = 'Audio Amplitude',
  amplitudeScale: rawScale = 100,
  smoothing: rawSmoothing = 0
} = options;

// BUG-034 FIX: Validate numeric options
const amplitudeScale = Number.isFinite(rawScale) ? rawScale : 100;
const smoothing = Number.isFinite(rawSmoothing) ? Math.max(0, Math.min(1, rawSmoothing)) : 0;
```
