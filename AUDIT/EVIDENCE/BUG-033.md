# BUG-033: Multiple Functions Don't Validate NaN currentFrame

## Summary
Multiple functions in audioActions.ts use `store.getActiveComp()?.currentFrame ?? 0` without validating that currentFrame is a finite number. If currentFrame is NaN, it bypasses the nullish coalescing and propagates through audio feature lookups.

## Severity: LOW

## Location
- File: /ui/src/stores/actions/audioActions.ts
- Lines: 135, 231, 263, 352
- Functions: `getAudioFeatureAtFrame`, `getAllMappedValuesAtFrame`, `isBeatAtCurrentFrame`, `updatePathAnimators`

## The Bug
The `?? 0` only guards against null/undefined, not NaN.

## Code Evidence
```typescript
// Line 135 - getAudioFeatureAtFrame
return getFeatureAtFrame(store.audioAnalysis, feature, frame ?? (store.getActiveComp()?.currentFrame ?? 0));
//                                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//                                                                If currentFrame is NaN, NaN is passed through

// Line 231 - getAllMappedValuesAtFrame
return store.audioReactiveMapper.getAllValuesAtFrame(frame ?? (store.getActiveComp()?.currentFrame ?? 0));

// Line 263 - isBeatAtCurrentFrame
return isBeatAtFrame(store.audioAnalysis, store.getActiveComp()?.currentFrame ?? 0);

// Line 352 - updatePathAnimators
const frame = store.getActiveComp()?.currentFrame ?? 0;
const amplitude = getFeatureAtFrame(store.audioAnalysis, 'amplitude', frame);
```

## Crash Path Trace
```
1. Playback system has bug, sets currentFrame = NaN
2. Animation loop calls getAudioFeatureAtFrame(store, 'amplitude')
3. Line 135: frame is undefined, falls through to store.getActiveComp()?.currentFrame
4. currentFrame = NaN
5. NaN ?? 0 = NaN (nullish coalescing doesn't catch NaN!)
6. getFeatureAtFrame(analysis, 'amplitude', NaN) called
7. In audioFeatures.ts: analysis.amplitudeEnvelope[NaN] = undefined
8. Returns undefined or 0, silent incorrect value
```

## JavaScript Proof
```javascript
const currentFrame = NaN;
const frame = currentFrame ?? 0;
console.log(frame);  // NaN - not 0!

const currentFrame2 = null;
const frame2 = currentFrame2 ?? 0;
console.log(frame2);  // 0 - works for null
```

## Impact
- Audio features return undefined/0 for NaN frames
- Silent incorrect animation values
- Hard to reproduce - depends on upstream NaN source
- May cause flickering or incorrect audio-reactive behavior

## Suggested Fix
```typescript
// Helper function
function safeFrame(frame: number | undefined, fallback: number = 0): number {
  return Number.isFinite(frame) ? frame : fallback;
}

// Usage:
const frame = safeFrame(store.getActiveComp()?.currentFrame, 0);
```
