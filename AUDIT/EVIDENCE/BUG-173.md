# BUG-173: ControlLayer.setIndicatorSize() No Validation

## Summary
setIndicatorSize() stores the size value without validation, then createIndicator() uses it to generate geometry coordinates. NaN/0/Infinity/negative values corrupt the visual indicator geometry.

## Severity: LOW

## Location
- File: /ui/src/engine/layers/ControlLayer.ts
- Lines: 115-126
- Function: setIndicatorSize()

## Crash Path Trace
```
Function: setIndicatorSize(size: number)

Line 116: if (size === this.indicatorSize) return;
  → size=NaN: NaN === 50 is FALSE (proceeds)

Line 118: this.indicatorSize = size;
  → size=NaN: this.indicatorSize = NaN

Line 124: this.createIndicator();

Inside createIndicator():
Line 44: const size = this.indicatorSize;
  → size = NaN

Lines 56-58 (horizontal line):
  new THREE.Vector3(-size / 2, 0, 0)  // -NaN/2 = NaN
  new THREE.Vector3(size / 2, 0, 0)   // NaN/2 = NaN
  → Creates BufferGeometry with NaN coordinates

Lines 65-67 (vertical line):
  new THREE.Vector3(0, -size / 2, 0)  // NaN
  new THREE.Vector3(0, size / 2, 0)   // NaN
  → Creates BufferGeometry with NaN coordinates

Result: SILENT CORRUPTION - control indicator geometry corrupted
```

## Code Evidence
```typescript
// Lines 115-126
setIndicatorSize(size: number): void {
  if (size === this.indicatorSize) return;  // NaN !== indicatorSize passes

  this.indicatorSize = size;  // NaN stored

  // Recreate indicator with new size
  if (this.indicator) {
    this.group.remove(this.indicator);
    this.disposeIndicator();
    this.createIndicator();  // Uses this.indicatorSize (NaN)
  }
}

// Lines 56-58 (inside createIndicator)
const hPoints = [
  new THREE.Vector3(-size / 2, 0, 0),  // NaN coordinates
  new THREE.Vector3(size / 2, 0, 0),
];
```

## Impact
- Expression evaluation can return NaN for indicatorSize
- NaN stored without validation
- Visual indicator becomes invisible/corrupted
- Minor visual bug - control layers are mainly for transform hierarchy
- Low severity as it doesn't affect composition output

## Suggested Fix
```typescript
setIndicatorSize(size: number): void {
  if (!Number.isFinite(size) || size <= 0) {
    console.warn(`setIndicatorSize: invalid size ${size}`);
    return;
  }
  if (size === this.indicatorSize) return;
  // ...
}
```
