# BUG-037: Infinite Loop in Pre-Cache with preCacheWindow = Infinity

## Summary
The `startPreCache()` function uses `this.config.preCacheWindow` as a loop bound without validation. When `preCacheWindow = Infinity`, the loop `for (let i = 1; i <= window; i++)` runs forever, hanging the browser.

## Severity: MEDIUM

## Location
- File: /ui/src/services/frameCache.ts
- Lines: 473-490
- Function: startPreCache

## The Bug
```typescript
// Line 473 - preCacheWindow from config, no validation
const window = this.config.preCacheWindow;

// Line 475 - Loop bound is window (could be Infinity)
for (let i = 1; i <= window; i++) {  // i <= Infinity is ALWAYS true
  if (direction !== 'backward') {
    this.preCacheQueue.push({
      frame: currentFrame + i,  // Also: currentFrame + Infinity = Infinity
      compositionId,
      priority: window - i,  // Infinity - i = Infinity
    });
  }
  if (direction !== 'forward') {
    this.preCacheQueue.push({
      frame: currentFrame - i,
      compositionId,
      priority: window - i,
    });
  }
}
// NEVER EXITS - browser hangs
```

## Proof of Failure
```typescript
const cache = new FrameCache({
  preCacheWindow: Infinity,  // User sets bad config
  predictivePreCache: true
});

cache.setRenderCallback(async (frame) => {
  // Never gets here - loop hangs before starting
  return new ImageData(100, 100);
});

await cache.startPreCache(0, "comp1", "hash1");
// Browser hangs - infinite loop building queue
```

## Related Issues
- `preCacheWindow = NaN`: Loop condition `i <= NaN` is always false → loop skips entirely (silent failure)
- `preCacheWindow = -5`: Loop condition `1 <= -5` is false → loop skips

## Impact
- Browser tab becomes unresponsive
- Must force-kill the tab/process
- Config validation is missing
- Medium severity because it requires explicitly bad config

## Suggested Fix
Add validation in constructor and setConfig:
```typescript
constructor(config: Partial<FrameCacheConfig> = {}) {
  this.config = { ...DEFAULT_CONFIG, ...config };
  this.validateConfig();
}

setConfig(config: Partial<FrameCacheConfig>): void {
  this.config = { ...this.config, ...config };
  this.validateConfig();
}

private validateConfig(): void {
  if (!Number.isFinite(this.config.preCacheWindow) || this.config.preCacheWindow < 0) {
    this.config.preCacheWindow = DEFAULT_CONFIG.preCacheWindow;
  }
  if (!Number.isFinite(this.config.maxFrames) || this.config.maxFrames < 1) {
    this.config.maxFrames = DEFAULT_CONFIG.maxFrames;
  }
  // etc.
}
```
