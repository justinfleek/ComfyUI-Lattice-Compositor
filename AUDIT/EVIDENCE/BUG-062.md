# BUG-062: Infinite Loop / RangeError from Invalid maxParticles (ParticleTrailSystem)

## Summary
Same vulnerability as BUG-059 and BUG-061. The ParticleTrailSystem constructor accepts maxParticles without validation. If Infinity, the update loop runs forever. If negative, Float32Array constructor throws RangeError.

## Severity: LOW

## Location
- File: /ui/src/engine/particles/ParticleTrailSystem.ts
- Lines: 47-55 (constructor), 68-72 (allocations), 116 (loop)
- Function: constructor, initialize, update

## The Bug
```typescript
// Lines 47-55: Constructor has no validation
constructor(
  maxParticles: number,  // No validation - could be Infinity, NaN, negative
  config: TrailConfig,
  blendingConfig: TrailBlendingConfig
) {
  this.maxParticles = maxParticles;  // Stored as-is
  this.config = config;
  this.blendingConfig = blendingConfig;
}

// Line 68-72: Allocations can fail
const maxTrailVertices = this.maxParticles * trailLength * 2;
// ...
this.trailBuffer = new Float32Array(this.maxParticles * this.TRAIL_POSITIONS_PER_PARTICLE * 4);
// If maxParticles is negative: RangeError

// Line 116: Loop can be infinite
for (let i = 0; i < this.maxParticles; i++) {
  // If maxParticles = Infinity, never terminates
}
```

## Proof of Failure

**Test 1: Infinite Loop**
```typescript
const system = new ParticleTrailSystem(
  Infinity,
  { trailLength: 5, trailSegments: 1, trailWidthStart: 1, trailWidthEnd: 0, trailFadeMode: 'alpha' },
  { blendMode: 'normal' }
);
system.initialize();
system.update(particleBuffer); // Never returns
```

**Test 2: RangeError**
```typescript
const system = new ParticleTrailSystem(
  -1000,
  { trailLength: 5, trailSegments: 1, trailWidthStart: 1, trailWidthEnd: 0, trailFadeMode: 'alpha' },
  { blendMode: 'normal' }
);
system.initialize(); // Throws RangeError: Invalid typed array length: -64000
```

## Related
- BUG-059: Same pattern in SpatialHashGrid.rebuild()
- BUG-061: Same pattern in ParticleConnectionSystem.update()

## Impact
- Browser freeze when maxParticles = Infinity
- Crash when maxParticles is negative
- Low severity: Requires specific bad input

## Suggested Fix
```typescript
constructor(
  maxParticles: number,
  config: TrailConfig,
  blendingConfig: TrailBlendingConfig
) {
  if (!Number.isFinite(maxParticles) || maxParticles < 0) {
    console.warn('ParticleTrailSystem: Invalid maxParticles, using 10000');
    this.maxParticles = 10000;
  } else {
    this.maxParticles = maxParticles;
  }
  this.config = config;
  this.blendingConfig = blendingConfig;
}
```
