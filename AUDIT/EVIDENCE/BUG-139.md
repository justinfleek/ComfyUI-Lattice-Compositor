# BUG-139: applyMaterialOverrideToMesh Crashes on Empty Material Array

## Summary
applyMaterialOverrideToMesh() accesses mesh.material[0] without checking if the array is empty. An empty material array causes TypeError.

## Severity: LOW

## Location
- File: /ui/src/engine/layers/ModelLayer.ts
- Lines: 568-570
- Function: applyMaterialOverrideToMesh()

## Crash Path Trace
```
Function: applyMaterialOverrideToMesh(mesh, override)

Line 568-570:
  let material = Array.isArray(mesh.material)
    ? mesh.material[0].clone()  // CRASH if material is []
    : mesh.material.clone();

  - mesh.material = [] (empty array)
  - Array.isArray([]) = true → enters ternary true branch
  - mesh.material[0] = undefined
  - undefined.clone() → TypeError: Cannot read properties of undefined (reading 'clone')

Result: CRASH - TypeError
```

## Code Evidence
```typescript
// Line 567-570
// Clone material to avoid affecting shared materials
let material = Array.isArray(mesh.material)
  ? mesh.material[0].clone()  // No check for empty array
  : mesh.material.clone();
```

## Impact
- Unhandled crash when mesh has empty material array
- Could occur with malformed or partially loaded 3D models
- No defensive coding

## Suggested Fix
```typescript
let material: THREE.Material;
if (Array.isArray(mesh.material)) {
  if (mesh.material.length === 0) {
    console.warn('applyMaterialOverrideToMesh: mesh has empty material array');
    return;
  }
  material = mesh.material[0].clone();
} else {
  material = mesh.material.clone();
}
```
