# BUG-083: NaN Velocity Bypasses Motion Blur Threshold Check

## Summary
In BaseLayer.applyMotionBlur(), the velocity magnitude check uses comparison with NaN, which always returns false. This allows NaN velocity to bypass the "negligible velocity" skip, potentially corrupting motion blur output.

## Severity: LOW

## Location
- File: /ui/src/engine/layers/BaseLayer.ts
- Lines: 1231-1232
- Function: applyMotionBlur

## The Bug
```typescript
// Calculate velocity
const velocity = this.calculateTransformVelocity(currentTransform);

// Lines 1231-1232
const velocityMagnitude = Math.sqrt(velocity.x * velocity.x + velocity.y * velocity.y);
// If velocity.x or velocity.y is NaN, velocityMagnitude is NaN

if (velocityMagnitude < 0.5 && Math.abs(velocity.rotation) < 0.5 && Math.abs(velocity.scale) < 0.01) {
  return sourceCanvas;  // Skip blur if velocity negligible
}
// NaN < 0.5 is false! So NaN velocity proceeds to blur processing
```

## How Velocity Becomes NaN
```typescript
// calculateTransformVelocity (lines 1183-1186)
return {
  x: currentTransform.position.x - this.prevTransform.position.x,
  // If either transform has NaN position, velocity is NaN
```

If transform values contain NaN (from corrupt animation data or expressions), velocity becomes NaN, bypasses the threshold check, and gets passed to MotionBlurProcessor.

## Proof of Failure
```typescript
const layer = new ImageLayer(layerData);
layer.motionBlur = true;

// If expression produces NaN position
layer.drivenValues.set('transform.position.x', NaN);
layer.evaluateFrame(0);

// currentTransform.position.x = NaN
// velocity.x = NaN - this.prevTransform.position.x = NaN
// velocityMagnitude = Math.sqrt(NaN * NaN + ...) = NaN
// NaN < 0.5 = false â†’ blur proceeds with NaN velocity
```

## Impact
- Motion blur processor receives NaN velocity
- Blur output may be corrupted or unexpected
- Low severity: Requires NaN in transform values (rare)

## Related: SYSTEMIC-005
NaN bypasses comparison guards - same pattern as BUG-051, BUG-072, BUG-082.

## Suggested Fix
```typescript
const velocityMagnitude = Math.sqrt(velocity.x * velocity.x + velocity.y * velocity.y);
if (!Number.isFinite(velocityMagnitude) ||
    (velocityMagnitude < 0.5 && Math.abs(velocity.rotation) < 0.5 && Math.abs(velocity.scale) < 0.01)) {
  return sourceCanvas;
}
```
