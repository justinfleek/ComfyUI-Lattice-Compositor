# BUG-152: DepthflowLayer.updateConfig() Stores NaN/Infinity to Uniforms

## Summary
updateConfig() uses Object.assign to store config values and sets shader uniforms without validation. NaN, zero (for zoom), and Infinity values corrupt shader rendering.

## Severity: LOW

## Location
- File: /ui/src/engine/layers/DepthflowLayer.ts
- Lines: 287-306
- Function: updateConfig()

## Crash Path Trace
```
Function: updateConfig(config: Partial<DepthflowConfig>)

Line 288: Object.assign(this.depthflowData.config, config);
  - config.zoom=NaN → stored in this.depthflowData.config.zoom

Line 291-299:
  if (config.depthScale !== undefined) {
    this.material.uniforms.depthScale.value = config.depthScale;  // NaN stored
  }
  if (config.zoom !== undefined) {
    this.material.uniforms.zoom.value = config.zoom;  // 0 or NaN stored
  }

Test cases:
  - config.zoom=NaN → uniform zoom=NaN → shader produces NaN colors
  - config.zoom=0 → uniform zoom=0 → shader divides by zero (line 63)
  - config.depthScale=Infinity → shader displacement = Infinity
  - config.focusDepth=NaN → shader depth calculation = NaN

Result: SILENT CORRUPTION - shader uniforms invalid, rendering broken
```

## Code Evidence
```typescript
// Line 287-306
updateConfig(config: Partial<DepthflowConfig>): void {
  Object.assign(this.depthflowData.config, config);  // No validation

  // Update uniforms
  if (config.depthScale !== undefined) {
    this.material.uniforms.depthScale.value = config.depthScale;  // No validation
  }
  if (config.focusDepth !== undefined) {
    this.material.uniforms.focusDepth.value = config.focusDepth;  // No validation
  }
  if (config.zoom !== undefined) {
    this.material.uniforms.zoom.value = config.zoom;  // No validation - triggers BUG-153
  }
  // ...
}
```

## Impact
- Shader receives NaN/Infinity uniforms
- Rendering produces black, white, or garbage output
- zoom=0 triggers shader division by zero (BUG-153)

## Suggested Fix
```typescript
updateConfig(config: Partial<DepthflowConfig>): void {
  // Validate before storing
  if (config.zoom !== undefined && (!Number.isFinite(config.zoom) || config.zoom <= 0)) {
    console.warn(`updateConfig: invalid zoom ${config.zoom}`);
    delete config.zoom;
  }
  if (config.depthScale !== undefined && !Number.isFinite(config.depthScale)) {
    console.warn(`updateConfig: invalid depthScale ${config.depthScale}`);
    delete config.depthScale;
  }
  // ... validate other properties ...

  Object.assign(this.depthflowData.config, config);
  // ...
}
```
