# BUG-050: NaN Frame Bypasses Marker Equality Check

## Summary
The marker functions use `m.frame === frame` to find existing markers, but `NaN === NaN` is false in JavaScript. NaN frame markers can never be found, updated, or removed. Additionally, `sort((a, b) => a.frame - b.frame)` produces undefined ordering when NaN frames are present.

## Severity: LOW

## Location
- File: /ui/src/stores/actions/markerActions.ts
- Lines: 62, 105, 188, 280 (equality), 70, 139, 291 (sort)
- Functions: addMarker, removeMarkerAtFrame, getMarkerAtFrame, addMarkers

## The Bug
```typescript
// Line 62 in addMarker()
const existingIndex = comp.markers.findIndex(m => m.frame === marker.frame);
// NaN === NaN is FALSE in JavaScript
// If marker.frame is NaN, existingIndex will always be -1

// Line 70 in addMarker()
comp.markers.sort((a, b) => a.frame - b.frame);
// NaN - NaN = NaN, NaN - number = NaN
// Sort comparator returning NaN produces undefined ordering

// Line 105 in removeMarkerAtFrame()
const index = comp.markers.findIndex(m => m.frame === frame);
// NaN === NaN is FALSE - marker at NaN frame cannot be removed

// Line 188 in getMarkerAtFrame()
return comp?.markers?.find(m => m.frame === frame) || null;
// NaN === NaN is FALSE - marker at NaN frame cannot be found
```

## Proof of Failure
```typescript
// Add marker at frame NaN
addMarker(store, { frame: NaN, label: 'Test', color: 'red' });
// existingIndex = -1 (NaN === NaN is false)
// Marker pushed with frame = NaN

// Try to add another marker at frame NaN
addMarker(store, { frame: NaN, label: 'Test2', color: 'blue' });
// existingIndex = -1 again
// Second NaN marker pushed - duplicates accumulate!

// Try to remove marker at frame NaN
removeMarkerAtFrame(store, NaN);
// findIndex returns -1 (NaN === NaN is false)
// Returns false - cannot remove!

// Try to get marker at frame NaN
getMarkerAtFrame(store, NaN);
// find() never matches - returns null

// Sort with NaN frames:
// markers = [{frame: 0}, {frame: NaN}, {frame: 10}]
// sort((a, b) => a.frame - b.frame)
// 0 - NaN = NaN, NaN - 10 = NaN
// Result: Undefined ordering
```

## Same Pattern As
- BUG-044: NaN frame equality in keyframeActions.ts

## Impact
- NaN frame markers accumulate indefinitely
- NaN frame markers cannot be found, updated, or removed
- Sort produces undefined ordering
- Low severity because NaN frame requires upstream bug

## Suggested Fix
Validate frame before using:
```typescript
export function addMarker(
  store: MarkerStore,
  marker: Omit<Marker, 'id'> & { id?: string }
): Marker | null {
  // Validate frame
  if (!Number.isFinite(marker.frame)) {
    storeLogger.warn('addMarker: Invalid frame number', marker.frame);
    return null;
  }
  // ... rest of function
}
```

Or use `Number.isNaN()` check:
```typescript
const existingIndex = comp.markers.findIndex(m =>
  Number.isNaN(marker.frame)
    ? Number.isNaN(m.frame)
    : m.frame === marker.frame
);
```
