# BUG-117: VideoLayer.setSpeed() No Validation

## Summary
The `setSpeed(speed)` method accepts the speed parameter without validation and passes it directly to `HTMLVideoElement.playbackRate`. Zero, negative, NaN, and Infinity values cause browser-dependent undefined behavior.

## Severity: LOW

## Location
- File: /ui/src/engine/layers/VideoLayer.ts
- Lines: 599-604
- Function: setSpeed

## The Bug
```typescript
// Lines 599-604
setSpeed(speed: number): void {
  this.videoData.speed = speed;  // No validation!
  if (this.videoElement) {
    this.videoElement.playbackRate = speed;  // Direct assignment
  }
}
```

## Proof of Failure
```typescript
const videoLayer = new VideoLayer(layerData, resources);
await videoLayer.loadVideo(assetId);

// Attack 1: speed = 0
videoLayer.setSpeed(0);
// playbackRate = 0
// Video pauses (intentional?) or throws in some browsers

// Attack 2: speed = NaN
videoLayer.setSpeed(NaN);
// playbackRate = NaN
// Browser behavior undefined - may ignore, may throw

// Attack 3: speed = -1
videoLayer.setSpeed(-1);
// playbackRate = -1
// Most browsers throw: "Failed to set 'playbackRate': not a valid floating-point value"
// Or may attempt to play backwards (not widely supported)

// Attack 4: speed = Infinity
videoLayer.setSpeed(Infinity);
// playbackRate = Infinity
// Browser throws or video skips to end instantly

// Attack 5: Very high speed
videoLayer.setSpeed(1000);
// playbackRate = 1000
// May throw or cause audio crackling/glitches
```

## Impact
- Browser may throw errors for invalid playbackRate
- Video playback breaks with bad values
- Low severity: Usually set from UI slider with bounded values
- Note: Also affects calculateVideoTime() via effectiveSpeed

## Related
- 14A: Numeric inputs - 0, NaN, Infinity, negative testing
- 14X: Platform/Environment - browser differences

## Suggested Fix
```typescript
setSpeed(speed: number): void {
  // Validate speed
  if (!Number.isFinite(speed) || speed <= 0) {
    console.warn('VideoLayer.setSpeed: Invalid speed, using 1');
    speed = 1;
  }
  // Clamp to browser-supported range (typically 0.0625 to 16)
  speed = Math.max(0.0625, Math.min(16, speed));

  this.videoData.speed = speed;
  if (this.videoElement) {
    this.videoElement.playbackRate = speed;
  }
}
```
