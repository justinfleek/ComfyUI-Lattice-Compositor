# BUG-144: metalness/roughness No Validation

## Summary
applyMaterialOverrideToMesh() stores metalness and roughness values without validation. PBR materials expect [0,1] range but NaN, Infinity, and out-of-range values are accepted.

## Severity: LOW

## Location
- File: /ui/src/engine/layers/ModelLayer.ts
- Lines: 597-608
- Function: applyMaterialOverrideToMesh()

## Crash Path Trace
```
Function: applyMaterialOverrideToMesh(mesh, override)

Line 597-601:
  if (override.metalness !== undefined) {
    material.metalness = override.metalness;  // No validation
  }
  if (override.roughness !== undefined) {
    material.roughness = override.roughness;  // No validation
  }

  - metalness=NaN → material.metalness = NaN → undefined rendering
  - metalness=-5 → material.metalness = -5 → out of range
  - metalness=100 → material.metalness = 100 → out of range
  - roughness=Infinity → material.roughness = Infinity → undefined rendering

Result: SILENT CORRUPTION - PBR material values out of valid range
```

## Code Evidence
```typescript
// Line 596-608
if (material instanceof THREE.MeshStandardMaterial) {
  if (override.metalness !== undefined) {
    material.metalness = override.metalness;  // No clamping/validation
  }
  if (override.roughness !== undefined) {
    material.roughness = override.roughness;  // No clamping/validation
  }
  if (override.emissive) {
    material.emissive = new THREE.Color(override.emissive);
  }
  if (override.emissiveIntensity !== undefined) {
    material.emissiveIntensity = override.emissiveIntensity;  // Also no validation
  }
}
```

## Impact
- PBR rendering becomes incorrect with out-of-range values
- NaN values produce undefined WebGL behavior
- Material appearance breaks silently

## Suggested Fix
```typescript
if (override.metalness !== undefined) {
  if (Number.isFinite(override.metalness)) {
    material.metalness = Math.max(0, Math.min(1, override.metalness));
  }
}
if (override.roughness !== undefined) {
  if (Number.isFinite(override.roughness)) {
    material.roughness = Math.max(0, Math.min(1, override.roughness));
  }
}
if (override.emissiveIntensity !== undefined) {
  if (Number.isFinite(override.emissiveIntensity)) {
    material.emissiveIntensity = Math.max(0, override.emissiveIntensity);
  }
}
```
