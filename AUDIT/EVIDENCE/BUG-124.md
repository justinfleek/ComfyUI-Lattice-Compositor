# BUG-124: AudioLayer.updatePan() NaN Bypass

## Summary
The `updatePan(pan)` method clamps the input using `Math.max(-1, Math.min(1, pan))`. However, NaN bypasses these checks, and the resulting NaN is passed to `panNode.pan.setValueAtTime()`, causing undefined WebAudio behavior.

## Severity: LOW

## Location
- File: /ui/src/engine/layers/AudioLayer.ts
- Lines: 341-351
- Function: updatePan

## The Bug
```typescript
// Lines 341-351
updatePan(pan: number): void {
  if (!this.playbackNodes) return;

  // Clamp pan to valid range
  const clampedPan = Math.max(-1, Math.min(1, pan));
  //                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  // NaN bypasses! Math.max(-1, Math.min(1, NaN)) = NaN

  this.playbackNodes.panNode.pan.setValueAtTime(
    clampedPan,  // NaN passed to WebAudio!
    this.playbackNodes.context.currentTime
  );
}
```

## Proof of Failure
```typescript
const audioLayer = new AudioLayer(layerData);
audioLayer.initializePlayback(audioBuffer);

// NaN comparison behavior:
console.log(Math.min(1, NaN));   // NaN
console.log(Math.max(-1, NaN));  // NaN

// Attack: pan = NaN
audioLayer.updatePan(NaN);
// clampedPan = NaN
// panNode.pan.setValueAtTime(NaN, ...)
// WebAudio behavior undefined

// Could happen from:
// - Corrupt keyframe interpolation
// - Expression returning NaN
// - Calculation producing NaN
```

## Impact
- WebAudio StereoPannerNode receives NaN value
- Audio panning may break or error
- Low severity: Usually called with interpolated animation values

## Related
- BUG-123: updateGain NaN bypass (identical pattern)
- SYSTEMIC-005: NaN bypass via comparison operators
- 14A: Numeric inputs - NaN testing

## Suggested Fix
```typescript
updatePan(pan: number): void {
  if (!this.playbackNodes) return;

  // Guard against NaN
  if (!Number.isFinite(pan)) {
    pan = 0;  // Default to center
  }

  // Clamp pan to valid range
  const clampedPan = Math.max(-1, Math.min(1, pan));

  this.playbackNodes.panNode.pan.setValueAtTime(
    clampedPan,
    this.playbackNodes.context.currentTime
  );
}
```
