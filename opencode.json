{
  "$schema": "https://opencode.ai/config.schema.json",
  "name": "straylight-protocol",
  "instructions": [
    "MANDATORY: This codebase follows the Straylight Protocol. Enforcement is REQUIRED.",
    "WORKFLOW: 1) straylight_plan → 2) Read docs → 3) straylight_template → 4) straylight_validate (MANDATORY) → 5) Write only if valid",
    "Before writing Nix: read straylight-protocol/docs/rfc/straylight-001-standard-nix.md OR straylight-core/docs/rfc/straylight-001-standard-nix.md",
    "Before writing bash: read straylight-protocol/docs/rfc/straylight-006-safe-bash.md OR straylight-core/docs/rfc/straylight-006-safe-bash.md (NO logic allowed)",
    "Before writing scripts: read skills/straylight-script/SKILL.md OR straylight-core/docs/skills/straylight-script/SKILL.md",
    "Before creating files: read straylight-core/CONTRIBUTING.md for locations (if exists)",
    "Rules: lisp-case naming, no 'with lib;', no 'rec {', packages need meta block",
    "Bash: ONLY 'exec \"$@\"' allowed. No logic, no variables.",
    "Scripts: Must import Straylight.Script, use typed tool wrappers",
    "VALIDATION: You MUST call straylight_validate before writing ANY code. This is NON-NEGOTIABLE.",
    "If validation fails: Fix errors, re-validate, repeat until valid === true",
    "Validate with: node scripts/validate-file.js <file>"
  ],
  "mcpServers": {
    "straylight": {
      "command": "node",
      "args": [".claude/straylight-mcp.js"]
    }
  },
  "permission": {
    "skill": {
      "*": "allow",
      "straylight-script": "allow",
      "deterministic-coder": "allow",
      "expert-researcher": "allow",
      "thorough-reading": "allow",
      "verification": "allow",
      "testing-methodology": "allow",
      "safe-refactoring": "allow",
      "type-cleanup": "allow",
      "exploratory-architect": "allow",
      "creative-coder": "ask",
      "council": "allow"
    }
  }
}
