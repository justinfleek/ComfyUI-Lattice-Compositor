// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as $$Math from "../Math/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var safeDiv = function (v) {
    return function (v1) {
        return function (v2) {
            if (v1 === 0.0) {
                return v2;
            };
            return v / v1;
        };
    };
};
var defaultLevelsParams = {
    inputBlack: 0.0,
    inputWhite: 1.0,
    gamma: 1.0,
    outputBlack: 0.0,
    outputWhite: 1.0
};
var defaultExposureParams = {
    exposure: 0.0,
    offset: 0.0,
    gamma: 1.0
};
var defaultColorParams = {
    brightness: 0.0,
    contrast: 0.0,
    useLegacy: false
};
var contrastFactor = function (v) {
    return function (v1) {
        if (v) {
            return 1.0 + v1;
        };
        if (!v) {
            var c255 = v1 * 255.0;
            return safeDiv(259.0 * (c255 + 255.0))(255.0 * (259.0 - c255))(1.0);
        };
        throw new Error("Failed pattern match at Lattice.Services.Effects.ColorCorrection (line 115, column 1 - line 115, column 46): " + [ v.constructor.name, v1.constructor.name ]);
    };
};
var clamp255 = /* #__PURE__ */ (function () {
    var $37 = $$Math.max(0.0);
    var $38 = $$Math.min(255.0);
    return function ($39) {
        return $37($38($39));
    };
})();
var clamp01 = /* #__PURE__ */ (function () {
    var $40 = $$Math.max(0.0);
    var $41 = $$Math.min(1.0);
    return function ($42) {
        return $40($41($42));
    };
})();
var exposurePixel = function (params) {
    return function (value) {
        var multiplier = $$Math.pow(2.0)(params.exposure);
        var withExposure = value * multiplier;
        var withOffset = withExposure + params.offset;
        var gamma = $$Math.max(1.0e-2)(params.gamma);
        var clamped = clamp01(withOffset);
        var gammaApplied = $$Math.pow(clamped)(1.0 / gamma);
        return gammaApplied;
    };
};
var exposure = function (params) {
    return function (v) {
        return new Data_Tuple.Tuple(exposurePixel(params)(v.value0), new Data_Tuple.Tuple(exposurePixel(params)(v.value1.value0), exposurePixel(params)(v.value1.value1)));
    };
};
var levelsPixel = function (params) {
    return function (value) {
        var outputRange = params.outputWhite - params.outputBlack;
        var inputRange = params.inputWhite - params.inputBlack;
        var mapped = safeDiv(value - params.inputBlack)(inputRange)(0.0);
        var gamma = $$Math.max(1.0e-2)(params.gamma);
        var clamped = clamp01(mapped);
        var gammaApplied = $$Math.pow(clamped)(1.0 / gamma);
        var output = params.outputBlack + gammaApplied * outputRange;
        return clamp01(output);
    };
};
var levels = function (params) {
    return function (v) {
        return new Data_Tuple.Tuple(levelsPixel(params)(v.value0), new Data_Tuple.Tuple(levelsPixel(params)(v.value1.value0), levelsPixel(params)(v.value1.value1)));
    };
};
var buildLUT = function (f) {
    return map(function (i) {
        var normalized = Data_Int.toNumber(i) / 255.0;
        var result = f(normalized);
        return Data_Int.round(clamp255(result * 255.0));
    })(Data_Array.range(0)(255));
};
var brightnessContrastPixel = function (params) {
    return function (value) {
        var withBrightness = value + params.brightness;
        var factor = contrastFactor(params.useLegacy)(params.contrast);
        var withContrast = factor * (withBrightness - 0.5) + 0.5;
        return clamp01(withContrast);
    };
};
var brightnessContrast = function (params) {
    return function (v) {
        return new Data_Tuple.Tuple(brightnessContrastPixel(params)(v.value0), new Data_Tuple.Tuple(brightnessContrastPixel(params)(v.value1.value0), brightnessContrastPixel(params)(v.value1.value1)));
    };
};
export {
    defaultColorParams,
    defaultLevelsParams,
    defaultExposureParams,
    brightnessContrast,
    brightnessContrastPixel,
    levels,
    levelsPixel,
    exposure,
    exposurePixel,
    buildLUT
};
//# sourceMappingURL=index.js.map
