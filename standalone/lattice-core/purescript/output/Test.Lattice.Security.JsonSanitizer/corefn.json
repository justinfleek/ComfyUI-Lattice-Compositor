{"builtWith":"0.15.15","comments":[{"LineComment":" | Port of ui/src/__tests__/security/jsonSanitizer.test.ts"},{"LineComment":" |"},{"LineComment":" | Tests security validation and sanitization for JSON data to prevent:"},{"LineComment":" |   - JSON bombs (deeply nested structures)"},{"LineComment":" |   - Resource exhaustion (large arrays/objects)"},{"LineComment":" |   - Prototype pollution attacks"},{"LineComment":" |"},{"LineComment":" | 35 tests across 12 describe blocks:"},{"LineComment":" |   - parseAndSanitize - Depth Limits (3 tests)"},{"LineComment":" |   - parseAndSanitize - Array Size Limits (3 tests)"},{"LineComment":" |   - parseAndSanitize - String Size Limits (2 tests)"},{"LineComment":" |   - parseAndSanitize - Prototype Pollution Protection (5 tests)"},{"LineComment":" |   - parseAndSanitize - Object Key Limits (2 tests)"},{"LineComment":" |   - parseAndSanitize - Special Values (4 tests)"},{"LineComment":" |   - parseAndSanitize - Invalid JSON (2 tests)"},{"LineComment":" |   - sanitize - Pre-parsed Data (2 tests)"},{"LineComment":" |   - quickValidate - Fast Rejection (4 tests)"},{"LineComment":" |   - safeParse - Convenience Function (3 tests)"},{"LineComment":" |   - deepFreeze - Immutability (2 tests)"},{"LineComment":" |   - Custom Options (4 tests)"}],"decls":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[309,11],"start":[309,3]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Spec"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[309,47],"start":[309,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadIdentity","moduleName":["Data","Identity"]}},"type":"App"},"identifier":"describe"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[325,50],"start":[311,5]}},"type":"Var","value":{"identifier":"discard","moduleName":["Control","Bind"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[325,50],"start":[311,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discardUnit","moduleName":["Control","Bind"]}},"type":"App"},"identifier":"discard"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[325,50],"start":[311,5]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"bindSpecT","moduleName":["Test","Spec"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[325,50],"start":[311,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"bindIdentity","moduleName":["Data","Identity"]}},"type":"App"},"type":"App"},"identifier":"discard1"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[311,7],"start":[311,5]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Spec"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[311,35],"start":[311,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadIdentity","moduleName":["Data","Identity"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[311,35],"start":[311,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"exampleMUnit","moduleName":["Test","Spec"]}},"type":"App"},"identifier":"it"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[314,38],"start":[314,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"bindAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"discard2"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[314,32],"start":[314,21]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Spec","Assertions"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[314,38],"start":[314,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadThrowAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"shouldEqual"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[314,38],"start":[314,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showBoolean","moduleName":["Data","Show"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[314,38],"start":[314,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqBoolean","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"shouldEqual1"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[321,28],"start":[321,24]}},"type":"Var","value":{"identifier":"pure","moduleName":["Control","Applicative"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[321,33],"start":[321,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"applicativeAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"pure"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[322,28],"start":[322,24]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Spec","Assertions"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[322,50],"start":[322,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadThrowAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"fail"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[335,65],"start":[335,25]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showMaybe","moduleName":["Data","Maybe"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[335,65],"start":[335,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showBoolean","moduleName":["Data","Show"]}},"type":"App"},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[335,65],"start":[335,25]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqMaybe","moduleName":["Data","Maybe"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[335,65],"start":[335,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqBoolean","moduleName":["Data","Eq"]}},"type":"App"},"type":"App"},"identifier":"shouldEqual2"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[351,64],"start":[351,25]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showMaybe","moduleName":["Data","Maybe"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[351,64],"start":[351,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showNumber","moduleName":["Data","Show"]}},"type":"App"},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[351,64],"start":[351,25]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqMaybe","moduleName":["Data","Maybe"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[351,64],"start":[351,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqNumber","moduleName":["Data","Eq"]}},"type":"App"},"type":"App"},"identifier":"shouldEqual3"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[357,66],"start":[357,61]}},"type":"Var","value":{"identifier":"negate","moduleName":["Data","Ring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[357,66],"start":[357,61]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ringNumber","moduleName":["Data","Ring"]}},"type":"App"},"identifier":"negate"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[370,72],"start":[370,25]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showMaybe","moduleName":["Data","Maybe"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[370,72],"start":[370,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showString","moduleName":["Data","Show"]}},"type":"App"},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[370,72],"start":[370,25]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqMaybe","moduleName":["Data","Maybe"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[370,72],"start":[370,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqString","moduleName":["Data","Eq"]}},"type":"App"},"type":"App"},"identifier":"shouldEqual4"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[375,33],"start":[375,31]}},"type":"Var","value":{"identifier":"eq","moduleName":["Data","Eq"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[375,67],"start":[375,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqString","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"eq"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[407,33],"start":[407,17]}},"type":"Var","value":{"identifier":"fromFoldable","moduleName":["Foreign","Object"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[410,14],"start":[407,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldableArray","moduleName":["Data","Foldable"]}},"type":"App"},"identifier":"fromFoldable"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[483,58],"start":[483,56]}},"type":"Var","value":{"identifier":"append","moduleName":["Data","Semigroup"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[483,62],"start":[483,27]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"semigroupString","moduleName":["Data","Semigroup"]}},"type":"App"},"identifier":"append"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[456,23],"start":[456,18]}},"type":"Var","value":{"identifier":"foldl","moduleName":["Data","Foldable"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[456,53],"start":[456,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldableArray","moduleName":["Data","Foldable"]}},"type":"App"},"identifier":"foldl"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[209,56],"start":[209,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showInt","moduleName":["Data","Show"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[209,56],"start":[209,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqInt","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"shouldEqual5"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[220,20],"start":[220,16]}},"type":"Var","value":{"identifier":"elem","moduleName":["Data","Array"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[220,32],"start":[220,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqString","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"elem"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[277,58],"start":[277,32]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Spec","Assertions","String"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[277,73],"start":[277,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadThrowAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"shouldContain"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[511,65],"start":[511,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showString","moduleName":["Data","Show"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[511,65],"start":[511,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqString","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"shouldEqual6"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[126,31],"start":[126,29]}},"type":"Var","value":{"identifier":"lessThanOrEq","moduleName":["Data","Ord"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[126,34],"start":[126,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordInt","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"lessThanOrEq"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[128,56],"start":[128,52]}},"type":"Var","value":{"identifier":"show","moduleName":["Data","Show"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[128,75],"start":[128,52]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showInt","moduleName":["Data","Show"]}},"type":"App"},"identifier":"show"},{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[309,47],"start":[309,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[309,47],"start":[309,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"parseAndSanitize - Special Values"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[376,36],"start":[309,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[325,50],"start":[311,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[311,35],"start":[311,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[311,35],"start":[311,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should handle null values"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[325,50],"start":[311,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[312,37],"start":[312,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[312,37],"start":[312,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[312,37],"start":[312,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"value\": null}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[313,56],"start":[313,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[313,56],"start":[313,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[313,36],"start":[313,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[313,41],"start":[313,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[313,41],"start":[313,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[312,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[313,56],"start":[313,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[313,56],"start":[313,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[314,38],"start":[314,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[314,38],"start":[314,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[314,19],"start":[314,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[314,13],"start":[314,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[313,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[314,38],"start":[314,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[314,38],"start":[314,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[314,38],"start":[314,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[314,38],"start":[314,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[325,50],"start":[315,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[316,15],"start":[316,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[316,15],"start":[316,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[324,60],"start":[316,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[316,37],"start":[316,24]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[316,39],"start":[316,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[316,39],"start":[316,38]}},"type":"Var","value":{"identifier":"d","sourcePos":[316,14]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[324,60],"start":[316,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[317,19],"start":[317,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[317,19],"start":[317,16]}},"binderType":"VarBinder","identifier":"obj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[323,53],"start":[318,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[318,28],"start":[318,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[318,36],"start":[318,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[318,36],"start":[318,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"value"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[318,40],"start":[318,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[318,40],"start":[318,37]}},"type":"Var","value":{"identifier":"obj","sourcePos":[317,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[323,53],"start":[318,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[319,21],"start":[319,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[319,21],"start":[319,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[322,50],"start":[320,17]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[322,50],"start":[320,17]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[321,33],"start":[321,24]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[321,33],"start":[321,29]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[322,50],"start":[320,17]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[322,50],"start":[322,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[322,50],"start":[322,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected null value"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[320,31],"start":[320,20]}},"type":"Var","value":{"identifier":"isNull","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[320,33],"start":[320,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[320,33],"start":[320,32]}},"type":"Var","value":{"identifier":"v2","sourcePos":[319,20]}},"type":"App"}],"type":"Case"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[323,22],"start":[323,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[323,53],"start":[323,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[323,53],"start":[323,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'value' key"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[324,18],"start":[324,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[324,60],"start":[324,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[324,60],"start":[324,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[325,16],"start":[325,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[325,50],"start":[325,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[325,50],"start":[325,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[315,22],"start":[315,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[315,18],"start":[315,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[313,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[325,50],"start":[311,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[325,50],"start":[311,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[341,50],"start":[327,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[327,38],"start":[327,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[327,38],"start":[327,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should handle boolean values"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[341,50],"start":[327,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[328,50],"start":[328,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[328,50],"start":[328,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[328,50],"start":[328,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"yes\": true, \"no\": false}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[329,56],"start":[329,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[329,56],"start":[329,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[329,36],"start":[329,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[329,41],"start":[329,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[329,41],"start":[329,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[328,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[329,56],"start":[329,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[329,56],"start":[329,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[330,38],"start":[330,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[330,38],"start":[330,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[330,19],"start":[330,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[330,13],"start":[330,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[329,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[330,38],"start":[330,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[330,38],"start":[330,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[330,38],"start":[330,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[330,38],"start":[330,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[341,50],"start":[331,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[332,15],"start":[332,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[332,15],"start":[332,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[340,60],"start":[332,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[332,37],"start":[332,24]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[332,39],"start":[332,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[332,39],"start":[332,38]}},"type":"Var","value":{"identifier":"d","sourcePos":[332,14]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[340,60],"start":[332,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[333,19],"start":[333,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[333,19],"start":[333,16]}},"binderType":"VarBinder","identifier":"obj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[336,51],"start":[334,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[336,51],"start":[334,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[334,28],"start":[334,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[334,34],"start":[334,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[334,34],"start":[334,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"yes"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[334,38],"start":[334,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[334,38],"start":[334,35]}},"type":"Var","value":{"identifier":"obj","sourcePos":[333,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[336,51],"start":[334,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[335,21],"start":[335,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[335,21],"start":[335,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[335,65],"start":[335,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[335,39],"start":[335,25]}},"type":"Var","value":{"identifier":"toBoolean","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[335,41],"start":[335,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[335,41],"start":[335,40]}},"type":"Var","value":{"identifier":"v2","sourcePos":[335,20]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[335,65],"start":[335,25]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[335,60],"start":[335,56]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[335,65],"start":[335,56]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[335,65],"start":[335,61]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[336,22],"start":[336,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[336,51],"start":[336,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[336,51],"start":[336,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'yes' key"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[336,51],"start":[334,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[336,51],"start":[334,13]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[339,50],"start":[337,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[337,28],"start":[337,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[337,33],"start":[337,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[337,33],"start":[337,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"no"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[337,37],"start":[337,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[337,37],"start":[337,34]}},"type":"Var","value":{"identifier":"obj","sourcePos":[333,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[339,50],"start":[337,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[338,21],"start":[338,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[338,21],"start":[338,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[338,66],"start":[338,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[338,39],"start":[338,25]}},"type":"Var","value":{"identifier":"toBoolean","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[338,41],"start":[338,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[338,41],"start":[338,40]}},"type":"Var","value":{"identifier":"v2","sourcePos":[338,20]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[338,66],"start":[338,25]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[338,60],"start":[338,56]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[338,66],"start":[338,56]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[338,66],"start":[338,61]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[339,22],"start":[339,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[339,50],"start":[339,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[339,50],"start":[339,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'no' key"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[340,18],"start":[340,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[340,60],"start":[340,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[340,60],"start":[340,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[341,16],"start":[341,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[341,50],"start":[341,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[341,50],"start":[341,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[331,22],"start":[331,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[331,18],"start":[331,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[329,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[341,50],"start":[327,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[341,50],"start":[327,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[360,50],"start":[343,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[343,37],"start":[343,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[343,37],"start":[343,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should handle number values"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[360,50],"start":[343,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[344,64],"start":[344,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[344,64],"start":[344,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[344,64],"start":[344,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"int\": 42, \"float\": 3.14, \"neg\": -10}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[345,56],"start":[345,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[345,56],"start":[345,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[345,36],"start":[345,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[345,41],"start":[345,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[345,41],"start":[345,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[344,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[345,56],"start":[345,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[345,56],"start":[345,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[346,38],"start":[346,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[346,38],"start":[346,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[346,19],"start":[346,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[346,13],"start":[346,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[345,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[346,38],"start":[346,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[346,38],"start":[346,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[346,38],"start":[346,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[346,38],"start":[346,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[360,50],"start":[347,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[348,15],"start":[348,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[348,15],"start":[348,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[359,60],"start":[348,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[348,37],"start":[348,24]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[348,39],"start":[348,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[348,39],"start":[348,38]}},"type":"Var","value":{"identifier":"d","sourcePos":[348,14]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[359,60],"start":[348,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[349,19],"start":[349,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[349,19],"start":[349,16]}},"binderType":"VarBinder","identifier":"obj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[352,51],"start":[350,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[352,51],"start":[350,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[350,28],"start":[350,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[350,34],"start":[350,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[350,34],"start":[350,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"int"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[350,38],"start":[350,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[350,38],"start":[350,35]}},"type":"Var","value":{"identifier":"obj","sourcePos":[349,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[352,51],"start":[350,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[351,21],"start":[351,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[351,21],"start":[351,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual3","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[351,64],"start":[351,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[351,38],"start":[351,25]}},"type":"Var","value":{"identifier":"toNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[351,40],"start":[351,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[351,40],"start":[351,39]}},"type":"Var","value":{"identifier":"v2","sourcePos":[351,20]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[351,64],"start":[351,25]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[351,59],"start":[351,55]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[351,64],"start":[351,55]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[351,64],"start":[351,60]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":42}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[352,22],"start":[352,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[352,51],"start":[352,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[352,51],"start":[352,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'int' key"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[352,51],"start":[350,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[352,51],"start":[350,13]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[355,53],"start":[353,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[355,53],"start":[353,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[353,28],"start":[353,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[353,36],"start":[353,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[353,36],"start":[353,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"float"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[353,40],"start":[353,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[353,40],"start":[353,37]}},"type":"Var","value":{"identifier":"obj","sourcePos":[349,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[355,53],"start":[353,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[354,21],"start":[354,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[354,21],"start":[354,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual3","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[354,64],"start":[354,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[354,38],"start":[354,25]}},"type":"Var","value":{"identifier":"toNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[354,40],"start":[354,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[354,40],"start":[354,39]}},"type":"Var","value":{"identifier":"v2","sourcePos":[354,20]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[354,64],"start":[354,25]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[354,59],"start":[354,55]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[354,64],"start":[354,55]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[354,64],"start":[354,60]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":3.14}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[355,22],"start":[355,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[355,53],"start":[355,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[355,53],"start":[355,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'float' key"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[355,53],"start":[353,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[355,53],"start":[353,13]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[358,51],"start":[356,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[356,28],"start":[356,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[356,34],"start":[356,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[356,34],"start":[356,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"neg"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[356,38],"start":[356,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[356,38],"start":[356,35]}},"type":"Var","value":{"identifier":"obj","sourcePos":[349,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[358,51],"start":[356,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[357,21],"start":[357,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[357,21],"start":[357,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual3","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[357,67],"start":[357,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[357,38],"start":[357,25]}},"type":"Var","value":{"identifier":"toNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[357,40],"start":[357,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[357,40],"start":[357,39]}},"type":"Var","value":{"identifier":"v2","sourcePos":[357,20]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[357,67],"start":[357,25]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[357,59],"start":[357,55]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[357,67],"start":[357,55]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"negate","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[357,66],"start":[357,61]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[357,66],"start":[357,62]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":10}},"type":"App"},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[358,22],"start":[358,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[358,51],"start":[358,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[358,51],"start":[358,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'neg' key"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[359,18],"start":[359,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[359,60],"start":[359,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[359,60],"start":[359,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[360,16],"start":[360,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[360,50],"start":[360,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[360,50],"start":[360,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[347,22],"start":[347,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[347,18],"start":[347,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[345,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[360,50],"start":[343,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[360,50],"start":[343,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[362,47],"start":[362,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[362,47],"start":[362,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should remove null bytes from strings"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[376,36],"start":[362,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[363,54],"start":[363,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[363,54],"start":[363,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[363,54],"start":[363,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"value\": \"hello\\u0000world\"}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[364,56],"start":[364,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[364,56],"start":[364,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[364,36],"start":[364,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[364,41],"start":[364,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[364,41],"start":[364,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[363,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[364,56],"start":[364,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[364,56],"start":[364,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[365,38],"start":[365,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[365,38],"start":[365,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[365,19],"start":[365,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[365,13],"start":[365,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[364,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[365,38],"start":[365,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[365,38],"start":[365,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[365,38],"start":[365,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[365,38],"start":[365,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[373,50],"start":[366,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[373,50],"start":[366,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[367,15],"start":[367,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[367,15],"start":[367,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[372,60],"start":[367,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[367,37],"start":[367,24]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[367,39],"start":[367,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[367,39],"start":[367,38]}},"type":"Var","value":{"identifier":"d","sourcePos":[367,14]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[372,60],"start":[367,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[368,19],"start":[368,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[368,19],"start":[368,16]}},"binderType":"VarBinder","identifier":"obj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[371,53],"start":[369,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[369,28],"start":[369,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[369,36],"start":[369,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[369,36],"start":[369,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"value"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[369,40],"start":[369,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[369,40],"start":[369,37]}},"type":"Var","value":{"identifier":"obj","sourcePos":[368,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[371,53],"start":[369,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[370,21],"start":[370,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[370,21],"start":[370,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual4","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[370,72],"start":[370,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[370,38],"start":[370,25]}},"type":"Var","value":{"identifier":"toString","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[370,40],"start":[370,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[370,40],"start":[370,39]}},"type":"Var","value":{"identifier":"v2","sourcePos":[370,20]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[370,72],"start":[370,25]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[370,59],"start":[370,55]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[370,72],"start":[370,55]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[370,72],"start":[370,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"helloworld"}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[371,22],"start":[371,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[371,53],"start":[371,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[371,53],"start":[371,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'value' key"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[372,18],"start":[372,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[372,60],"start":[372,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[372,60],"start":[372,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,31],"start":[307,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[373,16],"start":[373,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[373,50],"start":[373,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[373,50],"start":[373,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[366,22],"start":[366,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[366,18],"start":[366,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[364,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[373,50],"start":[366,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[373,50],"start":[366,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[375,83],"start":[375,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[375,83],"start":[375,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[375,27],"start":[375,24]}},"type":"Var","value":{"identifier":"any","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[375,67],"start":[375,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[375,67],"start":[375,28]}},"argument":"v","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[375,67],"start":[375,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[375,67],"start":[375,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[375,66],"start":[375,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Null bytes removed from string"}},"type":"App"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[375,83],"start":[375,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[375,83],"start":[375,68]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[375,74],"start":[375,68]}},"type":"Var","value":{"identifier":"result","sourcePos":[364,11]}},"fieldName":"warnings","type":"Accessor"},"type":"App"},"identifier":"hasWarning"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[376,36],"start":[376,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[376,17],"start":[376,7]}},"type":"Var","value":{"identifier":"hasWarning","sourcePos":[375,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[376,36],"start":[376,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[376,36],"start":[376,32]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Let"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"specialValueTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[401,36],"start":[401,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[403,40],"start":[403,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[403,40],"start":[403,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"sanitize - Pre-parsed Data"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[437,50],"start":[403,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[422,50],"start":[405,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[405,48],"start":[405,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[405,48],"start":[405,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should sanitize already-parsed objects"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[422,50],"start":[405,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[410,14],"start":[407,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[410,14],"start":[407,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fromFoldable","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[410,14],"start":[407,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[410,14],"start":[408,13]}},"type":"Literal","value":{"literalType":"ArrayLiteral","value":[{"abstraction":{"abstraction":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":["value0","value1"],"metaType":"IsConstructor"},"sourceSpan":{"end":[408,20],"start":[408,15]}},"type":"Var","value":{"identifier":"Tuple","moduleName":["Data","Tuple"]}},"annotation":{"meta":null,"sourceSpan":{"end":[408,27],"start":[408,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[408,27],"start":[408,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"safe"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[408,53],"start":[408,15]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[408,44],"start":[408,29]}},"type":"Var","value":{"identifier":"fromString","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[408,52],"start":[408,29]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[408,52],"start":[408,45]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"value"}},"type":"App"},"type":"App"},{"abstraction":{"abstraction":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":["value0","value1"],"metaType":"IsConstructor"},"sourceSpan":{"end":[409,20],"start":[409,15]}},"type":"Var","value":{"identifier":"Tuple","moduleName":["Data","Tuple"]}},"annotation":{"meta":null,"sourceSpan":{"end":[409,32],"start":[409,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[409,32],"start":[409,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"__proto__"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[409,97],"start":[409,15]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[409,49],"start":[409,34]}},"type":"Var","value":{"identifier":"fromObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[409,96],"start":[409,34]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[409,64],"start":[409,51]}},"type":"Var","value":{"identifier":"singleton","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[409,71],"start":[409,51]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[409,71],"start":[409,65]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"evil"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[409,95],"start":[409,51]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[409,89],"start":[409,73]}},"type":"Var","value":{"identifier":"fromBoolean","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[409,94],"start":[409,73]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[409,94],"start":[409,90]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"type":"App"},"type":"App"}]}},"type":"App"},"identifier":"obj"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[411,37],"start":[411,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[411,37],"start":[411,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[411,33],"start":[411,18]}},"type":"Var","value":{"identifier":"fromObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[411,37],"start":[411,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[411,37],"start":[411,34]}},"type":"Var","value":{"identifier":"obj","sourcePos":[407,11]}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[412,48],"start":[412,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[412,48],"start":[412,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[412,28],"start":[412,20]}},"type":"Var","value":{"identifier":"sanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[412,33],"start":[412,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[412,33],"start":[412,29]}},"type":"Var","value":{"identifier":"json","sourcePos":[411,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[412,48],"start":[412,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[412,48],"start":[412,34]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[413,38],"start":[413,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[413,38],"start":[413,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[413,19],"start":[413,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[413,13],"start":[413,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[412,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[413,38],"start":[413,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[413,38],"start":[413,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[413,38],"start":[413,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[413,38],"start":[413,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[422,50],"start":[414,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[415,15],"start":[415,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[415,15],"start":[415,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[421,60],"start":[415,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[401,36],"start":[401,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[415,37],"start":[415,24]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[415,39],"start":[415,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[415,39],"start":[415,38]}},"type":"Var","value":{"identifier":"d","sourcePos":[415,14]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[421,60],"start":[415,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[416,28],"start":[416,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[416,28],"start":[416,16]}},"binderType":"VarBinder","identifier":"sanitizedObj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[420,66],"start":[418,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[401,36],"start":[401,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[418,28],"start":[418,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[418,35],"start":[418,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[418,35],"start":[418,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"safe"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[418,48],"start":[418,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[418,48],"start":[418,36]}},"type":"Var","value":{"identifier":"sanitizedObj","sourcePos":[416,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[420,66],"start":[418,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[419,21],"start":[419,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[419,21],"start":[419,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual4","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[419,67],"start":[419,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[419,38],"start":[419,25]}},"type":"Var","value":{"identifier":"toString","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[419,40],"start":[419,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[419,40],"start":[419,39]}},"type":"Var","value":{"identifier":"v2","sourcePos":[419,20]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[419,67],"start":[419,25]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[419,59],"start":[419,55]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[419,67],"start":[419,55]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[419,67],"start":[419,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"value"}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[420,22],"start":[420,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[420,66],"start":[420,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[420,66],"start":[420,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'safe' key to be present"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[401,36],"start":[401,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[421,18],"start":[421,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[421,60],"start":[421,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[421,60],"start":[421,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[401,36],"start":[401,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[422,16],"start":[422,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[422,50],"start":[422,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[422,50],"start":[422,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[414,22],"start":[414,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[414,18],"start":[414,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[412,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[422,50],"start":[405,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[422,50],"start":[405,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[424,30],"start":[424,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[424,30],"start":[424,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should handle arrays"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[437,50],"start":[424,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[429,14],"start":[425,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[429,14],"start":[425,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[425,31],"start":[425,17]}},"type":"Var","value":{"identifier":"fromArray","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[429,14],"start":[425,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[429,14],"start":[426,13]}},"type":"Literal","value":{"literalType":"ArrayLiteral","value":[{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[426,30],"start":[426,15]}},"type":"Var","value":{"identifier":"fromNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[426,34],"start":[426,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[426,34],"start":[426,31]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":1}},"type":"App"},{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[427,30],"start":[427,15]}},"type":"Var","value":{"identifier":"fromNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[427,34],"start":[427,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[427,34],"start":[427,31]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":2}},"type":"App"},{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[428,30],"start":[428,15]}},"type":"Var","value":{"identifier":"fromObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[428,79],"start":[428,15]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[428,45],"start":[428,32]}},"type":"Var","value":{"identifier":"singleton","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[428,54],"start":[428,32]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[428,54],"start":[428,46]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"nested"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[428,78],"start":[428,32]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[428,72],"start":[428,56]}},"type":"Var","value":{"identifier":"fromBoolean","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[428,77],"start":[428,56]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[428,77],"start":[428,73]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"type":"App"}]}},"type":"App"},"identifier":"arr"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[430,47],"start":[430,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[430,47],"start":[430,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[430,28],"start":[430,20]}},"type":"Var","value":{"identifier":"sanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[430,32],"start":[430,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[430,32],"start":[430,29]}},"type":"Var","value":{"identifier":"arr","sourcePos":[425,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[430,47],"start":[430,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[430,47],"start":[430,33]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[431,38],"start":[431,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[431,38],"start":[431,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[431,19],"start":[431,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[431,13],"start":[431,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[430,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[431,38],"start":[431,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[431,38],"start":[431,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[431,38],"start":[431,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[431,38],"start":[431,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[437,50],"start":[432,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[433,15],"start":[433,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[433,15],"start":[433,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[436,55],"start":[434,11]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[436,55],"start":[434,11]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[435,27],"start":[435,18]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[435,27],"start":[435,23]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[436,55],"start":[434,11]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[436,55],"start":[436,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[436,55],"start":[436,23]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an array"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[434,26],"start":[434,14]}},"type":"Var","value":{"identifier":"isArray","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[434,28],"start":[434,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[434,28],"start":[434,27]}},"type":"Var","value":{"identifier":"d","sourcePos":[433,14]}},"type":"App"}],"type":"Case"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[437,16],"start":[437,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[437,50],"start":[437,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[437,50],"start":[437,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[432,22],"start":[432,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[432,18],"start":[432,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[430,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"sanitizePreParsedTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[72,37],"start":[72,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[72,37],"start":[72,1]}},"argument":"n","body":{"annotation":{"meta":null,"sourceSpan":{"end":[72,37],"start":[72,1]}},"argument":"s","body":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[73,25],"start":[73,17]}},"type":"Var","value":{"identifier":"joinWith","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[73,28],"start":[73,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[73,28],"start":[73,26]}},"type":"Literal","value":{"literalType":"StringLiteral","value":""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[73,44],"start":[73,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[73,39],"start":[73,30]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[73,41],"start":[73,30]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[73,41],"start":[73,40]}},"type":"Var","value":{"identifier":"n","sourcePos":[73,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[73,43],"start":[73,30]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[73,43],"start":[73,42]}},"type":"Var","value":{"identifier":"s","sourcePos":[73,1]}},"type":"App"},"type":"App"},"type":"Abs"},"type":"Abs"},"identifier":"repeatStr"},{"annotation":{"meta":null,"sourceSpan":{"end":[470,28],"start":[470,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[472,46],"start":[472,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[472,46],"start":[472,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"safeParse - Convenience Function"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[494,39],"start":[472,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[483,63],"start":[474,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[474,50],"start":[474,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[474,50],"start":[474,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should return parsed data for valid JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[483,63],"start":[474,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[475,62],"start":[475,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[475,62],"start":[475,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[475,29],"start":[475,20]}},"type":"Var","value":{"identifier":"safeParse","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[475,47],"start":[475,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[475,47],"start":[475,30]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"value\": 42}"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[475,62],"start":[475,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[475,62],"start":[475,48]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[483,63],"start":[476,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[477,19],"start":[477,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[477,19],"start":[477,15]}},"binderType":"VarBinder","identifier":"json"}],"constructorName":{"identifier":"Right","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[482,60],"start":[477,23]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[470,28],"start":[470,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[477,41],"start":[477,28]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[477,46],"start":[477,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[477,46],"start":[477,42]}},"type":"Var","value":{"identifier":"json","sourcePos":[477,15]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[482,60],"start":[477,23]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[478,19],"start":[478,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[478,19],"start":[478,16]}},"binderType":"VarBinder","identifier":"obj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[481,53],"start":[479,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[470,28],"start":[470,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[479,28],"start":[479,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[479,36],"start":[479,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[479,36],"start":[479,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"value"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[479,40],"start":[479,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[479,40],"start":[479,37]}},"type":"Var","value":{"identifier":"obj","sourcePos":[478,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[481,53],"start":[479,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[480,21],"start":[480,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[480,21],"start":[480,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual3","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[480,64],"start":[480,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[480,38],"start":[480,25]}},"type":"Var","value":{"identifier":"toNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[480,40],"start":[480,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[480,40],"start":[480,39]}},"type":"Var","value":{"identifier":"v2","sourcePos":[480,20]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[480,64],"start":[480,25]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[480,59],"start":[480,55]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[480,64],"start":[480,55]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[480,64],"start":[480,60]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":42}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[481,22],"start":[481,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[481,53],"start":[481,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[481,53],"start":[481,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'value' key"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[470,28],"start":[470,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[482,18],"start":[482,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[482,60],"start":[482,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[482,60],"start":[482,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[470,28],"start":[470,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[483,17],"start":[483,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[483,17],"start":[483,14]}},"binderType":"VarBinder","identifier":"err"}],"constructorName":{"identifier":"Left","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[483,63],"start":[483,21]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[483,62],"start":[483,27]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[483,55],"start":[483,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected Right, got Left: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[483,62],"start":[483,27]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[483,62],"start":[483,59]}},"type":"Var","value":{"identifier":"err","sourcePos":[483,14]}},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[476,18],"start":[476,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[475,11]}}],"type":"Case"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[483,63],"start":[474,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[483,63],"start":[474,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[487,39],"start":[485,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[485,45],"start":[485,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[485,45],"start":[485,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should return Left for invalid JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[487,39],"start":[485,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[486,56],"start":[486,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[486,56],"start":[486,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[486,29],"start":[486,20]}},"type":"Var","value":{"identifier":"safeParse","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[486,41],"start":[486,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[486,41],"start":[486,30]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{invalid}"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[486,56],"start":[486,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[486,56],"start":[486,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[487,39],"start":[487,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[487,13],"start":[487,7]}},"type":"Var","value":{"identifier":"isLeft","moduleName":["Data","Either"]}},"annotation":{"meta":null,"sourceSpan":{"end":[487,20],"start":[487,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[487,20],"start":[487,14]}},"type":"Var","value":{"identifier":"result","sourcePos":[486,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[487,39],"start":[487,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[487,39],"start":[487,35]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[487,39],"start":[485,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[487,39],"start":[485,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[489,47],"start":[489,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[489,47],"start":[489,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should return Left for oversized JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[494,39],"start":[489,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[491,57],"start":[491,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[491,57],"start":[491,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[491,57],"start":[491,18]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[494,39],"start":[471,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[491,32],"start":[491,18]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[491,57],"start":[491,18]}},"copy":["maxArrayLength","maxDepth","maxKeyLength","maxTotalKeys","removeNullBytes","removePrototypeKeys"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[471,1]}},"type":"ObjectUpdate","updates":[["maxStringLength",{"annotation":{"meta":null,"sourceSpan":{"end":[491,55],"start":[491,53]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10}}]]},"type":"Let"},"identifier":"opts"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[492,35],"start":[492,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[492,35],"start":[492,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[492,28],"start":[492,19]}},"type":"Var","value":{"identifier":"repeatStr","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[492,31],"start":[492,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[492,31],"start":[492,29]}},"type":"Literal","value":{"literalType":"IntLiteral","value":50}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[492,35],"start":[492,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[492,35],"start":[492,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"a"}},"type":"App"},"identifier":"large"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[493,66],"start":[493,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[493,66],"start":[493,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[493,29],"start":[493,20]}},"type":"Var","value":{"identifier":"safeParse","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[493,61],"start":[493,20]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[493,60],"start":[493,31]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[493,42],"start":[493,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"x\":\""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[493,60],"start":[493,31]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[493,60],"start":[493,31]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[493,51],"start":[493,46]}},"type":"Var","value":{"identifier":"large","sourcePos":[492,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[493,60],"start":[493,31]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[493,60],"start":[493,55]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"\"}"}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[493,66],"start":[493,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[493,66],"start":[493,62]}},"type":"Var","value":{"identifier":"opts","sourcePos":[491,11]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[494,39],"start":[494,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[494,13],"start":[494,7]}},"type":"Var","value":{"identifier":"isLeft","moduleName":["Data","Either"]}},"annotation":{"meta":null,"sourceSpan":{"end":[494,20],"start":[494,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[494,20],"start":[494,14]}},"type":"Var","value":{"identifier":"result","sourcePos":[493,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[494,39],"start":[494,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[494,39],"start":[494,35]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"safeParseTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[443,32],"start":[443,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[445,44],"start":[445,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[445,44],"start":[445,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"quickValidate - Fast Rejection"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[464,78],"start":[445,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[452,50],"start":[447,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[447,46],"start":[447,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[447,46],"start":[447,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should quickly reject oversized JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[452,50],"start":[447,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[449,57],"start":[449,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[449,57],"start":[449,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[449,57],"start":[449,18]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[464,78],"start":[444,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[449,32],"start":[449,18]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[449,57],"start":[449,18]}},"copy":["maxArrayLength","maxDepth","maxKeyLength","maxTotalKeys","removeNullBytes","removePrototypeKeys"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[444,1]}},"type":"ObjectUpdate","updates":[["maxStringLength",{"annotation":{"meta":null,"sourceSpan":{"end":[449,55],"start":[449,53]}},"type":"Literal","value":{"literalType":"IntLiteral","value":50}}]]},"type":"Let"},"identifier":"opts"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[450,36],"start":[450,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[450,36],"start":[450,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[450,28],"start":[450,19]}},"type":"Var","value":{"identifier":"repeatStr","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[450,32],"start":[450,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[450,32],"start":[450,29]}},"type":"Literal","value":{"literalType":"IntLiteral","value":200}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[450,36],"start":[450,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[450,36],"start":[450,33]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"a"}},"type":"App"},"identifier":"large"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[451,47],"start":[451,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[451,47],"start":[451,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[451,47],"start":[451,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[451,29],"start":[451,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"x\":\""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[451,47],"start":[451,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[451,47],"start":[451,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[451,38],"start":[451,33]}},"type":"Var","value":{"identifier":"large","sourcePos":[450,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[451,47],"start":[451,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[451,47],"start":[451,42]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"\"}"}},"type":"App"},"type":"App"},"identifier":"json"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[452,50],"start":[452,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[452,20],"start":[452,7]}},"type":"Var","value":{"identifier":"quickValidate","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[452,25],"start":[452,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[452,25],"start":[452,21]}},"type":"Var","value":{"identifier":"json","sourcePos":[451,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[452,30],"start":[452,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[452,30],"start":[452,26]}},"type":"Var","value":{"identifier":"opts","sourcePos":[449,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[452,50],"start":[452,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[452,50],"start":[452,45]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[452,50],"start":[447,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[452,50],"start":[447,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[457,60],"start":[454,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[454,44],"start":[454,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[454,44],"start":[454,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should quickly reject deep nesting"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[457,60],"start":[454,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[456,77],"start":[456,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[456,77],"start":[456,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldl","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[456,53],"start":[456,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[456,52],"start":[456,25]}},"argument":"acc","body":{"annotation":{"meta":null,"sourceSpan":{"end":[456,52],"start":[456,25]}},"argument":"v","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[456,52],"start":[456,35]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[456,38],"start":[456,35]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"["}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[456,52],"start":[456,35]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[456,52],"start":[456,35]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[456,45],"start":[456,42]}},"type":"Var","value":{"identifier":"acc","sourcePos":[456,26]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[456,52],"start":[456,35]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[456,52],"start":[456,49]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"]"}},"type":"App"},"type":"App"},"type":"Abs"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[456,57],"start":[456,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[456,57],"start":[456,54]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"1"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[456,77],"start":[456,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[456,68],"start":[456,59]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[456,71],"start":[456,59]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[456,71],"start":[456,69]}},"type":"Literal","value":{"literalType":"IntLiteral","value":60}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[456,76],"start":[456,59]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[456,76],"start":[456,72]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"type":"App"},"identifier":"json"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[457,60],"start":[457,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[457,20],"start":[457,7]}},"type":"Var","value":{"identifier":"quickValidate","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[457,25],"start":[457,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[457,25],"start":[457,21]}},"type":"Var","value":{"identifier":"json","sourcePos":[456,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[457,40],"start":[457,7]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[457,40],"start":[457,26]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[457,60],"start":[457,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[457,60],"start":[457,55]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[457,60],"start":[454,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[457,60],"start":[454,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[461,79],"start":[459,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[459,46],"start":[459,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[459,46],"start":[459,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should quickly reject __proto__ keys"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[461,79],"start":[459,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[460,77],"start":[460,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[460,77],"start":[460,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[460,20],"start":[460,7]}},"type":"Var","value":{"identifier":"quickValidate","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[460,42],"start":[460,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[460,42],"start":[460,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"__proto__\": {}}"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[460,57],"start":[460,7]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[460,57],"start":[460,43]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[460,77],"start":[460,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[460,77],"start":[460,72]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[460,77],"start":[460,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[460,77],"start":[460,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[461,79],"start":[461,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[461,20],"start":[461,7]}},"type":"Var","value":{"identifier":"quickValidate","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[461,44],"start":[461,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[461,44],"start":[461,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"constructor\": {}}"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[461,59],"start":[461,7]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[461,59],"start":[461,45]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[461,79],"start":[461,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[461,79],"start":[461,74]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[461,79],"start":[459,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[461,79],"start":[459,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[463,32],"start":[463,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[463,32],"start":[463,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should pass valid JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[464,78],"start":[463,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[464,78],"start":[464,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[464,20],"start":[464,7]}},"type":"Var","value":{"identifier":"quickValidate","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[464,44],"start":[464,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[464,44],"start":[464,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"safe\": \"value\"}"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[464,59],"start":[464,7]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[464,59],"start":[464,45]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[464,78],"start":[464,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[464,78],"start":[464,74]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"quickValidateTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[200,37],"start":[200,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[202,63],"start":[202,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[202,63],"start":[202,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"parseAndSanitize - Prototype Pollution Protection"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[260,56],"start":[202,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[228,50],"start":[204,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[204,37],"start":[204,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[204,37],"start":[204,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK __proto__ keys"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[228,50],"start":[204,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[205,70],"start":[205,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[205,70],"start":[205,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[205,70],"start":[205,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"__proto__\": {\"polluted\": true}, \"safe\": 1}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[206,56],"start":[206,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[206,56],"start":[206,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[206,36],"start":[206,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[206,41],"start":[206,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[206,41],"start":[206,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[205,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[206,56],"start":[206,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[206,56],"start":[206,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[208,38],"start":[208,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[208,38],"start":[208,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[208,19],"start":[208,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[208,13],"start":[208,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[206,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[208,38],"start":[208,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[208,38],"start":[208,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[208,38],"start":[208,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[208,38],"start":[208,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[209,56],"start":[209,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual5","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[209,56],"start":[209,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,40],"start":[209,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[209,40],"start":[209,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[209,13],"start":[209,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[206,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,56],"start":[209,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,56],"start":[209,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,56],"start":[209,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,56],"start":[209,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[211,95],"start":[211,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[211,95],"start":[211,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[211,27],"start":[211,24]}},"type":"Var","value":{"identifier":"any","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[211,79],"start":[211,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[211,79],"start":[211,28]}},"argument":"v","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[211,79],"start":[211,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[211,79],"start":[211,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[211,78],"start":[211,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Prototype pollution key removed: __proto__"}},"type":"App"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[211,95],"start":[211,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[211,95],"start":[211,80]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[211,86],"start":[211,80]}},"type":"Var","value":{"identifier":"result","sourcePos":[206,11]}},"fieldName":"warnings","type":"Accessor"},"type":"App"},"identifier":"hasWarning"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[212,36],"start":[212,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[212,36],"start":[212,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[212,17],"start":[212,7]}},"type":"Var","value":{"identifier":"hasWarning","sourcePos":[211,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[212,36],"start":[212,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[212,36],"start":[212,32]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[212,36],"start":[212,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[212,36],"start":[212,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[228,50],"start":[216,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[217,15],"start":[217,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[217,15],"start":[217,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[227,60],"start":[217,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[200,37],"start":[200,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[217,37],"start":[217,24]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[217,39],"start":[217,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[217,39],"start":[217,38]}},"type":"Var","value":{"identifier":"d","sourcePos":[217,14]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[227,60],"start":[217,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[218,19],"start":[218,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[218,19],"start":[218,16]}},"binderType":"VarBinder","identifier":"obj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[222,29],"start":[220,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[222,29],"start":[220,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[222,29],"start":[220,13]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[221,63],"start":[221,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[221,63],"start":[221,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected __proto__ key to be removed"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[222,29],"start":[220,13]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[222,29],"start":[222,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[222,29],"start":[222,25]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"elem","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[220,32],"start":[220,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[220,32],"start":[220,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"__proto__"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[220,47],"start":[220,16]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[220,42],"start":[220,34]}},"type":"Var","value":{"identifier":"keys","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[220,46],"start":[220,34]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[220,46],"start":[220,43]}},"type":"Var","value":{"identifier":"obj","sourcePos":[218,16]}},"type":"App"},"type":"App"}],"type":"Case"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[222,29],"start":[220,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[222,29],"start":[220,13]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[226,60],"start":[224,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[226,60],"start":[224,13]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[225,29],"start":[225,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[225,29],"start":[225,25]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[226,60],"start":[224,13]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[226,60],"start":[226,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[226,60],"start":[226,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'safe' key to be present"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"elem","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[224,27],"start":[224,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[224,27],"start":[224,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"safe"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[224,42],"start":[224,16]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[224,37],"start":[224,29]}},"type":"Var","value":{"identifier":"keys","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[224,41],"start":[224,29]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[224,41],"start":[224,38]}},"type":"Var","value":{"identifier":"obj","sourcePos":[218,16]}},"type":"App"},"type":"App"}],"type":"Case"},"type":"Abs"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[227,18],"start":[227,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[227,60],"start":[227,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[227,60],"start":[227,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[200,37],"start":[200,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[228,16],"start":[228,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[228,50],"start":[228,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[228,50],"start":[228,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[216,22],"start":[216,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[216,18],"start":[216,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[206,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[228,50],"start":[204,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[228,50],"start":[204,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[242,50],"start":[230,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[230,39],"start":[230,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[230,39],"start":[230,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK constructor keys"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[242,50],"start":[230,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[231,72],"start":[231,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[231,72],"start":[231,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[231,72],"start":[231,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"constructor\": {\"prototype\": {\"evil\": true}}}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[232,56],"start":[232,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[232,56],"start":[232,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[232,36],"start":[232,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[232,41],"start":[232,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[232,41],"start":[232,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[231,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[232,56],"start":[232,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[232,56],"start":[232,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[233,38],"start":[233,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[233,38],"start":[233,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[233,19],"start":[233,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[233,13],"start":[233,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[232,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[233,38],"start":[233,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[233,38],"start":[233,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[233,38],"start":[233,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[233,38],"start":[233,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[234,56],"start":[234,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual5","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[234,56],"start":[234,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,40],"start":[234,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[234,40],"start":[234,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[234,13],"start":[234,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[232,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[234,56],"start":[234,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,56],"start":[234,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[234,56],"start":[234,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,56],"start":[234,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[242,50],"start":[235,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[236,15],"start":[236,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[236,15],"start":[236,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[241,60],"start":[236,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[200,37],"start":[200,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[236,37],"start":[236,24]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[236,39],"start":[236,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[236,39],"start":[236,38]}},"type":"Var","value":{"identifier":"d","sourcePos":[236,14]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[241,60],"start":[236,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[237,19],"start":[237,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[237,19],"start":[237,16]}},"binderType":"VarBinder","identifier":"obj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[240,29],"start":[238,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[240,29],"start":[238,13]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[239,67],"start":[239,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[239,67],"start":[239,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'constructor' key to be removed"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[240,29],"start":[238,13]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[240,29],"start":[240,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[240,29],"start":[240,25]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"elem","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[238,34],"start":[238,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[238,34],"start":[238,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"constructor"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[238,49],"start":[238,16]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[238,44],"start":[238,36]}},"type":"Var","value":{"identifier":"keys","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[238,48],"start":[238,36]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[238,48],"start":[238,45]}},"type":"Var","value":{"identifier":"obj","sourcePos":[237,16]}},"type":"App"},"type":"App"}],"type":"Case"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[241,18],"start":[241,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[241,60],"start":[241,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[241,60],"start":[241,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[200,37],"start":[200,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[242,16],"start":[242,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[242,50],"start":[242,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[242,50],"start":[242,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[235,22],"start":[235,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[235,18],"start":[235,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[232,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[242,50],"start":[230,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[242,50],"start":[230,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[248,56],"start":[244,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[244,37],"start":[244,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[244,37],"start":[244,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK prototype keys"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[248,56],"start":[244,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[245,53],"start":[245,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[245,53],"start":[245,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[245,53],"start":[245,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"prototype\": {\"evil\": true}}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[246,56],"start":[246,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[246,56],"start":[246,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[246,36],"start":[246,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[246,41],"start":[246,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[246,41],"start":[246,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[245,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[246,56],"start":[246,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[246,56],"start":[246,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[247,38],"start":[247,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[247,38],"start":[247,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[247,19],"start":[247,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[247,13],"start":[247,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[246,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[247,38],"start":[247,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[247,38],"start":[247,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[247,38],"start":[247,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[247,38],"start":[247,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual5","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[248,56],"start":[248,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[248,40],"start":[248,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[248,40],"start":[248,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[248,13],"start":[248,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[246,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[248,56],"start":[248,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[248,56],"start":[248,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[248,56],"start":[244,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[248,56],"start":[244,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[254,56],"start":[250,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[250,56],"start":[250,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[250,56],"start":[250,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK case variations of dangerous keys"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[254,56],"start":[250,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[251,87],"start":[251,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[251,87],"start":[251,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[251,87],"start":[251,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"__PROTO__\": {\"evil\": true}, \"CONSTRUCTOR\": {\"bad\": true}}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[252,56],"start":[252,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[252,56],"start":[252,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[252,36],"start":[252,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[252,41],"start":[252,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[252,41],"start":[252,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[251,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[252,56],"start":[252,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[252,56],"start":[252,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[253,38],"start":[253,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[253,38],"start":[253,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[253,19],"start":[253,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[253,13],"start":[253,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[252,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[253,38],"start":[253,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[253,38],"start":[253,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[253,38],"start":[253,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[253,38],"start":[253,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual5","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[254,56],"start":[254,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[254,40],"start":[254,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[254,40],"start":[254,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[254,13],"start":[254,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[252,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[254,56],"start":[254,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[254,56],"start":[254,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":2}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[254,56],"start":[250,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[254,56],"start":[250,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[256,51],"start":[256,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[256,51],"start":[256,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK __defineGetter__ and similar"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[260,56],"start":[256,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[257,83],"start":[257,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[257,83],"start":[257,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[257,83],"start":[257,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"__defineGetter__\": \"evil\", \"__defineSetter__\": \"bad\"}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[258,56],"start":[258,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[258,56],"start":[258,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[258,36],"start":[258,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[258,41],"start":[258,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[258,41],"start":[258,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[257,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[258,56],"start":[258,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[258,56],"start":[258,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[259,38],"start":[259,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[259,38],"start":[259,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[259,19],"start":[259,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[259,13],"start":[259,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[258,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[259,38],"start":[259,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[259,38],"start":[259,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[259,38],"start":[259,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[259,38],"start":[259,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual5","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[260,56],"start":[260,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[260,40],"start":[260,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[260,40],"start":[260,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[260,13],"start":[260,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[258,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[260,56],"start":[260,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[260,56],"start":[260,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":2}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"prototypePollutionTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[266,33],"start":[266,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[268,50],"start":[268,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[268,50],"start":[268,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"parseAndSanitize - Object Key Limits"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[301,50],"start":[268,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[278,59],"start":[270,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[270,55],"start":[270,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[270,55],"start":[270,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK objects with too many total keys"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[278,59],"start":[270,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[272,53],"start":[272,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[272,53],"start":[272,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[272,53],"start":[272,18]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[301,50],"start":[267,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[272,32],"start":[272,18]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[272,53],"start":[272,18]}},"copy":["maxArrayLength","maxDepth","maxKeyLength","maxStringLength","removeNullBytes","removePrototypeKeys"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[267,1]}},"type":"ObjectUpdate","updates":[["maxTotalKeys",{"annotation":{"meta":null,"sourceSpan":{"end":[272,51],"start":[272,50]}},"type":"Literal","value":{"literalType":"IntLiteral","value":5}}]]},"type":"Let"},"identifier":"opts"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[273,90],"start":[273,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[273,90],"start":[273,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[273,90],"start":[273,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"a\": 1, \"b\": 2, \"c\": 3, \"d\": 4, \"e\": 5, \"f\": 6, \"g\": 7}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[274,46],"start":[274,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[274,46],"start":[274,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[274,36],"start":[274,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[274,41],"start":[274,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[274,41],"start":[274,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[273,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[274,46],"start":[274,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[274,46],"start":[274,42]}},"type":"Var","value":{"identifier":"opts","sourcePos":[272,11]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[275,39],"start":[275,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[275,39],"start":[275,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[275,19],"start":[275,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[275,13],"start":[275,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[274,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[275,39],"start":[275,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[275,39],"start":[275,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[275,39],"start":[275,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[275,39],"start":[275,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[278,59],"start":[276,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[277,20],"start":[277,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[277,20],"start":[277,14]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[277,73],"start":[277,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[277,30],"start":[277,24]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[277,14]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[277,73],"start":[277,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[277,73],"start":[277,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"keys exceed"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[278,16],"start":[278,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[278,59],"start":[278,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[278,59],"start":[278,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about keys exceed"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[276,22],"start":[276,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[276,18],"start":[276,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[274,11]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[278,59],"start":[270,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[278,59],"start":[270,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[280,44],"start":[280,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[280,44],"start":[280,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should SKIP keys that are too long"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[301,50],"start":[280,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[282,39],"start":[282,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[282,39],"start":[282,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[282,30],"start":[282,21]}},"type":"Var","value":{"identifier":"repeatStr","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[282,35],"start":[282,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[282,35],"start":[282,31]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1500}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[282,39],"start":[282,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[282,39],"start":[282,36]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"a"}},"type":"App"},"identifier":"longKey"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[283,61],"start":[283,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[283,61],"start":[283,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[283,61],"start":[283,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[283,23],"start":[283,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[283,61],"start":[283,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[283,61],"start":[283,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[283,34],"start":[283,27]}},"type":"Var","value":{"identifier":"longKey","sourcePos":[282,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[283,61],"start":[283,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[283,61],"start":[283,38]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"\": 1, \"normal\": 2}"}},"type":"App"},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[284,56],"start":[284,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[284,56],"start":[284,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[284,36],"start":[284,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[284,41],"start":[284,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[284,41],"start":[284,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[283,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[284,56],"start":[284,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[284,56],"start":[284,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[285,38],"start":[285,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[285,38],"start":[285,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[285,19],"start":[285,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[285,13],"start":[285,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[284,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[285,38],"start":[285,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[285,38],"start":[285,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[285,38],"start":[285,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[285,38],"start":[285,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[287,97],"start":[287,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[287,97],"start":[287,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[287,97],"start":[287,29]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[287,46],"start":[287,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Key truncated: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[287,97],"start":[287,29]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[287,97],"start":[287,29]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[287,59],"start":[287,50]}},"type":"Var","value":{"identifier":"repeatStr","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[287,62],"start":[287,50]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[287,62],"start":[287,60]}},"type":"Literal","value":{"literalType":"IntLiteral","value":50}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[287,66],"start":[287,50]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[287,66],"start":[287,63]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"a"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[287,97],"start":[287,29]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[287,97],"start":[287,70]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"... (exceeded 1000 chars)"}},"type":"App"},"type":"App"},"identifier":"expectedWarning"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[288,66],"start":[288,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[288,66],"start":[288,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[288,27],"start":[288,24]}},"type":"Var","value":{"identifier":"any","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[288,50],"start":[288,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[288,50],"start":[288,28]}},"argument":"v","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[288,50],"start":[288,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[288,50],"start":[288,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[288,49],"start":[288,34]}},"type":"Var","value":{"identifier":"expectedWarning","sourcePos":[287,11]}},"type":"App"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[288,66],"start":[288,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[288,66],"start":[288,51]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[288,57],"start":[288,51]}},"type":"Var","value":{"identifier":"result","sourcePos":[284,11]}},"fieldName":"warnings","type":"Accessor"},"type":"App"},"identifier":"hasWarning"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[289,36],"start":[289,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[289,36],"start":[289,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[289,17],"start":[289,7]}},"type":"Var","value":{"identifier":"hasWarning","sourcePos":[288,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[289,36],"start":[289,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[289,36],"start":[289,32]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[289,36],"start":[289,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[289,36],"start":[289,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[301,50],"start":[291,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[292,15],"start":[292,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[292,15],"start":[292,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[300,60],"start":[292,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[266,33],"start":[266,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[292,37],"start":[292,24]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[292,39],"start":[292,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[292,39],"start":[292,38]}},"type":"Var","value":{"identifier":"d","sourcePos":[292,14]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[300,60],"start":[292,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[293,19],"start":[293,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[293,19],"start":[293,16]}},"binderType":"VarBinder","identifier":"obj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[296,68],"start":[294,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[296,68],"start":[294,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[266,33],"start":[266,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[294,28],"start":[294,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[294,37],"start":[294,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[294,37],"start":[294,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"normal"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[294,41],"start":[294,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[294,41],"start":[294,38]}},"type":"Var","value":{"identifier":"obj","sourcePos":[293,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[296,68],"start":[294,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[295,21],"start":[295,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[295,21],"start":[295,20]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[295,34],"start":[295,25]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[295,34],"start":[295,30]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[296,22],"start":[296,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[296,68],"start":[296,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[296,68],"start":[296,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'normal' key to be present"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[266,33],"start":[266,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[296,68],"start":[294,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[296,68],"start":[294,13]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[299,63],"start":[297,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[266,33],"start":[266,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[297,28],"start":[297,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[297,36],"start":[297,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[297,36],"start":[297,29]}},"type":"Var","value":{"identifier":"longKey","sourcePos":[282,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[297,40],"start":[297,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[297,40],"start":[297,37]}},"type":"Var","value":{"identifier":"obj","sourcePos":[293,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[299,63],"start":[297,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[298,22],"start":[298,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[298,35],"start":[298,26]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[298,35],"start":[298,31]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[299,21],"start":[299,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[299,21],"start":[299,20]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[299,63],"start":[299,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[299,63],"start":[299,30]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected long key to be removed"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[266,33],"start":[266,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[300,18],"start":[300,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[300,60],"start":[300,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[300,60],"start":[300,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[266,33],"start":[266,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[301,16],"start":[301,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[301,50],"start":[301,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[301,50],"start":[301,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[291,22],"start":[291,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[291,18],"start":[291,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[284,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"objectKeyLimitTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[382,30],"start":[382,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[384,45],"start":[384,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[384,45],"start":[384,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"parseAndSanitize - Invalid JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[395,39],"start":[384,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[391,60],"start":[386,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[386,53],"start":[386,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[386,53],"start":[386,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should return error for invalid JSON syntax"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[391,60],"start":[386,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[387,70],"start":[387,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[387,70],"start":[387,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[387,36],"start":[387,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[387,55],"start":[387,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[387,55],"start":[387,37]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{not valid json}"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[387,70],"start":[387,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[387,70],"start":[387,56]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[388,39],"start":[388,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[388,39],"start":[388,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[388,19],"start":[388,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[388,13],"start":[388,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[387,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[388,39],"start":[388,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[388,39],"start":[388,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[388,39],"start":[388,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[388,39],"start":[388,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[391,60],"start":[389,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[390,20],"start":[390,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[390,20],"start":[390,14]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[390,74],"start":[390,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[390,30],"start":[390,24]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[390,14]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[390,74],"start":[390,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[390,74],"start":[390,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Invalid JSON"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[391,16],"start":[391,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[391,60],"start":[391,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[391,60],"start":[391,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about invalid JSON"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[389,22],"start":[389,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[389,18],"start":[389,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[387,11]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[391,60],"start":[386,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[391,60],"start":[386,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[393,52],"start":[393,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[393,52],"start":[393,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should return error for empty string input"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[395,39],"start":[393,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[394,54],"start":[394,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[394,54],"start":[394,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[394,36],"start":[394,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[394,39],"start":[394,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[394,39],"start":[394,37]}},"type":"Literal","value":{"literalType":"StringLiteral","value":""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[394,54],"start":[394,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[394,54],"start":[394,40]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[395,39],"start":[395,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[395,19],"start":[395,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[395,13],"start":[395,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[394,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[395,39],"start":[395,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[395,39],"start":[395,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"invalidJsonTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[500,29],"start":[500,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[502,39],"start":[502,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[502,39],"start":[502,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"deepFreeze - Immutability"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[516,91],"start":[502,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[511,65],"start":[504,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[504,77],"start":[504,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[504,77],"start":[504,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should be identity for objects (PureScript is immutable by default)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[511,65],"start":[504,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[508,15],"start":[505,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[508,15],"start":[505,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[505,32],"start":[505,17]}},"type":"Var","value":{"identifier":"fromObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[508,15],"start":[505,17]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fromFoldable","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[508,14],"start":[505,34]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[508,14],"start":[506,13]}},"type":"Literal","value":{"literalType":"ArrayLiteral","value":[{"abstraction":{"abstraction":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":["value0","value1"],"metaType":"IsConstructor"},"sourceSpan":{"end":[506,20],"start":[506,15]}},"type":"Var","value":{"identifier":"Tuple","moduleName":["Data","Tuple"]}},"annotation":{"meta":null,"sourceSpan":{"end":[506,24],"start":[506,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[506,24],"start":[506,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"a"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[506,46],"start":[506,15]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[506,41],"start":[506,26]}},"type":"Var","value":{"identifier":"fromNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[506,45],"start":[506,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[506,45],"start":[506,42]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":1}},"type":"App"},"type":"App"},{"abstraction":{"abstraction":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":["value0","value1"],"metaType":"IsConstructor"},"sourceSpan":{"end":[507,20],"start":[507,15]}},"type":"Var","value":{"identifier":"Tuple","moduleName":["Data","Tuple"]}},"annotation":{"meta":null,"sourceSpan":{"end":[507,29],"start":[507,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[507,29],"start":[507,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"nested"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[507,89],"start":[507,15]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[507,46],"start":[507,31]}},"type":"Var","value":{"identifier":"fromObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[507,88],"start":[507,31]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[507,61],"start":[507,48]}},"type":"Var","value":{"identifier":"singleton","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[507,65],"start":[507,48]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[507,65],"start":[507,62]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"b"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[507,87],"start":[507,48]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[507,82],"start":[507,67]}},"type":"Var","value":{"identifier":"fromNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[507,86],"start":[507,67]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[507,86],"start":[507,83]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":2}},"type":"App"},"type":"App"},"type":"App"},"type":"App"}]}},"type":"App"},"type":"App"},"identifier":"obj"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[509,34],"start":[509,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[509,34],"start":[509,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[509,30],"start":[509,20]}},"type":"Var","value":{"identifier":"deepFreeze","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[509,34],"start":[509,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[509,34],"start":[509,31]}},"type":"Var","value":{"identifier":"obj","sourcePos":[505,11]}},"type":"App"},"identifier":"frozen"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual6","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[511,65],"start":[511,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[511,22],"start":[511,8]}},"type":"Var","value":{"identifier":"stringify","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[511,29],"start":[511,8]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[511,29],"start":[511,23]}},"type":"Var","value":{"identifier":"frozen","sourcePos":[509,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[511,65],"start":[511,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[511,60],"start":[511,46]}},"type":"Var","value":{"identifier":"stringify","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[511,64],"start":[511,46]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[511,64],"start":[511,61]}},"type":"Var","value":{"identifier":"obj","sourcePos":[505,11]}},"type":"App"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[511,65],"start":[504,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[511,65],"start":[504,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[513,34],"start":[513,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[513,34],"start":[513,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should handle primitives"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[516,91],"start":[513,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[514,109],"start":[514,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual6","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[514,109],"start":[514,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[514,21],"start":[514,7]}},"type":"Var","value":{"identifier":"stringify","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[514,57],"start":[514,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[514,33],"start":[514,23]}},"type":"Var","value":{"identifier":"deepFreeze","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[514,56],"start":[514,23]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[514,50],"start":[514,35]}},"type":"Var","value":{"identifier":"fromNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[514,55],"start":[514,35]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[514,55],"start":[514,51]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":42}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[514,109],"start":[514,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[514,86],"start":[514,72]}},"type":"Var","value":{"identifier":"stringify","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[514,109],"start":[514,72]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[514,103],"start":[514,88]}},"type":"Var","value":{"identifier":"fromNumber","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[514,108],"start":[514,88]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[514,108],"start":[514,104]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":42}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[514,109],"start":[514,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[514,109],"start":[514,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[515,117],"start":[515,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual6","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[515,117],"start":[515,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[515,21],"start":[515,7]}},"type":"Var","value":{"identifier":"stringify","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[515,61],"start":[515,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[515,33],"start":[515,23]}},"type":"Var","value":{"identifier":"deepFreeze","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[515,60],"start":[515,23]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[515,50],"start":[515,35]}},"type":"Var","value":{"identifier":"fromString","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[515,59],"start":[515,35]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[515,59],"start":[515,51]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"string"}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[515,117],"start":[515,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[515,90],"start":[515,76]}},"type":"Var","value":{"identifier":"stringify","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[515,117],"start":[515,76]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[515,107],"start":[515,92]}},"type":"Var","value":{"identifier":"fromString","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[515,116],"start":[515,92]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[515,116],"start":[515,108]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"string"}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[515,117],"start":[515,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[515,117],"start":[515,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual6","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[516,91],"start":[516,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[516,21],"start":[516,7]}},"type":"Var","value":{"identifier":"stringify","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[516,48],"start":[516,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[516,33],"start":[516,23]}},"type":"Var","value":{"identifier":"deepFreeze","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[516,47],"start":[516,23]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[516,47],"start":[516,34]}},"type":"Var","value":{"identifier":"jsonNull","moduleName":["Data","Argonaut","Core"]}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[516,91],"start":[516,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[516,77],"start":[516,63]}},"type":"Var","value":{"identifier":"stringify","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[516,91],"start":[516,63]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[516,91],"start":[516,78]}},"type":"Var","value":{"identifier":"jsonNull","moduleName":["Data","Argonaut","Core"]}},"type":"App"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"deepFreezeTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[53,33],"start":[53,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[53,33],"start":[53,1]}},"argument":"depth","body":{"annotation":{"meta":null,"sourceSpan":{"end":[57,42],"start":[55,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[56,70],"start":[56,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldl","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[56,44],"start":[56,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,43],"start":[56,23]}},"argument":"acc","body":{"annotation":{"meta":null,"sourceSpan":{"end":[56,43],"start":[56,23]}},"argument":"v","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[56,43],"start":[56,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,36],"start":[56,33]}},"type":"Var","value":{"identifier":"acc","sourcePos":[56,24]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[56,43],"start":[56,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,43],"start":[56,40]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"}"}},"type":"App"},"type":"Abs"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[56,47],"start":[56,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,47],"start":[56,45]}},"type":"Literal","value":{"literalType":"StringLiteral","value":""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[56,70],"start":[56,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[56,58],"start":[56,49]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[56,64],"start":[56,49]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,64],"start":[56,59]}},"type":"Var","value":{"identifier":"depth","sourcePos":[54,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[56,69],"start":[56,49]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[56,69],"start":[56,65]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"type":"App"},"identifier":"suffix"},{"annotation":{"meta":null,"sourceSpan":{"end":[55,82],"start":[55,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldl","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[55,56],"start":[55,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[55,55],"start":[55,23]}},"argument":"acc","body":{"annotation":{"meta":null,"sourceSpan":{"end":[55,55],"start":[55,23]}},"argument":"v","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[55,55],"start":[55,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[55,36],"start":[55,33]}},"type":"Var","value":{"identifier":"acc","sourcePos":[55,24]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[55,55],"start":[55,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[55,55],"start":[55,40]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"nested\": "}},"type":"App"},"type":"Abs"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[55,59],"start":[55,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[55,59],"start":[55,57]}},"type":"Literal","value":{"literalType":"StringLiteral","value":""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[55,82],"start":[55,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[55,70],"start":[55,61]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[55,76],"start":[55,61]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[55,76],"start":[55,71]}},"type":"Var","value":{"identifier":"depth","sourcePos":[54,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[55,81],"start":[55,61]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[55,81],"start":[55,77]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"type":"App"},"identifier":"prefix"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[57,42],"start":[57,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[57,12],"start":[57,6]}},"type":"Var","value":{"identifier":"prefix","sourcePos":[55,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[57,42],"start":[57,6]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[57,42],"start":[57,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[57,32],"start":[57,16]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"value\": 1}"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[57,42],"start":[57,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[57,42],"start":[57,36]}},"type":"Var","value":{"identifier":"suffix","sourcePos":[56,7]}},"type":"App"},"type":"App"},"type":"Let"},"type":"Abs"},"identifier":"buildNestedJson"},{"annotation":{"meta":null,"sourceSpan":{"end":[107,29],"start":[107,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[109,45],"start":[109,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[109,45],"start":[109,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"parseAndSanitize - Depth Limits"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[135,41],"start":[109,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[118,53],"start":[111,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[111,61],"start":[111,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[111,61],"start":[111,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK JSON exceeding max depth (default: 50)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[118,53],"start":[111,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[113,36],"start":[113,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[113,36],"start":[113,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[113,33],"start":[113,18]}},"type":"Var","value":{"identifier":"buildNestedJson","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[113,36],"start":[113,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[113,36],"start":[113,34]}},"type":"Literal","value":{"literalType":"IntLiteral","value":60}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[114,56],"start":[114,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[114,56],"start":[114,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[114,36],"start":[114,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[114,41],"start":[114,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[114,41],"start":[114,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[113,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[114,56],"start":[114,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[114,56],"start":[114,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[115,39],"start":[115,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[115,39],"start":[115,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[115,19],"start":[115,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[115,13],"start":[115,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[114,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[115,39],"start":[115,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[115,39],"start":[115,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[115,39],"start":[115,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[115,39],"start":[115,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[118,53],"start":[116,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[117,20],"start":[117,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[117,20],"start":[117,14]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[117,67],"start":[117,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,30],"start":[117,24]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[117,14]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[117,67],"start":[117,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,67],"start":[117,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"depth"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[118,16],"start":[118,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[118,53],"start":[118,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,53],"start":[118,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about depth"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[116,22],"start":[116,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[116,18],"start":[116,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[114,11]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[118,53],"start":[111,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,53],"start":[111,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[128,76],"start":[120,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[120,46],"start":[120,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[120,46],"start":[120,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW JSON within depth limit"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[128,76],"start":[120,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[122,36],"start":[122,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[122,36],"start":[122,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[122,33],"start":[122,18]}},"type":"Var","value":{"identifier":"buildNestedJson","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[122,36],"start":[122,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[122,36],"start":[122,34]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[123,56],"start":[123,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[123,56],"start":[123,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[123,36],"start":[123,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[123,41],"start":[123,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[123,41],"start":[123,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[122,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[123,56],"start":[123,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[123,56],"start":[123,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[124,38],"start":[124,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[124,38],"start":[124,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[124,19],"start":[124,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[124,13],"start":[124,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[123,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[124,38],"start":[124,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[124,38],"start":[124,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[124,38],"start":[124,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[124,38],"start":[124,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[128,76],"start":[126,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[128,76],"start":[126,7]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[127,23],"start":[127,14]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[127,23],"start":[127,19]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[128,76],"start":[126,7]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[128,76],"start":[128,14]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[128,75],"start":[128,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[128,48],"start":[128,20]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected depth <= 15, got "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[128,75],"start":[128,20]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"show","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[128,75],"start":[128,52]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[128,75],"start":[128,57]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[128,75],"start":[128,57]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[128,63],"start":[128,57]}},"type":"Var","value":{"identifier":"result","sourcePos":[123,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"depth","type":"Accessor"},"type":"App"},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lessThanOrEq","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[126,34],"start":[126,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[126,28],"start":[126,10]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[126,28],"start":[126,10]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[126,16],"start":[126,10]}},"type":"Var","value":{"identifier":"result","sourcePos":[123,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"depth","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[126,34],"start":[126,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[126,34],"start":[126,32]}},"type":"Literal","value":{"literalType":"IntLiteral","value":15}},"type":"App"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[128,76],"start":[120,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[128,76],"start":[120,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[130,44],"start":[130,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[130,44],"start":[130,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should track actual depth in stats"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[135,41],"start":[130,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[132,57],"start":[132,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[132,57],"start":[132,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[132,57],"start":[132,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"a\": {\"b\": {\"c\": {\"d\": 1}}}}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[133,56],"start":[133,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[133,56],"start":[133,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[133,36],"start":[133,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[133,41],"start":[133,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[133,41],"start":[133,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[132,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[133,56],"start":[133,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[133,56],"start":[133,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[134,38],"start":[134,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[134,38],"start":[134,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[134,19],"start":[134,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[134,13],"start":[134,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[133,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[134,38],"start":[134,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[134,38],"start":[134,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[134,38],"start":[134,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[134,38],"start":[134,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual5","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[135,41],"start":[135,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[135,25],"start":[135,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[135,25],"start":[135,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[135,13],"start":[135,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[133,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"depth","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[135,41],"start":[135,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[135,41],"start":[135,40]}},"type":"Literal","value":{"literalType":"IntLiteral","value":4}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"depthLimitTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[66,37],"start":[66,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[66,37],"start":[66,1]}},"argument":"n","body":{"annotation":{"meta":null,"sourceSpan":{"end":[69,37],"start":[68,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[68,42],"start":[68,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[68,21],"start":[68,13]}},"type":"Var","value":{"identifier":"joinWith","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[68,24],"start":[68,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[68,24],"start":[68,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[68,42],"start":[68,13]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[68,35],"start":[68,26]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[68,37],"start":[68,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[68,37],"start":[68,36]}},"type":"Var","value":{"identifier":"n","sourcePos":[67,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[68,41],"start":[68,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[68,41],"start":[68,38]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"a"}},"type":"App"},"type":"App"},"identifier":"str"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[69,37],"start":[69,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[69,21],"start":[69,6]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"data\": \""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[69,37],"start":[69,6]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[69,37],"start":[69,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[69,28],"start":[69,25]}},"type":"Var","value":{"identifier":"str","sourcePos":[68,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[69,37],"start":[69,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[69,37],"start":[69,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"\"}"}},"type":"App"},"type":"App"},"type":"Let"},"type":"Abs"},"identifier":"buildLongStringJson"},{"annotation":{"meta":null,"sourceSpan":{"end":[175,34],"start":[175,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[177,51],"start":[177,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[177,51],"start":[177,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"parseAndSanitize - String Size Limits"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[194,38],"start":[177,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[189,62],"start":[179,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[179,51],"start":[179,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[179,51],"start":[179,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK strings exceeding max length"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[189,62],"start":[179,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,58],"start":[183,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[183,58],"start":[183,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[183,58],"start":[183,18]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[194,38],"start":[176,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[183,32],"start":[183,18]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[183,58],"start":[183,18]}},"copy":["maxArrayLength","maxDepth","maxKeyLength","maxTotalKeys","removeNullBytes","removePrototypeKeys"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[176,1]}},"type":"ObjectUpdate","updates":[["maxStringLength",{"annotation":{"meta":null,"sourceSpan":{"end":[183,56],"start":[183,53]}},"type":"Literal","value":{"literalType":"IntLiteral","value":200}}]]},"type":"Let"},"identifier":"opts"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[184,41],"start":[184,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[184,41],"start":[184,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[184,37],"start":[184,18]}},"type":"Var","value":{"identifier":"buildLongStringJson","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[184,41],"start":[184,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,41],"start":[184,38]}},"type":"Literal","value":{"literalType":"IntLiteral","value":300}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[185,46],"start":[185,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[185,46],"start":[185,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[185,36],"start":[185,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,41],"start":[185,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,41],"start":[185,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[184,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,46],"start":[185,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,46],"start":[185,42]}},"type":"Var","value":{"identifier":"opts","sourcePos":[183,11]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[186,39],"start":[186,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[186,39],"start":[186,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,19],"start":[186,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[186,13],"start":[186,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[185,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[186,39],"start":[186,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,39],"start":[186,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[186,39],"start":[186,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,39],"start":[186,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[189,62],"start":[187,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[188,20],"start":[188,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[188,20],"start":[188,14]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[188,76],"start":[188,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[188,30],"start":[188,24]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[188,14]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[188,76],"start":[188,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[188,76],"start":[188,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"String exceeds"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[189,16],"start":[189,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[189,62],"start":[189,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[189,62],"start":[189,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about string exceeds"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[187,22],"start":[187,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[187,18],"start":[187,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[185,11]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[189,62],"start":[179,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[189,62],"start":[179,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[191,43],"start":[191,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[191,43],"start":[191,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW strings within limit"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[194,38],"start":[191,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[192,42],"start":[192,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[192,42],"start":[192,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[192,37],"start":[192,18]}},"type":"Var","value":{"identifier":"buildLongStringJson","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[192,42],"start":[192,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[192,42],"start":[192,38]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1000}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[193,56],"start":[193,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[193,56],"start":[193,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[193,36],"start":[193,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[193,41],"start":[193,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[193,41],"start":[193,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[192,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[193,56],"start":[193,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[193,56],"start":[193,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[194,38],"start":[194,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[194,19],"start":[194,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[194,13],"start":[194,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[193,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[194,38],"start":[194,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[194,38],"start":[194,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"stringSizeLimitTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[60,37],"start":[60,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[60,37],"start":[60,1]}},"argument":"n","body":{"annotation":{"meta":null,"sourceSpan":{"end":[63,40],"start":[62,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[62,49],"start":[62,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[62,26],"start":[62,18]}},"type":"Var","value":{"identifier":"joinWith","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[62,31],"start":[62,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[62,31],"start":[62,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":", "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[62,49],"start":[62,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[62,42],"start":[62,33]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[62,44],"start":[62,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[62,44],"start":[62,43]}},"type":"Var","value":{"identifier":"n","sourcePos":[61,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[62,48],"start":[62,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[62,48],"start":[62,45]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"1"}},"type":"App"},"type":"App"},"identifier":"elements"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[63,40],"start":[63,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[63,20],"start":[63,6]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"data\": ["}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[63,40],"start":[63,6]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[63,40],"start":[63,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[63,32],"start":[63,24]}},"type":"Var","value":{"identifier":"elements","sourcePos":[62,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[63,40],"start":[63,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[63,40],"start":[63,36]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"]}"}},"type":"App"},"type":"App"},"type":"Let"},"type":"Abs"},"identifier":"buildLargeArrayJson"},{"annotation":{"meta":null,"sourceSpan":{"end":[522,32],"start":[522,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[524,28],"start":[524,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[524,28],"start":[524,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Custom Options"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[524,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[533,53],"start":[526,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[526,40],"start":[526,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[526,40],"start":[526,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should respect custom maxDepth"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[533,53],"start":[526,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[528,48],"start":[528,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[528,48],"start":[528,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[528,48],"start":[528,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"a\": {\"b\": {\"c\": 1}}}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[529,75],"start":[529,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[529,75],"start":[529,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[529,36],"start":[529,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[529,41],"start":[529,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[529,41],"start":[529,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[528,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[529,75],"start":[529,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[529,74],"start":[529,43]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[523,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[529,57],"start":[529,43]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[529,74],"start":[529,43]}},"copy":["maxArrayLength","maxStringLength","maxTotalKeys","maxKeyLength","removePrototypeKeys","removeNullBytes"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[523,1]}},"type":"ObjectUpdate","updates":[["maxDepth",{"annotation":{"meta":null,"sourceSpan":{"end":[529,72],"start":[529,71]}},"type":"Literal","value":{"literalType":"IntLiteral","value":2}}]]},"type":"Let"},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[530,39],"start":[530,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[530,39],"start":[530,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[530,19],"start":[530,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[530,13],"start":[530,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[529,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[530,39],"start":[530,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[530,39],"start":[530,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[530,39],"start":[530,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[530,39],"start":[530,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[533,53],"start":[531,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[532,20],"start":[532,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[532,20],"start":[532,14]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[532,67],"start":[532,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[532,30],"start":[532,24]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[532,14]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[532,67],"start":[532,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[532,67],"start":[532,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"depth"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[533,16],"start":[533,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[533,53],"start":[533,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[533,53],"start":[533,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about depth"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[531,22],"start":[531,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[531,18],"start":[531,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[529,11]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[533,53],"start":[526,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[533,53],"start":[526,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[541,61],"start":[535,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[535,46],"start":[535,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[535,46],"start":[535,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should respect custom maxArrayLength"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[541,61],"start":[535,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[536,41],"start":[536,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[536,41],"start":[536,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[536,37],"start":[536,18]}},"type":"Var","value":{"identifier":"buildLargeArrayJson","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[536,41],"start":[536,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[536,41],"start":[536,38]}},"type":"Literal","value":{"literalType":"IntLiteral","value":100}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[537,82],"start":[537,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[537,82],"start":[537,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[537,36],"start":[537,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[537,41],"start":[537,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[537,41],"start":[537,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[536,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[537,82],"start":[537,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[537,81],"start":[537,43]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[523,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[537,57],"start":[537,43]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[537,81],"start":[537,43]}},"copy":["maxDepth","maxStringLength","maxTotalKeys","maxKeyLength","removePrototypeKeys","removeNullBytes"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[523,1]}},"type":"ObjectUpdate","updates":[["maxArrayLength",{"annotation":{"meta":null,"sourceSpan":{"end":[537,79],"start":[537,77]}},"type":"Literal","value":{"literalType":"IntLiteral","value":50}}]]},"type":"Let"},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[538,39],"start":[538,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[538,39],"start":[538,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[538,19],"start":[538,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[538,13],"start":[538,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[537,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[538,39],"start":[538,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[538,39],"start":[538,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[538,39],"start":[538,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[538,39],"start":[538,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[541,61],"start":[539,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[540,20],"start":[540,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[540,20],"start":[540,14]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[540,75],"start":[540,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[540,30],"start":[540,24]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[540,14]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[540,75],"start":[540,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[540,75],"start":[540,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Array exceeds"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[541,16],"start":[541,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[541,61],"start":[541,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[541,61],"start":[541,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about array exceeds"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[539,22],"start":[539,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[539,18],"start":[539,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[537,11]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[541,61],"start":[535,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[541,61],"start":[535,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[547,56],"start":[543,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[543,51],"start":[543,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[543,51],"start":[543,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should allow prototype keys when disabled"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[547,56],"start":[543,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[544,47],"start":[544,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[544,47],"start":[544,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[544,47],"start":[544,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"__proto__\": {\"x\": 1}}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[545,90],"start":[545,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[545,90],"start":[545,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[545,36],"start":[545,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[545,41],"start":[545,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[545,41],"start":[545,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[544,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[545,90],"start":[545,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[545,89],"start":[545,43]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[523,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[545,57],"start":[545,43]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[545,89],"start":[545,43]}},"copy":["maxDepth","maxArrayLength","maxStringLength","maxTotalKeys","maxKeyLength","removeNullBytes"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[523,1]}},"type":"ObjectUpdate","updates":[["removePrototypeKeys",{"annotation":{"meta":null,"sourceSpan":{"end":[545,87],"start":[545,82]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}}]]},"type":"Let"},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[546,38],"start":[546,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[546,38],"start":[546,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[546,19],"start":[546,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[546,13],"start":[546,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[545,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[546,38],"start":[546,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[546,38],"start":[546,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[546,38],"start":[546,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[546,38],"start":[546,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual5","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[547,56],"start":[547,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[547,40],"start":[547,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[547,40],"start":[547,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[547,13],"start":[547,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[545,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[547,56],"start":[547,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[547,56],"start":[547,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[547,56],"start":[543,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[547,56],"start":[543,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[549,47],"start":[549,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[549,47],"start":[549,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should allow null bytes when disabled"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[549,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[550,54],"start":[550,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[550,54],"start":[550,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[550,54],"start":[550,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"value\": \"hello\\u0000world\"}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[551,86],"start":[551,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[551,86],"start":[551,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[551,36],"start":[551,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[551,41],"start":[551,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[551,41],"start":[551,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[550,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[551,86],"start":[551,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[551,85],"start":[551,43]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[523,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[551,57],"start":[551,43]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[551,85],"start":[551,43]}},"copy":["maxDepth","maxArrayLength","maxStringLength","maxTotalKeys","maxKeyLength","removePrototypeKeys"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[523,1]}},"type":"ObjectUpdate","updates":[["removeNullBytes",{"annotation":{"meta":null,"sourceSpan":{"end":[551,83],"start":[551,78]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}}]]},"type":"Let"},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[552,38],"start":[552,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[552,38],"start":[552,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[552,19],"start":[552,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[552,13],"start":[552,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[551,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[552,38],"start":[552,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[552,38],"start":[552,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[552,38],"start":[552,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[552,38],"start":[552,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[553,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[554,15],"start":[554,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[554,15],"start":[554,14]}},"binderType":"VarBinder","identifier":"d"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[559,60],"start":[554,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[522,32],"start":[522,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[554,37],"start":[554,24]}},"type":"Var","value":{"identifier":"toObject","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[554,39],"start":[554,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[554,39],"start":[554,38]}},"type":"Var","value":{"identifier":"d","sourcePos":[554,14]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[559,60],"start":[554,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[555,19],"start":[555,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[555,19],"start":[555,16]}},"binderType":"VarBinder","identifier":"obj"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[558,53],"start":[556,13]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[522,32],"start":[522,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[556,28],"start":[556,18]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Foreign","Object"]}},"annotation":{"meta":null,"sourceSpan":{"end":[556,36],"start":[556,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[556,36],"start":[556,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"value"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[556,40],"start":[556,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[556,40],"start":[556,37]}},"type":"Var","value":{"identifier":"obj","sourcePos":[555,16]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[558,53],"start":[556,13]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[557,21],"start":[557,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[557,21],"start":[557,20]}},"binderType":"VarBinder","identifier":"v2"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual4","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[557,78],"start":[557,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[557,38],"start":[557,25]}},"type":"Var","value":{"identifier":"toString","moduleName":["Data","Argonaut","Core"]}},"annotation":{"meta":null,"sourceSpan":{"end":[557,40],"start":[557,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[557,40],"start":[557,39]}},"type":"Var","value":{"identifier":"v2","sourcePos":[557,20]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[557,78],"start":[557,25]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[557,59],"start":[557,55]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[557,78],"start":[557,55]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[557,78],"start":[557,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"hello\u0000world"}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[558,22],"start":[558,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[558,53],"start":[558,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[558,53],"start":[558,31]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 'value' key"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[522,32],"start":[522,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[559,18],"start":[559,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[559,60],"start":[559,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[559,60],"start":[559,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result to be an object"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[522,32],"start":[522,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[560,16],"start":[560,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[560,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[560,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected data in result"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[553,22],"start":[553,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[553,18],"start":[553,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[551,11]}},"fieldName":"dat","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"customOptionsTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[76,104],"start":[76,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[76,104],"start":[76,1]}},"argument":"result","body":{"annotation":{"meta":null,"sourceSpan":{"end":[76,104],"start":[76,1]}},"argument":"expectedSubstr","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[78,35],"start":[78,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[78,35],"start":[78,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[78,15],"start":[78,3]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[78,9],"start":[78,3]}},"type":"Var","value":{"identifier":"result","sourcePos":[77,1]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[78,35],"start":[78,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[78,35],"start":[78,30]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[78,35],"start":[78,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[78,35],"start":[78,3]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[81,94],"start":[79,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[80,16],"start":[80,5]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[80,16],"start":[80,10]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[80,70],"start":[80,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[80,26],"start":[80,20]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[80,10]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[80,70],"start":[80,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[80,70],"start":[80,56]}},"type":"Var","value":{"identifier":"expectedSubstr","sourcePos":[77,1]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[81,12],"start":[81,5]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[81,94],"start":[81,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[81,93],"start":[81,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,51],"start":[81,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error containing '"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[81,93],"start":[81,22]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[81,93],"start":[81,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,69],"start":[81,55]}},"type":"Var","value":{"identifier":"expectedSubstr","sourcePos":[77,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[81,93],"start":[81,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,93],"start":[81,73]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"' but got no error"}},"type":"App"},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[79,18],"start":[79,8]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[79,14],"start":[79,8]}},"type":"Var","value":{"identifier":"result","sourcePos":[77,1]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"Abs"},"identifier":"assertInvalidWithError"},{"annotation":{"meta":null,"sourceSpan":{"end":[141,33],"start":[141,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[143,50],"start":[143,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[143,50],"start":[143,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"parseAndSanitize - Array Size Limits"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[169,39],"start":[143,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[153,61],"start":[145,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[145,50],"start":[145,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,50],"start":[145,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK arrays exceeding max length"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[153,61],"start":[145,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[147,57],"start":[147,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[147,57],"start":[147,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[147,57],"start":[147,18]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[169,39],"start":[142,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[147,32],"start":[147,18]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[147,57],"start":[147,18]}},"copy":["maxDepth","maxKeyLength","maxStringLength","maxTotalKeys","removeNullBytes","removePrototypeKeys"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[142,1]}},"type":"ObjectUpdate","updates":[["maxArrayLength",{"annotation":{"meta":null,"sourceSpan":{"end":[147,55],"start":[147,52]}},"type":"Literal","value":{"literalType":"IntLiteral","value":100}}]]},"type":"Let"},"identifier":"opts"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[148,41],"start":[148,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[148,41],"start":[148,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[148,37],"start":[148,18]}},"type":"Var","value":{"identifier":"buildLargeArrayJson","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[148,41],"start":[148,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[148,41],"start":[148,38]}},"type":"Literal","value":{"literalType":"IntLiteral","value":150}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[149,46],"start":[149,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[149,46],"start":[149,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[149,36],"start":[149,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[149,41],"start":[149,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[149,41],"start":[149,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[148,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[149,46],"start":[149,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[149,46],"start":[149,42]}},"type":"Var","value":{"identifier":"opts","sourcePos":[147,11]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[150,39],"start":[150,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[150,39],"start":[150,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[150,19],"start":[150,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[150,13],"start":[150,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[149,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[150,39],"start":[150,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[150,39],"start":[150,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[150,39],"start":[150,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[150,39],"start":[150,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[153,61],"start":[151,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[152,20],"start":[152,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[152,20],"start":[152,14]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[152,75],"start":[152,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[152,30],"start":[152,24]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[152,14]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[152,75],"start":[152,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[152,75],"start":[152,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Array exceeds"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[153,16],"start":[153,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[153,61],"start":[153,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,61],"start":[153,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about array exceeds"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[151,22],"start":[151,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[151,18],"start":[151,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[149,11]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[153,61],"start":[145,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,61],"start":[145,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[158,38],"start":[155,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[155,42],"start":[155,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[155,42],"start":[155,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW arrays within limit"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[158,38],"start":[155,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[156,41],"start":[156,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[156,41],"start":[156,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[156,37],"start":[156,18]}},"type":"Var","value":{"identifier":"buildLargeArrayJson","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[156,41],"start":[156,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[156,41],"start":[156,38]}},"type":"Literal","value":{"literalType":"IntLiteral","value":100}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[157,56],"start":[157,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[157,56],"start":[157,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[157,36],"start":[157,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[157,41],"start":[157,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[157,41],"start":[157,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[156,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[157,56],"start":[157,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[157,56],"start":[157,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[158,38],"start":[158,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[158,19],"start":[158,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[158,13],"start":[158,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[157,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[158,38],"start":[158,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[158,38],"start":[158,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[158,38],"start":[155,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[158,38],"start":[155,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[160,67],"start":[160,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[160,67],"start":[160,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK cumulative array elements across many arrays"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[169,39],"start":[160,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[163,56],"start":[163,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[163,56],"start":[163,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[163,56],"start":[163,18]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[169,39],"start":[142,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[163,32],"start":[163,18]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[163,56],"start":[163,18]}},"copy":["maxDepth","maxKeyLength","maxStringLength","maxTotalKeys","removeNullBytes","removePrototypeKeys"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[142,1]}},"type":"ObjectUpdate","updates":[["maxArrayLength",{"annotation":{"meta":null,"sourceSpan":{"end":[163,54],"start":[163,52]}},"type":"Literal","value":{"literalType":"IntLiteral","value":50}}]]},"type":"Let"},"identifier":"opts"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[164,56],"start":[164,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[164,56],"start":[164,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[164,32],"start":[164,24]}},"type":"Var","value":{"identifier":"joinWith","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[164,37],"start":[164,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,37],"start":[164,33]}},"type":"Literal","value":{"literalType":"StringLiteral","value":", "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[164,56],"start":[164,24]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[164,48],"start":[164,39]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[164,51],"start":[164,39]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,51],"start":[164,49]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[164,55],"start":[164,39]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,55],"start":[164,52]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"1"}},"type":"App"},"type":"App"},"identifier":"innerArray"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[165,59],"start":[165,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[165,59],"start":[165,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[165,29],"start":[165,20]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[165,32],"start":[165,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[165,32],"start":[165,30]}},"type":"Literal","value":{"literalType":"IntLiteral","value":60}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[165,59],"start":[165,20]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[165,58],"start":[165,34]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[165,37],"start":[165,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"["}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[165,58],"start":[165,34]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[165,58],"start":[165,34]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[165,51],"start":[165,41]}},"type":"Var","value":{"identifier":"innerArray","sourcePos":[164,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[165,58],"start":[165,34]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[165,58],"start":[165,55]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"]"}},"type":"App"},"type":"App"},"type":"App"},"identifier":"arrays"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[166,64],"start":[166,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[166,64],"start":[166,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[166,64],"start":[166,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,32],"start":[166,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"data\": ["}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[166,64],"start":[166,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[166,64],"start":[166,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[166,44],"start":[166,36]}},"type":"Var","value":{"identifier":"joinWith","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[166,49],"start":[166,36]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,49],"start":[166,45]}},"type":"Literal","value":{"literalType":"StringLiteral","value":", "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[166,56],"start":[166,36]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,56],"start":[166,50]}},"type":"Var","value":{"identifier":"arrays","sourcePos":[165,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[166,64],"start":[166,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,64],"start":[166,60]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"]}"}},"type":"App"},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[167,46],"start":[167,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[167,46],"start":[167,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[167,36],"start":[167,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[167,41],"start":[167,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[167,41],"start":[167,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[166,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[167,46],"start":[167,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[167,46],"start":[167,42]}},"type":"Var","value":{"identifier":"opts","sourcePos":[163,11]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[169,39],"start":[169,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[169,19],"start":[169,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[169,13],"start":[169,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[167,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[169,39],"start":[169,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[169,39],"start":[169,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"arraySizeLimitTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[87,18],"start":[87,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[89,39],"start":[89,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[89,39],"start":[89,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"JSON Sanitizer - Security"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[101,23],"start":[89,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[90,20],"start":[90,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,20],"start":[90,5]}},"type":"Var","value":{"identifier":"depthLimitTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[90,20],"start":[90,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,20],"start":[90,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[91,24],"start":[91,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,24],"start":[91,5]}},"type":"Var","value":{"identifier":"arraySizeLimitTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[91,24],"start":[91,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,24],"start":[91,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[92,25],"start":[92,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[92,25],"start":[92,5]}},"type":"Var","value":{"identifier":"stringSizeLimitTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[92,25],"start":[92,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[92,25],"start":[92,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[93,28],"start":[93,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[93,28],"start":[93,5]}},"type":"Var","value":{"identifier":"prototypePollutionTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[93,28],"start":[93,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[93,28],"start":[93,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[94,24],"start":[94,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[94,24],"start":[94,5]}},"type":"Var","value":{"identifier":"objectKeyLimitTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[94,24],"start":[94,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[94,24],"start":[94,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[95,22],"start":[95,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[95,22],"start":[95,5]}},"type":"Var","value":{"identifier":"specialValueTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[95,22],"start":[95,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[95,22],"start":[95,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[96,21],"start":[96,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[96,21],"start":[96,5]}},"type":"Var","value":{"identifier":"invalidJsonTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[96,21],"start":[96,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[96,21],"start":[96,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[97,27],"start":[97,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[97,27],"start":[97,5]}},"type":"Var","value":{"identifier":"sanitizePreParsedTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[97,27],"start":[97,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[97,27],"start":[97,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[98,23],"start":[98,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[98,23],"start":[98,5]}},"type":"Var","value":{"identifier":"quickValidateTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[98,23],"start":[98,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[98,23],"start":[98,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[99,19],"start":[99,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[99,19],"start":[99,5]}},"type":"Var","value":{"identifier":"safeParseTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[99,19],"start":[99,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[99,19],"start":[99,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[100,20],"start":[100,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[100,20],"start":[100,5]}},"type":"Var","value":{"identifier":"deepFreezeTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[100,20],"start":[100,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[100,20],"start":[100,5]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[101,23],"start":[101,5]}},"type":"Var","value":{"identifier":"customOptionsTests","moduleName":["Test","Lattice","Security","JsonSanitizer"]}},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"spec"}],"exports":["spec"],"foreign":[],"imports":[{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Control","Applicative"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Control","Bind"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Argonaut","Core"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Array"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Either"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Eq"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Foldable"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Identity"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Maybe"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Ord"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Ring"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Semigroup"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Show"]},{"annotation":{"meta":null,"sourceSpan":{"end":[31,30],"start":[31,1]}},"moduleName":["Data","String"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","String","Common"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Tuple"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Data","Unit"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Effect","Aff"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Foreign","Object"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Lattice","Services","Security","JsonSanitizer"]},{"annotation":{"meta":null,"sourceSpan":{"end":[24,15],"start":[24,1]}},"moduleName":["Prelude"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Prim"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Test","Lattice","Security","JsonSanitizer"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Test","Spec"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Test","Spec","Assertions"]},{"annotation":{"meta":null,"sourceSpan":{"end":[560,50],"start":[22,1]}},"moduleName":["Test","Spec","Assertions","String"]}],"moduleName":["Test","Lattice","Security","JsonSanitizer"],"modulePath":"test/Lattice/Security/JsonSanitizer.purs","reExports":{},"sourceSpan":{"end":[560,50],"start":[22,1]}}