// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Identity from "../Data.Identity/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as Lattice_BlendModes from "../Lattice.BlendModes/index.js";
import * as Test_Spec from "../Test.Spec/index.js";
import * as Test_Spec_Assertions from "../Test.Spec.Assertions/index.js";
var describe = /* #__PURE__ */ Test_Spec.describe(Data_Identity.monadIdentity);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit);
var discard1 = /* #__PURE__ */ discard(/* #__PURE__ */ Test_Spec.bindSpecT(Data_Identity.bindIdentity));
var it = /* #__PURE__ */ Test_Spec.it(Data_Identity.monadIdentity)(Test_Spec.exampleMUnit);
var for_ = /* #__PURE__ */ Data_Foldable.for_(Effect_Aff.applicativeAff)(Data_Foldable.foldableArray);
var shouldEqual = /* #__PURE__ */ Test_Spec_Assertions.shouldEqual(Effect_Aff.monadThrowAff);
var shouldEqual1 = /* #__PURE__ */ shouldEqual(Lattice_BlendModes.showBlendMode)(Lattice_BlendModes.eqBlendMode);
var fail = /* #__PURE__ */ Test_Spec_Assertions.fail(Effect_Aff.monadThrowAff);
var show = /* #__PURE__ */ Data_Show.show(Lattice_BlendModes.showBlendMode);
var discard2 = /* #__PURE__ */ discard(Effect_Aff.bindAff);
var shouldEqual2 = /* #__PURE__ */ shouldEqual(Data_Show.showBoolean)(Data_Eq.eqBoolean);
var shouldEqual3 = /* #__PURE__ */ shouldEqual(Data_Show.showString)(Data_Eq.eqString);
var shouldEqual4 = /* #__PURE__ */ shouldEqual(Data_Show.showInt)(Data_Eq.eqInt);
var nub = /* #__PURE__ */ Data_Array.nub(Lattice_BlendModes.ordBlendMode);
var shouldEqual5 = /* #__PURE__ */ shouldEqual(Lattice_BlendModes.showBlendModeCategory)(Lattice_BlendModes.eqBlendModeCategory);
var elem = /* #__PURE__ */ Data_Array.elem(Lattice_BlendModes.eqBlendMode);
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect_Aff.applicativeAff);
var stringConversionTests = /* #__PURE__ */ describe("blendModeToString / blendModeFromString")(/* #__PURE__ */ discard1(/* #__PURE__ */ it("should roundtrip all blend modes through string conversion")(/* #__PURE__ */ for_(Lattice_BlendModes.allBlendModes)(function (mode) {
    var str = Lattice_BlendModes.blendModeToString(mode);
    var v = Lattice_BlendModes.blendModeFromString(str);
    if (v instanceof Data_Maybe.Just) {
        return shouldEqual1(v.value0)(mode);
    };
    if (v instanceof Data_Maybe.Nothing) {
        return fail("Failed to parse string: " + (str + (" for mode " + show(mode))));
    };
    throw new Error("Failed pattern match at Test.Lattice.Types.BlendModes (line 161, column 9 - line 163, column 91): " + [ v.constructor.name ]);
})))(function () {
    return discard1(it("should return Nothing for unknown strings")(discard2(shouldEqual2(Data_Maybe.isNothing(Lattice_BlendModes.blendModeFromString("unknown-mode")))(true))(function () {
        return discard2(shouldEqual2(Data_Maybe.isNothing(Lattice_BlendModes.blendModeFromString("")))(true))(function () {
            return shouldEqual2(Data_Maybe.isNothing(Lattice_BlendModes.blendModeFromString("Normal")))(true);
        });
    })))(function () {
        return discard1(it("should produce kebab-case strings")(discard2(shouldEqual3(Lattice_BlendModes.blendModeToString(Lattice_BlendModes.BMColorBurn.value))("color-burn"))(function () {
            return discard2(shouldEqual3(Lattice_BlendModes.blendModeToString(Lattice_BlendModes.BMSoftLight.value))("soft-light"))(function () {
                return shouldEqual3(Lattice_BlendModes.blendModeToString(Lattice_BlendModes.BMNormal.value))("normal");
            });
        })))(function () {
            return it("should parse all known strings successfully")((function () {
                var knownStrings = [ "normal", "dissolve", "darken", "multiply", "color-burn", "lighten", "screen", "overlay", "soft-light", "hard-light", "difference", "exclusion", "hue", "saturation", "color", "luminosity" ];
                return for_(knownStrings)(function (str) {
                    return shouldEqual2(Data_Maybe.isJust(Lattice_BlendModes.blendModeFromString(str)))(true);
                });
            })());
        });
    });
}));
var categoryModesTests = /* #__PURE__ */ (function () {
    return describe("categoryModes")(discard1(it("should return correct number of modes per category")(discard2(shouldEqual4(Data_Array.length(Lattice_BlendModes.categoryModes(Lattice_BlendModes.BMCNormal.value)))(2))(function () {
        return discard2(shouldEqual4(Data_Array.length(Lattice_BlendModes.categoryModes(Lattice_BlendModes.BMCDarken.value)))(5))(function () {
            return discard2(shouldEqual4(Data_Array.length(Lattice_BlendModes.categoryModes(Lattice_BlendModes.BMCLighten.value)))(6))(function () {
                return discard2(shouldEqual4(Data_Array.length(Lattice_BlendModes.categoryModes(Lattice_BlendModes.BMCContrast.value)))(7))(function () {
                    return discard2(shouldEqual4(Data_Array.length(Lattice_BlendModes.categoryModes(Lattice_BlendModes.BMCInversion.value)))(4))(function () {
                        return discard2(shouldEqual4(Data_Array.length(Lattice_BlendModes.categoryModes(Lattice_BlendModes.BMCComponent.value)))(4))(function () {
                            return shouldEqual4(Data_Array.length(Lattice_BlendModes.categoryModes(Lattice_BlendModes.BMCUtility.value)))(6);
                        });
                    });
                });
            });
        });
    })))(function () {
        return discard1(it("should not have duplicates within a category")((function () {
            var categories = [ Lattice_BlendModes.BMCNormal.value, Lattice_BlendModes.BMCDarken.value, Lattice_BlendModes.BMCLighten.value, Lattice_BlendModes.BMCContrast.value, Lattice_BlendModes.BMCInversion.value, Lattice_BlendModes.BMCComponent.value, Lattice_BlendModes.BMCUtility.value ];
            return for_(categories)(function (cat) {
                var modes = Lattice_BlendModes.categoryModes(cat);
                var unique = nub(modes);
                return shouldEqual4(Data_Array.length(unique))(Data_Array.length(modes));
            });
        })()))(function () {
            return it("should return modes that map back to the same category")((function () {
                var categories = [ Lattice_BlendModes.BMCNormal.value, Lattice_BlendModes.BMCDarken.value, Lattice_BlendModes.BMCLighten.value, Lattice_BlendModes.BMCContrast.value, Lattice_BlendModes.BMCInversion.value, Lattice_BlendModes.BMCComponent.value, Lattice_BlendModes.BMCUtility.value ];
                return for_(categories)(function (cat) {
                    var modes = Lattice_BlendModes.categoryModes(cat);
                    return for_(modes)(function (mode) {
                        return shouldEqual5(Lattice_BlendModes.blendModeCategory(mode))(cat);
                    });
                });
            })());
        });
    }));
})();
var blendModeCategoryTests = /* #__PURE__ */ (function () {
    return describe("blendModeCategory")(discard1(it("should categorize Normal modes correctly")(discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMNormal.value))(Lattice_BlendModes.BMCNormal.value))(function () {
        return shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMDissolve.value))(Lattice_BlendModes.BMCNormal.value);
    })))(function () {
        return discard1(it("should categorize Darken modes correctly")(discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMDarken.value))(Lattice_BlendModes.BMCDarken.value))(function () {
            return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMMultiply.value))(Lattice_BlendModes.BMCDarken.value))(function () {
                return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMColorBurn.value))(Lattice_BlendModes.BMCDarken.value))(function () {
                    return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMLinearBurn.value))(Lattice_BlendModes.BMCDarken.value))(function () {
                        return shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMDarkerColor.value))(Lattice_BlendModes.BMCDarken.value);
                    });
                });
            });
        })))(function () {
            return discard1(it("should categorize Lighten modes correctly")(discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMLighten.value))(Lattice_BlendModes.BMCLighten.value))(function () {
                return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMScreen.value))(Lattice_BlendModes.BMCLighten.value))(function () {
                    return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMColorDodge.value))(Lattice_BlendModes.BMCLighten.value))(function () {
                        return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMLinearDodge.value))(Lattice_BlendModes.BMCLighten.value))(function () {
                            return shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMAdd.value))(Lattice_BlendModes.BMCLighten.value);
                        });
                    });
                });
            })))(function () {
                return discard1(it("should categorize Contrast modes correctly")(discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMOverlay.value))(Lattice_BlendModes.BMCContrast.value))(function () {
                    return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMSoftLight.value))(Lattice_BlendModes.BMCContrast.value))(function () {
                        return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMHardLight.value))(Lattice_BlendModes.BMCContrast.value))(function () {
                            return shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMHardMix.value))(Lattice_BlendModes.BMCContrast.value);
                        });
                    });
                })))(function () {
                    return discard1(it("should categorize Inversion modes correctly")(discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMDifference.value))(Lattice_BlendModes.BMCInversion.value))(function () {
                        return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMExclusion.value))(Lattice_BlendModes.BMCInversion.value))(function () {
                            return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMSubtract.value))(Lattice_BlendModes.BMCInversion.value))(function () {
                                return shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMDivide.value))(Lattice_BlendModes.BMCInversion.value);
                            });
                        });
                    })))(function () {
                        return discard1(it("should categorize Component modes correctly")(discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMHue.value))(Lattice_BlendModes.BMCComponent.value))(function () {
                            return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMSaturation.value))(Lattice_BlendModes.BMCComponent.value))(function () {
                                return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMColor.value))(Lattice_BlendModes.BMCComponent.value))(function () {
                                    return shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMLuminosity.value))(Lattice_BlendModes.BMCComponent.value);
                                });
                            });
                        })))(function () {
                            return discard1(it("should categorize Utility modes correctly")(discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMStencilAlpha.value))(Lattice_BlendModes.BMCUtility.value))(function () {
                                return discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMStencilLuma.value))(Lattice_BlendModes.BMCUtility.value))(function () {
                                    return shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMAlphaAdd.value))(Lattice_BlendModes.BMCUtility.value);
                                });
                            })))(function () {
                                return it("should categorize classic modes to parent categories")(discard2(shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMClassicColorBurn.value))(Lattice_BlendModes.BMCDarken.value))(function () {
                                    return shouldEqual5(Lattice_BlendModes.blendModeCategory(Lattice_BlendModes.BMClassicColorDodge.value))(Lattice_BlendModes.BMCLighten.value);
                                }));
                            });
                        });
                    });
                });
            });
        });
    }));
})();
var allBlendModesTests = /* #__PURE__ */ describe("allBlendModes")(/* #__PURE__ */ discard1(/* #__PURE__ */ it("should contain all blend modes (36 total)")(/* #__PURE__ */ shouldEqual4(/* #__PURE__ */ Data_Array.length(Lattice_BlendModes.allBlendModes))(36)))(function () {
    return discard1(it("should have no duplicates")((function () {
        var unique = nub(Lattice_BlendModes.allBlendModes);
        return shouldEqual4(Data_Array.length(unique))(Data_Array.length(Lattice_BlendModes.allBlendModes));
    })()))(function () {
        return it("should contain all category modes")((function () {
            var categories = [ Lattice_BlendModes.BMCNormal.value, Lattice_BlendModes.BMCDarken.value, Lattice_BlendModes.BMCLighten.value, Lattice_BlendModes.BMCContrast.value, Lattice_BlendModes.BMCInversion.value, Lattice_BlendModes.BMCComponent.value, Lattice_BlendModes.BMCUtility.value ];
            var allFromCategories = Data_Array.concatMap(Lattice_BlendModes.categoryModes)(categories);
            return for_(allFromCategories)(function (mode) {
                var $29 = elem(mode)(Lattice_BlendModes.allBlendModes);
                if ($29) {
                    return pure(Data_Unit.unit);
                };
                return fail("Expected allBlendModes to contain " + show(mode));
            });
        })());
    });
}));
var spec = /* #__PURE__ */ describe("BlendModes - Type Tests")(/* #__PURE__ */ discard1(blendModeCategoryTests)(function () {
    return discard1(categoryModesTests)(function () {
        return discard1(allBlendModesTests)(function () {
            return stringConversionTests;
        });
    });
}));
export {
    spec
};
//# sourceMappingURL=index.js.map
