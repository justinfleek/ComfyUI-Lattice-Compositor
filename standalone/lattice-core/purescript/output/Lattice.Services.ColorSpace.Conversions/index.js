// Generated by purs version 0.15.15
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Lattice_Services_ColorSpace_TransferFunctions from "../Lattice.Services.ColorSpace.TransferFunctions/index.js";
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var eq = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Maybe.eqMaybe(Data_Eq.eqChar));
var SRGB_CS = /* #__PURE__ */ (function () {
    function SRGB_CS() {

    };
    SRGB_CS.value = new SRGB_CS();
    return SRGB_CS;
})();
var LinearSRGB = /* #__PURE__ */ (function () {
    function LinearSRGB() {

    };
    LinearSRGB.value = new LinearSRGB();
    return LinearSRGB;
})();
var WideGamutRGB = /* #__PURE__ */ (function () {
    function WideGamutRGB() {

    };
    WideGamutRGB.value = new WideGamutRGB();
    return WideGamutRGB;
})();
var DisplayP3 = /* #__PURE__ */ (function () {
    function DisplayP3() {

    };
    DisplayP3.value = new DisplayP3();
    return DisplayP3;
})();
var ProPhotoRGB = /* #__PURE__ */ (function () {
    function ProPhotoRGB() {

    };
    ProPhotoRGB.value = new ProPhotoRGB();
    return ProPhotoRGB;
})();
var ACEScg = /* #__PURE__ */ (function () {
    function ACEScg() {

    };
    ACEScg.value = new ACEScg();
    return ACEScg;
})();
var Rec709 = /* #__PURE__ */ (function () {
    function Rec709() {

    };
    Rec709.value = new Rec709();
    return Rec709;
})();
var Rec2020 = /* #__PURE__ */ (function () {
    function Rec2020() {

    };
    Rec2020.value = new Rec2020();
    return Rec2020;
})();
var mkMatrix = function (v) {
    return {
        m00: v.r0.a,
        m01: v.r0.b,
        m02: v.r0.c,
        m10: v.r1.a,
        m11: v.r1.b,
        m12: v.r1.c,
        m20: v.r2.a,
        m21: v.r2.b,
        m22: v.r2.c
    };
};
var p3ToXYZ = /* #__PURE__ */ mkMatrix({
    r0: {
        a: 0.4865709,
        b: 0.2656677,
        c: 0.1982173
    },
    r1: {
        a: 0.2289746,
        b: 0.6917385,
        c: 7.92869e-2
    },
    r2: {
        a: 0.0,
        b: 4.51134e-2,
        c: 1.0439444
    }
});
var proPhotoToXYZ = /* #__PURE__ */ mkMatrix({
    r0: {
        a: 0.7976749,
        b: 0.1351917,
        c: 3.13534e-2
    },
    r1: {
        a: 0.2880402,
        b: 0.7118741,
        c: 8.57e-5
    },
    r2: {
        a: 0.0,
        b: 0.0,
        c: 0.82521
    }
});
var srgbToXYZ = /* #__PURE__ */ mkMatrix({
    r0: {
        a: 0.4124564,
        b: 0.3575761,
        c: 0.1804375
    },
    r1: {
        a: 0.2126729,
        b: 0.7151522,
        c: 7.2175e-2
    },
    r2: {
        a: 1.93339e-2,
        b: 0.119192,
        c: 0.9503041
    }
});
var wideGamutRGBToXYZ = /* #__PURE__ */ mkMatrix({
    r0: {
        a: 0.5767309,
        b: 0.185554,
        c: 0.1881852
    },
    r1: {
        a: 0.2973769,
        b: 0.6273491,
        c: 7.52741e-2
    },
    r2: {
        a: 2.70343e-2,
        b: 7.06872e-2,
        c: 0.9911085
    }
});
var xyzToACEScg = /* #__PURE__ */ (function () {
    return mkMatrix({
        r0: {
            a: 1.6410234,
            b: -0.3248033,
            c: -0.2364247
        },
        r1: {
            a: -0.6636629,
            b: 1.6153316,
            c: 1.67563e-2
        },
        r2: {
            a: 1.17219e-2,
            b: -8.2844e-3,
            c: 0.9883948
        }
    });
})();
var xyzToP3 = /* #__PURE__ */ (function () {
    return mkMatrix({
        r0: {
            a: 2.4934969,
            b: -0.9313836,
            c: -0.4027108
        },
        r1: {
            a: -0.829489,
            b: 1.7626641,
            c: 2.36247e-2
        },
        r2: {
            a: 3.58458e-2,
            b: -7.61724e-2,
            c: 0.9568845
        }
    });
})();
var xyzToProPhoto = /* #__PURE__ */ (function () {
    return mkMatrix({
        r0: {
            a: 1.3459433,
            b: -0.2556075,
            c: -5.11118e-2
        },
        r1: {
            a: -0.5445989,
            b: 1.5081673,
            c: 2.05351e-2
        },
        r2: {
            a: 0.0,
            b: 0.0,
            c: 1.2118128
        }
    });
})();
var xyzToSRGB = /* #__PURE__ */ (function () {
    return mkMatrix({
        r0: {
            a: 3.2404542,
            b: -1.5371385,
            c: -0.4985314
        },
        r1: {
            a: -0.969266,
            b: 1.8760108,
            c: 4.1556e-2
        },
        r2: {
            a: 5.56434e-2,
            b: -0.2040259,
            c: 1.0572252
        }
    });
})();
var xyzToWideGamutRGB = /* #__PURE__ */ (function () {
    return mkMatrix({
        r0: {
            a: 2.041369,
            b: -0.5649464,
            c: -0.3446944
        },
        r1: {
            a: -0.969266,
            b: 1.8760108,
            c: 4.1556e-2
        },
        r2: {
            a: 1.34474e-2,
            b: -0.1183897,
            c: 1.0154096
        }
    });
})();
var matrixMultiplyXYZ = function (m) {
    return function (xyz) {
        return {
            r: m.m00 * xyz.x + m.m01 * xyz.y + m.m02 * xyz.z,
            g: m.m10 * xyz.x + m.m11 * xyz.y + m.m12 * xyz.z,
            b: m.m20 * xyz.x + m.m21 * xyz.y + m.m22 * xyz.z
        };
    };
};
var matrixMultiplyRGB = function (m) {
    return function (rgb) {
        return {
            x: m.m00 * rgb.r + m.m01 * rgb.g + m.m02 * rgb.b,
            y: m.m10 * rgb.r + m.m11 * rgb.g + m.m12 * rgb.b,
            z: m.m20 * rgb.r + m.m21 * rgb.g + m.m22 * rgb.b
        };
    };
};
var isInGamut = function (rgb) {
    return rgb.r >= 0.0 && (rgb.r <= 1.0 && (rgb.g >= 0.0 && (rgb.g <= 1.0 && (rgb.b >= 0.0 && rgb.b <= 1.0))));
};
var getGamma = function (cs) {
    if (cs instanceof SRGB_CS) {
        return Lattice_Services_ColorSpace_TransferFunctions.SRGB.value;
    };
    if (cs instanceof LinearSRGB) {
        return Lattice_Services_ColorSpace_TransferFunctions.Linear.value;
    };
    if (cs instanceof WideGamutRGB) {
        return new Lattice_Services_ColorSpace_TransferFunctions.Power(2.2);
    };
    if (cs instanceof DisplayP3) {
        return Lattice_Services_ColorSpace_TransferFunctions.SRGB.value;
    };
    if (cs instanceof ProPhotoRGB) {
        return new Lattice_Services_ColorSpace_TransferFunctions.Power(1.8);
    };
    if (cs instanceof ACEScg) {
        return Lattice_Services_ColorSpace_TransferFunctions.Linear.value;
    };
    if (cs instanceof Rec709) {
        return new Lattice_Services_ColorSpace_TransferFunctions.Power(2.4);
    };
    if (cs instanceof Rec2020) {
        return new Lattice_Services_ColorSpace_TransferFunctions.Power(2.4);
    };
    throw new Error("Failed pattern match at Lattice.Services.ColorSpace.Conversions (line 189, column 15 - line 197, column 23): " + [ cs.constructor.name ]);
};
var getFromXYZMatrix = function (cs) {
    if (cs instanceof SRGB_CS) {
        return xyzToSRGB;
    };
    if (cs instanceof LinearSRGB) {
        return xyzToSRGB;
    };
    if (cs instanceof WideGamutRGB) {
        return xyzToWideGamutRGB;
    };
    if (cs instanceof DisplayP3) {
        return xyzToP3;
    };
    if (cs instanceof ProPhotoRGB) {
        return xyzToProPhoto;
    };
    if (cs instanceof ACEScg) {
        return xyzToACEScg;
    };
    if (cs instanceof Rec709) {
        return xyzToSRGB;
    };
    if (cs instanceof Rec2020) {
        return xyzToSRGB;
    };
    throw new Error("Failed pattern match at Lattice.Services.ColorSpace.Conversions (line 213, column 23 - line 221, column 23): " + [ cs.constructor.name ]);
};
var xyzToRGB = function (xyz) {
    return function (colorSpace) {
        var matrix = getFromXYZMatrix(colorSpace);
        var linear = matrixMultiplyXYZ(matrix)(xyz);
        var gamma = getGamma(colorSpace);
        return Lattice_Services_ColorSpace_TransferFunctions.applyGammaRGB(linear)(gamma);
    };
};
var fromHex = function (s) {
    var parseHex6 = function (h) {
        return bind(Data_Int.fromStringAs(Data_Int.hexadecimal)(Data_String_CodePoints.take(2)(h)))(function (rv) {
            return bind(Data_Int.fromStringAs(Data_Int.hexadecimal)(Data_String_CodePoints.take(2)(Data_String_CodePoints.drop(2)(h))))(function (gv) {
                return bind(Data_Int.fromStringAs(Data_Int.hexadecimal)(Data_String_CodePoints.drop(4)(h)))(function (bv) {
                    return new Data_Maybe.Just({
                        r: Data_Int.toNumber(rv) / 255.0,
                        g: Data_Int.toNumber(gv) / 255.0,
                        b: Data_Int.toNumber(bv) / 255.0
                    });
                });
            });
        });
    };
    var parseHex3 = function (h) {
        return bind(Data_Int.fromStringAs(Data_Int.hexadecimal)(Data_String_CodePoints.take(1)(h)))(function (rv) {
            return bind(Data_Int.fromStringAs(Data_Int.hexadecimal)(Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(1)(h))))(function (gv) {
                return bind(Data_Int.fromStringAs(Data_Int.hexadecimal)(Data_String_CodePoints.drop(2)(h)))(function (bv) {
                    return new Data_Maybe.Just({
                        r: Data_Int.toNumber(rv * 17 | 0) / 255.0,
                        g: Data_Int.toNumber(gv * 17 | 0) / 255.0,
                        b: Data_Int.toNumber(bv * 17 | 0) / 255.0
                    });
                });
            });
        });
    };
    var hex = (function () {
        var $22 = eq(Data_String_CodeUnits.charAt(0)(s))(new Data_Maybe.Just("#"));
        if ($22) {
            return Data_String_CodePoints.drop(1)(s);
        };
        return s;
    })();
    var v = Data_String_CodePoints.length(hex);
    if (v === 6) {
        return parseHex6(hex);
    };
    if (v === 3) {
        return parseHex3(hex);
    };
    return Data_Maybe.Nothing.value;
};
var eqColorSpaceId = {
    eq: function (x) {
        return function (y) {
            if (x instanceof SRGB_CS && y instanceof SRGB_CS) {
                return true;
            };
            if (x instanceof LinearSRGB && y instanceof LinearSRGB) {
                return true;
            };
            if (x instanceof WideGamutRGB && y instanceof WideGamutRGB) {
                return true;
            };
            if (x instanceof DisplayP3 && y instanceof DisplayP3) {
                return true;
            };
            if (x instanceof ProPhotoRGB && y instanceof ProPhotoRGB) {
                return true;
            };
            if (x instanceof ACEScg && y instanceof ACEScg) {
                return true;
            };
            if (x instanceof Rec709 && y instanceof Rec709) {
                return true;
            };
            if (x instanceof Rec2020 && y instanceof Rec2020) {
                return true;
            };
            return false;
        };
    }
};
var eq1 = /* #__PURE__ */ Data_Eq.eq(eqColorSpaceId);
var clipToGamut = Lattice_Services_ColorSpace_TransferFunctions.clampRGB;
var acesCGToXYZ = /* #__PURE__ */ (function () {
    return mkMatrix({
        r0: {
            a: 0.6624542,
            b: 0.1340042,
            c: 0.1561877
        },
        r1: {
            a: 0.2722287,
            b: 0.6740818,
            c: 5.36895e-2
        },
        r2: {
            a: -5.5746e-3,
            b: 4.0607e-3,
            c: 1.0103391
        }
    });
})();
var getToXYZMatrix = function (cs) {
    if (cs instanceof SRGB_CS) {
        return srgbToXYZ;
    };
    if (cs instanceof LinearSRGB) {
        return srgbToXYZ;
    };
    if (cs instanceof WideGamutRGB) {
        return wideGamutRGBToXYZ;
    };
    if (cs instanceof DisplayP3) {
        return p3ToXYZ;
    };
    if (cs instanceof ProPhotoRGB) {
        return proPhotoToXYZ;
    };
    if (cs instanceof ACEScg) {
        return acesCGToXYZ;
    };
    if (cs instanceof Rec709) {
        return srgbToXYZ;
    };
    if (cs instanceof Rec2020) {
        return srgbToXYZ;
    };
    throw new Error("Failed pattern match at Lattice.Services.ColorSpace.Conversions (line 201, column 21 - line 209, column 23): " + [ cs.constructor.name ]);
};
var rgbToXYZ = function (rgb) {
    return function (colorSpace) {
        var matrix = getToXYZMatrix(colorSpace);
        var gamma = getGamma(colorSpace);
        var linear = Lattice_Services_ColorSpace_TransferFunctions.linearizeRGB(rgb)(gamma);
        return matrixMultiplyRGB(matrix)(linear);
    };
};
var convertColorSpace = function (rgb) {
    return function (from) {
        return function (to) {
            if (eq1(from)(to)) {
                return rgb;
            };
            if (Data_Boolean.otherwise) {
                var $30 = {
                    from: from,
                    to: to
                };
                if ($30.from instanceof LinearSRGB && $30.to instanceof SRGB_CS) {
                    return Lattice_Services_ColorSpace_TransferFunctions.applyGammaRGB(rgb)(Lattice_Services_ColorSpace_TransferFunctions.SRGB.value);
                };
                if ($30.from instanceof SRGB_CS && $30.to instanceof LinearSRGB) {
                    return Lattice_Services_ColorSpace_TransferFunctions.linearizeRGB(rgb)(Lattice_Services_ColorSpace_TransferFunctions.SRGB.value);
                };
                var xyz = rgbToXYZ(rgb)(from);
                return xyzToRGB(xyz)(to);
            };
            throw new Error("Failed pattern match at Lattice.Services.ColorSpace.Conversions (line 244, column 1 - line 244, column 64): " + [ rgb.constructor.name, from.constructor.name, to.constructor.name ]);
        };
    };
};
var getLuminance = function (rgb) {
    return function (colorSpace) {
        return (rgbToXYZ(rgb)(colorSpace)).y;
    };
};
export {
    SRGB_CS,
    LinearSRGB,
    WideGamutRGB,
    DisplayP3,
    ProPhotoRGB,
    ACEScg,
    Rec709,
    Rec2020,
    mkMatrix,
    matrixMultiplyRGB,
    matrixMultiplyXYZ,
    srgbToXYZ,
    xyzToSRGB,
    p3ToXYZ,
    xyzToP3,
    wideGamutRGBToXYZ,
    xyzToWideGamutRGB,
    proPhotoToXYZ,
    xyzToProPhoto,
    acesCGToXYZ,
    xyzToACEScg,
    getGamma,
    getToXYZMatrix,
    getFromXYZMatrix,
    rgbToXYZ,
    xyzToRGB,
    convertColorSpace,
    getLuminance,
    isInGamut,
    clipToGamut,
    fromHex,
    eqColorSpaceId
};
//# sourceMappingURL=index.js.map
