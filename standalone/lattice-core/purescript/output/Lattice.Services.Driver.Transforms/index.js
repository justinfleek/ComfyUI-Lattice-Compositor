// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as $$Math from "../Math/index.js";
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordNumber);
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordNumber);
var TransformScale = /* #__PURE__ */ (function () {
    function TransformScale() {

    };
    TransformScale.value = new TransformScale();
    return TransformScale;
})();
var TransformOffset = /* #__PURE__ */ (function () {
    function TransformOffset() {

    };
    TransformOffset.value = new TransformOffset();
    return TransformOffset;
})();
var TransformClamp = /* #__PURE__ */ (function () {
    function TransformClamp() {

    };
    TransformClamp.value = new TransformClamp();
    return TransformClamp;
})();
var TransformSmooth = /* #__PURE__ */ (function () {
    function TransformSmooth() {

    };
    TransformSmooth.value = new TransformSmooth();
    return TransformSmooth;
})();
var TransformInvert = /* #__PURE__ */ (function () {
    function TransformInvert() {

    };
    TransformInvert.value = new TransformInvert();
    return TransformInvert;
})();
var TransformRemap = /* #__PURE__ */ (function () {
    function TransformRemap() {

    };
    TransformRemap.value = new TransformRemap();
    return TransformRemap;
})();
var TransformThreshold = /* #__PURE__ */ (function () {
    function TransformThreshold() {

    };
    TransformThreshold.value = new TransformThreshold();
    return TransformThreshold;
})();
var TransformOscillate = /* #__PURE__ */ (function () {
    function TransformOscillate() {

    };
    TransformOscillate.value = new TransformOscillate();
    return TransformOscillate;
})();
var BlendReplace = /* #__PURE__ */ (function () {
    function BlendReplace() {

    };
    BlendReplace.value = new BlendReplace();
    return BlendReplace;
})();
var BlendAdd = /* #__PURE__ */ (function () {
    function BlendAdd() {

    };
    BlendAdd.value = new BlendAdd();
    return BlendAdd;
})();
var BlendMultiply = /* #__PURE__ */ (function () {
    function BlendMultiply() {

    };
    BlendMultiply.value = new BlendMultiply();
    return BlendMultiply;
})();
var eqTransformType = {
    eq: function (x) {
        return function (y) {
            if (x instanceof TransformScale && y instanceof TransformScale) {
                return true;
            };
            if (x instanceof TransformOffset && y instanceof TransformOffset) {
                return true;
            };
            if (x instanceof TransformClamp && y instanceof TransformClamp) {
                return true;
            };
            if (x instanceof TransformSmooth && y instanceof TransformSmooth) {
                return true;
            };
            if (x instanceof TransformInvert && y instanceof TransformInvert) {
                return true;
            };
            if (x instanceof TransformRemap && y instanceof TransformRemap) {
                return true;
            };
            if (x instanceof TransformThreshold && y instanceof TransformThreshold) {
                return true;
            };
            if (x instanceof TransformOscillate && y instanceof TransformOscillate) {
                return true;
            };
            return false;
        };
    }
};
var eqBlendMode = {
    eq: function (x) {
        return function (y) {
            if (x instanceof BlendReplace && y instanceof BlendReplace) {
                return true;
            };
            if (x instanceof BlendAdd && y instanceof BlendAdd) {
                return true;
            };
            if (x instanceof BlendMultiply && y instanceof BlendMultiply) {
                return true;
            };
            return false;
        };
    }
};
var defaultTransform = /* #__PURE__ */ (function () {
    return {
        transformType: TransformScale.value,
        factor: 1.0,
        amount: 0.0,
        minVal: 0.0,
        maxVal: 1.0,
        smoothing: 0.5,
        inMin: 0.0,
        inMax: 1.0,
        outMin: 0.0,
        outMax: 1.0,
        threshold: 0.5,
        frequency: 1.0,
        amplitude: 1.0,
        phase: 0.0
    };
})();
var mkClampTransform = function (minVal) {
    return function (maxVal) {
        return {
            factor: defaultTransform.factor,
            amount: defaultTransform.amount,
            smoothing: defaultTransform.smoothing,
            inMin: defaultTransform.inMin,
            inMax: defaultTransform.inMax,
            outMin: defaultTransform.outMin,
            outMax: defaultTransform.outMax,
            threshold: defaultTransform.threshold,
            frequency: defaultTransform.frequency,
            amplitude: defaultTransform.amplitude,
            phase: defaultTransform.phase,
            transformType: TransformClamp.value,
            minVal: minVal,
            maxVal: maxVal
        };
    };
};
var mkOffsetTransform = function (amount) {
    return {
        factor: defaultTransform.factor,
        minVal: defaultTransform.minVal,
        maxVal: defaultTransform.maxVal,
        smoothing: defaultTransform.smoothing,
        inMin: defaultTransform.inMin,
        inMax: defaultTransform.inMax,
        outMin: defaultTransform.outMin,
        outMax: defaultTransform.outMax,
        threshold: defaultTransform.threshold,
        frequency: defaultTransform.frequency,
        amplitude: defaultTransform.amplitude,
        phase: defaultTransform.phase,
        transformType: TransformOffset.value,
        amount: amount
    };
};
var mkOscillateTransform = function (frequency) {
    return function (amplitude) {
        return function (phase) {
            return {
                factor: defaultTransform.factor,
                amount: defaultTransform.amount,
                minVal: defaultTransform.minVal,
                maxVal: defaultTransform.maxVal,
                smoothing: defaultTransform.smoothing,
                inMin: defaultTransform.inMin,
                inMax: defaultTransform.inMax,
                outMin: defaultTransform.outMin,
                outMax: defaultTransform.outMax,
                threshold: defaultTransform.threshold,
                transformType: TransformOscillate.value,
                frequency: frequency,
                amplitude: amplitude,
                phase: phase
            };
        };
    };
};
var mkRemapTransform = function (inMin) {
    return function (inMax) {
        return function (outMin) {
            return function (outMax) {
                return {
                    factor: defaultTransform.factor,
                    amount: defaultTransform.amount,
                    minVal: defaultTransform.minVal,
                    maxVal: defaultTransform.maxVal,
                    smoothing: defaultTransform.smoothing,
                    threshold: defaultTransform.threshold,
                    frequency: defaultTransform.frequency,
                    amplitude: defaultTransform.amplitude,
                    phase: defaultTransform.phase,
                    transformType: TransformRemap.value,
                    inMin: inMin,
                    inMax: inMax,
                    outMin: outMin,
                    outMax: outMax
                };
            };
        };
    };
};
var mkScaleTransform = function (factor) {
    return {
        amount: defaultTransform.amount,
        minVal: defaultTransform.minVal,
        maxVal: defaultTransform.maxVal,
        smoothing: defaultTransform.smoothing,
        inMin: defaultTransform.inMin,
        inMax: defaultTransform.inMax,
        outMin: defaultTransform.outMin,
        outMax: defaultTransform.outMax,
        threshold: defaultTransform.threshold,
        frequency: defaultTransform.frequency,
        amplitude: defaultTransform.amplitude,
        phase: defaultTransform.phase,
        transformType: TransformScale.value,
        factor: factor
    };
};
var mkThresholdTransform = function (thresholdVal) {
    return {
        factor: defaultTransform.factor,
        amount: defaultTransform.amount,
        minVal: defaultTransform.minVal,
        maxVal: defaultTransform.maxVal,
        smoothing: defaultTransform.smoothing,
        inMin: defaultTransform.inMin,
        inMax: defaultTransform.inMax,
        outMin: defaultTransform.outMin,
        outMax: defaultTransform.outMax,
        frequency: defaultTransform.frequency,
        amplitude: defaultTransform.amplitude,
        phase: defaultTransform.phase,
        transformType: TransformThreshold.value,
        threshold: thresholdVal
    };
};
var blendValue = function (base) {
    return function (driven) {
        return function (mode) {
            return function (amount) {
                var result = (function () {
                    if (mode instanceof BlendReplace) {
                        return driven;
                    };
                    if (mode instanceof BlendAdd) {
                        return base + driven;
                    };
                    if (mode instanceof BlendMultiply) {
                        return base * driven;
                    };
                    throw new Error("Failed pattern match at Lattice.Services.Driver.Transforms (line 198, column 16 - line 201, column 39): " + [ mode.constructor.name ]);
                })();
                return base * (1.0 - amount) + result * amount;
            };
        };
    };
};
var applyThreshold = function (value) {
    return function (thresholdVal) {
        var $25 = value > thresholdVal;
        if ($25) {
            return 1.0;
        };
        return 0.0;
    };
};
var applySmooth = function (value) {
    return function (prevValue) {
        return function (smoothing) {
            var s = max(0.0)(min(1.0)(smoothing));
            return prevValue * s + value * (1.0 - s);
        };
    };
};
var applyScale = function (value) {
    return function (factor) {
        return value * factor;
    };
};
var applyRemap = function (value) {
    return function (inMin) {
        return function (inMax) {
            return function (outMin) {
                return function (outMax) {
                    var inRange = inMax - inMin;
                    var $26 = inRange === 0.0;
                    if ($26) {
                        return (outMin + outMax) / 2.0;
                    };
                    var normalized = (value - inMin) / inRange;
                    return outMin + normalized * (outMax - outMin);
                };
            };
        };
    };
};
var applyOscillate = function (value) {
    return function (frequency) {
        return function (amplitude) {
            return function (phase) {
                var freq = (function () {
                    var $27 = frequency <= 0.0;
                    if ($27) {
                        return 1.0;
                    };
                    return frequency;
                })();
                var amp = (function () {
                    var $28 = amplitude < 0.0;
                    if ($28) {
                        return 0.0;
                    };
                    return amplitude;
                })();
                return $$Math.sin((value * freq + phase) * $$Math.pi * 2.0) * amp;
            };
        };
    };
};
var applyOffset = function (value) {
    return function (amount) {
        return value + amount;
    };
};
var applyInvert = function (value) {
    return 1.0 - value;
};
var applyClamp = function (value) {
    return function (minVal) {
        return function (maxVal) {
            return max(minVal)(min(maxVal)(value));
        };
    };
};
var applyTransformWithPrev = function (transform) {
    return function (value) {
        return function (prevValue) {
            if (transform.transformType instanceof TransformScale) {
                return applyScale(value)(transform.factor);
            };
            if (transform.transformType instanceof TransformOffset) {
                return applyOffset(value)(transform.amount);
            };
            if (transform.transformType instanceof TransformClamp) {
                return applyClamp(value)(transform.minVal)(transform.maxVal);
            };
            if (transform.transformType instanceof TransformSmooth) {
                return applySmooth(value)(prevValue)(transform.smoothing);
            };
            if (transform.transformType instanceof TransformInvert) {
                return applyInvert(value);
            };
            if (transform.transformType instanceof TransformRemap) {
                return applyRemap(value)(transform.inMin)(transform.inMax)(transform.outMin)(transform.outMax);
            };
            if (transform.transformType instanceof TransformThreshold) {
                return applyThreshold(value)(transform.threshold);
            };
            if (transform.transformType instanceof TransformOscillate) {
                return applyOscillate(value)(transform.frequency)(transform.amplitude)(transform.phase);
            };
            throw new Error("Failed pattern match at Lattice.Services.Driver.Transforms (line 170, column 3 - line 180, column 64): " + [ transform.transformType.constructor.name ]);
        };
    };
};
var applyTransform = function (transform) {
    return function (value) {
        return applyTransformWithPrev(transform)(value)(value);
    };
};
var applyTransformChain = function (transforms) {
    return function (value) {
        return Data_Array.foldl(function (v) {
            return function (t) {
                return applyTransform(t)(v);
            };
        })(value)(transforms);
    };
};
export {
    TransformScale,
    TransformOffset,
    TransformClamp,
    TransformSmooth,
    TransformInvert,
    TransformRemap,
    TransformThreshold,
    TransformOscillate,
    BlendReplace,
    BlendAdd,
    BlendMultiply,
    defaultTransform,
    applyScale,
    applyOffset,
    applyClamp,
    applySmooth,
    applyInvert,
    applyRemap,
    applyThreshold,
    applyOscillate,
    applyTransformWithPrev,
    applyTransform,
    applyTransformChain,
    blendValue,
    mkScaleTransform,
    mkOffsetTransform,
    mkClampTransform,
    mkRemapTransform,
    mkThresholdTransform,
    mkOscillateTransform,
    eqTransformType,
    eqBlendMode
};
//# sourceMappingURL=index.js.map
