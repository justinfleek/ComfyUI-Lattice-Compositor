// Generated by purs version 0.15.15
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Show_Generic from "../Data.Show.Generic/index.js";
import * as $$Math from "../Math/index.js";
var showRecord = /* #__PURE__ */ Data_Show.showRecord()();
var bIsSymbol = {
    reflectSymbol: function () {
        return "b";
    }
};
var gIsSymbol = {
    reflectSymbol: function () {
        return "g";
    }
};
var rIsSymbol = {
    reflectSymbol: function () {
        return "r";
    }
};
var hIsSymbol = {
    reflectSymbol: function () {
        return "h";
    }
};
var lIsSymbol = {
    reflectSymbol: function () {
        return "l";
    }
};
var sIsSymbol = {
    reflectSymbol: function () {
        return "s";
    }
};
var eqRec = /* #__PURE__ */ Data_Eq.eqRec();
var eqRowCons = /* #__PURE__ */ Data_Eq.eqRowCons(Data_Eq.eqRowNil)();
var RGB = function (x) {
    return x;
};
var HSL = function (x) {
    return x;
};
var genericRGB_ = {
    to: function (x) {
        return x;
    },
    from: function (x) {
        return x;
    }
};
var showRGB = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericRGB_)(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(/* #__PURE__ */ showRecord(/* #__PURE__ */ Data_Show.showRecordFieldsCons(bIsSymbol)(/* #__PURE__ */ Data_Show.showRecordFieldsCons(gIsSymbol)(/* #__PURE__ */ Data_Show.showRecordFieldsConsNil(rIsSymbol)(Data_Show.showNumber))(Data_Show.showNumber))(Data_Show.showNumber))))({
        reflectSymbol: function () {
            return "RGB";
        }
    }))
};
var genericHSL_ = {
    to: function (x) {
        return x;
    },
    from: function (x) {
        return x;
    }
};
var showHSL = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericHSL_)(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(/* #__PURE__ */ showRecord(/* #__PURE__ */ Data_Show.showRecordFieldsCons(hIsSymbol)(/* #__PURE__ */ Data_Show.showRecordFieldsCons(lIsSymbol)(/* #__PURE__ */ Data_Show.showRecordFieldsConsNil(sIsSymbol)(Data_Show.showNumber))(Data_Show.showNumber))(Data_Show.showNumber))))({
        reflectSymbol: function () {
            return "HSL";
        }
    }))
};
var eqRGB = /* #__PURE__ */ eqRec(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ eqRowCons(rIsSymbol)(Data_Eq.eqNumber))()(gIsSymbol)(Data_Eq.eqNumber))()(bIsSymbol)(Data_Eq.eqNumber));
var eqHSL = /* #__PURE__ */ eqRec(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ eqRowCons(sIsSymbol)(Data_Eq.eqNumber))()(lIsSymbol)(Data_Eq.eqNumber))()(hIsSymbol)(Data_Eq.eqNumber));
var rgbToHsl = function (r) {
    return function (g) {
        return function (b) {
            var rn = r / 255.0;
            var gn = g / 255.0;
            var bn = b / 255.0;
            var maxVal = $$Math.max(rn)($$Math.max(gn)(bn));
            var minVal = $$Math.min(rn)($$Math.min(gn)(bn));
            var l = (maxVal + minVal) / 2.0;
            var $89 = maxVal === minVal;
            if ($89) {
                return {
                    h: 0.0,
                    s: 0.0,
                    l: l
                };
            };
            var d = maxVal - minVal;
            var h = (function () {
                var $90 = maxVal === rn;
                if ($90) {
                    return ((gn - bn) / d + (function () {
                        var $91 = gn < bn;
                        if ($91) {
                            return 6.0;
                        };
                        return 0.0;
                    })()) / 6.0;
                };
                var $92 = maxVal === gn;
                if ($92) {
                    return ((bn - rn) / d + 2.0) / 6.0;
                };
                return ((rn - gn) / d + 4.0) / 6.0;
            })();
            var s = (function () {
                var $93 = l > 0.5;
                if ($93) {
                    return d / (2.0 - maxVal - minVal);
                };
                return d / (maxVal + minVal);
            })();
            return {
                h: h,
                s: s,
                l: l
            };
        };
    };
};
var rgb = function (r) {
    return function (g) {
        return function (b) {
            return {
                r: r,
                g: g,
                b: b
            };
        };
    };
};
var hue2rgb = function (p) {
    return function (q) {
        return function (t0) {
            var t = (function () {
                var $94 = t0 < 0.0;
                if ($94) {
                    return t0 + 1.0;
                };
                var $95 = t0 > 1.0;
                if ($95) {
                    return t0 - 1.0;
                };
                return t0;
            })();
            var $96 = t < 1.0 / 6.0;
            if ($96) {
                return p + (q - p) * 6.0 * t;
            };
            var $97 = t < 1.0 / 2.0;
            if ($97) {
                return q;
            };
            var $98 = t < 2.0 / 3.0;
            if ($98) {
                return p + (q - p) * (2.0 / 3.0 - t) * 6.0;
            };
            return p;
        };
    };
};
var hslToRgb = function (v) {
    if (v.s === 0.0) {
        var v1 = $$Math.round(v.l * 255.0);
        return {
            r: v1,
            g: v1,
            b: v1
        };
    };
    if (Data_Boolean.otherwise) {
        var q = (function () {
            var $100 = v.l < 0.5;
            if ($100) {
                return v.l * (1.0 + v.s);
            };
            return (v.l + v.s) - v.l * v.s;
        })();
        var p = 2.0 * v.l - q;
        var r$prime = hue2rgb(p)(q)(v.h + 1.0 / 3.0);
        var g$prime = hue2rgb(p)(q)(v.h);
        var b$prime = hue2rgb(p)(q)(v.h - 1.0 / 3.0);
        return {
            r: $$Math.round(r$prime * 255.0),
            g: $$Math.round(g$prime * 255.0),
            b: $$Math.round(b$prime * 255.0)
        };
    };
    throw new Error("Failed pattern match at Lattice.Services.BlendModes.ColorSpace (line 134, column 1 - line 134, column 23): " + [ v.constructor.name ]);
};
var hsl$prime = function (h) {
    return function (s) {
        return function (l) {
            return {
                h: h,
                s: s,
                l: l
            };
        };
    };
};
var getSaturation = function (r) {
    return function (g) {
        return function (b) {
            var v = rgbToHsl(r)(g)(b);
            return v.s;
        };
    };
};
var getLuminance = function (r) {
    return function (g) {
        return function (b) {
            return 0.299 * r + 0.587 * g + 0.114 * b;
        };
    };
};
var getLuminanceNormalized = function (r) {
    return function (g) {
        return function (b) {
            return getLuminance(r)(g)(b) / 255.0;
        };
    };
};
var getLightness = function (r) {
    return function (g) {
        return function (b) {
            var v = rgbToHsl(r)(g)(b);
            return v.l;
        };
    };
};
var getHue = function (r) {
    return function (g) {
        return function (b) {
            var v = rgbToHsl(r)(g)(b);
            return v.h;
        };
    };
};
var clamp255 = function (value) {
    return $$Math.max(0.0)($$Math.min(255.0)(value));
};
var clampRound = function ($104) {
    return clamp255($$Math.round($104));
};
export {
    RGB,
    HSL,
    rgb,
    hsl$prime,
    rgbToHsl,
    hslToRgb,
    getLuminance,
    getLuminanceNormalized,
    getHue,
    getSaturation,
    getLightness,
    clamp255,
    clampRound,
    genericRGB_,
    eqRGB,
    showRGB,
    genericHSL_,
    eqHSL,
    showHSL
};
//# sourceMappingURL=index.js.map
