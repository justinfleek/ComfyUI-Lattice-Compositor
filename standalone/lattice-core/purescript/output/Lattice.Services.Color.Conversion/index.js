// Generated by purs version 0.15.15
import * as Data_EuclideanRing from "../Data.EuclideanRing/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as $$Math from "../Math/index.js";
var mod = /* #__PURE__ */ Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt);
var FeatureBrightness = /* #__PURE__ */ (function () {
    function FeatureBrightness() {

    };
    FeatureBrightness.value = new FeatureBrightness();
    return FeatureBrightness;
})();
var FeatureHue = /* #__PURE__ */ (function () {
    function FeatureHue() {

    };
    FeatureHue.value = new FeatureHue();
    return FeatureHue;
})();
var FeatureSaturation = /* #__PURE__ */ (function () {
    function FeatureSaturation() {

    };
    FeatureSaturation.value = new FeatureSaturation();
    return FeatureSaturation;
})();
var FeatureValue = /* #__PURE__ */ (function () {
    function FeatureValue() {

    };
    FeatureValue.value = new FeatureValue();
    return FeatureValue;
})();
var FeatureRed = /* #__PURE__ */ (function () {
    function FeatureRed() {

    };
    FeatureRed.value = new FeatureRed();
    return FeatureRed;
})();
var FeatureGreen = /* #__PURE__ */ (function () {
    function FeatureGreen() {

    };
    FeatureGreen.value = new FeatureGreen();
    return FeatureGreen;
})();
var FeatureBlue = /* #__PURE__ */ (function () {
    function FeatureBlue() {

    };
    FeatureBlue.value = new FeatureBlue();
    return FeatureBlue;
})();
var FeatureAlpha = /* #__PURE__ */ (function () {
    function FeatureAlpha() {

    };
    FeatureAlpha.value = new FeatureAlpha();
    return FeatureAlpha;
})();
var rgbToHsv = function (rgb) {
    var maxVal = $$Math.max(rgb.r)($$Math.max(rgb.g)(rgb.b));
    var minVal = $$Math.min(rgb.r)($$Math.min(rgb.g)(rgb.b));
    var d = maxVal - minVal;
    var s = (function () {
        var $9 = maxVal === 0.0;
        if ($9) {
            return 0.0;
        };
        return d / maxVal;
    })();
    var h = (function () {
        var $10 = maxVal === minVal;
        if ($10) {
            return 0.0;
        };
        var $11 = maxVal === rgb.r;
        if ($11) {
            var hRaw = (rgb.g - rgb.b) / d;
            var hAdj = (function () {
                var $12 = rgb.g < rgb.b;
                if ($12) {
                    return hRaw + 6.0;
                };
                return hRaw;
            })();
            return hAdj / 6.0;
        };
        var $13 = maxVal === rgb.g;
        if ($13) {
            return ((rgb.b - rgb.r) / d + 2.0) / 6.0;
        };
        return ((rgb.r - rgb.g) / d + 4.0) / 6.0;
    })();
    return {
        h: h,
        s: s,
        v: maxVal
    };
};
var hsvToRgb = function (hsv) {
    var $14 = hsv.s === 0.0;
    if ($14) {
        return {
            r: hsv.v,
            g: hsv.v,
            b: hsv.v
        };
    };
    var p = hsv.v * (1.0 - hsv.s);
    var h6 = hsv.h * 6.0;
    var i = mod(Data_Int.floor(h6))(6);
    var f = h6 - Data_Int.toNumber(Data_Int.floor(h6));
    var q = hsv.v * (1.0 - hsv.s * f);
    var t = hsv.v * (1.0 - hsv.s * (1.0 - f));
    if (i === 0) {
        return {
            r: hsv.v,
            g: t,
            b: p
        };
    };
    if (i === 1) {
        return {
            r: q,
            g: hsv.v,
            b: p
        };
    };
    if (i === 2) {
        return {
            r: p,
            g: hsv.v,
            b: t
        };
    };
    if (i === 3) {
        return {
            r: p,
            g: q,
            b: hsv.v
        };
    };
    if (i === 4) {
        return {
            r: t,
            g: p,
            b: hsv.v
        };
    };
    return {
        r: hsv.v,
        g: p,
        b: q
    };
};
var getFeatureValue = function (sample) {
    return function (feature) {
        if (feature instanceof FeatureBrightness) {
            return sample.brightness;
        };
        if (feature instanceof FeatureHue) {
            return sample.hue;
        };
        if (feature instanceof FeatureSaturation) {
            return sample.saturation;
        };
        if (feature instanceof FeatureValue) {
            return sample.value;
        };
        if (feature instanceof FeatureRed) {
            return sample.r;
        };
        if (feature instanceof FeatureGreen) {
            return sample.g;
        };
        if (feature instanceof FeatureBlue) {
            return sample.b;
        };
        if (feature instanceof FeatureAlpha) {
            return sample.a;
        };
        throw new Error("Failed pattern match at Lattice.Services.Color.Conversion (line 196, column 34 - line 204, column 27): " + [ feature.constructor.name ]);
    };
};
var eqColorFeature = {
    eq: function (x) {
        return function (y) {
            if (x instanceof FeatureBrightness && y instanceof FeatureBrightness) {
                return true;
            };
            if (x instanceof FeatureHue && y instanceof FeatureHue) {
                return true;
            };
            if (x instanceof FeatureSaturation && y instanceof FeatureSaturation) {
                return true;
            };
            if (x instanceof FeatureValue && y instanceof FeatureValue) {
                return true;
            };
            if (x instanceof FeatureRed && y instanceof FeatureRed) {
                return true;
            };
            if (x instanceof FeatureGreen && y instanceof FeatureGreen) {
                return true;
            };
            if (x instanceof FeatureBlue && y instanceof FeatureBlue) {
                return true;
            };
            if (x instanceof FeatureAlpha && y instanceof FeatureAlpha) {
                return true;
            };
            return false;
        };
    }
};
var clamp01 = function (x) {
    return $$Math.max(0.0)($$Math.min(1.0)(x));
};
var clampRGB = function (rgb) {
    return {
        r: clamp01(rgb.r),
        g: clamp01(rgb.g),
        b: clamp01(rgb.b)
    };
};
var clampRGBA = function (rgba) {
    return {
        r: clamp01(rgba.r),
        g: clamp01(rgba.g),
        b: clamp01(rgba.b),
        a: clamp01(rgba.a)
    };
};
var lerpRGB = function (a) {
    return function (b) {
        return function (t) {
            var tc = clamp01(t);
            return {
                r: a.r + (b.r - a.r) * tc,
                g: a.g + (b.g - a.g) * tc,
                b: a.b + (b.b - a.b) * tc
            };
        };
    };
};
var lerpRGBA = function (a) {
    return function (b) {
        return function (t) {
            var tc = clamp01(t);
            return {
                r: a.r + (b.r - a.r) * tc,
                g: a.g + (b.g - a.g) * tc,
                b: a.b + (b.b - a.b) * tc,
                a: a.a + (b.a - a.a) * tc
            };
        };
    };
};
var calculateBrightness = function (r) {
    return function (g) {
        return function (b) {
            return 0.2126 * r + 0.7152 * g + 7.22e-2 * b;
        };
    };
};
var createColorSample = function (r) {
    return function (g) {
        return function (b) {
            return function (a) {
                var hsv = rgbToHsv({
                    r: r,
                    g: g,
                    b: b
                });
                var brightness = calculateBrightness(r)(g)(b);
                return {
                    r: r,
                    g: g,
                    b: b,
                    a: a,
                    brightness: brightness,
                    hue: hsv.h,
                    saturation: hsv.s,
                    value: hsv.v
                };
            };
        };
    };
};
var colorSampleFromRGB = function (rgb) {
    return function (a) {
        return createColorSample(rgb.r)(rgb.g)(rgb.b)(a);
    };
};
var colorSampleFromRGBA = function (rgba) {
    return createColorSample(rgba.r)(rgba.g)(rgba.b)(rgba.a);
};
var emptyColorSample = /* #__PURE__ */ createColorSample(0.0)(0.0)(0.0)(0.0);
var rgbBrightness = function (rgb) {
    return calculateBrightness(rgb.r)(rgb.g)(rgb.b);
};
export {
    FeatureBrightness,
    FeatureHue,
    FeatureSaturation,
    FeatureValue,
    FeatureRed,
    FeatureGreen,
    FeatureBlue,
    FeatureAlpha,
    rgbToHsv,
    hsvToRgb,
    calculateBrightness,
    rgbBrightness,
    createColorSample,
    colorSampleFromRGB,
    colorSampleFromRGBA,
    emptyColorSample,
    getFeatureValue,
    clamp01,
    clampRGB,
    clampRGBA,
    lerpRGB,
    lerpRGBA,
    eqColorFeature
};
//# sourceMappingURL=index.js.map
