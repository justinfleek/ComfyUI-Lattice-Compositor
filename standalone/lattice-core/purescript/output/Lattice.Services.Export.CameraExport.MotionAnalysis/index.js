// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Number from "../Data.Number/index.js";
import * as Lattice_Services_Export_CameraExport_Types from "../Lattice.Services.Export.CameraExport.Types/index.js";
var zoomThreshold = 50.0;
var rotationThreshold = 5.0;
var panThreshold = 30.0;
var orbitThreshold = 20.0;
var max = function (a) {
    return function (b) {
        var $8 = a > b;
        if ($8) {
            return a;
        };
        return b;
    };
};
var detectDominantMotion = function (motion) {
    if (motion.hasOrbit) {
        return "orbit";
    };
    if (motion.hasZoom && motion.hasPan) {
        return "zoom_pan";
    };
    if (motion.hasZoom) {
        return "zoom";
    };
    if (motion.hasPan) {
        return "pan";
    };
    if (motion.hasRotation) {
        return "rotation";
    };
    if (Data_Boolean.otherwise) {
        return "static";
    };
    throw new Error("Failed pattern match at Lattice.Services.Export.CameraExport.MotionAnalysis (line 148, column 1 - line 148, column 55): " + [ motion.constructor.name ]);
};
var analyzeKeyframePair = function (first) {
    return function (last) {
        var defaultVec = {
            x: 0.0,
            y: 0.0,
            z: 0.0
        };
        var firstOri = Data_Maybe.fromMaybe(defaultVec)(first.orientation);
        var firstPos = Data_Maybe.fromMaybe(defaultVec)(first.position);
        var lastOri = Data_Maybe.fromMaybe(defaultVec)(last.orientation);
        var deltaRy = lastOri.y - firstOri.y;
        var hasRotation = Data_Number.abs(deltaRy) > rotationThreshold;
        var orbitMagnitude = Data_Number.abs(deltaRy);
        var rotationMagnitude = Data_Number.abs(deltaRy);
        var lastPos = Data_Maybe.fromMaybe(defaultVec)(last.position);
        var deltaX = lastPos.x - firstPos.x;
        var hasOrbit = Data_Number.abs(deltaRy) > orbitThreshold && Data_Number.abs(deltaX) > panThreshold;
        var orbitDirection = (function () {
            var $10 = !hasOrbit;
            if ($10) {
                return Data_Maybe.Nothing.value;
            };
            var $11 = deltaRy > 0.0;
            if ($11) {
                return new Data_Maybe.Just(Lattice_Services_Export_CameraExport_Types.OrbitRight.value);
            };
            return new Data_Maybe.Just(Lattice_Services_Export_CameraExport_Types.OrbitLeft.value);
        })();
        var panX = Data_Number.abs(deltaX);
        var hasPanX = panX > panThreshold;
        var deltaY = lastPos.y - firstPos.y;
        var panY = Data_Number.abs(deltaY);
        var hasPanY = panY > panThreshold;
        var hasPan = hasPanX || hasPanY;
        var panDirection = (function () {
            var $12 = !hasPan;
            if ($12) {
                return Data_Maybe.Nothing.value;
            };
            var $13 = panX > panY;
            if ($13) {
                var $14 = deltaX > 0.0;
                if ($14) {
                    return new Data_Maybe.Just(Lattice_Services_Export_CameraExport_Types.PanRight.value);
                };
                return new Data_Maybe.Just(Lattice_Services_Export_CameraExport_Types.PanLeft.value);
            };
            var $15 = deltaY > 0.0;
            if ($15) {
                return new Data_Maybe.Just(Lattice_Services_Export_CameraExport_Types.PanDown.value);
            };
            return new Data_Maybe.Just(Lattice_Services_Export_CameraExport_Types.PanUp.value);
        })();
        var panMagnitude = max(panX)(panY);
        var deltaZ = lastPos.z - firstPos.z;
        var hasZoom = Data_Number.abs(deltaZ) > zoomThreshold;
        var zoomDirection = (function () {
            var $16 = !hasZoom;
            if ($16) {
                return Data_Maybe.Nothing.value;
            };
            var $17 = deltaZ < 0.0;
            if ($17) {
                return new Data_Maybe.Just(Lattice_Services_Export_CameraExport_Types.ZoomIn.value);
            };
            return new Data_Maybe.Just(Lattice_Services_Export_CameraExport_Types.ZoomOut.value);
        })();
        var zoomMagnitude = Data_Number.abs(deltaZ);
        return {
            hasPan: hasPan,
            panDirection: panDirection,
            panMagnitude: panMagnitude,
            hasZoom: hasZoom,
            zoomDirection: zoomDirection,
            zoomMagnitude: zoomMagnitude,
            hasOrbit: hasOrbit,
            orbitDirection: orbitDirection,
            orbitMagnitude: orbitMagnitude,
            hasRotation: hasRotation,
            rotationMagnitude: rotationMagnitude
        };
    };
};
var analyzeCameraMotion = function (keyframes) {
    var $18 = Data_Array.length(keyframes) < 2;
    if ($18) {
        return Lattice_Services_Export_CameraExport_Types.defaultMotionAnalysis;
    };
    var $19 = {
        first: Data_Array.index(keyframes)(0),
        last: Data_Array.index(keyframes)(Data_Array.length(keyframes) - 1 | 0)
    };
    if ($19.first instanceof Data_Maybe.Just && $19.last instanceof Data_Maybe.Just) {
        return analyzeKeyframePair($19.first.value0)($19.last.value0);
    };
    return Lattice_Services_Export_CameraExport_Types.defaultMotionAnalysis;
};
export {
    analyzeCameraMotion,
    detectDominantMotion,
    panThreshold,
    zoomThreshold,
    orbitThreshold,
    rotationThreshold
};
//# sourceMappingURL=index.js.map
