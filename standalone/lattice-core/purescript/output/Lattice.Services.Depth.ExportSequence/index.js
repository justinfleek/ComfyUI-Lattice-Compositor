// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var FormatRaw = /* #__PURE__ */ (function () {
    function FormatRaw() {

    };
    FormatRaw.value = new FormatRaw();
    return FormatRaw;
})();
var FormatMidas = /* #__PURE__ */ (function () {
    function FormatMidas() {

    };
    FormatMidas.value = new FormatMidas();
    return FormatMidas;
})();
var FormatDepthAnything = /* #__PURE__ */ (function () {
    function FormatDepthAnything() {

    };
    FormatDepthAnything.value = new FormatDepthAnything();
    return FormatDepthAnything;
})();
var FormatZoeDepth = /* #__PURE__ */ (function () {
    function FormatZoeDepth() {

    };
    FormatZoeDepth.value = new FormatZoeDepth();
    return FormatZoeDepth;
})();
var FormatMarigold = /* #__PURE__ */ (function () {
    function FormatMarigold() {

    };
    FormatMarigold.value = new FormatMarigold();
    return FormatMarigold;
})();
var FormatGrayscale8 = /* #__PURE__ */ (function () {
    function FormatGrayscale8() {

    };
    FormatGrayscale8.value = new FormatGrayscale8();
    return FormatGrayscale8;
})();
var FormatGrayscale16 = /* #__PURE__ */ (function () {
    function FormatGrayscale16() {

    };
    FormatGrayscale16.value = new FormatGrayscale16();
    return FormatGrayscale16;
})();
var validateOptions = function (options) {
    return options.width > 0 && (options.height > 0 && options.endFrame >= options.startFrame);
};
var totalFrames = function (startFrame) {
    return function (endFrame) {
        if (endFrame >= startFrame) {
            return (endFrame - startFrame | 0) + 1 | 0;
        };
        if (Data_Boolean.otherwise) {
            return 0;
        };
        throw new Error("Failed pattern match at Lattice.Services.Depth.ExportSequence (line 115, column 1 - line 115, column 33): " + [ startFrame.constructor.name, endFrame.constructor.name ]);
    };
};
var showDepthMapFormat = {
    show: function (v) {
        if (v instanceof FormatRaw) {
            return "raw";
        };
        if (v instanceof FormatMidas) {
            return "midas";
        };
        if (v instanceof FormatDepthAnything) {
            return "depth-anything";
        };
        if (v instanceof FormatZoeDepth) {
            return "zoe-depth";
        };
        if (v instanceof FormatMarigold) {
            return "marigold";
        };
        if (v instanceof FormatGrayscale8) {
            return "grayscale-8";
        };
        if (v instanceof FormatGrayscale16) {
            return "grayscale-16";
        };
        throw new Error("Failed pattern match at Lattice.Services.Depth.ExportSequence (line 62, column 1 - line 69, column 42): " + [ v.constructor.name ]);
    }
};
var progressPercent = function (progress) {
    if (progress.totalFrames === 0) {
        return 100.0;
    };
    if (Data_Boolean.otherwise) {
        return (Data_Int.toNumber(progress.currentFrame) / Data_Int.toNumber(progress.totalFrames)) * 100.0;
    };
    throw new Error("Failed pattern match at Lattice.Services.Depth.ExportSequence (line 243, column 1 - line 243, column 44): " + [ progress.constructor.name ]);
};
var padNumber = function (n) {
    return function (width) {
        var s = show(n);
        var paddingLen = width - Data_String_CodePoints.length(s) | 0;
        var padding = Data_String_CodeUnits.fromCharArray(map(Data_Function["const"]("0"))(Data_Array.range(1)(paddingLen)));
        var $19 = paddingLen > 0;
        if ($19) {
            return padding + s;
        };
        return s;
    };
};
var isValidOutputDir = function (path) {
    return Data_String_CodePoints.length(path) > 0 && Data_String_CodePoints.take(1)(path) !== " ";
};
var isComplete = function (progress) {
    return progress.currentFrame >= progress.totalFrames;
};
var generatorName = "Lattice Compositor";
var frameIndices = function (startFrame) {
    return function (endFrame) {
        return Data_Array.range(0)(totalFrames(startFrame)(endFrame) - 1 | 0);
    };
};
var frameFromIndex = function (startFrame) {
    return function (index) {
        return startFrame + index | 0;
    };
};
var formatNormalized = function (format) {
    if (format instanceof FormatRaw) {
        return false;
    };
    if (format instanceof FormatZoeDepth) {
        return false;
    };
    return true;
};
var formatNearClip = function (format) {
    if (format instanceof FormatZoeDepth) {
        return 1.0e-3;
    };
    return 0.1;
};
var formatInverted = function (format) {
    if (format instanceof FormatMidas) {
        return true;
    };
    if (format instanceof FormatDepthAnything) {
        return true;
    };
    return false;
};
var formatFarClip = function (format) {
    if (format instanceof FormatZoeDepth) {
        return 80.0;
    };
    return 100.0;
};
var formatBitDepth = function (format) {
    if (format instanceof FormatRaw) {
        return 32;
    };
    if (format instanceof FormatGrayscale8) {
        return 8;
    };
    return 16;
};
var eqDepthMapFormat = {
    eq: function (x) {
        return function (y) {
            if (x instanceof FormatRaw && y instanceof FormatRaw) {
                return true;
            };
            if (x instanceof FormatMidas && y instanceof FormatMidas) {
                return true;
            };
            if (x instanceof FormatDepthAnything && y instanceof FormatDepthAnything) {
                return true;
            };
            if (x instanceof FormatZoeDepth && y instanceof FormatZoeDepth) {
                return true;
            };
            if (x instanceof FormatMarigold && y instanceof FormatMarigold) {
                return true;
            };
            if (x instanceof FormatGrayscale8 && y instanceof FormatGrayscale8) {
                return true;
            };
            if (x instanceof FormatGrayscale16 && y instanceof FormatGrayscale16) {
                return true;
            };
            return false;
        };
    }
};
var depthFilename = function (frameIndex) {
    return "depth_" + (padNumber(frameIndex)(5) + ".png");
};
var depthOutputPath = function (outputDir) {
    return function (frameIndex) {
        return outputDir + ("/depth/" + depthFilename(frameIndex));
    };
};
var createProgress = function (currentFrame) {
    return function (totalFrames$prime) {
        return {
            currentFrame: currentFrame,
            totalFrames: totalFrames$prime
        };
    };
};
var createDepthMetadata = function (format) {
    return function (frameCount) {
        return function (width) {
            return function (height) {
                return function (minDepth) {
                    return function (maxDepth) {
                        return function (timestamp) {
                            return {
                                format: format,
                                bitDepth: formatBitDepth(format),
                                nearClip: formatNearClip(format),
                                farClip: formatFarClip(format),
                                inverted: formatInverted(format),
                                normalized: formatNormalized(format),
                                frameCount: frameCount,
                                width: width,
                                height: height,
                                actualRangeMin: minDepth,
                                actualRangeMax: maxDepth,
                                generatedAt: timestamp,
                                generator: generatorName
                            };
                        };
                    };
                };
            };
        };
    };
};
var metadataFromOptions = function (options) {
    return function (minDepth) {
        return function (maxDepth) {
            return function (timestamp) {
                return createDepthMetadata(options.format)(totalFrames(options.startFrame)(options.endFrame))(options.width)(options.height)(minDepth)(maxDepth)(timestamp);
            };
        };
    };
};
var allOutputPaths = function (options) {
    var total = totalFrames(options.startFrame)(options.endFrame);
    return map(depthOutputPath(options.outputDir))(Data_Array.range(0)(total - 1 | 0));
};
export {
    FormatRaw,
    FormatMidas,
    FormatDepthAnything,
    FormatZoeDepth,
    FormatMarigold,
    FormatGrayscale8,
    FormatGrayscale16,
    totalFrames,
    frameFromIndex,
    frameIndices,
    padNumber,
    depthFilename,
    depthOutputPath,
    allOutputPaths,
    formatBitDepth,
    formatNearClip,
    formatFarClip,
    formatNormalized,
    formatInverted,
    generatorName,
    createDepthMetadata,
    metadataFromOptions,
    createProgress,
    progressPercent,
    isComplete,
    validateOptions,
    isValidOutputDir,
    eqDepthMapFormat,
    showDepthMapFormat
};
//# sourceMappingURL=index.js.map
