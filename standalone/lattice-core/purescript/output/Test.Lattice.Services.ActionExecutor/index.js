// Generated by purs version 0.15.15
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Identity from "../Data.Identity/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Number from "../Data.Number/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as $$Math from "../Math/index.js";
import * as Test_Lattice_TestHelpers from "../Test.Lattice.TestHelpers/index.js";
import * as Test_Spec from "../Test.Spec/index.js";
import * as Test_Spec_Assertions from "../Test.Spec.Assertions/index.js";
var describe = /* #__PURE__ */ Test_Spec.describe(Data_Identity.monadIdentity);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit);
var discard1 = /* #__PURE__ */ discard(/* #__PURE__ */ Test_Spec.bindSpecT(Data_Identity.bindIdentity));
var it = /* #__PURE__ */ Test_Spec.it(Data_Identity.monadIdentity)(Test_Spec.exampleMUnit);
var discard2 = /* #__PURE__ */ discard(Effect_Aff.bindAff);
var shouldEqual = /* #__PURE__ */ Test_Spec_Assertions.shouldEqual(Effect_Aff.monadThrowAff)(Data_Show.showNumber)(Data_Eq.eqNumber);
var safeComponent = function (v) {
    if (v instanceof Data_Maybe.Just && Data_Number["isFinite"](v.value0)) {
        return v.value0;
    };
    return 0.0;
};
var calculateWindStrength = function (v) {
    if (v instanceof Data_Maybe.Nothing) {
        return 0.0;
    };
    if (v instanceof Data_Maybe.Just) {
        var windY = safeComponent(v.value0.y);
        var windX = safeComponent(v.value0.x);
        return $$Math.sqrt(windX * windX + windY * windY);
    };
    throw new Error("Failed pattern match at Test.Lattice.Services.ActionExecutor (line 28, column 1 - line 28, column 46): " + [ v.constructor.name ]);
};
var windStrengthTests = /* #__PURE__ */ (function () {
    return describe("wind strength calculation")(discard1(it("calculates wind strength correctly")(discard2(shouldEqual(calculateWindStrength(new Data_Maybe.Just({
        x: new Data_Maybe.Just(3.0),
        y: new Data_Maybe.Just(4.0)
    })))(5.0))(function () {
        return discard2(shouldEqual(calculateWindStrength(new Data_Maybe.Just({
            x: new Data_Maybe.Just(5.0),
            y: new Data_Maybe.Just(0.0)
        })))(5.0))(function () {
            return discard2(shouldEqual(calculateWindStrength(new Data_Maybe.Just({
                x: new Data_Maybe.Just(0.0),
                y: new Data_Maybe.Just(5.0)
            })))(5.0))(function () {
                return shouldEqual(calculateWindStrength(new Data_Maybe.Just({
                    x: new Data_Maybe.Just(0.0),
                    y: new Data_Maybe.Just(0.0)
                })))(0.0);
            });
        });
    })))(function () {
        return discard1(it("returns 0 for missing wind")(shouldEqual(calculateWindStrength(Data_Maybe.Nothing.value))(0.0)))(function () {
            return discard1(it("BUG #6 FIXED: missing x returns finite number instead of NaN")(discard2(shouldEqual(calculateWindStrength(new Data_Maybe.Just({
                x: Data_Maybe.Nothing.value,
                y: new Data_Maybe.Just(4.0)
            })))(4.0))(function () {
                return Test_Lattice_TestHelpers.assertFinite(calculateWindStrength(new Data_Maybe.Just({
                    x: Data_Maybe.Nothing.value,
                    y: new Data_Maybe.Just(4.0)
                })));
            })))(function () {
                return discard1(it("BUG #6 FIXED: missing y returns finite number instead of NaN")(discard2(shouldEqual(calculateWindStrength(new Data_Maybe.Just({
                    x: new Data_Maybe.Just(3.0),
                    y: Data_Maybe.Nothing.value
                })))(3.0))(function () {
                    return Test_Lattice_TestHelpers.assertFinite(calculateWindStrength(new Data_Maybe.Just({
                        x: new Data_Maybe.Just(3.0),
                        y: Data_Maybe.Nothing.value
                    })));
                })))(function () {
                    return it("BUG #6 FIXED: empty object returns 0 instead of NaN")(discard2(shouldEqual(calculateWindStrength(new Data_Maybe.Just({
                        x: Data_Maybe.Nothing.value,
                        y: Data_Maybe.Nothing.value
                    })))(0.0))(function () {
                        return Test_Lattice_TestHelpers.assertFinite(calculateWindStrength(new Data_Maybe.Just({
                            x: Data_Maybe.Nothing.value,
                            y: Data_Maybe.Nothing.value
                        })));
                    }));
                });
            });
        });
    }));
})();
var calculateWindDirection = function (v) {
    if (v instanceof Data_Maybe.Nothing) {
        return 0.0;
    };
    if (v instanceof Data_Maybe.Just) {
        var windY = safeComponent(v.value0.y);
        var windX = safeComponent(v.value0.x);
        return $$Math.atan2(windY)(windX) * (180.0 / $$Math.pi);
    };
    throw new Error("Failed pattern match at Test.Lattice.Services.ActionExecutor (line 39, column 1 - line 39, column 47): " + [ v.constructor.name ]);
};
var windDirectionTests = /* #__PURE__ */ (function () {
    return describe("wind direction calculation")(discard1(it("calculates wind direction correctly")(discard2(shouldEqual(calculateWindDirection(new Data_Maybe.Just({
        x: new Data_Maybe.Just(1.0),
        y: new Data_Maybe.Just(0.0)
    })))(0.0))(function () {
        return discard2(Test_Lattice_TestHelpers.assertCloseTo(1.0e-10)(90.0)(calculateWindDirection(new Data_Maybe.Just({
            x: new Data_Maybe.Just(0.0),
            y: new Data_Maybe.Just(1.0)
        }))))(function () {
            return Test_Lattice_TestHelpers.assertCloseTo(1.0e-5)(180.0)(calculateWindDirection(new Data_Maybe.Just({
                x: new Data_Maybe.Just(-1.0),
                y: new Data_Maybe.Just(0.0)
            })));
        });
    })))(function () {
        return it("BUG #6 FIXED: missing props return correct degrees instead of NaN")(discard2(Test_Lattice_TestHelpers.assertCloseTo(1.0e-10)(90.0)(calculateWindDirection(new Data_Maybe.Just({
            x: Data_Maybe.Nothing.value,
            y: new Data_Maybe.Just(1.0)
        }))))(function () {
            return discard2(shouldEqual(calculateWindDirection(new Data_Maybe.Just({
                x: new Data_Maybe.Just(1.0),
                y: Data_Maybe.Nothing.value
            })))(0.0))(function () {
                return discard2(shouldEqual(calculateWindDirection(new Data_Maybe.Just({
                    x: Data_Maybe.Nothing.value,
                    y: Data_Maybe.Nothing.value
                })))(0.0))(function () {
                    return Test_Lattice_TestHelpers.assertFinite(calculateWindDirection(new Data_Maybe.Just({
                        x: Data_Maybe.Nothing.value,
                        y: Data_Maybe.Nothing.value
                    })));
                });
            });
        }));
    }));
})();
var spec = /* #__PURE__ */ describe("ActionExecutor physics calculations")(/* #__PURE__ */ discard1(windStrengthTests)(function () {
    return windDirectionTests;
}));
export {
    spec
};
//# sourceMappingURL=index.js.map
