// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_State_Class from "../Control.Monad.State.Class/index.js";
import * as DOM_HTML_Indexed_ButtonType from "../DOM.HTML.Indexed.ButtonType/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect from "../Effect/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as Foreign_Object from "../Foreign.Object/index.js";
import * as Halogen_Component from "../Halogen.Component/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Events from "../Halogen.HTML.Events/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Halogen_HTML_Properties_ARIA from "../Halogen.HTML.Properties.ARIA/index.js";
import * as Halogen_Query_HalogenM from "../Halogen.Query.HalogenM/index.js";
import * as Web_DOM_NonElementParentNode from "../Web.DOM.NonElementParentNode/index.js";
import * as Web_Event_Event from "../Web.Event.Event/index.js";
import * as Web_HTML from "../Web.HTML/index.js";
import * as Web_HTML_HTMLDocument from "../Web.HTML.HTMLDocument/index.js";
import * as Web_HTML_HTMLElement from "../Web.HTML.HTMLElement/index.js";
import * as Web_HTML_Window from "../Web.HTML.Window/index.js";
import * as Web_UIEvent_KeyboardEvent from "../Web.UIEvent.KeyboardEvent/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var type_ = /* #__PURE__ */ Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropButtonType);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showBoolean);
var bind = /* #__PURE__ */ Control_Bind.bind(Effect.bindEffect);
var bind1 = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var pure1 = /* #__PURE__ */ Control_Applicative.pure(Halogen_Query_HalogenM.applicativeHalogenM);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(Halogen_Query_HalogenM.bindHalogenM);
var bind2 = /* #__PURE__ */ Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM);
var get = /* #__PURE__ */ Control_Monad_State_Class.get(Halogen_Query_HalogenM.monadStateHalogenM);
var when = /* #__PURE__ */ Control_Applicative.when(Halogen_Query_HalogenM.applicativeHalogenM);
var modify_ = /* #__PURE__ */ Control_Monad_State_Class.modify_(Halogen_Query_HalogenM.monadStateHalogenM);
var for_ = /* #__PURE__ */ Data_Foldable.for_(Halogen_Query_HalogenM.applicativeHalogenM)(Data_Foldable.foldableMaybe);
var SetValue = /* #__PURE__ */ (function () {
    function SetValue(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    SetValue.create = function (value0) {
        return function (value1) {
            return new SetValue(value0, value1);
        };
    };
    return SetValue;
})();
var GetValue = /* #__PURE__ */ (function () {
    function GetValue(value0) {
        this.value0 = value0;
    };
    GetValue.create = function (value0) {
        return new GetValue(value0);
    };
    return GetValue;
})();
var ValueChanged = /* #__PURE__ */ (function () {
    function ValueChanged(value0) {
        this.value0 = value0;
    };
    ValueChanged.create = function (value0) {
        return new ValueChanged(value0);
    };
    return ValueChanged;
})();
var Horizontal = /* #__PURE__ */ (function () {
    function Horizontal() {

    };
    Horizontal.value = new Horizontal();
    return Horizontal;
})();
var Vertical = /* #__PURE__ */ (function () {
    function Vertical() {

    };
    Vertical.value = new Vertical();
    return Vertical;
})();
var Automatic = /* #__PURE__ */ (function () {
    function Automatic() {

    };
    Automatic.value = new Automatic();
    return Automatic;
})();
var Manual = /* #__PURE__ */ (function () {
    function Manual() {

    };
    Manual.value = new Manual();
    return Manual;
})();
var Initialize = /* #__PURE__ */ (function () {
    function Initialize() {

    };
    Initialize.value = new Initialize();
    return Initialize;
})();
var Receive = /* #__PURE__ */ (function () {
    function Receive(value0) {
        this.value0 = value0;
    };
    Receive.create = function (value0) {
        return new Receive(value0);
    };
    return Receive;
})();
var SelectTab = /* #__PURE__ */ (function () {
    function SelectTab(value0) {
        this.value0 = value0;
    };
    SelectTab.create = function (value0) {
        return new SelectTab(value0);
    };
    return SelectTab;
})();
var HandleKeyDown = /* #__PURE__ */ (function () {
    function HandleKeyDown(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    HandleKeyDown.create = function (value0) {
        return function (value1) {
            return new HandleKeyDown(value0, value1);
        };
    };
    return HandleKeyDown;
})();
var renderTabPanel = function (dictMonadAff) {
    return function (panels) {
        return function (state) {
            return function (tab) {
                var tabId = state.baseId + ("-tab-" + tab.value);
                var panelId = state.baseId + ("-panel-" + tab.value);
                var panelContent = Data_Maybe.fromMaybe(Halogen_HTML_Core.text(""))(Foreign_Object.lookup(tab.value)(panels));
                var isSelected = tab.value === state.selectedValue;
                if (isSelected) {
                    return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.class_("lattice-tabs-content"), Halogen_HTML_Properties.id(panelId), Halogen_HTML_Properties.attr("role")("tabpanel"), Halogen_HTML_Properties.tabIndex(0), Halogen_HTML_Properties_ARIA.labelledBy(tabId), Halogen_HTML_Properties.attr("data-state")("active") ])([ panelContent ]);
                };
                return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.class_("lattice-tabs-content"), Halogen_HTML_Properties.id(panelId), Halogen_HTML_Properties.attr("role")("tabpanel"), Halogen_HTML_Properties.tabIndex(-1 | 0), Halogen_HTML_Properties_ARIA.labelledBy(tabId), Halogen_HTML_Properties.attr("data-state")("inactive"), Halogen_HTML_Properties.attr("hidden")("true") ])([  ]);
            };
        };
    };
};
var renderTabPanels = function (dictMonadAff) {
    var renderTabPanel1 = renderTabPanel(dictMonadAff);
    return function (panels) {
        return function (state) {
            return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.class_("lattice-tabs-panels") ])(map(renderTabPanel1(panels)(state))(state.input.tabs));
        };
    };
};
var renderTab = function (state) {
    return function (idx) {
        return function (tab) {
            var tabId = state.baseId + ("-tab-" + tab.value);
            var panelId = state.baseId + ("-panel-" + tab.value);
            var isSelected = tab.value === state.selectedValue;
            return Halogen_HTML_Elements.button([ Halogen_HTML_Properties.class_("lattice-tabs-trigger"), type_(DOM_HTML_Indexed_ButtonType.ButtonButton.value), Halogen_HTML_Properties.id(tabId), Halogen_HTML_Properties.disabled(tab.disabled), Halogen_HTML_Properties.tabIndex((function () {
                if (isSelected) {
                    return 0;
                };
                return -1 | 0;
            })()), Halogen_HTML_Properties.attr("role")("tab"), Halogen_HTML_Properties_ARIA.selected(show(isSelected)), Halogen_HTML_Properties_ARIA.controls(panelId), Halogen_HTML_Properties.attr("data-state")((function () {
                if (isSelected) {
                    return "active";
                };
                return "inactive";
            })()), Halogen_HTML_Properties.attr("data-disabled")((function () {
                if (tab.disabled) {
                    return "true";
                };
                return "false";
            })()), Halogen_HTML_Events.onClick(function (v) {
                return new SelectTab(tab.value);
            }), Halogen_HTML_Events.onKeyDown(HandleKeyDown.create(idx)) ])([ Halogen_HTML_Core.text(tab.label) ]);
        };
    };
};
var prevEnabledTab = function (indices) {
    return function (mCurrent) {
        return function (loop) {
            if (mCurrent instanceof Data_Maybe.Nothing) {
                return Data_Array.last(indices);
            };
            if (mCurrent instanceof Data_Maybe.Just) {
                var prev = mCurrent.value0 - 1 | 0;
                var $63 = prev < 0;
                if ($63) {
                    if (loop) {
                        return Data_Array.last(indices);
                    };
                    return Data_Maybe.Nothing.value;
                };
                return Data_Array.index(indices)(prev);
            };
            throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 305, column 3 - line 311, column 39): " + [ mCurrent.constructor.name ]);
        };
    };
};
var orientationStr = function (v) {
    if (v instanceof Horizontal) {
        return "horizontal";
    };
    if (v instanceof Vertical) {
        return "vertical";
    };
    throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 236, column 1 - line 236, column 40): " + [ v.constructor.name ]);
};
var renderTabList = function (state) {
    return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.class_("lattice-tabs-list"), Halogen_HTML_Properties.attr("role")("tablist"), Halogen_HTML_Properties.attr("aria-orientation")(orientationStr(state.input.orientation)) ])(Data_Array.mapWithIndex(renderTab(state))(state.input.tabs));
};
var renderWithPanels = function (dictMonadAff) {
    var renderTabPanels1 = renderTabPanels(dictMonadAff);
    return function (panels) {
        return function (state) {
            return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.class_("lattice-tabs-root"), Halogen_HTML_Properties.attr("data-orientation")(orientationStr(state.input.orientation)) ])([ renderTabList(state), renderTabPanels1(panels)(state) ]);
        };
    };
};
var nextEnabledTab = function (indices) {
    return function (mCurrent) {
        return function (loop) {
            if (mCurrent instanceof Data_Maybe.Nothing) {
                return Data_Array.head(indices);
            };
            if (mCurrent instanceof Data_Maybe.Just) {
                var next = mCurrent.value0 + 1 | 0;
                var $68 = next >= Data_Array.length(indices);
                if ($68) {
                    if (loop) {
                        return Data_Array.head(indices);
                    };
                    return Data_Maybe.Nothing.value;
                };
                return Data_Array.index(indices)(next);
            };
            throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 295, column 3 - line 301, column 39): " + [ mCurrent.constructor.name ]);
        };
    };
};
var initialState = function (input) {
    var getInitialValue = function (i) {
        if (i.value instanceof Data_Maybe.Just) {
            return i.value.value0;
        };
        if (i.value instanceof Data_Maybe.Nothing) {
            if (i.defaultValue instanceof Data_Maybe.Just) {
                return i.defaultValue.value0;
            };
            if (i.defaultValue instanceof Data_Maybe.Nothing) {
                var v = Data_Array.head(Data_Array.filter(function ($108) {
                    return !(function (v1) {
                        return v1.disabled;
                    })($108);
                })(i.tabs));
                if (v instanceof Data_Maybe.Just) {
                    return v.value0.value;
                };
                if (v instanceof Data_Maybe.Nothing) {
                    return "";
                };
                throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 144, column 20 - line 146, column 24): " + [ v.constructor.name ]);
            };
            throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 142, column 18 - line 146, column 24): " + [ i.defaultValue.constructor.name ]);
        };
        throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 140, column 5 - line 146, column 24): " + [ i.value.constructor.name ]);
    };
    return {
        selectedValue: getInitialValue(input),
        input: input,
        baseId: "lattice-tabs"
    };
};
var getElementById = function (id) {
    return function (doc) {
        return function __do() {
            var mElement = Web_DOM_NonElementParentNode.getElementById(id)(Web_HTML_HTMLDocument.toNonElementParentNode(doc))();
            return bind1(mElement)(Web_HTML_HTMLElement.fromElement);
        };
    };
};
var eqOrientation = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Horizontal && y instanceof Horizontal) {
                return true;
            };
            if (x instanceof Vertical && y instanceof Vertical) {
                return true;
            };
            return false;
        };
    }
};
var eqActivationMode = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Automatic && y instanceof Automatic) {
                return true;
            };
            if (x instanceof Manual && y instanceof Manual) {
                return true;
            };
            return false;
        };
    }
};
var eq2 = /* #__PURE__ */ Data_Eq.eq(eqActivationMode);
var handleAction = function (dictMonadAff) {
    var liftEffect = Effect_Class.liftEffect(Halogen_Query_HalogenM.monadEffectHalogenM(dictMonadAff.MonadEffect0()));
    return function (v) {
        if (v instanceof Initialize) {
            return pure1(Data_Unit.unit);
        };
        if (v instanceof Receive) {
            return discard((function () {
                if (v.value0.value instanceof Data_Maybe.Just) {
                    return bind2(get)(function (state) {
                        return when(v.value0.value.value0 !== state.selectedValue)(modify_(function (v1) {
                            var $83 = {};
                            for (var $84 in v1) {
                                if ({}.hasOwnProperty.call(v1, $84)) {
                                    $83[$84] = v1[$84];
                                };
                            };
                            $83.selectedValue = v.value0.value.value0;
                            return $83;
                        }));
                    });
                };
                if (v.value0.value instanceof Data_Maybe.Nothing) {
                    return pure1(Data_Unit.unit);
                };
                throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 245, column 5 - line 250, column 27): " + [ v.value0.value.constructor.name ]);
            })())(function () {
                return modify_(function (v1) {
                    var $87 = {};
                    for (var $88 in v1) {
                        if ({}.hasOwnProperty.call(v1, $88)) {
                            $87[$88] = v1[$88];
                        };
                    };
                    $87.input = v.value0;
                    return $87;
                });
            });
        };
        if (v instanceof SelectTab) {
            return bind2(get)(function (state) {
                var mTab = Data_Array.find(function (t) {
                    return t.value === v.value0;
                })(state.input.tabs);
                if (mTab instanceof Data_Maybe.Just && !mTab.value0.disabled) {
                    return discard(modify_(function (v1) {
                        var $92 = {};
                        for (var $93 in v1) {
                            if ({}.hasOwnProperty.call(v1, $93)) {
                                $92[$93] = v1[$93];
                            };
                        };
                        $92.selectedValue = v.value0;
                        return $92;
                    }))(function () {
                        return Halogen_Query_HalogenM.raise(new ValueChanged(v.value0));
                    });
                };
                return pure1(Data_Unit.unit);
            });
        };
        if (v instanceof HandleKeyDown) {
            return bind2(get)(function (state) {
                var key = Web_UIEvent_KeyboardEvent.key(v.value1);
                var enabledIndices = Data_Array.catMaybes(Data_Array.mapWithIndex(function (i) {
                    return function (t) {
                        if (t.disabled) {
                            return Data_Maybe.Nothing.value;
                        };
                        return new Data_Maybe.Just(i);
                    };
                })(state.input.tabs));
                var currentEnabledIdx = Data_Array.findIndex(function (v1) {
                    return v1 === v.value0;
                })(enabledIndices);
                var nextIdx = (function () {
                    if (state.input.orientation instanceof Horizontal && key === "ArrowRight") {
                        return nextEnabledTab(enabledIndices)(currentEnabledIdx)(state.input.loop);
                    };
                    if (state.input.orientation instanceof Horizontal && key === "ArrowLeft") {
                        return prevEnabledTab(enabledIndices)(currentEnabledIdx)(state.input.loop);
                    };
                    if (state.input.orientation instanceof Vertical && key === "ArrowDown") {
                        return nextEnabledTab(enabledIndices)(currentEnabledIdx)(state.input.loop);
                    };
                    if (state.input.orientation instanceof Vertical && key === "ArrowUp") {
                        return prevEnabledTab(enabledIndices)(currentEnabledIdx)(state.input.loop);
                    };
                    if (key === "Home") {
                        return Data_Array.head(enabledIndices);
                    };
                    if (key === "End") {
                        return Data_Array.last(enabledIndices);
                    };
                    return Data_Maybe.Nothing.value;
                })();
                return for_(nextIdx)(function (idx) {
                    return discard(liftEffect(Web_Event_Event.preventDefault(Web_UIEvent_KeyboardEvent.toEvent(v.value1))))(function () {
                        var v1 = Data_Array.index(state.input.tabs)(idx);
                        if (v1 instanceof Data_Maybe.Just) {
                            return bind2(liftEffect(bind(Web_HTML.window)(Web_HTML_Window.document)))(function (doc) {
                                var tabId = state.baseId + ("-tab-" + v1.value0.value);
                                return bind2(liftEffect(getElementById(tabId)(doc)))(function (mEl) {
                                    return discard(for_(mEl)(function (el) {
                                        return liftEffect(Web_HTML_HTMLElement.focus(el));
                                    }))(function () {
                                        return when(eq2(state.input.activationMode)(Automatic.value))(handleAction(dictMonadAff)(new SelectTab(v1.value0.value)));
                                    });
                                });
                            });
                        };
                        if (v1 instanceof Data_Maybe.Nothing) {
                            return pure1(Data_Unit.unit);
                        };
                        throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 282, column 7 - line 291, column 29): " + [ v1.constructor.name ]);
                    });
                });
            });
        };
        throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 241, column 16 - line 291, column 29): " + [ v.constructor.name ]);
    };
};
var handleQuery = function (dictMonadAff) {
    var handleAction1 = handleAction(dictMonadAff);
    return function (v) {
        if (v instanceof SetValue) {
            return discard(handleAction1(new SelectTab(v.value0)))(function () {
                return pure1(new Data_Maybe.Just(v.value1));
            });
        };
        if (v instanceof GetValue) {
            return bind2(get)(function (state) {
                return pure1(new Data_Maybe.Just(v.value0(state.selectedValue)));
            });
        };
        throw new Error("Failed pattern match at Lattice.UI.Radix.Tabs (line 320, column 15 - line 327, column 44): " + [ v.constructor.name ]);
    };
};
var defaultInput = /* #__PURE__ */ (function () {
    return {
        tabs: [  ],
        value: Data_Maybe.Nothing.value,
        defaultValue: Data_Maybe.Nothing.value,
        orientation: Horizontal.value,
        activationMode: Automatic.value,
        loop: true
    };
})();
var component = function (dictMonadAff) {
    var renderWithPanels1 = renderWithPanels(dictMonadAff);
    var handleAction1 = handleAction(dictMonadAff);
    var handleQuery1 = handleQuery(dictMonadAff);
    return function (panels) {
        return Halogen_Component.mkComponent({
            initialState: initialState,
            render: renderWithPanels1(panels),
            "eval": Halogen_Component.mkEval({
                finalize: Halogen_Component.defaultEval.finalize,
                handleAction: handleAction1,
                handleQuery: handleQuery1,
                initialize: new Data_Maybe.Just(Initialize.value),
                receive: function ($109) {
                    return Data_Maybe.Just.create(Receive.create($109));
                }
            })
        });
    };
};
export {
    component,
    SetValue,
    GetValue,
    ValueChanged,
    Horizontal,
    Vertical,
    Automatic,
    Manual,
    Initialize,
    Receive,
    SelectTab,
    HandleKeyDown,
    defaultInput,
    eqOrientation,
    eqActivationMode
};
//# sourceMappingURL=index.js.map
