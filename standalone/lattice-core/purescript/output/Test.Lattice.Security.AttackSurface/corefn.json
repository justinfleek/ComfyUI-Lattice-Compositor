{"builtWith":"0.15.15","comments":[{"LineComment":" | Port of ui/src/__tests__/security/attackSurface.test.ts"},{"LineComment":" |"},{"LineComment":" | Tests security CONCEPTS that can be verified in pure PureScript without"},{"LineComment":" | browser APIs, dynamic imports, or mock infrastructure. The original TS file"},{"LineComment":" | depends heavily on ExportPipeline (mocks, browser APIs) which cannot be"},{"LineComment":" | ported. This module tests the underlying defense primitives:"},{"LineComment":" |"},{"LineComment":" |   - JSON bomb defense via JsonSanitizer"},{"LineComment":" |   - Path traversal detection via pure string checks"},{"LineComment":" |   - Input validation for numeric bounds"},{"LineComment":" |   - Prototype pollution defense via JsonSanitizer"},{"LineComment":" |   - URL injection defense via UrlValidator"},{"LineComment":" |"},{"LineComment":" | 13 tests across 5 describe blocks:"},{"LineComment":" |   - JSON Bomb Defense (3 tests)"},{"LineComment":" |   - Path Traversal Defense (2 tests)"},{"LineComment":" |   - Input Validation Defense (3 tests)"},{"LineComment":" |   - Prototype Pollution Defense (3 tests)"},{"LineComment":" |   - URL Injection Defense (2 tests)"}],"decls":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[79,21],"start":[79,19]}},"type":"Var","value":{"identifier":"conj","moduleName":["Data","HeytingAlgebra"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[79,43],"start":[79,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"heytingAlgebraBoolean","moduleName":["Data","HeytingAlgebra"]}},"type":"App"},"identifier":"conj"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[79,16],"start":[79,14]}},"type":"Var","value":{"identifier":"greaterThanOrEq","moduleName":["Data","Ord"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[79,43],"start":[79,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordInt","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"greaterThanOrEq"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[79,32],"start":[79,31]}},"type":"Var","value":{"identifier":"greaterThan","moduleName":["Data","Ord"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[79,43],"start":[79,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordInt","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"greaterThan"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[74,34],"start":[74,32]}},"type":"Var","value":{"identifier":"lessThanOrEq","moduleName":["Data","Ord"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[74,40],"start":[74,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordInt","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"lessThanOrEq"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[231,11],"start":[231,3]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Spec"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[231,35],"start":[231,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadIdentity","moduleName":["Data","Identity"]}},"type":"App"},"identifier":"describe"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[241,68],"start":[233,5]}},"type":"Var","value":{"identifier":"discard","moduleName":["Control","Bind"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[241,68],"start":[233,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discardUnit","moduleName":["Control","Bind"]}},"type":"App"},"identifier":"discard"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[241,68],"start":[233,5]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"bindSpecT","moduleName":["Test","Spec"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[241,68],"start":[233,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"bindIdentity","moduleName":["Data","Identity"]}},"type":"App"},"type":"App"},"identifier":"discard1"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[233,7],"start":[233,5]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Spec"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[233,55],"start":[233,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadIdentity","moduleName":["Data","Identity"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[233,55],"start":[233,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"exampleMUnit","moduleName":["Test","Spec"]}},"type":"App"},"identifier":"it"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[235,39],"start":[235,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"bindAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"discard2"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[235,32],"start":[235,21]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Spec","Assertions"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[235,39],"start":[235,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadThrowAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"shouldEqual"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[235,39],"start":[235,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showBoolean","moduleName":["Data","Show"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[235,39],"start":[235,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqBoolean","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"shouldEqual1"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[239,22],"start":[239,18]}},"type":"Var","value":{"identifier":"pure","moduleName":["Control","Applicative"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[239,27],"start":[239,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"applicativeAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"pure"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[240,22],"start":[240,18]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Spec","Assertions"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[240,80],"start":[240,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadThrowAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"fail"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[240,75],"start":[240,73]}},"type":"Var","value":{"identifier":"append","moduleName":["Data","Semigroup"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[240,79],"start":[240,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"semigroupString","moduleName":["Data","Semigroup"]}},"type":"App"},"identifier":"append"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[211,56],"start":[211,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showInt","moduleName":["Data","Show"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[211,56],"start":[211,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqInt","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"shouldEqual2"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[171,25],"start":[171,23]}},"type":"Var","value":{"identifier":"negate","moduleName":["Data","Ring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[171,25],"start":[171,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ringInt","moduleName":["Data","Ring"]}},"type":"App"},"identifier":"negate"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[188,22],"start":[188,21]}},"type":"Var","value":{"identifier":"div","moduleName":["Data","EuclideanRing"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[188,26],"start":[188,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"euclideanRingNumber","moduleName":["Data","EuclideanRing"]}},"type":"App"},"identifier":"div"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[190,25],"start":[190,21]}},"type":"Var","value":{"identifier":"negate","moduleName":["Data","Ring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[190,25],"start":[190,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ringNumber","moduleName":["Data","Ring"]}},"type":"App"},"identifier":"negate1"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[59,5],"start":[59,3]}},"type":"Var","value":{"identifier":"disj","moduleName":["Data","HeytingAlgebra"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[59,24],"start":[58,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"heytingAlgebraBoolean","moduleName":["Data","HeytingAlgebra"]}},"type":"App"},"identifier":"disj"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[59,20],"start":[59,18]}},"type":"Var","value":{"identifier":"eq","moduleName":["Data","Eq"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[59,24],"start":[58,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqString","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"eq"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[45,21],"start":[45,16]}},"type":"Var","value":{"identifier":"foldl","moduleName":["Data","Foldable"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[45,44],"start":[45,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldableArray","moduleName":["Data","Foldable"]}},"type":"App"},"identifier":"foldl"},{"annotation":{"meta":null,"sourceSpan":{"end":[77,41],"start":[77,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[77,41],"start":[77,1]}},"argument":"startFrame","body":{"annotation":{"meta":null,"sourceSpan":{"end":[77,41],"start":[77,1]}},"argument":"endFrame","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"conj","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[79,43],"start":[79,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"greaterThanOrEq","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[79,43],"start":[79,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[79,13],"start":[79,3]}},"type":"Var","value":{"identifier":"startFrame","sourcePos":[78,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[79,43],"start":[79,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[79,18],"start":[79,17]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[79,43],"start":[79,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"greaterThan","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[79,43],"start":[79,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[79,30],"start":[79,22]}},"type":"Var","value":{"identifier":"endFrame","sourcePos":[78,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[79,43],"start":[79,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[79,43],"start":[79,33]}},"type":"Var","value":{"identifier":"startFrame","sourcePos":[78,1]}},"type":"App"},"type":"App"},"type":"Abs"},"type":"Abs"},"identifier":"validFrameRange"},{"annotation":{"meta":null,"sourceSpan":{"end":[73,34],"start":[73,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[73,34],"start":[73,1]}},"argument":"n","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"conj","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[74,40],"start":[74,21]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"greaterThan","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[74,40],"start":[74,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[74,22],"start":[74,21]}},"type":"Var","value":{"identifier":"n","sourcePos":[74,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[74,40],"start":[74,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[74,26],"start":[74,25]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[74,40],"start":[74,21]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lessThanOrEq","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[74,40],"start":[74,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[74,31],"start":[74,30]}},"type":"Var","value":{"identifier":"n","sourcePos":[74,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[74,40],"start":[74,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[74,40],"start":[74,35]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10000}},"type":"App"},"type":"App"},"type":"Abs"},"identifier":"validFrameCount"},{"annotation":{"meta":null,"sourceSpan":{"end":[69,33],"start":[69,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[69,33],"start":[69,1]}},"argument":"n","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"conj","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[70,38],"start":[70,20]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"greaterThan","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[70,38],"start":[70,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[70,21],"start":[70,20]}},"type":"Var","value":{"identifier":"n","sourcePos":[70,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[70,38],"start":[70,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[70,25],"start":[70,24]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[70,38],"start":[70,20]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lessThanOrEq","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[70,38],"start":[70,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[70,30],"start":[70,29]}},"type":"Var","value":{"identifier":"n","sourcePos":[70,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[70,38],"start":[70,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[70,38],"start":[70,34]}},"type":"Literal","value":{"literalType":"IntLiteral","value":8192}},"type":"App"},"type":"App"},"type":"Abs"},"identifier":"validDimension"},{"annotation":{"meta":null,"sourceSpan":{"end":[229,38],"start":[229,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[231,35],"start":[231,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[231,35],"start":[231,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"URL Injection Defense"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[231,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[241,68],"start":[233,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[233,55],"start":[233,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[233,55],"start":[233,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should block javascript: URLs in export paths"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[241,68],"start":[233,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,62],"start":[234,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[234,62],"start":[234,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[234,31],"start":[234,20]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[234,53],"start":[234,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,53],"start":[234,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"javascript:alert(1)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[234,62],"start":[234,20]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[234,62],"start":[234,54]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[235,39],"start":[235,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[235,39],"start":[235,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[235,19],"start":[235,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[235,13],"start":[235,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[234,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[235,39],"start":[235,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[235,39],"start":[235,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[235,39],"start":[235,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[235,39],"start":[235,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[241,68],"start":[236,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[237,17],"start":[237,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[237,17],"start":[237,14]}},"binderType":"VarBinder","identifier":"err"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[240,80],"start":[238,11]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[240,80],"start":[238,11]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[239,27],"start":[239,18]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[239,27],"start":[239,23]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[240,80],"start":[238,11]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[240,80],"start":[240,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[240,79],"start":[240,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[240,72],"start":[240,24]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error mentioning 'javascript:', got: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[240,79],"start":[240,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[240,79],"start":[240,76]}},"type":"Var","value":{"identifier":"err","sourcePos":[237,14]}},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[238,26],"start":[238,14]}},"type":"Var","value":{"identifier":"contains","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[238,54],"start":[238,14]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[238,39],"start":[238,28]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[238,53],"start":[238,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[238,53],"start":[238,40]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"javascript:"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[238,58],"start":[238,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[238,58],"start":[238,55]}},"type":"Var","value":{"identifier":"err","sourcePos":[237,14]}},"type":"App"}],"type":"Case"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[241,16],"start":[241,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[241,68],"start":[241,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[241,68],"start":[241,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about javascript: protocol"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[236,24],"start":[236,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[236,18],"start":[236,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[234,11]}},"fieldName":"error","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[241,68],"start":[233,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[241,68],"start":[233,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[243,51],"start":[243,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[243,51],"start":[243,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should block data: URLs with HTML content"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[243,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[244,83],"start":[244,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[244,83],"start":[244,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[244,31],"start":[244,20]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[244,74],"start":[244,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[244,74],"start":[244,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:text/html,<script>alert(1)</script>"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[244,83],"start":[244,20]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[244,83],"start":[244,75]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[245,39],"start":[245,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[245,39],"start":[245,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[245,19],"start":[245,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[245,13],"start":[245,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[244,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[245,39],"start":[245,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[245,39],"start":[245,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[245,39],"start":[245,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[245,39],"start":[245,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[246,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[247,17],"start":[247,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[247,17],"start":[247,14]}},"binderType":"VarBinder","identifier":"err"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[250,76],"start":[248,11]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[250,76],"start":[248,11]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[249,27],"start":[249,18]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[249,27],"start":[249,23]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[250,76],"start":[248,11]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[250,76],"start":[250,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[250,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[250,68],"start":[250,24]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error mentioning 'blocked', got: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[250,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[250,72]}},"type":"Var","value":{"identifier":"err","sourcePos":[247,14]}},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[248,26],"start":[248,14]}},"type":"Var","value":{"identifier":"contains","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[248,50],"start":[248,14]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[248,39],"start":[248,28]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[248,49],"start":[248,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[248,49],"start":[248,40]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"blocked"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[248,54],"start":[248,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[248,54],"start":[248,51]}},"type":"Var","value":{"identifier":"err","sourcePos":[247,14]}},"type":"App"}],"type":"Case"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[251,16],"start":[251,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[251,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[251,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about blocked data URL"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[246,24],"start":[246,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[246,18],"start":[246,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[244,11]}},"fieldName":"error","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"urlInjectionDefenseTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[203,44],"start":[203,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[205,41],"start":[205,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[205,41],"start":[205,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Prototype Pollution Defense"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[223,56],"start":[205,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[211,56],"start":[207,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[207,49],"start":[207,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[207,49],"start":[207,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should strip __proto__ from parsed JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[211,56],"start":[207,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[208,76],"start":[208,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[208,76],"start":[208,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[208,76],"start":[208,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"__proto__\": {\"isAdmin\": true}, \"name\": \"safe\"}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[209,56],"start":[209,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[209,56],"start":[209,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[209,36],"start":[209,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[209,41],"start":[209,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,41],"start":[209,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[208,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,56],"start":[209,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[209,56],"start":[209,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[210,38],"start":[210,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[210,38],"start":[210,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[210,19],"start":[210,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[210,13],"start":[210,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[209,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[210,38],"start":[210,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[210,38],"start":[210,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[210,38],"start":[210,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[210,38],"start":[210,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[211,56],"start":[211,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[211,40],"start":[211,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[211,40],"start":[211,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[211,13],"start":[211,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[209,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[211,56],"start":[211,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[211,56],"start":[211,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[211,56],"start":[207,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[211,56],"start":[207,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[217,56],"start":[213,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[213,51],"start":[213,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[213,51],"start":[213,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should strip constructor from parsed JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[217,56],"start":[213,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[214,72],"start":[214,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[214,72],"start":[214,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[214,72],"start":[214,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"constructor\": {\"prototype\": {\"evil\": true}}}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[215,56],"start":[215,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[215,56],"start":[215,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[215,36],"start":[215,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[215,41],"start":[215,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[215,41],"start":[215,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[214,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[215,56],"start":[215,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[215,56],"start":[215,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[216,38],"start":[216,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[216,38],"start":[216,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[216,19],"start":[216,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[216,13],"start":[216,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[215,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[216,38],"start":[216,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[216,38],"start":[216,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[216,38],"start":[216,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[216,38],"start":[216,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[217,56],"start":[217,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[217,40],"start":[217,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[217,40],"start":[217,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[217,13],"start":[217,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[215,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[217,56],"start":[217,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[217,56],"start":[217,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[217,56],"start":[213,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[217,56],"start":[213,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[219,56],"start":[219,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[219,56],"start":[219,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should strip __defineGetter__ from parsed JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[223,56],"start":[219,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[220,65],"start":[220,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[220,65],"start":[220,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[220,65],"start":[220,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"__defineGetter__\": \"evil\", \"safe\": 1}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[221,56],"start":[221,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[221,56],"start":[221,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[221,36],"start":[221,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[221,41],"start":[221,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[221,41],"start":[221,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[220,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[221,56],"start":[221,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[221,56],"start":[221,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[222,38],"start":[222,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[222,38],"start":[222,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[222,19],"start":[222,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[222,13],"start":[222,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[221,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[222,38],"start":[222,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[222,38],"start":[222,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[222,38],"start":[222,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[222,38],"start":[222,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[223,56],"start":[223,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[223,40],"start":[223,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[223,40],"start":[223,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[223,13],"start":[223,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[221,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[223,56],"start":[223,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[223,56],"start":[223,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"prototypePollutionDefenseTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[162,41],"start":[162,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[164,38],"start":[164,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,38],"start":[164,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Input Validation Defense"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,49],"start":[164,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[177,48],"start":[166,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[166,62],"start":[166,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,62],"start":[166,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should validate numeric bounds for export dimensions"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[177,48],"start":[166,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[168,45],"start":[168,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[168,45],"start":[168,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[168,21],"start":[168,7]}},"type":"Var","value":{"identifier":"validDimension","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[168,26],"start":[168,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[168,26],"start":[168,22]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1920}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[168,45],"start":[168,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[168,45],"start":[168,41]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[168,45],"start":[168,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[168,45],"start":[168,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[169,45],"start":[169,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[169,45],"start":[169,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[169,21],"start":[169,7]}},"type":"Var","value":{"identifier":"validDimension","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[169,26],"start":[169,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[169,26],"start":[169,22]}},"type":"Literal","value":{"literalType":"IntLiteral","value":8192}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[169,45],"start":[169,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[169,45],"start":[169,41]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[169,45],"start":[169,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[169,45],"start":[169,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[170,43],"start":[170,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[170,43],"start":[170,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[170,21],"start":[170,7]}},"type":"Var","value":{"identifier":"validDimension","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[170,23],"start":[170,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[170,23],"start":[170,22]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[170,43],"start":[170,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[170,43],"start":[170,38]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[170,43],"start":[170,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[170,43],"start":[170,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[171,46],"start":[171,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[171,46],"start":[171,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[171,21],"start":[171,7]}},"type":"Var","value":{"identifier":"validDimension","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[171,26],"start":[171,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"negate","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[171,25],"start":[171,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[171,25],"start":[171,24]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[171,46],"start":[171,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[171,46],"start":[171,41]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[171,46],"start":[171,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[171,46],"start":[171,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[172,46],"start":[172,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[172,46],"start":[172,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[172,21],"start":[172,7]}},"type":"Var","value":{"identifier":"validDimension","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[172,26],"start":[172,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[172,26],"start":[172,22]}},"type":"Literal","value":{"literalType":"IntLiteral","value":8193}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[172,46],"start":[172,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[172,46],"start":[172,41]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[172,46],"start":[172,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[172,46],"start":[172,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[174,43],"start":[174,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[174,43],"start":[174,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[174,22],"start":[174,7]}},"type":"Var","value":{"identifier":"validFrameCount","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[174,24],"start":[174,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[174,24],"start":[174,23]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[174,43],"start":[174,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[174,43],"start":[174,39]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[174,43],"start":[174,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[174,43],"start":[174,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[175,47],"start":[175,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[175,47],"start":[175,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[175,22],"start":[175,7]}},"type":"Var","value":{"identifier":"validFrameCount","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[175,28],"start":[175,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[175,28],"start":[175,23]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10000}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[175,47],"start":[175,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[175,47],"start":[175,43]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[175,47],"start":[175,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[175,47],"start":[175,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[176,44],"start":[176,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[176,44],"start":[176,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[176,22],"start":[176,7]}},"type":"Var","value":{"identifier":"validFrameCount","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[176,24],"start":[176,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[176,24],"start":[176,23]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[176,44],"start":[176,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[176,44],"start":[176,39]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[176,44],"start":[176,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[176,44],"start":[176,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[177,48],"start":[177,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[177,22],"start":[177,7]}},"type":"Var","value":{"identifier":"validFrameCount","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[177,28],"start":[177,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[177,28],"start":[177,23]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10001}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[177,48],"start":[177,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[177,48],"start":[177,43]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[177,48],"start":[166,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[177,48],"start":[166,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,48],"start":[179,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[179,45],"start":[179,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[179,45],"start":[179,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should reject negative frame ranges"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,48],"start":[179,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[181,47],"start":[181,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[181,47],"start":[181,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[181,22],"start":[181,7]}},"type":"Var","value":{"identifier":"validFrameRange","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[181,24],"start":[181,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[181,24],"start":[181,23]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[181,28],"start":[181,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[181,28],"start":[181,25]}},"type":"Literal","value":{"literalType":"IntLiteral","value":100}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[181,47],"start":[181,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[181,47],"start":[181,43]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[181,47],"start":[181,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[181,47],"start":[181,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[182,47],"start":[182,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[182,47],"start":[182,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[182,22],"start":[182,7]}},"type":"Var","value":{"identifier":"validFrameRange","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[182,25],"start":[182,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,25],"start":[182,23]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[182,28],"start":[182,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,28],"start":[182,26]}},"type":"Literal","value":{"literalType":"IntLiteral","value":20}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[182,47],"start":[182,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,47],"start":[182,43]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[182,47],"start":[182,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,47],"start":[182,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[183,50],"start":[183,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[183,50],"start":[183,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[183,22],"start":[183,7]}},"type":"Var","value":{"identifier":"validFrameRange","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[183,27],"start":[183,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"negate","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[183,26],"start":[183,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,26],"start":[183,25]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[183,30],"start":[183,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,30],"start":[183,28]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[183,50],"start":[183,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,50],"start":[183,45]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[183,50],"start":[183,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,50],"start":[183,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[184,48],"start":[184,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[184,48],"start":[184,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[184,22],"start":[184,7]}},"type":"Var","value":{"identifier":"validFrameRange","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[184,25],"start":[184,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,25],"start":[184,23]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[184,28],"start":[184,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,28],"start":[184,26]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[184,48],"start":[184,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,48],"start":[184,43]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[184,48],"start":[184,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,48],"start":[184,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,48],"start":[185,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[185,22],"start":[185,7]}},"type":"Var","value":{"identifier":"validFrameRange","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,25],"start":[185,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,25],"start":[185,23]}},"type":"Literal","value":{"literalType":"IntLiteral","value":20}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,28],"start":[185,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,28],"start":[185,26]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,48],"start":[185,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,48],"start":[185,43]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,48],"start":[179,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,48],"start":[179,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[187,42],"start":[187,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[187,42],"start":[187,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should reject non-finite numbers"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,49],"start":[187,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[188,26],"start":[188,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[188,26],"start":[188,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[188,26],"start":[188,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[188,20],"start":[188,17]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":0}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[188,26],"start":[188,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[188,26],"start":[188,23]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":0}},"type":"App"},"identifier":"nan"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[189,29],"start":[189,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[189,29],"start":[189,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[189,29],"start":[189,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[189,23],"start":[189,20]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":1}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[189,29],"start":[189,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[189,29],"start":[189,26]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":0}},"type":"App"},"identifier":"posInf"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,32],"start":[190,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,32],"start":[190,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[190,32],"start":[190,20]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"negate1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[190,25],"start":[190,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,25],"start":[190,22]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":1}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[190,32],"start":[190,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,32],"start":[190,29]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":0}},"type":"App"},"identifier":"negInf"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[191,46],"start":[191,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[191,46],"start":[191,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[191,22],"start":[191,7]}},"type":"Var","value":{"identifier":"isFinite","moduleName":["Data","Number"]}},"annotation":{"meta":null,"sourceSpan":{"end":[191,26],"start":[191,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[191,26],"start":[191,23]}},"type":"Var","value":{"identifier":"nan","sourcePos":[188,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[191,46],"start":[191,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[191,46],"start":[191,41]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[191,46],"start":[191,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[191,46],"start":[191,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[192,49],"start":[192,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[192,49],"start":[192,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[192,22],"start":[192,7]}},"type":"Var","value":{"identifier":"isFinite","moduleName":["Data","Number"]}},"annotation":{"meta":null,"sourceSpan":{"end":[192,29],"start":[192,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[192,29],"start":[192,23]}},"type":"Var","value":{"identifier":"posInf","sourcePos":[189,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[192,49],"start":[192,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[192,49],"start":[192,44]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[192,49],"start":[192,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[192,49],"start":[192,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[193,49],"start":[193,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[193,49],"start":[193,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[193,22],"start":[193,7]}},"type":"Var","value":{"identifier":"isFinite","moduleName":["Data","Number"]}},"annotation":{"meta":null,"sourceSpan":{"end":[193,29],"start":[193,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[193,29],"start":[193,23]}},"type":"Var","value":{"identifier":"negInf","sourcePos":[190,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[193,49],"start":[193,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[193,49],"start":[193,44]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[193,49],"start":[193,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[193,49],"start":[193,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[195,46],"start":[195,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[195,46],"start":[195,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[195,22],"start":[195,7]}},"type":"Var","value":{"identifier":"isFinite","moduleName":["Data","Number"]}},"annotation":{"meta":null,"sourceSpan":{"end":[195,27],"start":[195,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[195,27],"start":[195,23]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":42}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[195,46],"start":[195,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[195,46],"start":[195,42]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[195,46],"start":[195,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[195,46],"start":[195,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,45],"start":[196,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,45],"start":[196,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[196,22],"start":[196,7]}},"type":"Var","value":{"identifier":"isFinite","moduleName":["Data","Number"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,26],"start":[196,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,26],"start":[196,23]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":0}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,45],"start":[196,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,45],"start":[196,41]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,45],"start":[196,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,45],"start":[196,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,49],"start":[197,7]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[197,22],"start":[197,7]}},"type":"Var","value":{"identifier":"isFinite","moduleName":["Data","Number"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,30],"start":[197,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"negate1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,29],"start":[197,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,29],"start":[197,25]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":3.14}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,49],"start":[197,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,49],"start":[197,45]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"inputValidationDefenseTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[56,38],"start":[56,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[56,38],"start":[56,1]}},"argument":"path","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"disj","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[59,24],"start":[58,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[58,15],"start":[58,3]}},"type":"Var","value":{"identifier":"contains","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[58,34],"start":[58,3]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[58,28],"start":[58,17]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[58,33],"start":[58,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[58,33],"start":[58,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":".."}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[58,39],"start":[58,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[58,39],"start":[58,35]}},"type":"Var","value":{"identifier":"path","sourcePos":[57,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[59,24],"start":[58,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[59,24],"start":[58,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[59,10],"start":[59,6]}},"type":"Var","value":{"identifier":"take","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[59,12],"start":[59,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[59,12],"start":[59,11]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[59,17],"start":[59,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[59,17],"start":[59,13]}},"type":"Var","value":{"identifier":"path","sourcePos":[57,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[59,24],"start":[58,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[59,24],"start":[59,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"/"}},"type":"App"},"type":"App"},"type":"Abs"},"identifier":"hasPathTraversal"},{"annotation":{"meta":null,"sourceSpan":{"end":[63,41],"start":[63,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[63,41],"start":[63,1]}},"argument":"path","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"disj","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[66,43],"start":[65,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[65,15],"start":[65,3]}},"type":"Var","value":{"identifier":"contains","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[65,35],"start":[65,3]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[65,28],"start":[65,17]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[65,34],"start":[65,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[65,34],"start":[65,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"%2e"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[65,40],"start":[65,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[65,40],"start":[65,36]}},"type":"Var","value":{"identifier":"path","sourcePos":[64,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[66,43],"start":[65,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[66,18],"start":[66,6]}},"type":"Var","value":{"identifier":"contains","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[66,38],"start":[66,6]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[66,31],"start":[66,20]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[66,37],"start":[66,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,37],"start":[66,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"%2E"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[66,43],"start":[66,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,43],"start":[66,39]}},"type":"Var","value":{"identifier":"path","sourcePos":[64,1]}},"type":"App"},"type":"App"},"type":"Abs"},"identifier":"hasEncodedTraversal"},{"annotation":{"meta":null,"sourceSpan":{"end":[139,39],"start":[139,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[141,36],"start":[141,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[141,36],"start":[141,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Path Traversal Defense"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[156,65],"start":[141,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[149,62],"start":[143,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[143,47],"start":[143,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[143,47],"start":[143,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should detect path traversal patterns"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[149,62],"start":[143,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[145,64],"start":[145,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[145,64],"start":[145,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[145,23],"start":[145,7]}},"type":"Var","value":{"identifier":"hasPathTraversal","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[145,45],"start":[145,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,45],"start":[145,24]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"../../../etc/passwd"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[145,64],"start":[145,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,64],"start":[145,60]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[145,64],"start":[145,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,64],"start":[145,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[146,60],"start":[146,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[146,60],"start":[146,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[146,23],"start":[146,7]}},"type":"Var","value":{"identifier":"hasPathTraversal","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[146,41],"start":[146,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[146,41],"start":[146,24]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"..\\..\\Windows"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[146,60],"start":[146,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[146,60],"start":[146,56]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[146,60],"start":[146,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[146,60],"start":[146,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[147,56],"start":[147,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[147,56],"start":[147,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[147,23],"start":[147,7]}},"type":"Var","value":{"identifier":"hasPathTraversal","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[147,37],"start":[147,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[147,37],"start":[147,24]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"/etc/passwd"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[147,56],"start":[147,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[147,56],"start":[147,52]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[147,56],"start":[147,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[147,56],"start":[147,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[149,62],"start":[149,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[149,23],"start":[149,7]}},"type":"Var","value":{"identifier":"hasPathTraversal","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[149,42],"start":[149,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[149,42],"start":[149,24]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"images/photo.png"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[149,62],"start":[149,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[149,62],"start":[149,57]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[149,62],"start":[143,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[149,62],"start":[143,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[151,45],"start":[151,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[151,45],"start":[151,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should detect URL-encoded traversal"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[156,65],"start":[151,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[153,69],"start":[153,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[153,69],"start":[153,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[153,26],"start":[153,7]}},"type":"Var","value":{"identifier":"hasEncodedTraversal","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[153,50],"start":[153,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,50],"start":[153,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"%2e%2e%2fetc%2fpasswd"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[153,69],"start":[153,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,69],"start":[153,65]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[153,69],"start":[153,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,69],"start":[153,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[154,69],"start":[154,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[154,69],"start":[154,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[154,26],"start":[154,7]}},"type":"Var","value":{"identifier":"hasEncodedTraversal","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[154,50],"start":[154,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[154,50],"start":[154,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"%2E%2E%2Fetc%2Fpasswd"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[154,69],"start":[154,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[154,69],"start":[154,65]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[154,69],"start":[154,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[154,69],"start":[154,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[156,65],"start":[156,7]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[156,26],"start":[156,7]}},"type":"Var","value":{"identifier":"hasEncodedTraversal","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[156,45],"start":[156,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[156,45],"start":[156,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"images/photo.png"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[156,65],"start":[156,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[156,65],"start":[156,60]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"pathTraversalDefenseTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[42,33],"start":[42,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[42,33],"start":[42,1]}},"argument":"depth","body":{"annotation":{"meta":null,"sourceSpan":{"end":[46,42],"start":[44,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[45,70],"start":[45,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldl","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[45,44],"start":[45,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[45,43],"start":[45,23]}},"argument":"acc","body":{"annotation":{"meta":null,"sourceSpan":{"end":[45,43],"start":[45,23]}},"argument":"v","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[45,43],"start":[45,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[45,36],"start":[45,33]}},"type":"Var","value":{"identifier":"acc","sourcePos":[45,24]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[45,43],"start":[45,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[45,43],"start":[45,40]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"}"}},"type":"App"},"type":"Abs"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[45,47],"start":[45,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[45,47],"start":[45,45]}},"type":"Literal","value":{"literalType":"StringLiteral","value":""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[45,70],"start":[45,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[45,58],"start":[45,49]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[45,64],"start":[45,49]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[45,64],"start":[45,59]}},"type":"Var","value":{"identifier":"depth","sourcePos":[43,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[45,69],"start":[45,49]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[45,69],"start":[45,65]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"type":"App"},"identifier":"suffix"},{"annotation":{"meta":null,"sourceSpan":{"end":[44,82],"start":[44,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldl","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[44,56],"start":[44,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[44,55],"start":[44,23]}},"argument":"acc","body":{"annotation":{"meta":null,"sourceSpan":{"end":[44,55],"start":[44,23]}},"argument":"v","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[44,55],"start":[44,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[44,36],"start":[44,33]}},"type":"Var","value":{"identifier":"acc","sourcePos":[44,24]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[44,55],"start":[44,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[44,55],"start":[44,40]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"nested\": "}},"type":"App"},"type":"Abs"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[44,59],"start":[44,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[44,59],"start":[44,57]}},"type":"Literal","value":{"literalType":"StringLiteral","value":""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[44,82],"start":[44,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[44,70],"start":[44,61]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[44,76],"start":[44,61]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[44,76],"start":[44,71]}},"type":"Var","value":{"identifier":"depth","sourcePos":[43,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[44,81],"start":[44,61]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[44,81],"start":[44,77]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"type":"App"},"identifier":"prefix"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[46,42],"start":[46,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[46,12],"start":[46,6]}},"type":"Var","value":{"identifier":"prefix","sourcePos":[44,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[46,42],"start":[46,6]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[46,42],"start":[46,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[46,32],"start":[46,16]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"value\": 1}"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[46,42],"start":[46,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[46,42],"start":[46,36]}},"type":"Var","value":{"identifier":"suffix","sourcePos":[45,7]}},"type":"App"},"type":"App"},"type":"Let"},"type":"Abs"},"identifier":"buildNestedJson"},{"annotation":{"meta":null,"sourceSpan":{"end":[49,32],"start":[49,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[49,32],"start":[49,1]}},"argument":"n","body":{"annotation":{"meta":null,"sourceSpan":{"end":[52,28],"start":[51,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[51,49],"start":[51,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[51,26],"start":[51,18]}},"type":"Var","value":{"identifier":"joinWith","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[51,31],"start":[51,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[51,31],"start":[51,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":", "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[51,49],"start":[51,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[51,42],"start":[51,33]}},"type":"Var","value":{"identifier":"replicate","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[51,44],"start":[51,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[51,44],"start":[51,43]}},"type":"Var","value":{"identifier":"n","sourcePos":[50,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[51,48],"start":[51,33]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[51,48],"start":[51,45]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"1"}},"type":"App"},"type":"App"},"identifier":"elements"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[52,28],"start":[52,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[52,9],"start":[52,6]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"["}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[52,28],"start":[52,6]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[52,28],"start":[52,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[52,21],"start":[52,13]}},"type":"Var","value":{"identifier":"elements","sourcePos":[51,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[52,28],"start":[52,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[52,28],"start":[52,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"]"}},"type":"App"},"type":"App"},"type":"Let"},"type":"Abs"},"identifier":"buildArrayJson"},{"annotation":{"meta":null,"sourceSpan":{"end":[98,34],"start":[98,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[100,31],"start":[100,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[100,31],"start":[100,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"JSON Bomb Defense"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[133,56],"start":[100,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[112,70],"start":[102,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[102,54],"start":[102,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[102,54],"start":[102,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should reject deeply nested JSON (JSON bomb)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[112,70],"start":[102,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[104,36],"start":[104,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[104,36],"start":[104,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[104,33],"start":[104,18]}},"type":"Var","value":{"identifier":"buildNestedJson","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[104,36],"start":[104,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[104,36],"start":[104,34]}},"type":"Literal","value":{"literalType":"IntLiteral","value":60}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[105,56],"start":[105,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[105,56],"start":[105,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[105,36],"start":[105,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[105,41],"start":[105,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[105,41],"start":[105,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[104,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[105,56],"start":[105,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[105,56],"start":[105,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[106,39],"start":[106,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[106,39],"start":[106,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[106,19],"start":[106,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[106,13],"start":[106,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[105,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[106,39],"start":[106,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[106,39],"start":[106,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[106,39],"start":[106,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[106,39],"start":[106,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[112,70],"start":[107,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[108,20],"start":[108,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[108,20],"start":[108,14]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[111,70],"start":[109,11]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[111,70],"start":[109,11]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[110,27],"start":[110,18]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[110,27],"start":[110,23]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[111,70],"start":[109,11]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[111,70],"start":[111,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[111,69],"start":[111,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[111,59],"start":[111,24]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about depth, got: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[111,69],"start":[111,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[111,69],"start":[111,63]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[108,14]}},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[109,26],"start":[109,14]}},"type":"Var","value":{"identifier":"contains","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[109,48],"start":[109,14]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[109,39],"start":[109,28]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[109,47],"start":[109,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[109,47],"start":[109,40]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"depth"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[109,55],"start":[109,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[109,55],"start":[109,49]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[108,14]}},"type":"App"}],"type":"Case"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[112,16],"start":[112,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[112,70],"start":[112,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[112,70],"start":[112,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about depth but got no error"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[107,22],"start":[107,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[107,18],"start":[107,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[105,11]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[112,70],"start":[102,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[112,70],"start":[102,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[125,78],"start":[114,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[114,40],"start":[114,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[114,40],"start":[114,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should reject large array JSON"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[125,78],"start":[114,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[116,56],"start":[116,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[116,56],"start":[116,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[116,56],"start":[116,18]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[133,56],"start":[99,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[116,32],"start":[116,18]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[116,56],"start":[116,18]}},"copy":["maxDepth","maxKeyLength","maxStringLength","maxTotalKeys","removeNullBytes","removePrototypeKeys"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[99,1]}},"type":"ObjectUpdate","updates":[["maxArrayLength",{"annotation":{"meta":null,"sourceSpan":{"end":[116,54],"start":[116,52]}},"type":"Literal","value":{"literalType":"IntLiteral","value":10}}]]},"type":"Let"},"identifier":"opts"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[117,35],"start":[117,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[117,35],"start":[117,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[117,32],"start":[117,18]}},"type":"Var","value":{"identifier":"buildArrayJson","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[117,35],"start":[117,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,35],"start":[117,33]}},"type":"Literal","value":{"literalType":"IntLiteral","value":20}},"type":"App"},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[118,46],"start":[118,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[118,46],"start":[118,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[118,36],"start":[118,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[118,41],"start":[118,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,41],"start":[118,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[117,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[118,46],"start":[118,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,46],"start":[118,42]}},"type":"Var","value":{"identifier":"opts","sourcePos":[116,11]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[119,39],"start":[119,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[119,39],"start":[119,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[119,19],"start":[119,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[119,13],"start":[119,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[118,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[119,39],"start":[119,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[119,39],"start":[119,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[119,39],"start":[119,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[119,39],"start":[119,7]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[125,78],"start":[120,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[121,20],"start":[121,9]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[121,20],"start":[121,14]}},"binderType":"VarBinder","identifier":"errMsg"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[124,78],"start":[122,11]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[124,78],"start":[122,11]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"pure","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[123,27],"start":[123,18]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[123,27],"start":[123,23]}},"type":"Var","value":{"identifier":"unit","moduleName":["Data","Unit"]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[124,78],"start":[122,11]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[124,78],"start":[124,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[124,77],"start":[124,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[124,67],"start":[124,24]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about array exceeds, got: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[124,77],"start":[124,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[124,77],"start":[124,71]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[121,14]}},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[122,26],"start":[122,14]}},"type":"Var","value":{"identifier":"contains","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[122,56],"start":[122,14]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[122,39],"start":[122,28]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[122,55],"start":[122,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[122,55],"start":[122,40]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Array exceeds"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[122,63],"start":[122,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[122,63],"start":[122,57]}},"type":"Var","value":{"identifier":"errMsg","sourcePos":[121,14]}},"type":"App"}],"type":"Case"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[125,16],"start":[125,9]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[125,78],"start":[125,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[125,78],"start":[125,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about array exceeds but got no error"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[120,22],"start":[120,12]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[120,18],"start":[120,12]}},"type":"Var","value":{"identifier":"result","sourcePos":[118,11]}},"fieldName":"err","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[125,78],"start":[114,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[125,78],"start":[114,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[127,57],"start":[127,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[127,57],"start":[127,8]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should reject __proto__ pollution via sanitizer"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[133,56],"start":[127,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[129,70],"start":[129,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[129,70],"start":[129,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[129,70],"start":[129,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"{\"__proto__\": {\"polluted\": true}, \"safe\": 1}"}},"identifier":"json"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[130,56],"start":[130,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[130,56],"start":[130,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[130,36],"start":[130,20]}},"type":"Var","value":{"identifier":"parseAndSanitize","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"annotation":{"meta":null,"sourceSpan":{"end":[130,41],"start":[130,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[130,41],"start":[130,37]}},"type":"Var","value":{"identifier":"json","sourcePos":[129,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[130,56],"start":[130,20]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[130,56],"start":[130,42]}},"type":"Var","value":{"identifier":"defaultOptions","moduleName":["Lattice","Services","Security","JsonSanitizer"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[132,38],"start":[132,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[132,38],"start":[132,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[132,19],"start":[132,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[132,13],"start":[132,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[130,11]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[132,38],"start":[132,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[132,38],"start":[132,34]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[132,38],"start":[132,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[132,38],"start":[132,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[133,56],"start":[133,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[133,40],"start":[133,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[133,40],"start":[133,7]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[133,13],"start":[133,7]}},"type":"Var","value":{"identifier":"result","sourcePos":[130,11]}},"fieldName":"stats","type":"Accessor"},"fieldName":"prototypeKeysRemoved","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[133,56],"start":[133,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[133,56],"start":[133,55]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"jsonBombDefenseTests"},{"annotation":{"meta":null,"sourceSpan":{"end":[85,18],"start":[85,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[87,48],"start":[87,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[87,48],"start":[87,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Attack Surface - Security Concepts"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[92,29],"start":[87,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[88,25],"start":[88,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[88,25],"start":[88,5]}},"type":"Var","value":{"identifier":"jsonBombDefenseTests","moduleName":["Test","Lattice","Security","AttackSurface"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[88,25],"start":[88,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[88,25],"start":[88,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[89,30],"start":[89,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[89,30],"start":[89,5]}},"type":"Var","value":{"identifier":"pathTraversalDefenseTests","moduleName":["Test","Lattice","Security","AttackSurface"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[89,30],"start":[89,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[89,30],"start":[89,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[90,32],"start":[90,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,32],"start":[90,5]}},"type":"Var","value":{"identifier":"inputValidationDefenseTests","moduleName":["Test","Lattice","Security","AttackSurface"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[90,32],"start":[90,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,32],"start":[90,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","AttackSurface"]}},"annotation":{"meta":null,"sourceSpan":{"end":[91,35],"start":[91,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,35],"start":[91,5]}},"type":"Var","value":{"identifier":"prototypePollutionDefenseTests","moduleName":["Test","Lattice","Security","AttackSurface"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[91,35],"start":[91,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,35],"start":[91,5]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[92,29],"start":[92,5]}},"type":"Var","value":{"identifier":"urlInjectionDefenseTests","moduleName":["Test","Lattice","Security","AttackSurface"]}},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"spec"}],"exports":["spec"],"foreign":[],"imports":[{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Control","Applicative"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Control","Bind"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Array"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Eq"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","EuclideanRing"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Foldable"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","HeytingAlgebra"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Identity"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Maybe"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Number"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Ord"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Ring"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Semigroup"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Show"]},{"annotation":{"meta":null,"sourceSpan":{"end":[30,36],"start":[30,1]}},"moduleName":["Data","String"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","String","CodePoints"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","String","CodeUnits"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","String","Common"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","String","Pattern"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Data","Unit"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Effect","Aff"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Lattice","Services","Security","JsonSanitizer"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Lattice","Services","Security","UrlValidator"]},{"annotation":{"meta":null,"sourceSpan":{"end":[23,15],"start":[23,1]}},"moduleName":["Prelude"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Prim"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Test","Lattice","Security","AttackSurface"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Test","Spec"]},{"annotation":{"meta":null,"sourceSpan":{"end":[251,64],"start":[21,1]}},"moduleName":["Test","Spec","Assertions"]}],"moduleName":["Test","Lattice","Security","AttackSurface"],"modulePath":"test/Lattice/Security/AttackSurface.purs","reExports":{},"sourceSpan":{"end":[251,64],"start":[21,1]}}