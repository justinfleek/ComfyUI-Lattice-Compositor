// Generated by purs version 0.15.15
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordInt);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var max1 = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordNumber);
var TriggerDeath = /* #__PURE__ */ (function () {
    function TriggerDeath() {

    };
    TriggerDeath.value = new TriggerDeath();
    return TriggerDeath;
})();
var TriggerCollision = /* #__PURE__ */ (function () {
    function TriggerCollision() {

    };
    TriggerCollision.value = new TriggerCollision();
    return TriggerCollision;
})();
var TriggerLifetime = /* #__PURE__ */ (function () {
    function TriggerLifetime() {

    };
    TriggerLifetime.value = new TriggerLifetime();
    return TriggerLifetime;
})();
var InheritNone = /* #__PURE__ */ (function () {
    function InheritNone() {

    };
    InheritNone.value = new InheritNone();
    return InheritNone;
})();
var InheritFull = /* #__PURE__ */ (function () {
    function InheritFull() {

    };
    InheritFull.value = new InheritFull();
    return InheritFull;
})();
var InheritPartial = /* #__PURE__ */ (function () {
    function InheritPartial(value0) {
        this.value0 = value0;
    };
    InheritPartial.create = function (value0) {
        return new InheritPartial(value0);
    };
    return InheritPartial;
})();
var InheritInverse = /* #__PURE__ */ (function () {
    function InheritInverse() {

    };
    InheritInverse.value = new InheritInverse();
    return InheritInverse;
})();
var subEmitterBurst = function (base) {
    return function (variance) {
        return function (randomVal) {
            var varianceAmount = Data_Int.toNumber(base) * variance * (randomVal - 0.5) * 2.0;
            return max(0)(Data_Int.round(Data_Int.toNumber(base) + varianceAmount));
        };
    };
};
var showSubEmitterTrigger = {
    show: function (v) {
        if (v instanceof TriggerDeath) {
            return "TriggerDeath";
        };
        if (v instanceof TriggerCollision) {
            return "TriggerCollision";
        };
        if (v instanceof TriggerLifetime) {
            return "TriggerLifetime";
        };
        throw new Error("Failed pattern match at Lattice.Services.Particles.SubEmitter (line 42, column 1 - line 45, column 43): " + [ v.constructor.name ]);
    }
};
var showInheritMode = {
    show: function (v) {
        if (v instanceof InheritNone) {
            return "InheritNone";
        };
        if (v instanceof InheritFull) {
            return "InheritFull";
        };
        if (v instanceof InheritPartial) {
            return "InheritPartial " + show(v.value0);
        };
        if (v instanceof InheritInverse) {
            return "InheritInverse";
        };
        throw new Error("Failed pattern match at Lattice.Services.Particles.SubEmitter (line 56, column 1 - line 60, column 41): " + [ v.constructor.name ]);
    }
};
var shouldTrigger = function (config) {
    return function (parentEmitterId) {
        return function (trigger) {
            return function (lifeRatio) {
                return function (threshold) {
                    var matchesTrigger = function (v) {
                        return function (v1) {
                            return function (v2) {
                                return function (v3) {
                                    if (v instanceof TriggerDeath && v1 instanceof TriggerDeath) {
                                        return true;
                                    };
                                    if (v instanceof TriggerCollision && v1 instanceof TriggerCollision) {
                                        return true;
                                    };
                                    if (v instanceof TriggerLifetime && v1 instanceof TriggerLifetime) {
                                        return v2 >= v3;
                                    };
                                    return false;
                                };
                            };
                        };
                    };
                    return config.enabled && ((config.parentEmitterId === "*" || config.parentEmitterId === parentEmitterId) && matchesTrigger(config.trigger)(trigger)(lifeRatio)(threshold));
                };
            };
        };
    };
};
var inheritVelocity$prime = function (vx) {
    return function (vy) {
        return function (mode) {
            if (mode instanceof InheritNone) {
                return new Data_Tuple.Tuple(0.0, 0.0);
            };
            if (mode instanceof InheritFull) {
                return new Data_Tuple.Tuple(vx, vy);
            };
            if (mode instanceof InheritPartial) {
                return new Data_Tuple.Tuple(vx * mode.value0, vy * mode.value0);
            };
            if (mode instanceof InheritInverse) {
                return new Data_Tuple.Tuple(-vx, -vy);
            };
            throw new Error("Failed pattern match at Lattice.Services.Particles.SubEmitter (line 163, column 3 - line 167, column 40): " + [ mode.constructor.name ]);
        };
    };
};
var inheritVelocity = inheritVelocity$prime;
var inheritSize$prime = function (size) {
    return function (mode) {
        return function (multiplier) {
            var baseSize = (function () {
                if (mode instanceof InheritNone) {
                    return 10.0;
                };
                if (mode instanceof InheritFull) {
                    return size;
                };
                if (mode instanceof InheritPartial) {
                    return size * mode.value0;
                };
                if (mode instanceof InheritInverse) {
                    return 10.0;
                };
                throw new Error("Failed pattern match at Lattice.Services.Particles.SubEmitter (line 176, column 16 - line 180, column 29): " + [ mode.constructor.name ]);
            })();
            return baseSize * multiplier;
        };
    };
};
var inheritSize = inheritSize$prime;
var inheritColor$prime = function (v) {
    return function (mode) {
        if (mode instanceof InheritNone) {
            return new Data_Tuple.Tuple(255.0, new Data_Tuple.Tuple(255.0, 255.0));
        };
        if (mode instanceof InheritFull) {
            return new Data_Tuple.Tuple(v.value0, new Data_Tuple.Tuple(v.value1.value0, v.value1.value1));
        };
        if (mode instanceof InheritPartial) {
            return new Data_Tuple.Tuple(v.value0 * mode.value0, new Data_Tuple.Tuple(v.value1.value0 * mode.value0, v.value1.value1 * mode.value0));
        };
        if (mode instanceof InheritInverse) {
            return new Data_Tuple.Tuple(255.0 - v.value0, new Data_Tuple.Tuple(255.0 - v.value1.value0, 255.0 - v.value1.value1));
        };
        throw new Error("Failed pattern match at Lattice.Services.Particles.SubEmitter (line 190, column 3 - line 194, column 72): " + [ mode.constructor.name ]);
    };
};
var inheritColor = inheritColor$prime;
var eqSubEmitterTrigger = {
    eq: function (x) {
        return function (y) {
            if (x instanceof TriggerDeath && y instanceof TriggerDeath) {
                return true;
            };
            if (x instanceof TriggerCollision && y instanceof TriggerCollision) {
                return true;
            };
            if (x instanceof TriggerLifetime && y instanceof TriggerLifetime) {
                return true;
            };
            return false;
        };
    }
};
var eqInheritMode = {
    eq: function (x) {
        return function (y) {
            if (x instanceof InheritNone && y instanceof InheritNone) {
                return true;
            };
            if (x instanceof InheritFull && y instanceof InheritFull) {
                return true;
            };
            if (x instanceof InheritPartial && y instanceof InheritPartial) {
                return x.value0 === y.value0;
            };
            if (x instanceof InheritInverse && y instanceof InheritInverse) {
                return true;
            };
            return false;
        };
    }
};
var calculateSubSpawns = function (config) {
    return function (px) {
        return function (py) {
            return function (pvx) {
                return function (pvy) {
                    return function (psize) {
                        return function (pcolor) {
                            return function (plife) {
                                return function (randomVar) {
                                    var count = subEmitterBurst(config.burstCount)(config.burstCountVariance)(randomVar);
                                    var v = inheritVelocity$prime(pvx)(pvy)(config.inheritVelocity);
                                    var size = inheritSize$prime(psize)(config.inheritSize)(config.sizeMultiplier);
                                    var lifetime = plife * config.lifetimeMultiplier;
                                    var color = inheritColor$prime(pcolor)(config.inheritColor);
                                    return {
                                        count: count,
                                        baseX: px,
                                        baseY: py,
                                        baseVx: v.value0,
                                        baseVy: v.value1,
                                        baseSize: max1(1.0)(size),
                                        baseColor: color,
                                        lifetime: max1(1.0)(lifetime)
                                    };
                                };
                            };
                        };
                    };
                };
            };
        };
    };
};
export {
    TriggerDeath,
    TriggerCollision,
    TriggerLifetime,
    InheritNone,
    InheritFull,
    InheritPartial,
    InheritInverse,
    shouldTrigger,
    calculateSubSpawns,
    inheritVelocity,
    inheritSize,
    inheritColor,
    subEmitterBurst,
    eqSubEmitterTrigger,
    showSubEmitterTrigger,
    eqInheritMode,
    showInheritMode
};
//# sourceMappingURL=index.js.map
