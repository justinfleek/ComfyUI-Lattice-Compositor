// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Eq_Generic from "../Data.Eq.Generic/index.js";
import * as Data_EuclideanRing from "../Data.EuclideanRing/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Generic_Rep from "../Data.Generic.Rep/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Show_Generic from "../Data.Show.Generic/index.js";
import * as Lattice_Services_Export_CameraExport_Types from "../Lattice.Services.Export.CameraExport.Types/index.js";
var genericShowArgsArgument = /* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(Data_Show.showInt);
var genericShowConstructor = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(genericShowArgsArgument);
var genericShowConstructor1 = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsProduct(genericShowArgsArgument)(genericShowArgsArgument));
var genericShowConstructor2 = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(Data_Show_Generic.genericShowArgsNoArguments);
var genericEqArgument = /* #__PURE__ */ Data_Eq_Generic.genericEqArgument(Data_Eq.eqInt);
var genericEqSum = /* #__PURE__ */ Data_Eq_Generic.genericEqSum(/* #__PURE__ */ Data_Eq_Generic.genericEqConstructor(genericEqArgument));
var genericEqSum1 = /* #__PURE__ */ Data_Eq_Generic.genericEqSum(/* #__PURE__ */ Data_Eq_Generic.genericEqConstructor(/* #__PURE__ */ Data_Eq_Generic.genericEqProduct(genericEqArgument)(genericEqArgument)));
var genericEqConstructor = /* #__PURE__ */ Data_Eq_Generic.genericEqConstructor(Data_Eq_Generic.genericEqNoArguments);
var genericEqSum2 = /* #__PURE__ */ Data_Eq_Generic.genericEqSum(genericEqConstructor);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var show2 = /* #__PURE__ */ Data_Show.show(Lattice_Services_Export_CameraExport_Types.showExportTarget);
var mod = /* #__PURE__ */ Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var ErrorWidthOutOfRange = /* #__PURE__ */ (function () {
    function ErrorWidthOutOfRange(value0) {
        this.value0 = value0;
    };
    ErrorWidthOutOfRange.create = function (value0) {
        return new ErrorWidthOutOfRange(value0);
    };
    return ErrorWidthOutOfRange;
})();
var ErrorHeightOutOfRange = /* #__PURE__ */ (function () {
    function ErrorHeightOutOfRange(value0) {
        this.value0 = value0;
    };
    ErrorHeightOutOfRange.create = function (value0) {
        return new ErrorHeightOutOfRange(value0);
    };
    return ErrorHeightOutOfRange;
})();
var ErrorFrameCountOutOfRange = /* #__PURE__ */ (function () {
    function ErrorFrameCountOutOfRange(value0) {
        this.value0 = value0;
    };
    ErrorFrameCountOutOfRange.create = function (value0) {
        return new ErrorFrameCountOutOfRange(value0);
    };
    return ErrorFrameCountOutOfRange;
})();
var ErrorFpsOutOfRange = /* #__PURE__ */ (function () {
    function ErrorFpsOutOfRange(value0) {
        this.value0 = value0;
    };
    ErrorFpsOutOfRange.create = function (value0) {
        return new ErrorFpsOutOfRange(value0);
    };
    return ErrorFpsOutOfRange;
})();
var ErrorInvalidStartFrame = /* #__PURE__ */ (function () {
    function ErrorInvalidStartFrame(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    ErrorInvalidStartFrame.create = function (value0) {
        return function (value1) {
            return new ErrorInvalidStartFrame(value0, value1);
        };
    };
    return ErrorInvalidStartFrame;
})();
var ErrorInvalidEndFrame = /* #__PURE__ */ (function () {
    function ErrorInvalidEndFrame(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    ErrorInvalidEndFrame.create = function (value0) {
        return function (value1) {
            return new ErrorInvalidEndFrame(value0, value1);
        };
    };
    return ErrorInvalidEndFrame;
})();
var ErrorPromptRequired = /* #__PURE__ */ (function () {
    function ErrorPromptRequired() {

    };
    ErrorPromptRequired.value = new ErrorPromptRequired();
    return ErrorPromptRequired;
})();
var ErrorNoOutputSelected = /* #__PURE__ */ (function () {
    function ErrorNoOutputSelected() {

    };
    ErrorNoOutputSelected.value = new ErrorNoOutputSelected();
    return ErrorNoOutputSelected;
})();
var ErrorComfyUIServerRequired = /* #__PURE__ */ (function () {
    function ErrorComfyUIServerRequired() {

    };
    ErrorComfyUIServerRequired.value = new ErrorComfyUIServerRequired();
    return ErrorComfyUIServerRequired;
})();
var genericValidationError_ = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return new ErrorWidthOutOfRange(x.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inl) {
            return new ErrorHeightOutOfRange(x.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inl)) {
            return new ErrorFrameCountOutOfRange(x.value0.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0 instanceof Data_Generic_Rep.Inl))) {
            return new ErrorFpsOutOfRange(x.value0.value0.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl)))) {
            return new ErrorInvalidStartFrame(x.value0.value0.value0.value0.value0.value0, x.value0.value0.value0.value0.value0.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl))))) {
            return new ErrorInvalidEndFrame(x.value0.value0.value0.value0.value0.value0.value0, x.value0.value0.value0.value0.value0.value0.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl)))))) {
            return ErrorPromptRequired.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl))))))) {
            return ErrorNoOutputSelected.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr))))))) {
            return ErrorComfyUIServerRequired.value;
        };
        throw new Error("Failed pattern match at Lattice.Services.Export.ExportPipeline.Validation (line 49, column 1 - line 49, column 42): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof ErrorWidthOutOfRange) {
            return new Data_Generic_Rep.Inl(x.value0);
        };
        if (x instanceof ErrorHeightOutOfRange) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0));
        };
        if (x instanceof ErrorFrameCountOutOfRange) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0)));
        };
        if (x instanceof ErrorFpsOutOfRange) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0))));
        };
        if (x instanceof ErrorInvalidStartFrame) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, x.value1))))));
        };
        if (x instanceof ErrorInvalidEndFrame) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, x.value1)))))));
        };
        if (x instanceof ErrorPromptRequired) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value)))))));
        };
        if (x instanceof ErrorNoOutputSelected) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value))))))));
        };
        if (x instanceof ErrorComfyUIServerRequired) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(Data_Generic_Rep.NoArguments.value))))))));
        };
        throw new Error("Failed pattern match at Lattice.Services.Export.ExportPipeline.Validation (line 49, column 1 - line 49, column 42): " + [ x.constructor.name ]);
    }
};
var showValidationError = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericValidationError_)(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ErrorWidthOutOfRange";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ErrorHeightOutOfRange";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ErrorFrameCountOutOfRange";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ErrorFpsOutOfRange";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor1({
        reflectSymbol: function () {
            return "ErrorInvalidStartFrame";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor1({
        reflectSymbol: function () {
            return "ErrorInvalidEndFrame";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor2({
        reflectSymbol: function () {
            return "ErrorPromptRequired";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor2({
        reflectSymbol: function () {
            return "ErrorNoOutputSelected";
        }
    }))(/* #__PURE__ */ genericShowConstructor2({
        reflectSymbol: function () {
            return "ErrorComfyUIServerRequired";
        }
    }))))))))))
};
var eqValidationError = {
    eq: /* #__PURE__ */ Data_Eq_Generic.genericEq(genericValidationError_)(/* #__PURE__ */ genericEqSum(/* #__PURE__ */ genericEqSum(/* #__PURE__ */ genericEqSum(/* #__PURE__ */ genericEqSum(/* #__PURE__ */ genericEqSum1(/* #__PURE__ */ genericEqSum1(/* #__PURE__ */ genericEqSum2(/* #__PURE__ */ genericEqSum2(genericEqConstructor)))))))))
};
var notEq1 = /* #__PURE__ */ Data_Eq.notEq(eqValidationError);
var validateServerConfig = function (config) {
    var $153 = config.autoQueueWorkflow && Data_Maybe.isNothing(config.comfyuiServer);
    if ($153) {
        return [ ErrorComfyUIServerRequired.value ];
    };
    return [  ];
};
var validateOutputSelection = function (config) {
    var $154 = !config.exportDepthMap && (!config.exportControlImages && (!config.exportCameraData && (!config.exportReferenceFrame && !config.exportLastFrame)));
    if ($154) {
        return [ ErrorNoOutputSelected.value ];
    };
    return [  ];
};
var validateFrameRange = function (startFrame) {
    return function (endFrame) {
        return function (frameCount) {
            return Data_Array.concat([ (function () {
                var $155 = frameCount < 1 || frameCount > 1000;
                if ($155) {
                    return [ new ErrorFrameCountOutOfRange(frameCount) ];
                };
                return [  ];
            })(), (function () {
                var $156 = startFrame < 0 || startFrame >= frameCount;
                if ($156) {
                    return [ new ErrorInvalidStartFrame(startFrame, frameCount) ];
                };
                return [  ];
            })(), (function () {
                var $157 = endFrame <= startFrame || endFrame > frameCount;
                if ($157) {
                    return [ new ErrorInvalidEndFrame(endFrame, startFrame) ];
                };
                return [  ];
            })() ]);
        };
    };
};
var validateFps = function (fps) {
    var $158 = fps < 1 || fps > 120;
    if ($158) {
        return [ new ErrorFpsOutOfRange(fps) ];
    };
    return [  ];
};
var validateDimensions = function (width) {
    return function (height) {
        return Data_Array.filter(function (v) {
            return notEq1(v)(new ErrorWidthOutOfRange(0));
        })(Data_Array.concat([ (function () {
            var $159 = width < 64 || width > 4096;
            if ($159) {
                return [ new ErrorWidthOutOfRange(width) ];
            };
            return [  ];
        })(), (function () {
            var $160 = height < 64 || height > 4096;
            if ($160) {
                return [ new ErrorHeightOutOfRange(height) ];
            };
            return [  ];
        })() ]));
    };
};
var requiresDepthMap = function (v) {
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetMotionCtrl) {
        return true;
    };
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetMotionCtrlSVD) {
        return true;
    };
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetUni3CCamera) {
        return true;
    };
    return false;
};
var requiresCameraData = function (v) {
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetMotionCtrl) {
        return true;
    };
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetMotionCtrlSVD) {
        return true;
    };
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetUni3CCamera) {
        return true;
    };
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetUni3CMotion) {
        return true;
    };
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetWan22FunCamera) {
        return true;
    };
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetAnimateDiffCameraCtrl) {
        return true;
    };
    return false;
};
var qualityWarnings = function (config) {
    return Data_Array.concat([ (function () {
        if (config.steps instanceof Data_Maybe.Just && config.steps.value0 < 20) {
            return [ "Low step count (" + (show(config.steps.value0) + ") may reduce quality") ];
        };
        return [  ];
    })(), (function () {
        if (config.cfgScale instanceof Data_Maybe.Just && config.cfgScale.value0 > 15.0) {
            return [ "High CFG scale (" + (show1(config.cfgScale.value0) + ") may cause artifacts") ];
        };
        return [  ];
    })() ]);
};
var needsPrompt = function (v) {
    if (v instanceof Lattice_Services_Export_CameraExport_Types.TargetFullMatrices) {
        return false;
    };
    return true;
};
var validatePrompt = function (target) {
    return function (prompt) {
        var $168 = needsPrompt(target) && prompt === "";
        if ($168) {
            return [ ErrorPromptRequired.value ];
        };
        return [  ];
    };
};
var frameCountWarnings = function (frameCount) {
    return function (target) {
        var recommendedMax = (function () {
            if (target instanceof Lattice_Services_Export_CameraExport_Types.TargetWan22FunCamera) {
                return 81;
            };
            return 120;
        })();
        var $170 = frameCount > recommendedMax;
        if ($170) {
            return [ "Frame count " + (show(frameCount) + (" exceeds recommended max " + (show(recommendedMax) + (" for " + show2(target))))) ];
        };
        return [  ];
    };
};
var errorToMessage = function (v) {
    if (v instanceof ErrorWidthOutOfRange) {
        return "Width must be between 64 and 4096, got " + show(v.value0);
    };
    if (v instanceof ErrorHeightOutOfRange) {
        return "Height must be between 64 and 4096, got " + show(v.value0);
    };
    if (v instanceof ErrorFrameCountOutOfRange) {
        return "Frame count must be between 1 and 1000, got " + show(v.value0);
    };
    if (v instanceof ErrorFpsOutOfRange) {
        return "FPS must be between 1 and 120, got " + show(v.value0);
    };
    if (v instanceof ErrorInvalidStartFrame) {
        return "Start frame " + (show(v.value0) + (" is invalid (total frames: " + (show(v.value1) + ")")));
    };
    if (v instanceof ErrorInvalidEndFrame) {
        return "End frame " + (show(v.value0) + (" must be greater than start frame " + show(v.value1)));
    };
    if (v instanceof ErrorPromptRequired) {
        return "Prompt is required for this export target";
    };
    if (v instanceof ErrorNoOutputSelected) {
        return "At least one output type must be selected";
    };
    if (v instanceof ErrorComfyUIServerRequired) {
        return "ComfyUI server URL is required for auto-queue";
    };
    throw new Error("Failed pattern match at Lattice.Services.Export.ExportPipeline.Validation (line 55, column 18 - line 73, column 52): " + [ v.constructor.name ]);
};
var dimensionWarnings = function (width) {
    return function (height) {
        return Data_Array.concat([ (function () {
            var $180 = mod(width)(8) !== 0;
            if ($180) {
                return [ "Width " + (show(width) + " is not divisible by 8, may cause issues") ];
            };
            return [  ];
        })(), (function () {
            var $181 = mod(height)(8) !== 0;
            if ($181) {
                return [ "Height " + (show(height) + " is not divisible by 8, may cause issues") ];
            };
            return [  ];
        })(), (function () {
            var $182 = width > 1024 || height > 1024;
            if ($182) {
                return [ "Large dimensions may require significant GPU memory" ];
            };
            return [  ];
        })() ]);
    };
};
var generateWarnings = function (config) {
    return Data_Array.concat([ dimensionWarnings(config.width)(config.height), frameCountWarnings(config.frameCount)(config.target), qualityWarnings(config) ]);
};
var validateConfig = function (config) {
    var warnings = generateWarnings(config);
    var serverErrors = validateServerConfig(config);
    var promptErrors = validatePrompt(config.target)(config.prompt);
    var outputErrors = validateOutputSelection(config);
    var frameErrors = validateFrameRange(config.startFrame)(config.endFrame)(config.frameCount);
    var fpsErrors = validateFps(config.fps);
    var dimErrors = validateDimensions(config.width)(config.height);
    var allErrors = Data_Array.concat([ dimErrors, frameErrors, fpsErrors, promptErrors, outputErrors, serverErrors ]);
    return {
        valid: Data_Array["null"](allErrors),
        errors: map(errorToMessage)(allErrors),
        warnings: warnings
    };
};
export {
    validateConfig,
    ErrorWidthOutOfRange,
    ErrorHeightOutOfRange,
    ErrorFrameCountOutOfRange,
    ErrorFpsOutOfRange,
    ErrorInvalidStartFrame,
    ErrorInvalidEndFrame,
    ErrorPromptRequired,
    ErrorNoOutputSelected,
    ErrorComfyUIServerRequired,
    validateDimensions,
    validateFrameRange,
    validateFps,
    validatePrompt,
    needsPrompt,
    requiresDepthMap,
    requiresCameraData,
    genericValidationError_,
    showValidationError,
    eqValidationError
};
//# sourceMappingURL=index.js.map
