// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Generic_Rep from "../Data.Generic.Rep/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Show_Generic from "../Data.Show.Generic/index.js";
import * as Lattice_Services_Midi_Types from "../Lattice.Services.Midi.Types/index.js";
var genericShowArgsArgument = /* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(Data_Show.showString);
var genericShowArgsProduct = /* #__PURE__ */ Data_Show_Generic.genericShowArgsProduct(genericShowArgsArgument);
var showArray = /* #__PURE__ */ Data_Show.showArray(Data_Show.showInt);
var genericShowArgsArgument1 = /* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(Data_Show.showInt);
var genericShowArgsProduct1 = /* #__PURE__ */ Data_Show_Generic.genericShowArgsProduct(genericShowArgsArgument1);
var genericShowArgsProduct2 = /* #__PURE__ */ genericShowArgsProduct1(genericShowArgsArgument1);
var genericShowConstructor = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ genericShowArgsProduct(/* #__PURE__ */ genericShowArgsProduct1(genericShowArgsProduct2)));
var genericShowConstructor1 = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(genericShowArgsArgument);
var genericShowConstructor2 = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ genericShowArgsProduct(genericShowArgsArgument));
var showRecord = /* #__PURE__ */ Data_Show.showRecord()();
var maxIsSymbol = {
    reflectSymbol: function () {
        return "max";
    }
};
var minIsSymbol = {
    reflectSymbol: function () {
        return "min";
    }
};
var showMaybe = /* #__PURE__ */ Data_Maybe.showMaybe(/* #__PURE__ */ showRecord(/* #__PURE__ */ Data_Show.showRecordFieldsCons(maxIsSymbol)(/* #__PURE__ */ Data_Show.showRecordFieldsConsNil(minIsSymbol)(Data_Show.showInt))(Data_Show.showInt)));
var showMaybe1 = /* #__PURE__ */ Data_Maybe.showMaybe(showArray);
var genericShowConstructor3 = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(Data_Show_Generic.genericShowArgsNoArguments);
var genericShowConstructor4 = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(genericShowArgsProduct2);
var eqArray = /* #__PURE__ */ Data_Eq.eqArray(Data_Eq.eqInt);
var eq1 = /* #__PURE__ */ Data_Eq.eq(eqArray);
var eq3 = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Maybe.eqMaybe(eqArray));
var eq4 = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Maybe.eqMaybe(/* #__PURE__ */ Data_Eq.eqRec()(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(Data_Eq.eqRowNil)()(minIsSymbol)(Data_Eq.eqInt))()(maxIsSymbol)(Data_Eq.eqInt))));
var eq5 = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Maybe.eqMaybe(/* #__PURE__ */ Data_Eq.eqArray(Lattice_Services_Midi_Types.eqMIDIMessageType)));
var eq6 = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Maybe.eqMaybe(Data_Eq.eqInt));
var elem = /* #__PURE__ */ Data_Array.elem(Lattice_Services_Midi_Types.eqMIDIMessageType);
var elem1 = /* #__PURE__ */ Data_Array.elem(Data_Eq.eqInt);
var SendRaw = /* #__PURE__ */ (function () {
    function SendRaw(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    SendRaw.create = function (value0) {
        return function (value1) {
            return new SendRaw(value0, value1);
        };
    };
    return SendRaw;
})();
var SendNoteOn = /* #__PURE__ */ (function () {
    function SendNoteOn(value0, value1, value2, value3) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
    };
    SendNoteOn.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return new SendNoteOn(value0, value1, value2, value3);
                };
            };
        };
    };
    return SendNoteOn;
})();
var SendNoteOff = /* #__PURE__ */ (function () {
    function SendNoteOff(value0, value1, value2, value3) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
    };
    SendNoteOff.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return new SendNoteOff(value0, value1, value2, value3);
                };
            };
        };
    };
    return SendNoteOff;
})();
var SendCC = /* #__PURE__ */ (function () {
    function SendCC(value0, value1, value2, value3) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
    };
    SendCC.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return new SendCC(value0, value1, value2, value3);
                };
            };
        };
    };
    return SendCC;
})();
var AddGlobalListener = /* #__PURE__ */ (function () {
    function AddGlobalListener(value0) {
        this.value0 = value0;
    };
    AddGlobalListener.create = function (value0) {
        return new AddGlobalListener(value0);
    };
    return AddGlobalListener;
})();
var RemoveGlobalListener = /* #__PURE__ */ (function () {
    function RemoveGlobalListener(value0) {
        this.value0 = value0;
    };
    RemoveGlobalListener.create = function (value0) {
        return new RemoveGlobalListener(value0);
    };
    return RemoveGlobalListener;
})();
var AddDeviceListener = /* #__PURE__ */ (function () {
    function AddDeviceListener(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    AddDeviceListener.create = function (value0) {
        return function (value1) {
            return new AddDeviceListener(value0, value1);
        };
    };
    return AddDeviceListener;
})();
var RemoveDeviceListener = /* #__PURE__ */ (function () {
    function RemoveDeviceListener(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    RemoveDeviceListener.create = function (value0) {
        return function (value1) {
            return new RemoveDeviceListener(value0, value1);
        };
    };
    return RemoveDeviceListener;
})();
var AddFilteredListener = /* #__PURE__ */ (function () {
    function AddFilteredListener(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    AddFilteredListener.create = function (value0) {
        return function (value1) {
            return new AddFilteredListener(value0, value1);
        };
    };
    return AddFilteredListener;
})();
var ListDevices = /* #__PURE__ */ (function () {
    function ListDevices() {

    };
    ListDevices.value = new ListDevices();
    return ListDevices;
})();
var ListInputDevices = /* #__PURE__ */ (function () {
    function ListInputDevices() {

    };
    ListInputDevices.value = new ListInputDevices();
    return ListInputDevices;
})();
var ListOutputDevices = /* #__PURE__ */ (function () {
    function ListOutputDevices() {

    };
    ListOutputDevices.value = new ListOutputDevices();
    return ListOutputDevices;
})();
var Initialize = /* #__PURE__ */ (function () {
    function Initialize() {

    };
    Initialize.value = new Initialize();
    return Initialize;
})();
var Dispose = /* #__PURE__ */ (function () {
    function Dispose() {

    };
    Dispose.value = new Dispose();
    return Dispose;
})();
var DeviceReq = /* #__PURE__ */ (function () {
    function DeviceReq(value0) {
        this.value0 = value0;
    };
    DeviceReq.create = function (value0) {
        return new DeviceReq(value0);
    };
    return DeviceReq;
})();
var ListenerReq = /* #__PURE__ */ (function () {
    function ListenerReq(value0) {
        this.value0 = value0;
    };
    ListenerReq.create = function (value0) {
        return new ListenerReq(value0);
    };
    return ListenerReq;
})();
var SendReq = /* #__PURE__ */ (function () {
    function SendReq(value0) {
        this.value0 = value0;
    };
    SendReq.create = function (value0) {
        return new SendReq(value0);
    };
    return SendReq;
})();
var GetCCValue = /* #__PURE__ */ (function () {
    function GetCCValue(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    GetCCValue.create = function (value0) {
        return function (value1) {
            return new GetCCValue(value0, value1);
        };
    };
    return GetCCValue;
})();
var GetNoteState = /* #__PURE__ */ (function () {
    function GetNoteState(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    GetNoteState.create = function (value0) {
        return function (value1) {
            return new GetNoteState(value0, value1);
        };
    };
    return GetNoteState;
})();
var GetHeldNotes = /* #__PURE__ */ (function () {
    function GetHeldNotes() {

    };
    GetHeldNotes.value = new GetHeldNotes();
    return GetHeldNotes;
})();
var GetMessageHistory = /* #__PURE__ */ (function () {
    function GetMessageHistory(value0) {
        this.value0 = value0;
    };
    GetMessageHistory.create = function (value0) {
        return new GetMessageHistory(value0);
    };
    return GetMessageHistory;
})();
var genericMIDISendRequest_ = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return new SendRaw(x.value0.value0, x.value0.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inl) {
            return new SendNoteOn(x.value0.value0.value0, x.value0.value0.value1.value0, x.value0.value0.value1.value1.value0, x.value0.value0.value1.value1.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inl)) {
            return new SendNoteOff(x.value0.value0.value0.value0, x.value0.value0.value0.value1.value0, x.value0.value0.value0.value1.value1.value0, x.value0.value0.value0.value1.value1.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inr)) {
            return new SendCC(x.value0.value0.value0.value0, x.value0.value0.value0.value1.value0, x.value0.value0.value0.value1.value1.value0, x.value0.value0.value0.value1.value1.value1);
        };
        throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 90, column 1 - line 90, column 42): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof SendRaw) {
            return new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, x.value1));
        };
        if (x instanceof SendNoteOn) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, new Data_Generic_Rep.Product(x.value1, new Data_Generic_Rep.Product(x.value2, x.value3)))));
        };
        if (x instanceof SendNoteOff) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, new Data_Generic_Rep.Product(x.value1, new Data_Generic_Rep.Product(x.value2, x.value3))))));
        };
        if (x instanceof SendCC) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Product(x.value0, new Data_Generic_Rep.Product(x.value1, new Data_Generic_Rep.Product(x.value2, x.value3))))));
        };
        throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 90, column 1 - line 90, column 42): " + [ x.constructor.name ]);
    }
};
var showMIDISendRequest = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericMIDISendRequest_)(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ genericShowArgsProduct(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(showArray)))({
        reflectSymbol: function () {
            return "SendRaw";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "SendNoteOn";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "SendNoteOff";
        }
    }))(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "SendCC";
        }
    })))))
};
var genericMIDIRequest_ = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return Initialize.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inl) {
            return Dispose.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inl)) {
            return new DeviceReq(x.value0.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0 instanceof Data_Generic_Rep.Inl))) {
            return new ListenerReq(x.value0.value0.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl)))) {
            return new SendReq(x.value0.value0.value0.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl))))) {
            return new GetCCValue(x.value0.value0.value0.value0.value0.value0.value0, x.value0.value0.value0.value0.value0.value0.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl)))))) {
            return new GetNoteState(x.value0.value0.value0.value0.value0.value0.value0.value0, x.value0.value0.value0.value0.value0.value0.value0.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl))))))) {
            return GetHeldNotes.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr))))))) {
            return new GetMessageHistory(x.value0.value0.value0.value0.value0.value0.value0.value0);
        };
        throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 108, column 1 - line 108, column 38): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof Initialize) {
            return new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value);
        };
        if (x instanceof Dispose) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value));
        };
        if (x instanceof DeviceReq) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0)));
        };
        if (x instanceof ListenerReq) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0))));
        };
        if (x instanceof SendReq) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0)))));
        };
        if (x instanceof GetCCValue) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, x.value1)))))));
        };
        if (x instanceof GetNoteState) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, x.value1))))))));
        };
        if (x instanceof GetHeldNotes) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value))))))));
        };
        if (x instanceof GetMessageHistory) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(x.value0))))))));
        };
        throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 108, column 1 - line 108, column 38): " + [ x.constructor.name ]);
    }
};
var genericMIDIListenerReques = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return new AddGlobalListener(x.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inl) {
            return new RemoveGlobalListener(x.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inl)) {
            return new AddDeviceListener(x.value0.value0.value0.value0, x.value0.value0.value0.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0 instanceof Data_Generic_Rep.Inl))) {
            return new RemoveDeviceListener(x.value0.value0.value0.value0.value0, x.value0.value0.value0.value0.value1);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0 instanceof Data_Generic_Rep.Inr))) {
            return new AddFilteredListener(x.value0.value0.value0.value0.value0, x.value0.value0.value0.value0.value1);
        };
        throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 79, column 1 - line 79, column 46): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof AddGlobalListener) {
            return new Data_Generic_Rep.Inl(x.value0);
        };
        if (x instanceof RemoveGlobalListener) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0));
        };
        if (x instanceof AddDeviceListener) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, x.value1))));
        };
        if (x instanceof RemoveDeviceListener) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, x.value1)))));
        };
        if (x instanceof AddFilteredListener) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Product(x.value0, x.value1)))));
        };
        throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 79, column 1 - line 79, column 46): " + [ x.constructor.name ]);
    }
};
var showMIDIListenerRequest = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericMIDIListenerReques)(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor1({
        reflectSymbol: function () {
            return "AddGlobalListener";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor1({
        reflectSymbol: function () {
            return "RemoveGlobalListener";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor2({
        reflectSymbol: function () {
            return "AddDeviceListener";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor2({
        reflectSymbol: function () {
            return "RemoveDeviceListener";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ genericShowArgsProduct(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(/* #__PURE__ */ showRecord(/* #__PURE__ */ Data_Show.showRecordFieldsCons({
        reflectSymbol: function () {
            return "channels";
        }
    })(/* #__PURE__ */ Data_Show.showRecordFieldsCons({
        reflectSymbol: function () {
            return "controllers";
        }
    })(/* #__PURE__ */ Data_Show.showRecordFieldsCons({
        reflectSymbol: function () {
            return "noteRange";
        }
    })(/* #__PURE__ */ Data_Show.showRecordFieldsCons({
        reflectSymbol: function () {
            return "types";
        }
    })(/* #__PURE__ */ Data_Show.showRecordFieldsConsNil({
        reflectSymbol: function () {
            return "velocityRange";
        }
    })(showMaybe))(/* #__PURE__ */ Data_Maybe.showMaybe(/* #__PURE__ */ Data_Show.showArray(Lattice_Services_Midi_Types.showMIDIMessageType))))(showMaybe))(showMaybe1))(showMaybe1)))))({
        reflectSymbol: function () {
            return "AddFilteredListener";
        }
    }))))))
};
var genericMIDIDeviceRequest_ = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return ListDevices.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inl) {
            return ListInputDevices.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inr) {
            return ListOutputDevices.value;
        };
        throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 67, column 1 - line 67, column 44): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof ListDevices) {
            return new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value);
        };
        if (x instanceof ListInputDevices) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value));
        };
        if (x instanceof ListOutputDevices) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(Data_Generic_Rep.NoArguments.value));
        };
        throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 67, column 1 - line 67, column 44): " + [ x.constructor.name ]);
    }
};
var showMIDIDeviceRequest = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericMIDIDeviceRequest_)(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor3({
        reflectSymbol: function () {
            return "ListDevices";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor3({
        reflectSymbol: function () {
            return "ListInputDevices";
        }
    }))(/* #__PURE__ */ genericShowConstructor3({
        reflectSymbol: function () {
            return "ListOutputDevices";
        }
    }))))
};
var showMIDIRequest = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericMIDIRequest_)(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor3({
        reflectSymbol: function () {
            return "Initialize";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor3({
        reflectSymbol: function () {
            return "Dispose";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(showMIDIDeviceRequest))({
        reflectSymbol: function () {
            return "DeviceReq";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(showMIDIListenerRequest))({
        reflectSymbol: function () {
            return "ListenerReq";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(showMIDISendRequest))({
        reflectSymbol: function () {
            return "SendReq";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor4({
        reflectSymbol: function () {
            return "GetCCValue";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor4({
        reflectSymbol: function () {
            return "GetNoteState";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor3({
        reflectSymbol: function () {
            return "GetHeldNotes";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(/* #__PURE__ */ Data_Maybe.showMaybe(Data_Show.showInt)))({
        reflectSymbol: function () {
            return "GetMessageHistory";
        }
    }))))))))))
};
var eqMIDISendRequest = {
    eq: function (x) {
        return function (y) {
            if (x instanceof SendRaw && y instanceof SendRaw) {
                return x.value0 === y.value0 && eq1(x.value1)(y.value1);
            };
            if (x instanceof SendNoteOn && y instanceof SendNoteOn) {
                return x.value0 === y.value0 && x.value1 === y.value1 && x.value2 === y.value2 && x.value3 === y.value3;
            };
            if (x instanceof SendNoteOff && y instanceof SendNoteOff) {
                return x.value0 === y.value0 && x.value1 === y.value1 && x.value2 === y.value2 && x.value3 === y.value3;
            };
            if (x instanceof SendCC && y instanceof SendCC) {
                return x.value0 === y.value0 && x.value1 === y.value1 && x.value2 === y.value2 && x.value3 === y.value3;
            };
            return false;
        };
    }
};
var eq7 = /* #__PURE__ */ Data_Eq.eq(eqMIDISendRequest);
var eqMIDIListenerRequest = {
    eq: function (x) {
        return function (y) {
            if (x instanceof AddGlobalListener && y instanceof AddGlobalListener) {
                return x.value0 === y.value0;
            };
            if (x instanceof RemoveGlobalListener && y instanceof RemoveGlobalListener) {
                return x.value0 === y.value0;
            };
            if (x instanceof AddDeviceListener && y instanceof AddDeviceListener) {
                return x.value0 === y.value0 && x.value1 === y.value1;
            };
            if (x instanceof RemoveDeviceListener && y instanceof RemoveDeviceListener) {
                return x.value0 === y.value0 && x.value1 === y.value1;
            };
            if (x instanceof AddFilteredListener && y instanceof AddFilteredListener) {
                return x.value0 === y.value0 && (eq3(x.value1.channels)(y.value1.channels) && eq3(x.value1.controllers)(y.value1.controllers) && eq4(x.value1.noteRange)(y.value1.noteRange) && eq5(x.value1.types)(y.value1.types) && eq4(x.value1.velocityRange)(y.value1.velocityRange));
            };
            return false;
        };
    }
};
var eq8 = /* #__PURE__ */ Data_Eq.eq(eqMIDIListenerRequest);
var eqMIDIDeviceRequest = {
    eq: function (x) {
        return function (y) {
            if (x instanceof ListDevices && y instanceof ListDevices) {
                return true;
            };
            if (x instanceof ListInputDevices && y instanceof ListInputDevices) {
                return true;
            };
            if (x instanceof ListOutputDevices && y instanceof ListOutputDevices) {
                return true;
            };
            return false;
        };
    }
};
var eq9 = /* #__PURE__ */ Data_Eq.eq(eqMIDIDeviceRequest);
var eqMIDIRequest = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Initialize && y instanceof Initialize) {
                return true;
            };
            if (x instanceof Dispose && y instanceof Dispose) {
                return true;
            };
            if (x instanceof DeviceReq && y instanceof DeviceReq) {
                return eq9(x.value0)(y.value0);
            };
            if (x instanceof ListenerReq && y instanceof ListenerReq) {
                return eq8(x.value0)(y.value0);
            };
            if (x instanceof SendReq && y instanceof SendReq) {
                return eq7(x.value0)(y.value0);
            };
            if (x instanceof GetCCValue && y instanceof GetCCValue) {
                return x.value0 === y.value0 && x.value1 === y.value1;
            };
            if (x instanceof GetNoteState && y instanceof GetNoteState) {
                return x.value0 === y.value0 && x.value1 === y.value1;
            };
            if (x instanceof GetHeldNotes && y instanceof GetHeldNotes) {
                return true;
            };
            if (x instanceof GetMessageHistory && y instanceof GetMessageHistory) {
                return eq6(x.value0)(y.value0);
            };
            return false;
        };
    }
};
var min = function (a) {
    return function (b) {
        var $508 = a < b;
        if ($508) {
            return a;
        };
        return b;
    };
};
var max = function (a) {
    return function (b) {
        var $509 = a > b;
        if ($509) {
            return a;
        };
        return b;
    };
};
var matchesFilter = function (msg) {
    return function (midiFilter) {
        var velocityMatches = (function () {
            if (midiFilter.velocityRange instanceof Data_Maybe.Nothing) {
                return true;
            };
            if (midiFilter.velocityRange instanceof Data_Maybe.Just) {
                if (msg.velocity instanceof Data_Maybe.Nothing) {
                    return true;
                };
                if (msg.velocity instanceof Data_Maybe.Just) {
                    return msg.velocity.value0 >= midiFilter.velocityRange.value0.min && msg.velocity.value0 <= midiFilter.velocityRange.value0.max;
                };
                throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 136, column 21 - line 138, column 51): " + [ msg.velocity.constructor.name ]);
            };
            throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 134, column 23 - line 138, column 51): " + [ midiFilter.velocityRange.constructor.name ]);
        })();
        var typeMatches = (function () {
            if (midiFilter.types instanceof Data_Maybe.Nothing) {
                return true;
            };
            if (midiFilter.types instanceof Data_Maybe.Just) {
                return elem(msg.msgType)(midiFilter.types.value0);
            };
            throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 122, column 19 - line 124, column 45): " + [ midiFilter.types.constructor.name ]);
        })();
        var noteMatches = (function () {
            if (midiFilter.noteRange instanceof Data_Maybe.Nothing) {
                return true;
            };
            if (midiFilter.noteRange instanceof Data_Maybe.Just) {
                if (msg.note instanceof Data_Maybe.Nothing) {
                    return true;
                };
                if (msg.note instanceof Data_Maybe.Just) {
                    return msg.note.value0 >= midiFilter.noteRange.value0.min && msg.note.value0 <= midiFilter.noteRange.value0.max;
                };
                throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 129, column 21 - line 131, column 51): " + [ msg.note.constructor.name ]);
            };
            throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 127, column 19 - line 131, column 51): " + [ midiFilter.noteRange.constructor.name ]);
        })();
        var controllerMatches = (function () {
            if (midiFilter.controllers instanceof Data_Maybe.Nothing) {
                return true;
            };
            if (midiFilter.controllers instanceof Data_Maybe.Just) {
                if (msg.controller instanceof Data_Maybe.Nothing) {
                    return true;
                };
                if (msg.controller instanceof Data_Maybe.Just) {
                    return elem1(msg.controller.value0)(midiFilter.controllers.value0);
                };
                throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 143, column 27 - line 145, column 39): " + [ msg.controller.constructor.name ]);
            };
            throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 141, column 25 - line 145, column 39): " + [ midiFilter.controllers.constructor.name ]);
        })();
        var channelMatches = (function () {
            if (midiFilter.channels instanceof Data_Maybe.Nothing) {
                return true;
            };
            if (midiFilter.channels instanceof Data_Maybe.Just) {
                return elem1(msg.channel)(midiFilter.channels.value0);
            };
            throw new Error("Failed pattern match at Lattice.Services.Midi.Service (line 117, column 22 - line 119, column 51): " + [ midiFilter.channels.constructor.name ]);
        })();
        return channelMatches && (typeMatches && (noteMatches && (velocityMatches && controllerMatches)));
    };
};
var defaultMIDIConfig = {
    historySize: 100,
    smoothingDefault: 0.1,
    autoConnect: true
};
var calculateMappedValue = function (mapping) {
    return function (inputValue) {
        return function (currentSmoothed) {
            var normalizedInput = (inputValue - Data_Int.toNumber(mapping.inputMin)) / (Data_Int.toNumber(mapping.inputMax) - Data_Int.toNumber(mapping.inputMin));
            var clampedInput = max(0.0)(min(1.0)(normalizedInput));
            var rawOutput = mapping.outputMin + clampedInput * (mapping.outputMax - mapping.outputMin);
            var smoothedOutput = currentSmoothed + (rawOutput - currentSmoothed) * (1.0 - mapping.smoothing);
            return smoothedOutput;
        };
    };
};
var buildNoteOnMessage = function (channel) {
    return function (note) {
        return function (velocity) {
            var status = 144 + (channel - 1 | 0) | 0;
            return [ status, note, velocity ];
        };
    };
};
var buildNoteOffMessage = function (channel) {
    return function (note) {
        return function (velocity) {
            var status = 128 + (channel - 1 | 0) | 0;
            return [ status, note, velocity ];
        };
    };
};
var buildCCMessage = function (channel) {
    return function (controller) {
        return function (value) {
            var status = 176 + (channel - 1 | 0) | 0;
            return [ status, controller, value ];
        };
    };
};
export {
    defaultMIDIConfig,
    Initialize,
    Dispose,
    DeviceReq,
    ListenerReq,
    SendReq,
    GetCCValue,
    GetNoteState,
    GetHeldNotes,
    GetMessageHistory,
    ListDevices,
    ListInputDevices,
    ListOutputDevices,
    AddGlobalListener,
    RemoveGlobalListener,
    AddDeviceListener,
    RemoveDeviceListener,
    AddFilteredListener,
    SendRaw,
    SendNoteOn,
    SendNoteOff,
    SendCC,
    matchesFilter,
    calculateMappedValue,
    buildNoteOnMessage,
    buildNoteOffMessage,
    buildCCMessage,
    eqMIDIDeviceRequest,
    genericMIDIDeviceRequest_,
    showMIDIDeviceRequest,
    eqMIDIListenerRequest,
    genericMIDIListenerReques,
    showMIDIListenerRequest,
    eqMIDISendRequest,
    genericMIDISendRequest_,
    showMIDISendRequest,
    eqMIDIRequest,
    genericMIDIRequest_,
    showMIDIRequest
};
export {
    MIDIInput,
    MIDIOutput,
    Aftertouch,
    ChannelPressure,
    ControlChange,
    NoteOff,
    NoteOn,
    PitchBend,
    ProgramChange,
    SystemMessage
} from "../Lattice.Services.Midi.Types/index.js";
//# sourceMappingURL=index.js.map
