{"builtWith":"0.15.15","comments":[{"LineComment":" | Lattice.Services.Security.UrlValidator - URL validation for security"},{"LineComment":" |"},{"LineComment":" | Security module for validating URLs before loading external resources."},{"LineComment":" | Blocks dangerous protocols that could lead to XSS, code execution, or data exfiltration."},{"LineComment":" |"},{"LineComment":" | ENTERPRISE SECURITY: Critical security control for Enterprise Grade security."},{"LineComment":" |"},{"LineComment":" | Source: ui/src/services/security/urlValidator.ts"}],"decls":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowConstructor","moduleName":["Data","Show","Generic"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowArgsNoArguments","moduleName":["Data","Show","Generic"]}},"type":"App"},"identifier":"genericShowConstructor"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[363,34],"start":[363,32]}},"type":"Var","value":{"identifier":"eq","moduleName":["Data","Eq"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[363,41],"start":[363,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqString","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"eq"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[341,44],"start":[341,43]}},"type":"Var","value":{"identifier":"add","moduleName":["Data","Semiring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[341,46],"start":[341,34]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"semiringInt","moduleName":["Data","Semiring"]}},"type":"App"},"identifier":"add"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[252,14],"start":[252,12]}},"type":"Var","value":{"identifier":"disj","moduleName":["Data","HeytingAlgebra"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[252,78],"start":[251,12]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"heytingAlgebraBoolean","moduleName":["Data","HeytingAlgebra"]}},"type":"App"},"identifier":"disj"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[252,44],"start":[252,42]}},"type":"Var","value":{"identifier":"append","moduleName":["Data","Semigroup"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[252,61],"start":[252,38]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"semigroupString","moduleName":["Data","Semigroup"]}},"type":"App"},"identifier":"append"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[163,26],"start":[163,24]}},"type":"Var","value":{"identifier":"eq","moduleName":["Data","Eq"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[163,28],"start":[163,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqInt","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"eq1"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[166,30],"start":[166,29]}},"type":"Var","value":{"identifier":"greaterThan","moduleName":["Data","Ord"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[166,43],"start":[166,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordInt","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"greaterThan"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[260,9],"start":[260,6]}},"type":"Var","value":{"identifier":"map","moduleName":["Data","Functor"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[260,40],"start":[260,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"functorArray","moduleName":["Data","Functor"]}},"type":"App"},"identifier":"map"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[209,8],"start":[209,3]}},"type":"Var","value":{"identifier":"foldl","moduleName":["Data","Foldable"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[209,64],"start":[209,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldableArray","moduleName":["Data","Foldable"]}},"type":"App"},"identifier":"foldl"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[209,30],"start":[209,20]}},"type":"Var","value":{"identifier":"insert","moduleName":["Data","Map","Internal"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[209,34],"start":[209,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordString","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"insert"},{"annotation":{"meta":null,"sourceSpan":{"end":[57,57],"start":[57,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[57,57],"start":[57,1]}},"constructorName":"RiskSafe","fieldNames":[],"type":"Constructor","typeName":"URLRiskLevel"},"identifier":"RiskSafe"},{"annotation":{"meta":null,"sourceSpan":{"end":[57,57],"start":[57,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[57,57],"start":[57,1]}},"constructorName":"RiskWarning","fieldNames":[],"type":"Constructor","typeName":"URLRiskLevel"},"identifier":"RiskWarning"},{"annotation":{"meta":null,"sourceSpan":{"end":[57,57],"start":[57,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[57,57],"start":[57,1]}},"constructorName":"RiskBlocked","fieldNames":[],"type":"Constructor","typeName":"URLRiskLevel"},"identifier":"RiskBlocked"},{"annotation":{"meta":null,"sourceSpan":{"end":[50,49],"start":[50,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[50,49],"start":[50,1]}},"constructorName":"CtxAsset","fieldNames":[],"type":"Constructor","typeName":"URLContext"},"identifier":"CtxAsset"},{"annotation":{"meta":null,"sourceSpan":{"end":[50,49],"start":[50,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[50,49],"start":[50,1]}},"constructorName":"CtxFetch","fieldNames":[],"type":"Constructor","typeName":"URLContext"},"identifier":"CtxFetch"},{"annotation":{"meta":null,"sourceSpan":{"end":[50,49],"start":[50,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[50,49],"start":[50,1]}},"constructorName":"CtxEmbed","fieldNames":[],"type":"Constructor","typeName":"URLContext"},"identifier":"CtxEmbed"},{"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"Generic$Dict","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["to",{"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":"x","body":{"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inl","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inl","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"RiskWarning","moduleName":["Lattice","Services","Security","UrlValidator"]}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"x","sourcePos":[0,0]}}],"type":"Case"},"type":"Abs"}],["from",{"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":"x","body":{"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"Inl","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"NoArguments","moduleName":["Data","Generic","Rep"]}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"RiskWarning","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"Inl","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"NoArguments","moduleName":["Data","Generic","Rep"]}},"type":"App"},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,39],"start":[60,1]}},"argument":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,39],"start":[60,1]}},"type":"Var","value":{"identifier":"NoArguments","moduleName":["Data","Generic","Rep"]}},"type":"App"},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"x","sourcePos":[0,0]}}],"type":"Case"},"type":"Abs"}]]}},"type":"App"},"identifier":"genericURLRiskLevel_"},{"annotation":{"meta":null,"sourceSpan":{"end":[61,52],"start":[61,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[61,52],"start":[61,1]}},"type":"Var","value":{"identifier":"Show$Dict","moduleName":["Data","Show"]}},"annotation":{"meta":null,"sourceSpan":{"end":[61,52],"start":[61,1]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[61,52],"start":[61,1]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["show",{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"type":"Var","value":{"identifier":"genericShow","moduleName":["Data","Show","Generic"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericURLRiskLevel_","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowSum","moduleName":["Data","Show","Generic"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowConstructor","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"IsSymbol$Dict","moduleName":["Data","Symbol"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["reflectSymbol",{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"RiskSafe"}},"type":"Abs"}]]}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowSum","moduleName":["Data","Show","Generic"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowConstructor","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"IsSymbol$Dict","moduleName":["Data","Symbol"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["reflectSymbol",{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"RiskWarning"}},"type":"Abs"}]]}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowConstructor","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"IsSymbol$Dict","moduleName":["Data","Symbol"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[61,52],"start":[61,41]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["reflectSymbol",{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"RiskBlocked"}},"type":"Abs"}]]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"}]]}},"type":"App"},"identifier":"showURLRiskLevel"},{"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"Generic$Dict","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["to",{"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":"x","body":{"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inl","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inl","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"CtxFetch","moduleName":["Lattice","Services","Security","UrlValidator"]}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"constructorName":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]},"typeName":{"identifier":"Sum","moduleName":["Data","Generic","Rep"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"CtxEmbed","moduleName":["Lattice","Services","Security","UrlValidator"]}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"x","sourcePos":[0,0]}}],"type":"Case"},"type":"Abs"}],["from",{"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":"x","body":{"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLContext","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"Inl","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"NoArguments","moduleName":["Data","Generic","Rep"]}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CtxFetch","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLContext","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"Inl","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"NoArguments","moduleName":["Data","Generic","Rep"]}},"type":"App"},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CtxEmbed","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLContext","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"Inr","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"Constructor","moduleName":["Data","Generic","Rep"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,37],"start":[53,1]}},"argument":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[53,37],"start":[53,1]}},"type":"Var","value":{"identifier":"NoArguments","moduleName":["Data","Generic","Rep"]}},"type":"App"},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"x","sourcePos":[0,0]}}],"type":"Case"},"type":"Abs"}]]}},"type":"App"},"identifier":"genericURLContext_"},{"annotation":{"meta":null,"sourceSpan":{"end":[54,50],"start":[54,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[54,50],"start":[54,1]}},"type":"Var","value":{"identifier":"Show$Dict","moduleName":["Data","Show"]}},"annotation":{"meta":null,"sourceSpan":{"end":[54,50],"start":[54,1]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[54,50],"start":[54,1]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["show",{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"type":"Var","value":{"identifier":"genericShow","moduleName":["Data","Show","Generic"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericURLContext_","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowSum","moduleName":["Data","Show","Generic"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowConstructor","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"IsSymbol$Dict","moduleName":["Data","Symbol"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["reflectSymbol",{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"CtxAsset"}},"type":"Abs"}]]}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowSum","moduleName":["Data","Show","Generic"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowConstructor","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"IsSymbol$Dict","moduleName":["Data","Symbol"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["reflectSymbol",{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"CtxFetch"}},"type":"Abs"}]]}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"genericShowConstructor","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"IsSymbol$Dict","moduleName":["Data","Symbol"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[54,50],"start":[54,39]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["reflectSymbol",{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"CtxEmbed"}},"type":"Abs"}]]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"}]]}},"type":"App"},"identifier":"showURLContext"},{"annotation":{"meta":null,"sourceSpan":{"end":[59,32],"start":[59,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"Eq$Dict","moduleName":["Data","Eq"]}},"annotation":{"meta":null,"sourceSpan":{"end":[59,32],"start":[59,1]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["eq",{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"x","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"y","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}},{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"RiskWarning","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}},{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"RiskWarning","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}},{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"NullBinder"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"x","sourcePos":[0,0]}},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"y","sourcePos":[0,0]}}],"type":"Case"},"type":"Abs"},"type":"Abs"}]]}},"type":"App"},"identifier":"eqURLRiskLevel"},{"annotation":{"meta":null,"sourceSpan":{"end":[52,30],"start":[52,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"Eq$Dict","moduleName":["Data","Eq"]}},"annotation":{"meta":null,"sourceSpan":{"end":[52,30],"start":[52,1]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["eq",{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"x","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"y","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLContext","moduleName":["Lattice","Services","Security","UrlValidator"]}},{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLContext","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CtxFetch","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLContext","moduleName":["Lattice","Services","Security","UrlValidator"]}},{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CtxFetch","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLContext","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CtxEmbed","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLContext","moduleName":["Lattice","Services","Security","UrlValidator"]}},{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CtxEmbed","moduleName":["Lattice","Services","Security","UrlValidator"]},"typeName":{"identifier":"URLContext","moduleName":["Lattice","Services","Security","UrlValidator"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"NullBinder"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"x","sourcePos":[0,0]}},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"y","sourcePos":[0,0]}}],"type":"Case"},"type":"Abs"},"type":"Abs"}]]}},"type":"App"},"identifier":"eqURLContext"},{"annotation":{"meta":null,"sourceSpan":{"end":[110,31],"start":[110,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[113,20],"start":[111,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[110,31],"start":[110,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[111,29],"start":[111,24]}},"type":"Var","value":{"identifier":"regex","moduleName":["Data","String","Regex"]}},"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,30]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https?://[^\\s<>\"{}|\\\\^`\\[\\]]+|data:[^\\s<>\"{}|\\\\^`\\[\\]]+|"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[111,111],"start":[111,24]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[111,111],"start":[111,101]}},"type":"Var","value":{"identifier":"ignoreCase","moduleName":["Data","String","Regex","Flags"]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[113,20],"start":[111,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[112,10],"start":[112,3]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[112,10],"start":[112,9]}},"binderType":"VarBinder","identifier":"r"}],"constructorName":{"identifier":"Right","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[112,18],"start":[112,14]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[112,20],"start":[112,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[112,20],"start":[112,19]}},"type":"Var","value":{"identifier":"r","sourcePos":[112,9]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[113,9],"start":[113,3]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[113,9],"start":[113,8]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Left","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[113,20],"start":[113,13]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[110,31],"start":[110,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"identifier":"urlExtractRegex"},{"annotation":{"meta":null,"sourceSpan":{"end":[361,42],"start":[361,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[361,42],"start":[361,1]}},"argument":"prefix","body":{"annotation":{"meta":null,"sourceSpan":{"end":[361,42],"start":[361,1]}},"argument":"str","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[363,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[363,11],"start":[363,3]}},"type":"Var","value":{"identifier":"take","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[363,27],"start":[363,3]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[363,19],"start":[363,13]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[363,26],"start":[363,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[363,26],"start":[363,20]}},"type":"Var","value":{"identifier":"prefix","sourcePos":[362,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[363,31],"start":[363,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[363,31],"start":[363,28]}},"type":"Var","value":{"identifier":"str","sourcePos":[362,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[363,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[363,35]}},"type":"Var","value":{"identifier":"prefix","sourcePos":[362,1]}},"type":"App"},"type":"Abs"},"type":"Abs"},"identifier":"startsWith"},{"annotation":{"meta":null,"sourceSpan":{"end":[134,32],"start":[134,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsWhere"},"sourceSpan":{"end":[145,4],"start":[135,20]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[147,37],"start":[147,5]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[147,37],"start":[147,5]}},"argument":"pat","body":{"annotation":{"meta":null,"sourceSpan":{"end":[150,24],"start":[148,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[134,32],"start":[134,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[148,29],"start":[148,24]}},"type":"Var","value":{"identifier":"regex","moduleName":["Data","String","Regex"]}},"annotation":{"meta":null,"sourceSpan":{"end":[148,33],"start":[148,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[148,33],"start":[148,30]}},"type":"Var","value":{"identifier":"pat","sourcePos":[148,5]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[148,44],"start":[148,24]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[148,44],"start":[148,34]}},"type":"Var","value":{"identifier":"ignoreCase","moduleName":["Data","String","Regex","Flags"]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[150,24],"start":[148,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[149,14],"start":[149,7]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[149,14],"start":[149,13]}},"binderType":"VarBinder","identifier":"r"}],"constructorName":{"identifier":"Right","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[149,22],"start":[149,18]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[149,24],"start":[149,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[149,24],"start":[149,23]}},"type":"Var","value":{"identifier":"r","sourcePos":[149,13]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[150,13],"start":[150,7]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[150,13],"start":[150,12]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Left","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[150,24],"start":[150,17]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[134,32],"start":[134,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"identifier":"mkRegex"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[135,28],"start":[135,20]}},"type":"Var","value":{"identifier":"mapMaybe","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[135,36],"start":[135,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[135,36],"start":[135,29]}},"type":"Var","value":{"identifier":"mkRegex","sourcePos":[147,5]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[145,4],"start":[135,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,4],"start":[136,3]}},"type":"Literal","value":{"literalType":"ArrayLiteral","value":[{"annotation":{"meta":null,"sourceSpan":{"end":[136,55],"start":[136,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:image/(png|jpeg|jpg|gif|webp|bmp|ico|avif)"}},{"annotation":{"meta":null,"sourceSpan":{"end":[137,41],"start":[137,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:image/svg\\+xml(?!.*<script)"}},{"annotation":{"meta":null,"sourceSpan":{"end":[138,46],"start":[138,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:audio/(mp3|wav|ogg|webm|aac|flac)"}},{"annotation":{"meta":null,"sourceSpan":{"end":[139,33],"start":[139,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:video/(mp4|webm|ogg)"}},{"annotation":{"meta":null,"sourceSpan":{"end":[140,38],"start":[140,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:font/(woff|woff2|ttf|otf)"}},{"annotation":{"meta":null,"sourceSpan":{"end":[141,37],"start":[141,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:application/octet-stream"}},{"annotation":{"meta":null,"sourceSpan":{"end":[142,29],"start":[142,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:application/json"}},{"annotation":{"meta":null,"sourceSpan":{"end":[143,23],"start":[143,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:text/plain"}},{"annotation":{"meta":null,"sourceSpan":{"end":[144,21],"start":[144,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:text/csv"}}]}},"type":"App"},"type":"Let"},"identifier":"safeDataPatterns"},{"annotation":{"meta":null,"sourceSpan":{"end":[104,29],"start":[104,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[107,20],"start":[105,17]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[104,29],"start":[104,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[105,27],"start":[105,22]}},"type":"Var","value":{"identifier":"regex","moduleName":["Data","String","Regex"]}},"annotation":{"meta":null,"sourceSpan":{"end":[105,57],"start":[105,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[105,57],"start":[105,28]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^([a-zA-Z][a-zA-Z0-9+.-]*):"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[105,68],"start":[105,22]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[105,68],"start":[105,58]}},"type":"Var","value":{"identifier":"ignoreCase","moduleName":["Data","String","Regex","Flags"]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[107,20],"start":[105,17]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[106,10],"start":[106,3]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[106,10],"start":[106,9]}},"binderType":"VarBinder","identifier":"r"}],"constructorName":{"identifier":"Right","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[106,18],"start":[106,14]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[106,20],"start":[106,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[106,20],"start":[106,19]}},"type":"Var","value":{"identifier":"r","sourcePos":[106,9]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[107,9],"start":[107,3]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[107,9],"start":[107,8]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Left","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[107,20],"start":[107,13]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[104,29],"start":[104,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"identifier":"protocolRegex"},{"annotation":{"meta":null,"sourceSpan":{"end":[335,40],"start":[335,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[335,40],"start":[335,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[348,43],"start":[338,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[335,40],"start":[335,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[338,15],"start":[338,8]}},"type":"Var","value":{"identifier":"indexOf","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[338,31],"start":[338,8]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[338,24],"start":[338,17]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[338,30],"start":[338,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[338,30],"start":[338,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"://"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[338,35],"start":[338,8]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[338,35],"start":[338,32]}},"type":"Var","value":{"identifier":"url","sourcePos":[336,1]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[348,43],"start":[338,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[339,12],"start":[339,5]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[339,23],"start":[339,16]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[340,18],"start":[340,5]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[340,18],"start":[340,10]}},"binderType":"VarBinder","identifier":"protoEnd"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[348,43],"start":[341,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[341,51],"start":[341,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[341,32],"start":[341,24]}},"type":"Var","value":{"identifier":"drop","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[341,47],"start":[341,24]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[341,46],"start":[341,34]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[341,42],"start":[341,34]}},"type":"Var","value":{"identifier":"protoEnd","sourcePos":[340,10]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[341,46],"start":[341,34]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[341,46],"start":[341,45]}},"type":"Literal","value":{"literalType":"IntLiteral","value":3}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[341,51],"start":[341,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[341,51],"start":[341,48]}},"type":"Var","value":{"identifier":"url","sourcePos":[336,1]}},"type":"App"},"identifier":"afterProto"},{"annotation":{"meta":null,"sourceSpan":{"end":[347,43],"start":[343,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[347,43],"start":[343,20]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[335,40],"start":[335,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[343,32],"start":[343,25]}},"type":"Var","value":{"identifier":"indexOf","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[343,46],"start":[343,25]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[343,41],"start":[343,34]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[343,45],"start":[343,34]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[343,45],"start":[343,42]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"/"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[343,57],"start":[343,25]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[343,57],"start":[343,47]}},"type":"Var","value":{"identifier":"afterProto","sourcePos":[341,11]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[347,43],"start":[343,20]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[344,19],"start":[344,13]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[344,19],"start":[344,18]}},"binderType":"VarBinder","identifier":"i"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[344,24],"start":[344,23]}},"type":"Var","value":{"identifier":"i","sourcePos":[344,18]}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[345,20],"start":[345,13]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[347,43],"start":[345,24]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[335,40],"start":[335,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[345,36],"start":[345,29]}},"type":"Var","value":{"identifier":"indexOf","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[345,50],"start":[345,29]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[345,45],"start":[345,38]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[345,49],"start":[345,38]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[345,49],"start":[345,46]}},"type":"Literal","value":{"literalType":"StringLiteral","value":":"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[345,61],"start":[345,29]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[345,61],"start":[345,51]}},"type":"Var","value":{"identifier":"afterProto","sourcePos":[341,11]}},"type":"App"},"identifier":"v2"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[347,43],"start":[345,24]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[346,21],"start":[346,15]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[346,21],"start":[346,20]}},"binderType":"VarBinder","identifier":"i"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[346,26],"start":[346,25]}},"type":"Var","value":{"identifier":"i","sourcePos":[346,20]}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[347,22],"start":[347,15]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[347,32],"start":[347,26]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[347,43],"start":[347,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[347,43],"start":[347,33]}},"type":"Var","value":{"identifier":"afterProto","sourcePos":[341,11]}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[335,40],"start":[335,1]}},"type":"Var","value":{"identifier":"v2","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[335,40],"start":[335,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"identifier":"endIdx"}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[348,14],"start":[348,10]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[348,43],"start":[348,10]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[348,24],"start":[348,16]}},"type":"Var","value":{"identifier":"take","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[348,31],"start":[348,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[348,31],"start":[348,25]}},"type":"Var","value":{"identifier":"endIdx","sourcePos":[343,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[348,42],"start":[348,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[348,42],"start":[348,32]}},"type":"Var","value":{"identifier":"afterProto","sourcePos":[341,11]}},"type":"App"},"type":"App"},"type":"Let"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[335,40],"start":[335,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"identifier":"parseHostname"},{"annotation":{"meta":null,"sourceSpan":{"end":[289,63],"start":[289,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[289,63],"start":[289,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[289,63],"start":[289,1]}},"argument":"proto","body":{"annotation":{"meta":null,"sourceSpan":{"end":[289,63],"start":[289,1]}},"argument":"warn","body":{"annotation":{"meta":null,"sourceSpan":{"end":[297,4],"start":[291,3]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["valid",{"annotation":{"meta":null,"sourceSpan":{"end":[291,16],"start":[291,12]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}}],["sanitized",{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[292,20],"start":[292,16]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[292,24],"start":[292,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[292,24],"start":[292,21]}},"type":"Var","value":{"identifier":"url","sourcePos":[290,1]}},"type":"App"}],["error",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[293,19],"start":[293,12]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}}],["warning",{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[294,18],"start":[294,14]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[294,23],"start":[294,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[294,23],"start":[294,19]}},"type":"Var","value":{"identifier":"warn","sourcePos":[290,1]}},"type":"App"}],["protocol",{"annotation":{"meta":null,"sourceSpan":{"end":[295,20],"start":[295,15]}},"type":"Var","value":{"identifier":"proto","sourcePos":[290,1]}}],["riskLevel",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[296,27],"start":[296,16]}},"type":"Var","value":{"identifier":"RiskWarning","moduleName":["Lattice","Services","Security","UrlValidator"]}}]]}},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"mkWarning"},{"annotation":{"meta":null,"sourceSpan":{"end":[278,50],"start":[278,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[278,50],"start":[278,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[278,50],"start":[278,1]}},"argument":"proto","body":{"annotation":{"meta":null,"sourceSpan":{"end":[286,4],"start":[280,3]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["valid",{"annotation":{"meta":null,"sourceSpan":{"end":[280,16],"start":[280,12]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}}],["sanitized",{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[281,20],"start":[281,16]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[281,24],"start":[281,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[281,24],"start":[281,21]}},"type":"Var","value":{"identifier":"url","sourcePos":[279,1]}},"type":"App"}],["error",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[282,19],"start":[282,12]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}}],["warning",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[283,21],"start":[283,14]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}}],["protocol",{"annotation":{"meta":null,"sourceSpan":{"end":[284,20],"start":[284,15]}},"type":"Var","value":{"identifier":"proto","sourcePos":[279,1]}}],["riskLevel",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[285,24],"start":[285,16]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}}]]}},"type":"Abs"},"type":"Abs"},"identifier":"mkSafe"},{"annotation":{"meta":null,"sourceSpan":{"end":[267,53],"start":[267,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[267,53],"start":[267,1]}},"argument":"err","body":{"annotation":{"meta":null,"sourceSpan":{"end":[267,53],"start":[267,1]}},"argument":"proto","body":{"annotation":{"meta":null,"sourceSpan":{"end":[275,4],"start":[269,3]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["valid",{"annotation":{"meta":null,"sourceSpan":{"end":[269,17],"start":[269,12]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}}],["sanitized",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[270,23],"start":[270,16]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}}],["error",{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[271,16],"start":[271,12]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[271,20],"start":[271,12]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[271,20],"start":[271,17]}},"type":"Var","value":{"identifier":"err","sourcePos":[268,1]}},"type":"App"}],["warning",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[272,21],"start":[272,14]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}}],["protocol",{"annotation":{"meta":null,"sourceSpan":{"end":[273,20],"start":[273,15]}},"type":"Var","value":{"identifier":"proto","sourcePos":[268,1]}}],["riskLevel",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[274,27],"start":[274,16]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}}]]}},"type":"Abs"},"type":"Abs"},"identifier":"mkBlocked"},{"annotation":{"meta":null,"sourceSpan":{"end":[78,20],"start":[78,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[79,23],"start":[79,16]}},"type":"Literal","value":{"literalType":"IntLiteral","value":2000000}},"identifier":"maxURLLength"},{"annotation":{"meta":null,"sourceSpan":{"end":[243,53],"start":[243,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[243,53],"start":[243,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[243,53],"start":[243,1]}},"argument":"trustedDomains","body":{"annotation":{"meta":null,"sourceSpan":{"end":[253,23],"start":[245,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[243,53],"start":[243,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[245,21],"start":[245,8]}},"type":"Var","value":{"identifier":"parseHostname","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[245,25],"start":[245,8]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[245,25],"start":[245,22]}},"type":"Var","value":{"identifier":"url","sourcePos":[244,1]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[253,23],"start":[245,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[246,12],"start":[246,5]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[246,21],"start":[246,16]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[247,18],"start":[247,5]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[247,18],"start":[247,10]}},"binderType":"VarBinder","identifier":"hostname"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[253,23],"start":[248,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[248,44],"start":[248,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[248,35],"start":[248,28]}},"type":"Var","value":{"identifier":"toLower","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[248,44],"start":[248,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[248,44],"start":[248,36]}},"type":"Var","value":{"identifier":"hostname","sourcePos":[247,10]}},"type":"App"},"identifier":"normalizedHost"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[249,13],"start":[249,10]}},"type":"Var","value":{"identifier":"any","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[253,8],"start":[249,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[252,78],"start":[249,15]}},"argument":"domain","body":{"annotation":{"meta":null,"sourceSpan":{"end":[252,78],"start":[250,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[250,46],"start":[250,13]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[250,39],"start":[250,32]}},"type":"Var","value":{"identifier":"toLower","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[250,46],"start":[250,32]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[250,46],"start":[250,40]}},"type":"Var","value":{"identifier":"domain","sourcePos":[249,16]}},"type":"App"},"identifier":"normalizedDomain"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"disj","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[252,78],"start":[251,12]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[252,78],"start":[251,12]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[251,26],"start":[251,12]}},"type":"Var","value":{"identifier":"normalizedHost","sourcePos":[248,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[252,78],"start":[251,12]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[251,46],"start":[251,30]}},"type":"Var","value":{"identifier":"normalizedDomain","sourcePos":[250,13]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[252,78],"start":[251,12]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[252,27],"start":[252,15]}},"type":"Var","value":{"identifier":"contains","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[252,63],"start":[252,15]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[252,36],"start":[252,29]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[252,62],"start":[252,29]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[252,61],"start":[252,38]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[252,41],"start":[252,38]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"."}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[252,61],"start":[252,38]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[252,61],"start":[252,45]}},"type":"Var","value":{"identifier":"normalizedDomain","sourcePos":[250,13]}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[252,78],"start":[252,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[252,78],"start":[252,64]}},"type":"Var","value":{"identifier":"normalizedHost","sourcePos":[248,11]}},"type":"App"},"type":"App"},"type":"Let"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[253,23],"start":[249,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[253,23],"start":[253,9]}},"type":"Var","value":{"identifier":"trustedDomains","sourcePos":[244,1]}},"type":"App"},"type":"Let"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[243,53],"start":[243,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"type":"Abs"},"identifier":"isTrustedDomain"},{"annotation":{"meta":null,"sourceSpan":{"end":[316,45],"start":[316,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[316,45],"start":[316,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[316,45],"start":[316,1]}},"argument":"protocol","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"disj","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[318,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[318,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[318,11],"start":[318,3]}},"type":"Var","value":{"identifier":"protocol","sourcePos":[317,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[318,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[318,25],"start":[318,15]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"relative"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[318,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"disj","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[318,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[319,16],"start":[319,6]}},"type":"Var","value":{"identifier":"startsWith","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[319,20],"start":[319,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[319,20],"start":[319,17]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"/"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[319,24],"start":[319,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[319,24],"start":[319,21]}},"type":"Var","value":{"identifier":"url","sourcePos":[317,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[318,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"disj","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[318,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[320,16],"start":[320,6]}},"type":"Var","value":{"identifier":"startsWith","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[320,21],"start":[320,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[320,21],"start":[320,17]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"./"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[320,25],"start":[320,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[320,25],"start":[320,22]}},"type":"Var","value":{"identifier":"url","sourcePos":[317,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[318,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[321,16],"start":[321,6]}},"type":"Var","value":{"identifier":"startsWith","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[321,22],"start":[321,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[321,22],"start":[321,17]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"../"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[321,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[321,26],"start":[321,23]}},"type":"Var","value":{"identifier":"url","sourcePos":[317,1]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"Abs"},"type":"Abs"},"identifier":"isRelativeURL"},{"annotation":{"meta":null,"sourceSpan":{"end":[351,46],"start":[351,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[351,46],"start":[351,1]}},"argument":"text","body":{"annotation":{"meta":null,"sourceSpan":{"end":[358,28],"start":[354,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[354,43],"start":[354,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[354,24],"start":[354,15]}},"type":"Var","value":{"identifier":"split","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[354,38],"start":[354,15]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[354,33],"start":[354,26]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[354,37],"start":[354,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[354,37],"start":[354,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":" "}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[354,43],"start":[354,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[354,43],"start":[354,39]}},"type":"Var","value":{"identifier":"text","sourcePos":[352,1]}},"type":"App"},"identifier":"words"},{"annotation":{"meta":null,"sourceSpan":{"end":[357,51],"start":[355,7]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[357,51],"start":[355,7]}},"argument":"w","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"disj","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[357,51],"start":[355,21]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[355,31],"start":[355,21]}},"type":"Var","value":{"identifier":"startsWith","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[355,41],"start":[355,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[355,41],"start":[355,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"http://"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[355,53],"start":[355,21]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[355,50],"start":[355,43]}},"type":"Var","value":{"identifier":"toLower","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[355,52],"start":[355,43]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[355,52],"start":[355,51]}},"type":"Var","value":{"identifier":"w","sourcePos":[355,7]}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[357,51],"start":[355,21]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"disj","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[357,51],"start":[355,21]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[356,31],"start":[356,21]}},"type":"Var","value":{"identifier":"startsWith","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[356,42],"start":[356,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[356,42],"start":[356,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[356,54],"start":[356,21]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[356,51],"start":[356,44]}},"type":"Var","value":{"identifier":"toLower","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[356,53],"start":[356,44]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[356,53],"start":[356,52]}},"type":"Var","value":{"identifier":"w","sourcePos":[355,7]}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[357,51],"start":[355,21]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[357,31],"start":[357,21]}},"type":"Var","value":{"identifier":"startsWith","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[357,39],"start":[357,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[357,39],"start":[357,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[357,51],"start":[357,21]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[357,48],"start":[357,41]}},"type":"Var","value":{"identifier":"toLower","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[357,50],"start":[357,41]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[357,50],"start":[357,49]}},"type":"Var","value":{"identifier":"w","sourcePos":[355,7]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"Abs"},"identifier":"isURLLike"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[358,12],"start":[358,6]}},"type":"Var","value":{"identifier":"filter","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[358,22],"start":[358,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[358,22],"start":[358,13]}},"type":"Var","value":{"identifier":"isURLLike","sourcePos":[355,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[358,28],"start":[358,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[358,28],"start":[358,23]}},"type":"Var","value":{"identifier":"words","sourcePos":[354,7]}},"type":"App"},"type":"Let"},"type":"Abs"},"identifier":"extractURLsFromText"},{"annotation":{"meta":null,"sourceSpan":{"end":[307,36],"start":[307,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[307,36],"start":[307,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[313,26],"start":[309,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,36],"start":[307,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[309,15],"start":[309,8]}},"type":"Var","value":{"identifier":"indexOf","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[309,29],"start":[309,8]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[309,24],"start":[309,17]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[309,28],"start":[309,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[309,28],"start":[309,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":":"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[309,33],"start":[309,8]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[309,33],"start":[309,30]}},"type":"Var","value":{"identifier":"url","sourcePos":[308,1]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[313,26],"start":[309,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[310,13],"start":[310,5]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[310,13],"start":[310,10]}},"binderType":"VarBinder","identifier":"idx"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[312,23],"start":[311,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[311,41],"start":[311,11]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[311,27],"start":[311,19]}},"type":"Var","value":{"identifier":"take","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[311,37],"start":[311,19]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[311,36],"start":[311,29]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[311,32],"start":[311,29]}},"type":"Var","value":{"identifier":"idx","sourcePos":[310,10]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[311,36],"start":[311,29]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[311,36],"start":[311,35]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[311,41],"start":[311,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[311,41],"start":[311,38]}},"type":"Var","value":{"identifier":"url","sourcePos":[308,1]}},"type":"App"},"identifier":"proto"}],"expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[312,17],"start":[312,10]}},"type":"Var","value":{"identifier":"toLower","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[312,23],"start":[312,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[312,23],"start":[312,18]}},"type":"Var","value":{"identifier":"proto","sourcePos":[311,11]}},"type":"App"},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[313,12],"start":[313,5]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[313,26],"start":[313,16]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"relative"}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[307,36],"start":[307,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"identifier":"extractProtocol"},{"annotation":{"meta":null,"sourceSpan":{"end":[324,43],"start":[324,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[324,43],"start":[324,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[332,27],"start":[327,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[327,33],"start":[327,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[327,27],"start":[327,19]}},"type":"Var","value":{"identifier":"drop","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[327,29],"start":[327,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[327,29],"start":[327,28]}},"type":"Literal","value":{"literalType":"IntLiteral","value":5}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[327,33],"start":[327,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[327,33],"start":[327,30]}},"type":"Var","value":{"identifier":"url","sourcePos":[325,1]}},"type":"App"},"identifier":"afterData"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[332,27],"start":[328,6]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[324,43],"start":[324,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[328,18],"start":[328,11]}},"type":"Var","value":{"identifier":"indexOf","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[328,32],"start":[328,11]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[328,27],"start":[328,20]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[328,31],"start":[328,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[328,31],"start":[328,28]}},"type":"Literal","value":{"literalType":"StringLiteral","value":";"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[328,42],"start":[328,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[328,42],"start":[328,33]}},"type":"Var","value":{"identifier":"afterData","sourcePos":[327,7]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[332,27],"start":[328,6]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[329,13],"start":[329,5]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[329,13],"start":[329,10]}},"binderType":"VarBinder","identifier":"idx"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[329,25],"start":[329,17]}},"type":"Var","value":{"identifier":"take","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[329,29],"start":[329,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[329,29],"start":[329,26]}},"type":"Var","value":{"identifier":"idx","sourcePos":[329,10]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[329,39],"start":[329,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[329,39],"start":[329,30]}},"type":"Var","value":{"identifier":"afterData","sourcePos":[327,7]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[330,12],"start":[330,5]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[332,27],"start":[330,16]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[324,43],"start":[324,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[330,28],"start":[330,21]}},"type":"Var","value":{"identifier":"indexOf","moduleName":["Data","String","CodeUnits"]}},"annotation":{"meta":null,"sourceSpan":{"end":[330,42],"start":[330,21]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[330,37],"start":[330,30]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[330,41],"start":[330,30]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[330,41],"start":[330,38]}},"type":"Literal","value":{"literalType":"StringLiteral","value":","}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[330,52],"start":[330,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[330,52],"start":[330,43]}},"type":"Var","value":{"identifier":"afterData","sourcePos":[327,7]}},"type":"App"},"identifier":"v1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[332,27],"start":[330,16]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[331,15],"start":[331,7]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[331,15],"start":[331,12]}},"binderType":"VarBinder","identifier":"idx"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[331,27],"start":[331,19]}},"type":"Var","value":{"identifier":"take","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[331,31],"start":[331,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[331,31],"start":[331,28]}},"type":"Var","value":{"identifier":"idx","sourcePos":[331,12]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[331,41],"start":[331,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[331,41],"start":[331,32]}},"type":"Var","value":{"identifier":"afterData","sourcePos":[327,7]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[332,14],"start":[332,7]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[332,27],"start":[332,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"unknown"}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[324,43],"start":[324,1]}},"type":"Var","value":{"identifier":"v1","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[324,43],"start":[324,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Let"},"type":"Abs"},"identifier":"extractMimeFromDataURL"},{"annotation":{"meta":null,"sourceSpan":{"end":[230,31],"start":[230,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[230,31],"start":[230,1]}},"argument":"s","body":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[236,19],"start":[236,5]}},"type":"Var","value":{"identifier":"replaceAll","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[236,33],"start":[236,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[236,28],"start":[236,21]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[236,32],"start":[236,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[236,32],"start":[236,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"'"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[236,60],"start":[236,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[236,50],"start":[236,35]}},"type":"Var","value":{"identifier":"Replacement","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[236,59],"start":[236,35]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[236,59],"start":[236,51]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"&#x27;"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[236,60],"start":[231,16]}},"argument":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[235,19],"start":[235,5]}},"type":"Var","value":{"identifier":"replaceAll","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[235,34],"start":[235,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[235,28],"start":[235,21]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[235,33],"start":[235,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[235,33],"start":[235,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"\""}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[235,61],"start":[235,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[235,51],"start":[235,36]}},"type":"Var","value":{"identifier":"Replacement","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[235,60],"start":[235,36]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[235,60],"start":[235,52]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"&quot;"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[236,60],"start":[231,16]}},"argument":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[234,19],"start":[234,5]}},"type":"Var","value":{"identifier":"replaceAll","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[234,33],"start":[234,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[234,28],"start":[234,21]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[234,32],"start":[234,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,32],"start":[234,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":">"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[234,58],"start":[234,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[234,50],"start":[234,35]}},"type":"Var","value":{"identifier":"Replacement","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[234,57],"start":[234,35]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,57],"start":[234,51]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"&gt;"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[236,60],"start":[231,16]}},"argument":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[233,19],"start":[233,5]}},"type":"Var","value":{"identifier":"replaceAll","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[233,33],"start":[233,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[233,28],"start":[233,21]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[233,32],"start":[233,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[233,32],"start":[233,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"<"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[233,58],"start":[233,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[233,50],"start":[233,35]}},"type":"Var","value":{"identifier":"Replacement","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[233,57],"start":[233,35]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[233,57],"start":[233,51]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"&lt;"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[236,60],"start":[231,16]}},"argument":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[232,19],"start":[232,5]}},"type":"Var","value":{"identifier":"replaceAll","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[232,33],"start":[232,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[232,28],"start":[232,21]}},"type":"Var","value":{"identifier":"Pattern","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[232,32],"start":[232,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[232,32],"start":[232,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"&"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[232,59],"start":[232,5]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[232,50],"start":[232,35]}},"type":"Var","value":{"identifier":"Replacement","moduleName":["Data","String","Pattern"]}},"annotation":{"meta":null,"sourceSpan":{"end":[232,58],"start":[232,35]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[232,58],"start":[232,51]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"&amp;"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[236,60],"start":[231,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[231,17],"start":[231,16]}},"type":"Var","value":{"identifier":"s","sourcePos":[231,1]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"Abs"},"identifier":"escapeHTML"},{"annotation":{"meta":null,"sourceSpan":{"end":[83,33],"start":[83,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[97,4],"start":[85,3]}},"type":"Literal","value":{"literalType":"ArrayLiteral","value":[{"annotation":{"meta":null,"sourceSpan":{"end":[85,18],"start":[85,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"javascript:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[86,16],"start":[86,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"vbscript:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[87,12],"start":[87,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"file:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[88,11],"start":[88,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"ftp:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[89,14],"start":[89,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"gopher:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[90,10],"start":[90,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"ws:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[91,11],"start":[91,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"wss:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[92,14],"start":[92,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"chrome:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[93,24],"start":[93,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"chrome-extension:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[94,21],"start":[94,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"moz-extension:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[95,13],"start":[95,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"about:"}},{"annotation":{"meta":null,"sourceSpan":{"end":[96,19],"start":[96,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"view-source:"}}]}},"identifier":"blockedProtocols"},{"annotation":{"meta":null,"sourceSpan":{"end":[300,46],"start":[300,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[300,46],"start":[300,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[304,24],"start":[302,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[302,27],"start":[302,7]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[302,23],"start":[302,16]}},"type":"Var","value":{"identifier":"toLower","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[302,27],"start":[302,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[302,27],"start":[302,24]}},"type":"Var","value":{"identifier":"url","sourcePos":[301,1]}},"type":"App"},"identifier":"lowUrl"},{"annotation":{"meta":null,"sourceSpan":{"end":[303,68],"start":[303,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[303,23],"start":[303,17]}},"type":"Var","value":{"identifier":"filter","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[303,51],"start":[303,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[303,50],"start":[303,25]}},"argument":"p","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[303,41],"start":[303,31]}},"type":"Var","value":{"identifier":"startsWith","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[303,43],"start":[303,31]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[303,43],"start":[303,42]}},"type":"Var","value":{"identifier":"p","sourcePos":[303,26]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[303,50],"start":[303,31]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[303,50],"start":[303,44]}},"type":"Var","value":{"identifier":"lowUrl","sourcePos":[302,7]}},"type":"App"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[303,68],"start":[303,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[303,68],"start":[303,52]}},"type":"Var","value":{"identifier":"blockedProtocols","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"matched"}],"expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[304,16],"start":[304,6]}},"type":"Var","value":{"identifier":"head","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[304,24],"start":[304,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[304,24],"start":[304,17]}},"type":"Var","value":{"identifier":"matched","sourcePos":[303,7]}},"type":"App"},"type":"Let"},"type":"Abs"},"identifier":"findBlockedProtocol"},{"annotation":{"meta":null,"sourceSpan":{"end":[116,35],"start":[116,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":{"metaType":"IsWhere"},"sourceSpan":{"end":[126,4],"start":[117,23]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[128,37],"start":[128,5]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[128,37],"start":[128,5]}},"argument":"pat","body":{"annotation":{"meta":null,"sourceSpan":{"end":[131,24],"start":[129,19]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[116,35],"start":[116,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[129,29],"start":[129,24]}},"type":"Var","value":{"identifier":"regex","moduleName":["Data","String","Regex"]}},"annotation":{"meta":null,"sourceSpan":{"end":[129,33],"start":[129,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[129,33],"start":[129,30]}},"type":"Var","value":{"identifier":"pat","sourcePos":[129,5]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[129,44],"start":[129,24]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[129,44],"start":[129,34]}},"type":"Var","value":{"identifier":"ignoreCase","moduleName":["Data","String","Regex","Flags"]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[131,24],"start":[129,19]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[130,14],"start":[130,7]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[130,14],"start":[130,13]}},"binderType":"VarBinder","identifier":"r"}],"constructorName":{"identifier":"Right","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[130,22],"start":[130,18]}},"type":"Var","value":{"identifier":"Just","moduleName":["Data","Maybe"]}},"annotation":{"meta":null,"sourceSpan":{"end":[130,24],"start":[130,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[130,24],"start":[130,23]}},"type":"Var","value":{"identifier":"r","sourcePos":[130,13]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[131,13],"start":[131,7]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[131,13],"start":[131,12]}},"binderType":"NullBinder"}],"constructorName":{"identifier":"Left","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[131,24],"start":[131,17]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[116,35],"start":[116,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"identifier":"mkRegex"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[117,31],"start":[117,23]}},"type":"Var","value":{"identifier":"mapMaybe","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[117,39],"start":[117,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,39],"start":[117,32]}},"type":"Var","value":{"identifier":"mkRegex","sourcePos":[128,5]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[126,4],"start":[117,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[126,4],"start":[118,3]}},"type":"Literal","value":{"literalType":"ArrayLiteral","value":[{"annotation":{"meta":null,"sourceSpan":{"end":[118,22],"start":[118,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:text/html"}},{"annotation":{"meta":null,"sourceSpan":{"end":[119,35],"start":[119,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:application/javascript"}},{"annotation":{"meta":null,"sourceSpan":{"end":[120,37],"start":[120,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:application/x-javascript"}},{"annotation":{"meta":null,"sourceSpan":{"end":[121,28],"start":[121,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:text/javascript"}},{"annotation":{"meta":null,"sourceSpan":{"end":[122,35],"start":[122,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:application/ecmascript"}},{"annotation":{"meta":null,"sourceSpan":{"end":[123,28],"start":[123,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:text/ecmascript"}},{"annotation":{"meta":null,"sourceSpan":{"end":[124,36],"start":[124,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:application/xhtml\\+xml"}},{"annotation":{"meta":null,"sourceSpan":{"end":[125,37],"start":[125,5]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"^data:image/svg\\+xml.*<script"}}]}},"type":"App"},"type":"Let"},"identifier":"blockedDataPatterns"},{"annotation":{"meta":null,"sourceSpan":{"end":[193,49],"start":[193,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[193,49],"start":[193,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[204,76],"start":[196,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[204,76],"start":[196,3]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[197,19],"start":[197,10]}},"type":"Var","value":{"identifier":"mkBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,88],"start":[197,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,88],"start":[197,20]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Data URL contains blocked content type (possible script injection)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,96],"start":[197,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,96],"start":[197,89]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[204,76],"start":[196,3]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[204,76],"start":[199,8]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[204,76],"start":[199,8]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[200,16],"start":[200,10]}},"type":"Var","value":{"identifier":"mkSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,20],"start":[200,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,20],"start":[200,17]}},"type":"Var","value":{"identifier":"url","sourcePos":[194,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,28],"start":[200,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,28],"start":[200,21]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[204,76],"start":[199,8]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[204,76],"start":[203,5]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[203,42],"start":[203,9]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[203,38],"start":[203,16]}},"type":"Var","value":{"identifier":"extractMimeFromDataURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[203,42],"start":[203,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[203,42],"start":[203,39]}},"type":"Var","value":{"identifier":"url","sourcePos":[194,1]}},"type":"App"},"identifier":"mime"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[204,17],"start":[204,8]}},"type":"Var","value":{"identifier":"mkBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[204,68],"start":[204,8]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[204,67],"start":[204,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[204,59],"start":[204,19]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Data URL with unrecognized MIME type: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[204,67],"start":[204,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[204,67],"start":[204,63]}},"type":"Var","value":{"identifier":"mime","sourcePos":[203,9]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[204,76],"start":[204,8]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[204,76],"start":[204,69]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:"}},"type":"App"},"type":"Let"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[199,14],"start":[199,11]}},"type":"Var","value":{"identifier":"any","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,37],"start":[199,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,36],"start":[199,16]}},"argument":"pat","body":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[199,28],"start":[199,24]}},"type":"Var","value":{"identifier":"test","moduleName":["Data","String","Regex"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,32],"start":[199,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,32],"start":[199,29]}},"type":"Var","value":{"identifier":"pat","sourcePos":[199,17]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,36],"start":[199,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,36],"start":[199,33]}},"type":"Var","value":{"identifier":"url","sourcePos":[194,1]}},"type":"App"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,54],"start":[199,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,54],"start":[199,38]}},"type":"Var","value":{"identifier":"safeDataPatterns","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"}],"type":"Case"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[196,9],"start":[196,6]}},"type":"Var","value":{"identifier":"any","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,32],"start":[196,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,31],"start":[196,11]}},"argument":"pat","body":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[196,23],"start":[196,19]}},"type":"Var","value":{"identifier":"test","moduleName":["Data","String","Regex"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,27],"start":[196,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,27],"start":[196,24]}},"type":"Var","value":{"identifier":"pat","sourcePos":[196,12]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,31],"start":[196,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,31],"start":[196,28]}},"type":"Var","value":{"identifier":"url","sourcePos":[194,1]}},"type":"App"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,52],"start":[196,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,52],"start":[196,33]}},"type":"Var","value":{"identifier":"blockedDataPatterns","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"}],"type":"Case"},"type":"Abs"},"identifier":"validateDataURL"},{"annotation":{"meta":null,"sourceSpan":{"end":[157,59],"start":[157,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[157,59],"start":[157,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[157,59],"start":[157,1]}},"argument":"_context","body":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[160,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[160,28],"start":[160,7]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[160,24],"start":[160,20]}},"type":"Var","value":{"identifier":"trim","moduleName":["Data","String","Common"]}},"annotation":{"meta":null,"sourceSpan":{"end":[160,28],"start":[160,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[160,28],"start":[160,25]}},"type":"Var","value":{"identifier":"url","sourcePos":[158,1]}},"type":"App"},"identifier":"trimmedUrl"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[163,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[163,3]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[164,19],"start":[164,10]}},"type":"Var","value":{"identifier":"mkBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[164,34],"start":[164,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,34],"start":[164,20]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"URL is empty"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[164,41],"start":[164,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,41],"start":[164,35]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"none"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[163,3]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[166,8]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[166,8]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[167,19],"start":[167,10]}},"type":"Var","value":{"identifier":"mkBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[167,54],"start":[167,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[167,54],"start":[167,20]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"URL exceeds maximum length (2MB)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[167,64],"start":[167,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[167,64],"start":[167,55]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"unknown"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[166,8]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[169,8]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[157,59],"start":[157,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[169,32],"start":[169,13]}},"type":"Var","value":{"identifier":"findBlockedProtocol","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[169,43],"start":[169,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[169,43],"start":[169,33]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[169,8]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[170,17],"start":[170,5]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[170,17],"start":[170,10]}},"binderType":"VarBinder","identifier":"blocked"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[170,30],"start":[170,21]}},"type":"Var","value":{"identifier":"mkBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[170,86],"start":[170,21]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[170,85],"start":[170,32]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[170,52],"start":[170,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Blocked protocol: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[170,85],"start":[170,32]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[170,85],"start":[170,32]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[170,63],"start":[170,56]}},"type":"Var","value":{"identifier":"blocked","sourcePos":[170,10]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[170,85],"start":[170,32]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[170,85],"start":[170,67]}},"type":"Literal","value":{"literalType":"StringLiteral","value":" - security risk"}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[170,94],"start":[170,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[170,94],"start":[170,87]}},"type":"Var","value":{"identifier":"blocked","sourcePos":[170,10]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[171,12],"start":[171,5]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[172,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[172,48],"start":[172,11]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[172,37],"start":[172,22]}},"type":"Var","value":{"identifier":"extractProtocol","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[172,48],"start":[172,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[172,48],"start":[172,38]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"identifier":"protocol"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[175,7]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[175,7]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[176,29],"start":[176,14]}},"type":"Var","value":{"identifier":"validateDataURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[176,40],"start":[176,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[176,40],"start":[176,30]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[175,7]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[178,12]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[178,12]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[179,20],"start":[179,14]}},"type":"Var","value":{"identifier":"mkSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[179,31],"start":[179,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[179,31],"start":[179,21]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[179,39],"start":[179,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[179,39],"start":[179,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"blob:"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[178,12]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[181,12]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[181,12]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[182,20],"start":[182,14]}},"type":"Var","value":{"identifier":"mkSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[182,31],"start":[182,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,31],"start":[182,21]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[182,40],"start":[182,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,40],"start":[182,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https:"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[181,12]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[184,12]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[184,12]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[185,23],"start":[185,14]}},"type":"Var","value":{"identifier":"mkWarning","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,34],"start":[185,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,34],"start":[185,24]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,42],"start":[185,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,42],"start":[185,35]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"http:"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,98],"start":[185,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,98],"start":[185,43]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Unencrypted HTTP connection - data may be intercepted"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[184,12]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[187,12]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[187,12]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[188,20],"start":[188,14]}},"type":"Var","value":{"identifier":"mkSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[188,31],"start":[188,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[188,31],"start":[188,21]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[188,42],"start":[188,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[188,42],"start":[188,32]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"relative"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[187,12]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[190,21],"start":[190,12]}},"type":"Var","value":{"identifier":"mkBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[190,85],"start":[190,12]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[190,84],"start":[190,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,43],"start":[190,23]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Unknown protocol: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[190,84],"start":[190,23]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[190,84],"start":[190,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,55],"start":[190,47]}},"type":"Var","value":{"identifier":"protocol","sourcePos":[172,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[190,84],"start":[190,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,84],"start":[190,59]}},"type":"Literal","value":{"literalType":"StringLiteral","value":" - blocked for security"}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[190,12]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,94],"start":[190,86]}},"type":"Var","value":{"identifier":"protocol","sourcePos":[172,11]}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[187,28],"start":[187,15]}},"type":"Var","value":{"identifier":"isRelativeURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[187,39],"start":[187,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[187,39],"start":[187,29]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[187,48],"start":[187,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[187,48],"start":[187,40]}},"type":"Var","value":{"identifier":"protocol","sourcePos":[172,11]}},"type":"App"}],"type":"Case"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[184,34],"start":[184,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,23],"start":[184,15]}},"type":"Var","value":{"identifier":"protocol","sourcePos":[172,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[184,34],"start":[184,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,34],"start":[184,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"http:"}},"type":"App"}],"type":"Case"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[181,35],"start":[181,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[181,23],"start":[181,15]}},"type":"Var","value":{"identifier":"protocol","sourcePos":[172,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[181,35],"start":[181,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[181,35],"start":[181,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https:"}},"type":"App"}],"type":"Case"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[178,34],"start":[178,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[178,23],"start":[178,15]}},"type":"Var","value":{"identifier":"protocol","sourcePos":[172,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[178,34],"start":[178,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[178,34],"start":[178,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"blob:"}},"type":"App"}],"type":"Case"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[175,29],"start":[175,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[175,18],"start":[175,10]}},"type":"Var","value":{"identifier":"protocol","sourcePos":[172,11]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[175,29],"start":[175,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[175,29],"start":[175,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:"}},"type":"App"}],"type":"Case"},"type":"Let"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[157,59],"start":[157,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"greaterThan","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[166,43],"start":[166,11]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[166,17],"start":[166,11]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[166,28],"start":[166,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,28],"start":[166,18]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[166,43],"start":[166,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,43],"start":[166,31]}},"type":"Var","value":{"identifier":"maxURLLength","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"}],"type":"Case"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eq1","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[163,28],"start":[163,6]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[163,12],"start":[163,6]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","String","CodePoints"]}},"annotation":{"meta":null,"sourceSpan":{"end":[163,23],"start":[163,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[163,23],"start":[163,13]}},"type":"Var","value":{"identifier":"trimmedUrl","sourcePos":[160,7]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[163,28],"start":[163,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[163,28],"start":[163,27]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}},"type":"App"}],"type":"Case"},"type":"Let"},"type":"Abs"},"type":"Abs"},"identifier":"validateURL"},{"annotation":{"meta":null,"sourceSpan":{"end":[256,62],"start":[256,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[256,62],"start":[256,1]}},"argument":"text","body":{"annotation":{"meta":null,"sourceSpan":{"end":[260,45],"start":[259,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[259,38],"start":[259,7]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[259,33],"start":[259,14]}},"type":"Var","value":{"identifier":"extractURLsFromText","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[259,38],"start":[259,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[259,38],"start":[259,34]}},"type":"Var","value":{"identifier":"text","sourcePos":[257,1]}},"type":"App"},"identifier":"urls"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"map","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[260,40],"start":[260,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[260,39],"start":[260,11]}},"argument":"u","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[260,28],"start":[260,17]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[260,30],"start":[260,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[260,30],"start":[260,29]}},"type":"Var","value":{"identifier":"u","sourcePos":[260,12]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[260,39],"start":[260,17]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[260,39],"start":[260,31]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[260,45],"start":[260,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[260,45],"start":[260,41]}},"type":"Var","value":{"identifier":"urls","sourcePos":[259,7]}},"type":"App"},"type":"Let"},"type":"Abs"},"identifier":"extractAndValidateURLs"},{"annotation":{"meta":null,"sourceSpan":{"end":[217,53],"start":[217,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[217,53],"start":[217,1]}},"argument":"url","body":{"annotation":{"meta":null,"sourceSpan":{"end":[227,42],"start":[219,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[219,40],"start":[219,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[219,27],"start":[219,16]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[219,31],"start":[219,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[219,31],"start":[219,28]}},"type":"Var","value":{"identifier":"url","sourcePos":[218,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[219,40],"start":[219,16]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[219,40],"start":[219,32]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[227,42],"start":[221,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[227,42],"start":[221,3]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[224,76],"start":[222,10]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[223,13],"start":[223,7]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[223,13],"start":[223,12]}},"binderType":"VarBinder","identifier":"s"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[223,22],"start":[223,17]}},"type":"Var","value":{"identifier":"Right","moduleName":["Data","Either"]}},"annotation":{"meta":null,"sourceSpan":{"end":[223,37],"start":[223,17]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[223,34],"start":[223,24]}},"type":"Var","value":{"identifier":"escapeHTML","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[223,36],"start":[223,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[223,36],"start":[223,35]}},"type":"Var","value":{"identifier":"s","sourcePos":[223,12]}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[224,14],"start":[224,7]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[224,22],"start":[224,18]}},"type":"Var","value":{"identifier":"Left","moduleName":["Data","Either"]}},"annotation":{"meta":null,"sourceSpan":{"end":[224,76],"start":[224,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[224,76],"start":[224,23]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"URL validation passed but no sanitized URL returned"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[222,31],"start":[222,15]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[222,21],"start":[222,15]}},"type":"Var","value":{"identifier":"result","sourcePos":[219,7]}},"fieldName":"sanitized","type":"Accessor"}],"type":"Case"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[227,42],"start":[221,3]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[225,14],"start":[225,10]}},"type":"Var","value":{"identifier":"Left","moduleName":["Data","Either"]}},"annotation":{"meta":null,"sourceSpan":{"end":[227,42],"start":[225,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[227,41],"start":[225,16]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[226,13],"start":[226,7]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[226,13],"start":[226,12]}},"binderType":"VarBinder","identifier":"e"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[226,18],"start":[226,17]}},"type":"Var","value":{"identifier":"e","sourcePos":[226,12]}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[227,14],"start":[227,7]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[227,41],"start":[227,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"URL validation failed"}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[225,33],"start":[225,21]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[225,27],"start":[225,21]}},"type":"Var","value":{"identifier":"result","sourcePos":[219,7]}},"fieldName":"error","type":"Accessor"}],"type":"Case"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[221,18],"start":[221,6]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[221,12],"start":[221,6]}},"type":"Var","value":{"identifier":"result","sourcePos":[219,7]}},"fieldName":"valid","type":"Accessor"}],"type":"Case"},"type":"Let"},"type":"Abs"},"identifier":"sanitizeURLForHTML"},{"annotation":{"meta":null,"sourceSpan":{"end":[207,63],"start":[207,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[207,63],"start":[207,1]}},"argument":"urls","body":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"foldl","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[209,64],"start":[209,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,63],"start":[209,10]}},"argument":"m","body":{"annotation":{"meta":null,"sourceSpan":{"end":[209,63],"start":[209,10]}},"argument":"url","body":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"insert","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[209,34],"start":[209,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,34],"start":[209,31]}},"type":"Var","value":{"identifier":"url","sourcePos":[209,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,61],"start":[209,20]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[209,47],"start":[209,36]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[209,51],"start":[209,36]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,51],"start":[209,48]}},"type":"Var","value":{"identifier":"url","sourcePos":[209,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,60],"start":[209,36]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[209,60],"start":[209,52]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,63],"start":[209,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,63],"start":[209,62]}},"type":"Var","value":{"identifier":"m","sourcePos":[209,11]}},"type":"App"},"type":"Abs"},"type":"Abs"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,74],"start":[209,3]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[209,74],"start":[209,65]}},"type":"Var","value":{"identifier":"empty","moduleName":["Data","Map","Internal"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,79],"start":[209,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,79],"start":[209,75]}},"type":"Var","value":{"identifier":"urls","sourcePos":[208,1]}},"type":"App"},"type":"Abs"},"identifier":"validateURLs"}],"exports":["CtxAsset","CtxFetch","CtxEmbed","RiskSafe","RiskWarning","RiskBlocked","validateURL","validateDataURL","validateURLs","sanitizeURLForHTML","isTrustedDomain","extractAndValidateURLs","blockedProtocols","maxURLLength","eqURLContext","genericURLContext_","showURLContext","eqURLRiskLevel","genericURLRiskLevel_","showURLRiskLevel"],"foreign":[],"imports":[{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Array"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Either"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Eq"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Foldable"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Function"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Functor"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Generic","Rep"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","HeytingAlgebra"]},{"annotation":{"meta":null,"sourceSpan":{"end":[35,23],"start":[35,1]}},"moduleName":["Data","Map"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Map","Internal"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Maybe"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Ord"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Semigroup"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Semiring"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Show"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Show","Generic"]},{"annotation":{"meta":null,"sourceSpan":{"end":[38,26],"start":[38,1]}},"moduleName":["Data","String"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","String","CodePoints"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","String","CodeUnits"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","String","Common"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","String","Pattern"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","String","Regex"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","String","Regex","Flags"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Data","Symbol"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Lattice","Services","Security","UrlValidator"]},{"annotation":{"meta":null,"sourceSpan":{"end":[29,15],"start":[29,1]}},"moduleName":["Prelude"]},{"annotation":{"meta":null,"sourceSpan":{"end":[363,41],"start":[10,1]}},"moduleName":["Prim"]}],"moduleName":["Lattice","Services","Security","UrlValidator"],"modulePath":"src/Lattice/Services/Security/UrlValidator.purs","reExports":{},"sourceSpan":{"end":[363,41],"start":[10,1]}}