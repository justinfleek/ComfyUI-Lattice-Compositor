{"comments":"Lattice.Services.Security.UrlValidator - URL validation for security\n\nSecurity module for validating URLs before loading external resources.\nBlocks dangerous protocols that could lead to XSS, code execution, or data exfiltration.\n\nENTERPRISE SECURITY: Critical security control for Enterprise Grade security.\n\nSource: ui/src/services/security/urlValidator.ts\n","declarations":[{"children":[],"comments":"Validation result\n","info":{"arguments":[],"declType":"typeSynonym","type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Record"],"tag":"TypeConstructor"},{"annotation":[],"contents":["valid",{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"},{"annotation":[],"contents":["sanitized",{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Maybe"],"Maybe"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":["error",{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Maybe"],"Maybe"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":["warning",{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Maybe"],"Maybe"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":["protocol",{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"},{"annotation":[],"contents":["riskLevel",{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLRiskLevel"],"tag":"TypeConstructor"},{"annotation":[],"tag":"REmpty"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[71,4],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[64,1]},"title":"URLValidationResult"},{"children":[{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[50,27],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[50,17]},"title":"CtxAsset"},{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[50,38],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[50,28]},"title":"CtxFetch"},{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[50,49],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[50,39]},"title":"CtxEmbed"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Eq"],"Eq"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLContext"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[52,30],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[52,1]},"title":"<anonymous>"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Generic","Rep"],"Generic"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLContext"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":null,"tag":"TypeWildcard"}],"tag":"TypeApp"}},"sourceSpan":{"end":[53,37],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[53,1]},"title":"<anonymous>"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Show"],"Show"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLContext"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[54,50],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[54,1]},"title":"<anonymous>"}],"comments":"URL validation context\n","info":{"dataDeclType":"data","declType":"data","roles":[],"typeArguments":[]},"kind":null,"sourceSpan":{"end":[50,49],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[50,1]},"title":"URLContext"},{"children":[{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[57,29],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[57,19]},"title":"RiskSafe"},{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[57,43],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[57,30]},"title":"RiskWarning"},{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[57,57],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[57,44]},"title":"RiskBlocked"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Eq"],"Eq"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLRiskLevel"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[59,32],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[59,1]},"title":"<anonymous>"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Generic","Rep"],"Generic"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLRiskLevel"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":null,"tag":"TypeWildcard"}],"tag":"TypeApp"}},"sourceSpan":{"end":[60,39],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[60,1]},"title":"<anonymous>"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Show"],"Show"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLRiskLevel"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[61,52],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[61,1]},"title":"<anonymous>"}],"comments":"Risk level assessment\n","info":{"dataDeclType":"data","declType":"data","roles":[],"typeArguments":[]},"kind":null,"sourceSpan":{"end":[57,57],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[57,1]},"title":"URLRiskLevel"},{"children":[],"comments":"Validate a URL for safe loading\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLContext"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLValidationResult"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[157,59],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[157,1]},"title":"validateURL"},{"children":[],"comments":"Validate data: URLs - only allows safe MIME types\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLValidationResult"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[193,49],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[193,1]},"title":"validateDataURL"},{"children":[],"comments":"Batch validate multiple URLs\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Map","Internal"],"Map"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLValidationResult"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[207,63],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[207,1]},"title":"validateURLs"},{"children":[],"comments":"Sanitize a URL for safe use in HTML attributes\nReturns Either with error on invalid URL (no exceptions)\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Either"],"Either"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[217,53],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[217,1]},"title":"sanitizeURLForHTML"},{"children":[],"comments":"Check if URL is from a trusted domain\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[243,53],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[243,1]},"title":"isTrustedDomain"},{"children":[],"comments":"Extract and validate URLs from text content\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Services","Security","UrlValidator"],"URLValidationResult"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[256,62],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[256,1]},"title":"extractAndValidateURLs"},{"children":[],"comments":"Dangerous protocols that MUST be blocked\nThese can execute code or access local resources\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[83,33],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[83,1]},"title":"blockedProtocols"},{"children":[],"comments":"Maximum URL length (2MB for data URLs)\n","info":{"declType":"value","type":{"annotation":[],"contents":[["Prim"],"Int"],"tag":"TypeConstructor"}},"kind":null,"sourceSpan":{"end":[78,20],"name":"src/Lattice/Services/Security/UrlValidator.purs","start":[78,1]},"title":"maxURLLength"}],"name":"Lattice.Services.Security.UrlValidator","reExports":[]}