// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as $$Math from "../Math/index.js";
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordNumber);
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordNumber);
var max1 = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordInt);
var min1 = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordInt);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var EchoAdd = /* #__PURE__ */ (function () {
    function EchoAdd() {

    };
    EchoAdd.value = new EchoAdd();
    return EchoAdd;
})();
var EchoScreen = /* #__PURE__ */ (function () {
    function EchoScreen() {

    };
    EchoScreen.value = new EchoScreen();
    return EchoScreen;
})();
var EchoMaximum = /* #__PURE__ */ (function () {
    function EchoMaximum() {

    };
    EchoMaximum.value = new EchoMaximum();
    return EchoMaximum;
})();
var EchoMinimum = /* #__PURE__ */ (function () {
    function EchoMinimum() {

    };
    EchoMinimum.value = new EchoMinimum();
    return EchoMinimum;
})();
var EchoCompositeBack = /* #__PURE__ */ (function () {
    function EchoCompositeBack() {

    };
    EchoCompositeBack.value = new EchoCompositeBack();
    return EchoCompositeBack;
})();
var EchoCompositeFront = /* #__PURE__ */ (function () {
    function EchoCompositeFront() {

    };
    EchoCompositeFront.value = new EchoCompositeFront();
    return EchoCompositeFront;
})();
var EchoBlend = /* #__PURE__ */ (function () {
    function EchoBlend() {

    };
    EchoBlend.value = new EchoBlend();
    return EchoBlend;
})();
var validateStartingIntensity = function (i) {
    return max(0.0)(min(1.0)(i));
};
var validateNumEchoes = function (n) {
    return max1(1)(min1(50)(n));
};
var validateEchoTime = function (echoTime) {
    return function (fps) {
        var $16 = echoTime === 0.0;
        if ($16) {
            return -1.0 / fps;
        };
        return echoTime;
    };
};
var validateDecay = function (d) {
    return max(0.0)(min(1.0)(d));
};
var showEchoOperator = {
    show: function (v) {
        if (v instanceof EchoAdd) {
            return "add";
        };
        if (v instanceof EchoScreen) {
            return "screen";
        };
        if (v instanceof EchoMaximum) {
            return "maximum";
        };
        if (v instanceof EchoMinimum) {
            return "minimum";
        };
        if (v instanceof EchoCompositeBack) {
            return "composite_back";
        };
        if (v instanceof EchoCompositeFront) {
            return "composite_front";
        };
        if (v instanceof EchoBlend) {
            return "blend";
        };
        throw new Error("Failed pattern match at Lattice.Services.Time.Echo (line 52, column 1 - line 59, column 27): " + [ v.constructor.name ]);
    }
};
var shouldDrawEchosBehind = function (v) {
    if (v instanceof EchoCompositeBack) {
        return true;
    };
    return false;
};
var parseEchoOperator = function (s) {
    if (s === "add") {
        return EchoAdd.value;
    };
    if (s === "screen") {
        return EchoScreen.value;
    };
    if (s === "maximum") {
        return EchoMaximum.value;
    };
    if (s === "minimum") {
        return EchoMinimum.value;
    };
    if (s === "composite_back") {
        return EchoCompositeBack.value;
    };
    if (s === "composite_front") {
        return EchoCompositeFront.value;
    };
    if (s === "blend") {
        return EchoBlend.value;
    };
    return EchoAdd.value;
};
var intensityThreshold = 1.0e-3;
var eqEchoOperator = {
    eq: function (x) {
        return function (y) {
            if (x instanceof EchoAdd && y instanceof EchoAdd) {
                return true;
            };
            if (x instanceof EchoScreen && y instanceof EchoScreen) {
                return true;
            };
            if (x instanceof EchoMaximum && y instanceof EchoMaximum) {
                return true;
            };
            if (x instanceof EchoMinimum && y instanceof EchoMinimum) {
                return true;
            };
            if (x instanceof EchoCompositeBack && y instanceof EchoCompositeBack) {
                return true;
            };
            if (x instanceof EchoCompositeFront && y instanceof EchoCompositeFront) {
                return true;
            };
            if (x instanceof EchoBlend && y instanceof EchoBlend) {
                return true;
            };
            return false;
        };
    }
};
var echoRequiresCurrentOnTop = function (v) {
    if (v instanceof EchoCompositeBack) {
        return true;
    };
    return false;
};
var echoOperatorToComposite = function (op) {
    if (op instanceof EchoAdd) {
        return "lighter";
    };
    if (op instanceof EchoScreen) {
        return "screen";
    };
    if (op instanceof EchoMaximum) {
        return "lighten";
    };
    if (op instanceof EchoMinimum) {
        return "darken";
    };
    if (op instanceof EchoCompositeBack) {
        return "destination-over";
    };
    if (op instanceof EchoCompositeFront) {
        return "source-over";
    };
    if (op instanceof EchoBlend) {
        return "source-over";
    };
    throw new Error("Failed pattern match at Lattice.Services.Time.Echo (line 75, column 30 - line 82, column 29): " + [ op.constructor.name ]);
};
var calculateEchoIntensities = function (startingIntensity) {
    return function (decay) {
        return function (numEchoes) {
            var base = 1.0 - decay;
            var calcIntensity = function (i) {
                return startingIntensity * $$Math.pow(base)(Data_Int.toNumber(i));
            };
            return map(calcIntensity)(Data_Array.range(0)(numEchoes - 1 | 0));
        };
    };
};
export {
    EchoAdd,
    EchoScreen,
    EchoMaximum,
    EchoMinimum,
    EchoCompositeBack,
    EchoCompositeFront,
    EchoBlend,
    parseEchoOperator,
    echoOperatorToComposite,
    validateNumEchoes,
    validateStartingIntensity,
    validateDecay,
    validateEchoTime,
    calculateEchoIntensities,
    intensityThreshold,
    shouldDrawEchosBehind,
    echoRequiresCurrentOnTop,
    eqEchoOperator,
    showEchoOperator
};
//# sourceMappingURL=index.js.map
