// Generated by purs version 0.15.15
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as $$Math from "../Math/index.js";
var WholeFrames = /* #__PURE__ */ (function () {
    function WholeFrames() {

    };
    WholeFrames.value = new WholeFrames();
    return WholeFrames;
})();
var FrameMix = /* #__PURE__ */ (function () {
    function FrameMix() {

    };
    FrameMix.value = new FrameMix();
    return FrameMix;
})();
var PixelMotion = /* #__PURE__ */ (function () {
    function PixelMotion() {

    };
    PixelMotion.value = new PixelMotion();
    return PixelMotion;
})();
var selectWholeFrame = function (blendFactor) {
    return blendFactor < 0.5;
};
var posterizedFrame = function (currentFrame) {
    return function (sourceFps) {
        return function (targetFps) {
            if (targetFps <= 0.0 || sourceFps <= 0.0) {
                return currentFrame;
            };
            if (Data_Boolean.otherwise) {
                var frameRatio = sourceFps / targetFps;
                var quantized = $$Math.floor(Data_Int.toNumber(currentFrame) / frameRatio) * frameRatio;
                return Data_Int.round(quantized);
            };
            throw new Error("Failed pattern match at Lattice.Services.Time.FrameBlending (line 91, column 1 - line 91, column 50): " + [ currentFrame.constructor.name, sourceFps.constructor.name, targetFps.constructor.name ]);
        };
    };
};
var needsBlending = function (blendFactor) {
    if (blendFactor === 0.0 || blendFactor === 1.0) {
        return Data_Maybe.Nothing.value;
    };
    if (Data_Boolean.otherwise) {
        return new Data_Maybe.Just(blendFactor);
    };
    throw new Error("Failed pattern match at Lattice.Services.Time.FrameBlending (line 125, column 1 - line 125, column 40): " + [ blendFactor.constructor.name ]);
};
var motionBlurFactor = function (motionBlurAmount) {
    return function (motionMagnitude) {
        return $$Math.min(1.0)((motionBlurAmount * motionMagnitude) / 10.0);
    };
};
var mixPixelValue = function (frame1Value) {
    return function (frame2Value) {
        return function (blend) {
            return frame1Value * (1.0 - blend) + frame2Value * blend;
        };
    };
};
var mixPixelRGBA = function (r1) {
    return function (g1) {
        return function (b1) {
            return function (a1) {
                return function (r2) {
                    return function (g2) {
                        return function (b2) {
                            return function (a2) {
                                return function (blend) {
                                    return new Data_Tuple.Tuple(mixPixelValue(r1)(r2)(blend), new Data_Tuple.Tuple(mixPixelValue(g1)(g2)(blend), new Data_Tuple.Tuple(mixPixelValue(b1)(b2)(blend), mixPixelValue(a1)(a2)(blend))));
                                };
                            };
                        };
                    };
                };
            };
        };
    };
};
var isSignificantEcho = function (intensity) {
    return intensity > 1.0e-3;
};
var isNewPosterizedFrame = function (currentFrame) {
    return function (sourceFps) {
        return function (targetFps) {
            var posterized = posterizedFrame(currentFrame)(sourceFps)(targetFps);
            var diff = $$Math.abs(Data_Int.toNumber(currentFrame) - Data_Int.toNumber(posterized));
            return diff < 0.5;
        };
    };
};
var eqTimewarpMethod = {
    eq: function (x) {
        return function (y) {
            if (x instanceof WholeFrames && y instanceof WholeFrames) {
                return true;
            };
            if (x instanceof FrameMix && y instanceof FrameMix) {
                return true;
            };
            if (x instanceof PixelMotion && y instanceof PixelMotion) {
                return true;
            };
            return false;
        };
    }
};
var echoIntensity = function (startingIntensity) {
    return function (decay) {
        return function (echoIndex) {
            return startingIntensity * $$Math.pow(1.0 - decay)(Data_Int.toNumber(echoIndex));
        };
    };
};
var adjustedBlendForMotion = function (blend) {
    return function (blurFactor) {
        return blend * (1.0 - blurFactor * 0.5);
    };
};
export {
    WholeFrames,
    FrameMix,
    PixelMotion,
    selectWholeFrame,
    mixPixelValue,
    mixPixelRGBA,
    echoIntensity,
    isSignificantEcho,
    posterizedFrame,
    isNewPosterizedFrame,
    motionBlurFactor,
    adjustedBlendForMotion,
    needsBlending,
    eqTimewarpMethod
};
//# sourceMappingURL=index.js.map
