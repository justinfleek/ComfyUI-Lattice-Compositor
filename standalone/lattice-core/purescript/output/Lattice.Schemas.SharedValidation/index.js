// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Number from "../Data.Number/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Data_String_Common from "../Data.String.Common/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var mkError = function (field) {
    return function (message) {
        return {
            field: field,
            message: message
        };
    };
};
var validateArrayLength = function (field) {
    return function (maxLen) {
        return function (arr) {
            if (Data_Array.length(arr) > maxLen) {
                return new Data_Either.Left(mkError(field)("must have at most " + (show(maxLen) + " elements")));
            };
            if (Data_Boolean.otherwise) {
                return new Data_Either.Right(arr);
            };
            throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 269, column 1 - line 269, column 94): " + [ field.constructor.name, maxLen.constructor.name, arr.constructor.name ]);
        };
    };
};
var validateDate = function (field) {
    return function (value) {
        if (Data_String_CodePoints.length(value) !== 10) {
            return new Data_Either.Left(mkError(field)("must be YYYY-MM-DD format"));
        };
        if (Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(4)(value)) === "-" && Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(7)(value)) === "-") {
            return new Data_Either.Right(value);
        };
        if (Data_Boolean.otherwise) {
            return new Data_Either.Left(mkError(field)("must be YYYY-MM-DD format"));
        };
        throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 300, column 1 - line 300, column 66): " + [ field.constructor.name, value.constructor.name ]);
    };
};
var validateDateTime = function (field) {
    return function (value) {
        var dateTimePart = Data_String_CodePoints.take(19)(value);
        var hasValidStructure = Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(4)(dateTimePart)) === "-" && (Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(7)(dateTimePart)) === "-" && (Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(10)(dateTimePart)) === "T" && (Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(13)(dateTimePart)) === ":" && Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(16)(dateTimePart)) === ":")));
        var $25 = Data_String_CodePoints.length(value) < 19;
        if ($25) {
            return new Data_Either.Left(mkError(field)("must be valid ISO 8601 datetime"));
        };
        if (hasValidStructure) {
            return new Data_Either.Right(value);
        };
        return new Data_Either.Left(mkError(field)("must be valid ISO 8601 datetime"));
    };
};
var validateNonEmptyArray = function (field) {
    return function (arr) {
        if (Data_Array["null"](arr)) {
            return new Data_Either.Left(mkError(field)("must not be empty"));
        };
        if (Data_Boolean.otherwise) {
            return new Data_Either.Right(arr);
        };
        throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 276, column 1 - line 276, column 89): " + [ field.constructor.name, arr.constructor.name ]);
    };
};
var validateNonEmptyString = function (field) {
    return function (maxLen) {
        return function (value) {
            if (Data_String_Common["null"](value)) {
                return new Data_Either.Left(mkError(field)("must not be empty"));
            };
            if (Data_String_CodePoints.length(value) > maxLen) {
                return new Data_Either.Left(mkError(field)("must be at most " + (show(maxLen) + " characters")));
            };
            if (Data_Boolean.otherwise) {
                return new Data_Either.Right(Data_String_Common.trim(value));
            };
            throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 161, column 1 - line 161, column 83): " + [ field.constructor.name, maxLen.constructor.name, value.constructor.name ]);
        };
    };
};
var validateNonNegativeFloat = function (field) {
    return function (maxVal) {
        return function (value) {
            if (value < 0.0) {
                return new Data_Either.Left(mkError(field)("must be non-negative"));
            };
            if (Data_Number["isNaN"](value) || !Data_Number["isFinite"](value)) {
                return new Data_Either.Left(mkError(field)("must be finite"));
            };
            if (value > maxVal) {
                return new Data_Either.Left(mkError(field)("must be at most " + show1(maxVal)));
            };
            if (Data_Boolean.otherwise) {
                return new Data_Either.Right(value);
            };
            throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 256, column 1 - line 256, column 88): " + [ field.constructor.name, maxVal.constructor.name, value.constructor.name ]);
        };
    };
};
var validateNonNegativeInt = function (field) {
    return function (maxVal) {
        return function (value) {
            if (value < 0) {
                return new Data_Either.Left(mkError(field)("must be non-negative"));
            };
            if (value > maxVal) {
                return new Data_Either.Left(mkError(field)("must be at most " + show(maxVal)));
            };
            if (Data_Boolean.otherwise) {
                return new Data_Either.Right(value);
            };
            throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 240, column 1 - line 240, column 77): " + [ field.constructor.name, maxVal.constructor.name, value.constructor.name ]);
        };
    };
};
var validatePositiveFloat = function (field) {
    return function (maxVal) {
        return function (value) {
            if (value <= 0.0) {
                return new Data_Either.Left(mkError(field)("must be positive"));
            };
            if (Data_Number["isNaN"](value) || !Data_Number["isFinite"](value)) {
                return new Data_Either.Left(mkError(field)("must be finite"));
            };
            if (value > maxVal) {
                return new Data_Either.Left(mkError(field)("must be at most " + show1(maxVal)));
            };
            if (Data_Boolean.otherwise) {
                return new Data_Either.Right(value);
            };
            throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 247, column 1 - line 247, column 85): " + [ field.constructor.name, maxVal.constructor.name, value.constructor.name ]);
        };
    };
};
var validatePositiveInt = function (field) {
    return function (maxVal) {
        return function (value) {
            if (value <= 0) {
                return new Data_Either.Left(mkError(field)("must be positive"));
            };
            if (value > maxVal) {
                return new Data_Either.Left(mkError(field)("must be at most " + show(maxVal)));
            };
            if (Data_Boolean.otherwise) {
                return new Data_Either.Right(value);
            };
            throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 233, column 1 - line 233, column 74): " + [ field.constructor.name, maxVal.constructor.name, value.constructor.name ]);
        };
    };
};
var validateString = function (field) {
    return function (maxLen) {
        return function (value) {
            if (Data_String_CodePoints.length(value) > maxLen) {
                return new Data_Either.Left(mkError(field)("must be at most " + (show(maxLen) + " characters")));
            };
            if (Data_Boolean.otherwise) {
                return new Data_Either.Right(Data_String_Common.trim(value));
            };
            throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 169, column 1 - line 169, column 75): " + [ field.constructor.name, maxLen.constructor.name, value.constructor.name ]);
        };
    };
};
var maxWarningLength = 500;
var maxUrlLength = 2048;
var maxTagsCount = 50;
var maxTagLength = 50;
var maxShaderLength = 100000;
var maxPathLength = 500;
var maxNameLength = 200;
var maxMimeTypeLength = 100;
var maxIdLength = 200;
var maxFontStyleLength = 100;
var maxFontFamilyLength = 200;
var maxFilenameLength = 255;
var maxDescriptionLength = 2000;
var maxCommentLength = 5000;
var maxBase64Length = /* #__PURE__ */ (function () {
    return (50 * 1024 | 0) * 1024 | 0;
})();
var maxAnimationNameLength = 100;
var isIdChar = function (c) {
    return c >= "a" && c <= "z" || (c >= "A" && c <= "Z" || (c >= "0" && c <= "9" || (c === "_" || c === "-")));
};
var validateEntityId = function (field) {
    return function (value) {
        if (Data_String_Common["null"](value)) {
            return new Data_Either.Left(mkError(field)("must not be empty"));
        };
        if (Data_String_CodePoints.length(value) > maxIdLength) {
            return new Data_Either.Left(mkError(field)("must be at most " + (show(maxIdLength) + " characters")));
        };
        if (!Data_Array.all(isIdChar)(Data_String_CodeUnits.toCharArray(value))) {
            return new Data_Either.Left(mkError(field)("must contain only alphanumeric, underscores, and hyphens"));
        };
        if (Data_Boolean.otherwise) {
            return new Data_Either.Right(value);
        };
        throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 203, column 1 - line 203, column 70): " + [ field.constructor.name, value.constructor.name ]);
    };
};
var isHexDigit = function (c) {
    return c >= "0" && c <= "9" || (c >= "a" && c <= "f" || c >= "A" && c <= "F");
};
var validateHexColor = function (field) {
    return function (value) {
        var len = Data_String_CodePoints.length(value);
        var chars = Data_String_CodeUnits.toCharArray(Data_String_CodePoints.drop(1)(value));
        var allHex = Data_Array.all(isHexDigit)(chars);
        var $49 = len === 7 && (Data_String_CodePoints.take(1)(value) === "#" && allHex);
        if ($49) {
            return new Data_Either.Right(value);
        };
        var $50 = len === 9 && (Data_String_CodePoints.take(1)(value) === "#" && allHex);
        if ($50) {
            return new Data_Either.Right(value);
        };
        return new Data_Either.Left(mkError(field)("must be valid hex color (#RRGGBB or #RRGGBBAA)"));
    };
};
var invalidFilenameChars = [ "<", ">", ":", "\"", "|", "?", "*" ];
var validateFilename = function (field) {
    return function (value) {
        if (Data_String_CodePoints.length(value) > maxFilenameLength) {
            return new Data_Either.Left(mkError(field)("must be at most " + (show(maxFilenameLength) + " characters")));
        };
        if (Data_Array.any(function (c) {
            return Data_String_CodeUnits.contains(c)(value);
        })(invalidFilenameChars)) {
            return new Data_Either.Left(mkError(field)("contains invalid characters"));
        };
        if (Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(Data_String_CodePoints.length(value) - 1 | 0)(value)) === "." || Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(Data_String_CodePoints.length(value) - 1 | 0)(value)) === " ") {
            return new Data_Either.Left(mkError(field)("must not end with dot or space"));
        };
        if (Data_Boolean.otherwise) {
            return new Data_Either.Right(value);
        };
        throw new Error("Failed pattern match at Lattice.Schemas.SharedValidation (line 217, column 1 - line 217, column 70): " + [ field.constructor.name, value.constructor.name ]);
    };
};
var defaultLimits = {
    maxDimension: 8192,
    maxFrameCount: 10000,
    maxArrayLength: 100000,
    maxParticles: 1000000,
    maxLayers: 1000,
    maxKeyframesPerProperty: 10000,
    maxStringLength: 100000,
    maxFPS: 120
};
export {
    maxNameLength,
    maxDescriptionLength,
    maxCommentLength,
    maxTagLength,
    maxTagsCount,
    maxPathLength,
    maxIdLength,
    maxMimeTypeLength,
    maxFontFamilyLength,
    maxFontStyleLength,
    maxUrlLength,
    maxBase64Length,
    maxShaderLength,
    maxFilenameLength,
    maxAnimationNameLength,
    maxWarningLength,
    defaultLimits,
    mkError,
    validateNonEmptyString,
    validateString,
    validateHexColor,
    validateEntityId,
    validateFilename,
    validatePositiveInt,
    validateNonNegativeInt,
    validatePositiveFloat,
    validateNonNegativeFloat,
    validateArrayLength,
    validateNonEmptyArray,
    validateDateTime,
    validateDate
};
//# sourceMappingURL=index.js.map
