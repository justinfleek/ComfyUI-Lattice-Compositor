// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_EuclideanRing from "../Data.EuclideanRing/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as $$Math from "../Math/index.js";
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordInt);
var div = /* #__PURE__ */ Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var foldl = /* #__PURE__ */ Data_Foldable.foldl(Data_Foldable.foldableArray);
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordInt);
var Flat = /* #__PURE__ */ (function () {
    function Flat() {

    };
    Flat.value = new Flat();
    return Flat;
})();
var Fillet = /* #__PURE__ */ (function () {
    function Fillet() {

    };
    Fillet.value = new Fillet();
    return Fillet;
})();
var Convex = /* #__PURE__ */ (function () {
    function Convex() {

    };
    Convex.value = new Convex();
    return Convex;
})();
var Concave = /* #__PURE__ */ (function () {
    function Concave() {

    };
    Concave.value = new Concave();
    return Concave;
})();
var Steps = /* #__PURE__ */ (function () {
    function Steps() {

    };
    Steps.value = new Steps();
    return Steps;
})();
var Custom = /* #__PURE__ */ (function () {
    function Custom() {

    };
    Custom.value = new Custom();
    return Custom;
})();
var stepsProfile = function (radius) {
    return function (depth) {
        return function (segments) {
            var stepCount = max(2)(div(segments)(2));
            var stepHeight = depth / Data_Int.toNumber(stepCount);
            var stepWidth = radius / Data_Int.toNumber(stepCount);
            var buildSteps = function ($copy_i) {
                return function ($copy_acc) {
                    var $tco_var_i = $copy_i;
                    var $tco_done = false;
                    var $tco_result;
                    function $tco_loop(i, acc) {
                        if (i > stepCount) {
                            $tco_done = true;
                            return acc;
                        };
                        if (Data_Boolean.otherwise) {
                            var iFloat = Data_Int.toNumber(i);
                            var stepPt = {
                                x: iFloat * stepWidth,
                                y: iFloat * stepHeight
                            };
                            var acc$prime = Data_Array.snoc(acc)(stepPt);
                            var $21 = i < stepCount;
                            if ($21) {
                                var riserPt = {
                                    x: iFloat * stepWidth,
                                    y: (iFloat + 1.0) * stepHeight
                                };
                                $tco_var_i = i + 1 | 0;
                                $copy_acc = Data_Array.snoc(acc$prime)(riserPt);
                                return;
                            };
                            $tco_var_i = i + 1 | 0;
                            $copy_acc = acc$prime;
                            return;
                        };
                        throw new Error("Failed pattern match at Lattice.Services.SVGExtrusion.CapProfile (line 127, column 7 - line 127, column 58): " + [ i.constructor.name, acc.constructor.name ]);
                    };
                    while (!$tco_done) {
                        $tco_result = $tco_loop($tco_var_i, $copy_acc);
                    };
                    return $tco_result;
                };
            };
            return buildSteps(0)([  ]);
        };
    };
};
var scaleCustomProfile = function (customPoints) {
    return function (radius) {
        return function (depth) {
            return map(function (p) {
                return {
                    x: p.x * radius,
                    y: p.y * depth
                };
            })(customPoints);
        };
    };
};
var requiresCurveGeneration = function (v) {
    if (v instanceof Flat) {
        return false;
    };
    return true;
};
var minSegmentsFor = function (v) {
    if (v instanceof Flat) {
        return 1;
    };
    if (v instanceof Fillet) {
        return 4;
    };
    if (v instanceof Convex) {
        return 4;
    };
    if (v instanceof Concave) {
        return 4;
    };
    if (v instanceof Steps) {
        return 4;
    };
    if (v instanceof Custom) {
        return 2;
    };
    throw new Error("Failed pattern match at Lattice.Services.SVGExtrusion.CapProfile (line 186, column 1 - line 186, column 40): " + [ v.constructor.name ]);
};
var flatProfile = function (depth) {
    return [ {
        x: 0.0,
        y: 0.0
    }, {
        x: 0.0,
        y: depth
    } ];
};
var filletProfile = function (radius) {
    return function (depth) {
        return function (segments) {
            var mkPoint = function (i) {
                var t = Data_Int.toNumber(i) / Data_Int.toNumber(segments);
                var angle = ($$Math.pi / 2.0) * t;
                var x = radius * (1.0 - $$Math.cos(angle));
                var y = depth * $$Math.sin(angle);
                return {
                    x: x,
                    y: y
                };
            };
            return map(mkPoint)(Data_Array.range(0)(segments));
        };
    };
};
var eqCapProfileType = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Flat && y instanceof Flat) {
                return true;
            };
            if (x instanceof Fillet && y instanceof Fillet) {
                return true;
            };
            if (x instanceof Convex && y instanceof Convex) {
                return true;
            };
            if (x instanceof Concave && y instanceof Concave) {
                return true;
            };
            if (x instanceof Steps && y instanceof Steps) {
                return true;
            };
            if (x instanceof Custom && y instanceof Custom) {
                return true;
            };
            return false;
        };
    }
};
var convexProfile = function (radius) {
    return function (depth) {
        return function (segments) {
            var mkPoint = function (i) {
                var t = Data_Int.toNumber(i) / Data_Int.toNumber(segments);
                var y = depth * t;
                var bulge = $$Math.sin($$Math.pi * t) * radius * 0.5;
                var x = -bulge;
                return {
                    x: x,
                    y: y
                };
            };
            return map(mkPoint)(Data_Array.range(0)(segments));
        };
    };
};
var concaveProfile = function (radius) {
    return function (depth) {
        return function (segments) {
            var mkPoint = function (i) {
                var t = Data_Int.toNumber(i) / Data_Int.toNumber(segments);
                var y = depth * t;
                var scoop = $$Math.sin($$Math.pi * t) * radius;
                return {
                    x: scoop,
                    y: y
                };
            };
            return map(mkPoint)(Data_Array.range(0)(segments));
        };
    };
};
var generateCapProfile = function (profileType) {
    return function (radius) {
        return function (depth) {
            return function (segments) {
                return function (customProfile) {
                    var length = function (arr) {
                        return foldl(function (acc) {
                            return function (v) {
                                return acc + 1 | 0;
                            };
                        })(0)(arr);
                    };
                    if (profileType instanceof Flat) {
                        return flatProfile(depth);
                    };
                    if (profileType instanceof Fillet) {
                        return filletProfile(radius)(depth)(segments);
                    };
                    if (profileType instanceof Convex) {
                        return convexProfile(radius)(depth)(segments);
                    };
                    if (profileType instanceof Concave) {
                        return concaveProfile(radius)(depth)(segments);
                    };
                    if (profileType instanceof Steps) {
                        return stepsProfile(radius)(depth)(segments);
                    };
                    if (profileType instanceof Custom) {
                        if (customProfile instanceof Data_Maybe.Just && length(customProfile.value0) >= 2) {
                            return scaleCustomProfile(customProfile.value0)(radius)(depth);
                        };
                        return filletProfile(radius)(depth)(segments);
                    };
                    throw new Error("Failed pattern match at Lattice.Services.SVGExtrusion.CapProfile (line 162, column 3 - line 170, column 47): " + [ profileType.constructor.name ]);
                };
            };
        };
    };
};
var clampSegments = function (segments) {
    return function (profileType) {
        var minSeg = minSegmentsFor(profileType);
        return max(minSeg)(min(32)(segments));
    };
};
export {
    Flat,
    Fillet,
    Convex,
    Concave,
    Steps,
    Custom,
    flatProfile,
    filletProfile,
    convexProfile,
    concaveProfile,
    stepsProfile,
    scaleCustomProfile,
    generateCapProfile,
    requiresCurveGeneration,
    minSegmentsFor,
    clampSegments,
    eqCapProfileType
};
//# sourceMappingURL=index.js.map
