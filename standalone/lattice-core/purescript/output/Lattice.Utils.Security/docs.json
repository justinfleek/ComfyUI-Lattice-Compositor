{"comments":"Lattice.Utils.Security - Security utilities\n\nProvides secure alternatives for common operations:\n- URL validation (SSRF prevention)\n- Input sanitization\n- Runtime type validation\n\nNote: Crypto random is platform-specific. Use Effect.Random\nor a crypto library for secure random in PureScript.\n\nSource: lattice-core/lean/Lattice/Utils/Security.lean\n","declarations":[{"children":[],"comments":"URL validation options\n","info":{"arguments":[],"declType":"typeSynonym","type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Record"],"tag":"TypeConstructor"},{"annotation":[],"contents":["allowData",{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"},{"annotation":[],"contents":["allowBlob",{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"},{"annotation":[],"contents":["allowHttp",{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"},{"annotation":[],"tag":"REmpty"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[84,4],"name":"src/Lattice/Utils/Security.purs","start":[80,1]},"title":"URLValidationOptions"},{"children":[],"comments":"Default URL validation options\n","info":{"declType":"value","type":{"annotation":[],"contents":[["Lattice","Utils","Security"],"URLValidationOptions"],"tag":"TypeConstructor"}},"kind":null,"sourceSpan":{"end":[87,42],"name":"src/Lattice/Utils/Security.purs","start":[87,1]},"title":"defaultURLOptions"},{"children":[{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[96,13],"name":"src/Lattice/Utils/Security.purs","start":[96,3]},"title":"URLValid"},{"comments":null,"info":{"arguments":[{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"declType":"dataConstructor"},"sourceSpan":{"end":[97,23],"name":"src/Lattice/Utils/Security.purs","start":[97,3]},"title":"URLInvalidProtocol"},{"comments":null,"info":{"arguments":[{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"declType":"dataConstructor"},"sourceSpan":{"end":[98,23],"name":"src/Lattice/Utils/Security.purs","start":[98,3]},"title":"URLBlockedHostname"},{"comments":null,"info":{"arguments":[{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"declType":"dataConstructor"},"sourceSpan":{"end":[99,17],"name":"src/Lattice/Utils/Security.purs","start":[99,3]},"title":"URLPrivateIP"},{"comments":null,"info":{"arguments":[{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"declType":"dataConstructor"},"sourceSpan":{"end":[100,18],"name":"src/Lattice/Utils/Security.purs","start":[100,3]},"title":"URLParseError"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Generic","Rep"],"Generic"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"URLValidationResult"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":null,"tag":"TypeWildcard"}],"tag":"TypeApp"}},"sourceSpan":{"end":[102,46],"name":"src/Lattice/Utils/Security.purs","start":[102,1]},"title":"<anonymous>"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Show"],"Show"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"URLValidationResult"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[105,21],"name":"src/Lattice/Utils/Security.purs","start":[104,1]},"title":"<anonymous>"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Eq"],"Eq"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"URLValidationResult"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[107,39],"name":"src/Lattice/Utils/Security.purs","start":[107,1]},"title":"<anonymous>"}],"comments":"URL validation result\n","info":{"dataDeclType":"data","declType":"data","roles":[],"typeArguments":[]},"kind":null,"sourceSpan":{"end":[100,25],"name":"src/Lattice/Utils/Security.purs","start":[95,1]},"title":"URLValidationResult"},{"children":[],"comments":"Parsed URL components\n","info":{"arguments":[],"declType":"typeSynonym","type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Record"],"tag":"TypeConstructor"},{"annotation":[],"contents":["protocol",{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"},{"annotation":[],"contents":["hostname",{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"},{"annotation":[],"contents":["port",{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Maybe"],"Maybe"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"Int"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":["path",{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"},{"annotation":[],"tag":"REmpty"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[115,4],"name":"src/Lattice/Utils/Security.purs","start":[110,1]},"title":"ParsedURL"},{"children":[],"comments":"Simple URL parser\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Maybe"],"Maybe"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"ParsedURL"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[118,38],"name":"src/Lattice/Utils/Security.purs","start":[118,1]},"title":"parseURL"},{"children":[],"comments":"Validate a URL for safe external resource loading\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"URLValidationOptions"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"URLValidationResult"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[150,69],"name":"src/Lattice/Utils/Security.purs","start":[150,1]},"title":"validateURL"},{"children":[],"comments":"Check if URL validation succeeded\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"URLValidationOptions"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[170,56],"name":"src/Lattice/Utils/Security.purs","start":[170,1]},"title":"isValidURL"},{"children":[],"comments":"Check if a hostname is a private IPv4 address\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[63,33],"name":"src/Lattice/Utils/Security.purs","start":[63,1]},"title":"isPrivateIP"},{"children":[],"comments":"Blocked hostnames (localhost, private IPs)\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[59,33],"name":"src/Lattice/Utils/Security.purs","start":[59,1]},"title":"blockedHostnames"},{"children":[],"comments":"Sanitize a filename to prevent directory traversal\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[185,37],"name":"src/Lattice/Utils/Security.purs","start":[185,1]},"title":"sanitizeFilename"},{"children":[],"comments":"Escape a string for safe HTML display\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[210,31],"name":"src/Lattice/Utils/Security.purs","start":[210,1]},"title":"escapeHTML"},{"children":[],"comments":"Validation error with context\n","info":{"arguments":[],"declType":"typeSynonym","type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Record"],"tag":"TypeConstructor"},{"annotation":[],"contents":["message",{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"},{"annotation":[],"contents":["path",{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"tag":"REmpty"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[225,4],"name":"src/Lattice/Utils/Security.purs","start":[222,1]},"title":"ValidationError"},{"children":[],"comments":"Create a validation error\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"ValidationError"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[228,63],"name":"src/Lattice/Utils/Security.purs","start":[228,1]},"title":"mkValidationError"},{"children":[],"comments":"Format validation error path\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[232,37],"name":"src/Lattice/Utils/Security.purs","start":[232,1]},"title":"formatPath"},{"children":[{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[243,13],"name":"src/Lattice/Utils/Security.purs","start":[243,3]},"title":"JSONNull"},{"comments":null,"info":{"arguments":[{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"}],"declType":"dataConstructor"},"sourceSpan":{"end":[244,13],"name":"src/Lattice/Utils/Security.purs","start":[244,3]},"title":"JSONBool"},{"comments":null,"info":{"arguments":[{"annotation":[],"contents":[["Prim"],"Number"],"tag":"TypeConstructor"}],"declType":"dataConstructor"},"sourceSpan":{"end":[245,15],"name":"src/Lattice/Utils/Security.purs","start":[245,3]},"title":"JSONNumber"},{"comments":null,"info":{"arguments":[{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"declType":"dataConstructor"},"sourceSpan":{"end":[246,15],"name":"src/Lattice/Utils/Security.purs","start":[246,3]},"title":"JSONString"},{"comments":null,"info":{"arguments":[{"annotation":[],"contents":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},"tag":"ParensInType"}],"declType":"dataConstructor"},"sourceSpan":{"end":[247,14],"name":"src/Lattice/Utils/Security.purs","start":[247,3]},"title":"JSONArray"},{"comments":null,"info":{"arguments":[{"annotation":[],"contents":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Tuple"],"Tuple"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},"tag":"ParensInType"}],"tag":"TypeApp"},"tag":"ParensInType"}],"declType":"dataConstructor"},"sourceSpan":{"end":[248,15],"name":"src/Lattice/Utils/Security.purs","start":[248,3]},"title":"JSONObject"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Eq"],"Eq"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[250,29],"name":"src/Lattice/Utils/Security.purs","start":[250,1]},"title":"<anonymous>"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Show"],"Show"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[260,74],"name":"src/Lattice/Utils/Security.purs","start":[252,1]},"title":"<anonymous>"}],"comments":"Simple JSON value representation\n","info":{"dataDeclType":"data","declType":"data","roles":[],"typeArguments":[]},"kind":null,"sourceSpan":{"end":[248,48],"name":"src/Lattice/Utils/Security.purs","start":[242,1]},"title":"JSONValue"},{"children":[],"comments":"Check if a JSONValue is an object\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[263,37],"name":"src/Lattice/Utils/Security.purs","start":[263,1]},"title":"jsonIsObject"},{"children":[],"comments":"Check if a JSONValue is an array\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Prim"],"Boolean"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[268,36],"name":"src/Lattice/Utils/Security.purs","start":[268,1]},"title":"jsonIsArray"},{"children":[],"comments":"Get object fields\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Maybe"],"Maybe"],"tag":"TypeConstructor"},{"annotation":[],"contents":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Tuple"],"Tuple"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},"tag":"ParensInType"}],"tag":"TypeApp"},"tag":"ParensInType"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[273,69],"name":"src/Lattice/Utils/Security.purs","start":[273,1]},"title":"jsonGetFields"},{"children":[],"comments":"Get array items\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Maybe"],"Maybe"],"tag":"TypeConstructor"},{"annotation":[],"contents":{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Array"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},"tag":"ParensInType"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[278,53],"name":"src/Lattice/Utils/Security.purs","start":[278,1]},"title":"jsonGetItems"},{"children":[],"comments":"Lookup a field in a JSON object\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Prim"],"String"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Maybe"],"Maybe"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[283,52],"name":"src/Lattice/Utils/Security.purs","start":[283,1]},"title":"jsonField"},{"children":[],"comments":"Validate basic project structure\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"JSONValue"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Either"],"Either"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Lattice","Utils","Security"],"ValidationError"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[["Data","Unit"],"Unit"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[293,69],"name":"src/Lattice/Utils/Security.purs","start":[293,1]},"title":"validateProjectStructure"}],"name":"Lattice.Utils.Security","reExports":[]}