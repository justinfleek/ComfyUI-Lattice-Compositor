// Generated by purs version 0.15.15
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Identity from "../Data.Identity/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as Lattice_State_ParticleConfig from "../Lattice.State.ParticleConfig/index.js";
import * as Test_Spec from "../Test.Spec/index.js";
import * as Test_Spec_Assertions from "../Test.Spec.Assertions/index.js";
var describe = /* #__PURE__ */ Test_Spec.describe(Data_Identity.monadIdentity);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit);
var discard1 = /* #__PURE__ */ discard(/* #__PURE__ */ Test_Spec.bindSpecT(Data_Identity.bindIdentity));
var it = /* #__PURE__ */ Test_Spec.it(Data_Identity.monadIdentity)(Test_Spec.exampleMUnit);
var shouldEqual = /* #__PURE__ */ Test_Spec_Assertions.shouldEqual(Effect_Aff.monadThrowAff);
var shouldEqual1 = /* #__PURE__ */ shouldEqual(Data_Show.showBoolean)(Data_Eq.eqBoolean);
var discard2 = /* #__PURE__ */ discard(Effect_Aff.bindAff);
var shouldEqual2 = /* #__PURE__ */ shouldEqual(Data_Show.showInt)(Data_Eq.eqInt);
var shouldEqual3 = /* #__PURE__ */ shouldEqual(Lattice_State_ParticleConfig.showRenderingBackend)(Lattice_State_ParticleConfig.eqRenderingBackend);
var shouldEqual4 = /* #__PURE__ */ shouldEqual(Lattice_State_ParticleConfig.showSimulationMode)(Lattice_State_ParticleConfig.eqSimulationMode);
var validationTests = /* #__PURE__ */ describe("validation")(/* #__PURE__ */ discard1(/* #__PURE__ */ it("positive particle count is valid")(/* #__PURE__ */ shouldEqual1(/* #__PURE__ */ Lattice_State_ParticleConfig.isValidMaxParticles(100))(true)))(function () {
    return discard1(it("zero particle count is invalid")(shouldEqual1(Lattice_State_ParticleConfig.isValidMaxParticles(0))(false)))(function () {
        return discard1(it("negative particle count is invalid")(shouldEqual1(Lattice_State_ParticleConfig.isValidMaxParticles(-1 | 0))(false)))(function () {
            return discard1(it("valid FPS range (1-240)")(discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidTargetFps(1))(true))(function () {
                return discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidTargetFps(60))(true))(function () {
                    return shouldEqual1(Lattice_State_ParticleConfig.isValidTargetFps(240))(true);
                });
            })))(function () {
                return discard1(it("invalid FPS (0 and >240)")(discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidTargetFps(0))(false))(function () {
                    return shouldEqual1(Lattice_State_ParticleConfig.isValidTargetFps(241))(false);
                })))(function () {
                    return discard1(it("valid checkpoint interval")(discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidCheckpointInterval(1))(true))(function () {
                        return shouldEqual1(Lattice_State_ParticleConfig.isValidCheckpointInterval(1000))(true);
                    })))(function () {
                        return it("invalid checkpoint interval")(discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidCheckpointInterval(0))(false))(function () {
                            return shouldEqual1(Lattice_State_ParticleConfig.isValidCheckpointInterval(-5 | 0))(false);
                        }));
                    });
                });
            });
        });
    });
}));
var updateTests = /* #__PURE__ */ describe("update operations")(/* #__PURE__ */ discard1(/* #__PURE__ */ it("updateMaxParticles with valid value")(/* #__PURE__ */ (function () {
    var result = Lattice_State_ParticleConfig.updateMaxParticles(5000)(Lattice_State_ParticleConfig.defaultPreferences);
    return shouldEqual2(result.maxParticles)(5000);
})()))(function () {
    return discard1(it("updateMaxParticles ignores zero")((function () {
        var result = Lattice_State_ParticleConfig.updateMaxParticles(0)(Lattice_State_ParticleConfig.defaultPreferences);
        return shouldEqual2(result.maxParticles)(10000);
    })()))(function () {
        return discard1(it("updateMaxParticles ignores negative")((function () {
            var result = Lattice_State_ParticleConfig.updateMaxParticles(-100 | 0)(Lattice_State_ParticleConfig.defaultPreferences);
            return shouldEqual2(result.maxParticles)(10000);
        })()))(function () {
            return discard1(it("updateTargetFps with valid value")((function () {
                var result = Lattice_State_ParticleConfig.updateTargetFps(144)(Lattice_State_ParticleConfig.defaultPreferences);
                return shouldEqual2(result.targetFps)(144);
            })()))(function () {
                return discard1(it("updateTargetFps ignores zero")((function () {
                    var result = Lattice_State_ParticleConfig.updateTargetFps(0)(Lattice_State_ParticleConfig.defaultPreferences);
                    return shouldEqual2(result.targetFps)(60);
                })()))(function () {
                    return discard1(it("updateTargetFps ignores above 240")((function () {
                        var result = Lattice_State_ParticleConfig.updateTargetFps(300)(Lattice_State_ParticleConfig.defaultPreferences);
                        return shouldEqual2(result.targetFps)(60);
                    })()))(function () {
                        return discard1(it("updateCheckpointInterval with valid value")((function () {
                            var result = Lattice_State_ParticleConfig.updateCheckpointInterval(600)(Lattice_State_ParticleConfig.defaultPreferences);
                            return shouldEqual2(result.checkpointInterval)(600);
                        })()))(function () {
                            return discard1(it("updateCheckpointInterval ignores zero")((function () {
                                var result = Lattice_State_ParticleConfig.updateCheckpointInterval(0)(Lattice_State_ParticleConfig.defaultPreferences);
                                return shouldEqual2(result.checkpointInterval)(300);
                            })()))(function () {
                                return discard1(it("updateBackend changes backend")((function () {
                                    var result = Lattice_State_ParticleConfig.updateBackend(Lattice_State_ParticleConfig.RBWebGPU.value)(Lattice_State_ParticleConfig.defaultPreferences);
                                    return shouldEqual3(result.backend)(Lattice_State_ParticleConfig.RBWebGPU.value);
                                })()))(function () {
                                    return discard1(it("updateSimulationMode changes mode")((function () {
                                        var result = Lattice_State_ParticleConfig.updateSimulationMode(Lattice_State_ParticleConfig.SMSubstepped.value)(Lattice_State_ParticleConfig.defaultPreferences);
                                        return shouldEqual4(result.simulationMode)(Lattice_State_ParticleConfig.SMSubstepped.value);
                                    })()))(function () {
                                        return it("update one preference does not affect others")((function () {
                                            var result = Lattice_State_ParticleConfig.updateMaxParticles(5000)(Lattice_State_ParticleConfig.defaultPreferences);
                                            return discard2(shouldEqual2(result.targetFps)(60))(function () {
                                                return discard2(shouldEqual3(result.backend)(Lattice_State_ParticleConfig.RBWebGL2.value))(function () {
                                                    return shouldEqual1(result.enableTrails)(false);
                                                });
                                            });
                                        })());
                                    });
                                });
                            });
                        });
                    });
                });
            });
        });
    });
}));
var presetTests = /* #__PURE__ */ (function () {
    return describe("presets")(discard1(it("lowEndPreset has reduced particles")(shouldEqual2(Lattice_State_ParticleConfig.lowEndPreset.maxParticles)(1000)))(function () {
        return discard1(it("lowEndPreset uses CPU fallback")(shouldEqual3(Lattice_State_ParticleConfig.lowEndPreset.backend)(Lattice_State_ParticleConfig.RBCPUFallback.value)))(function () {
            return discard1(it("lowEndPreset targets 30fps")(shouldEqual2(Lattice_State_ParticleConfig.lowEndPreset.targetFps)(30)))(function () {
                return discard1(it("highEndPreset has many particles")(shouldEqual2(Lattice_State_ParticleConfig.highEndPreset.maxParticles)(100000)))(function () {
                    return discard1(it("highEndPreset uses WebGPU")(shouldEqual3(Lattice_State_ParticleConfig.highEndPreset.backend)(Lattice_State_ParticleConfig.RBWebGPU.value)))(function () {
                        return discard1(it("highEndPreset targets 120fps")(shouldEqual2(Lattice_State_ParticleConfig.highEndPreset.targetFps)(120)))(function () {
                            return discard1(it("highEndPreset enables trails")(shouldEqual1(Lattice_State_ParticleConfig.highEndPreset.enableTrails)(true)))(function () {
                                return it("highEndPreset enables collisions")(shouldEqual1(Lattice_State_ParticleConfig.highEndPreset.enableCollisions)(true));
                            });
                        });
                    });
                });
            });
        });
    }));
})();
var invariantTests = /* #__PURE__ */ (function () {
    return describe("invariants")(discard1(it("all presets have positive maxParticles")(discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidMaxParticles(Lattice_State_ParticleConfig.defaultPreferences.maxParticles))(true))(function () {
        return discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidMaxParticles(Lattice_State_ParticleConfig.lowEndPreset.maxParticles))(true))(function () {
            return shouldEqual1(Lattice_State_ParticleConfig.isValidMaxParticles(Lattice_State_ParticleConfig.highEndPreset.maxParticles))(true);
        });
    })))(function () {
        return discard1(it("all presets have valid targetFps")(discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidTargetFps(Lattice_State_ParticleConfig.defaultPreferences.targetFps))(true))(function () {
            return discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidTargetFps(Lattice_State_ParticleConfig.lowEndPreset.targetFps))(true))(function () {
                return shouldEqual1(Lattice_State_ParticleConfig.isValidTargetFps(Lattice_State_ParticleConfig.highEndPreset.targetFps))(true);
            });
        })))(function () {
            return discard1(it("all presets have valid checkpointInterval")(discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidCheckpointInterval(Lattice_State_ParticleConfig.defaultPreferences.checkpointInterval))(true))(function () {
                return discard2(shouldEqual1(Lattice_State_ParticleConfig.isValidCheckpointInterval(Lattice_State_ParticleConfig.lowEndPreset.checkpointInterval))(true))(function () {
                    return shouldEqual1(Lattice_State_ParticleConfig.isValidCheckpointInterval(Lattice_State_ParticleConfig.highEndPreset.checkpointInterval))(true);
                });
            })))(function () {
                return it("backend descriptions are non-empty")(discard2(shouldEqual1(Lattice_State_ParticleConfig.backendDescription(Lattice_State_ParticleConfig.RBWebGL2.value) !== "")(true))(function () {
                    return discard2(shouldEqual1(Lattice_State_ParticleConfig.backendDescription(Lattice_State_ParticleConfig.RBWebGPU.value) !== "")(true))(function () {
                        return shouldEqual1(Lattice_State_ParticleConfig.backendDescription(Lattice_State_ParticleConfig.RBCPUFallback.value) !== "")(true);
                    });
                }));
            });
        });
    }));
})();
var defaultTests = /* #__PURE__ */ (function () {
    return describe("defaultPreferences")(discard1(it("maxParticles is 10000")(shouldEqual2(Lattice_State_ParticleConfig.defaultPreferences.maxParticles)(10000)))(function () {
        return discard1(it("targetFps is 60")(shouldEqual2(Lattice_State_ParticleConfig.defaultPreferences.targetFps)(60)))(function () {
            return discard1(it("checkpointInterval is 300")(shouldEqual2(Lattice_State_ParticleConfig.defaultPreferences.checkpointInterval)(300)))(function () {
                return discard1(it("backend is WebGL2")(shouldEqual3(Lattice_State_ParticleConfig.defaultPreferences.backend)(Lattice_State_ParticleConfig.RBWebGL2.value)))(function () {
                    return discard1(it("simulationMode is Realtime")(shouldEqual4(Lattice_State_ParticleConfig.defaultPreferences.simulationMode)(Lattice_State_ParticleConfig.SMRealtime.value)))(function () {
                        return discard1(it("enableTrails is false")(shouldEqual1(Lattice_State_ParticleConfig.defaultPreferences.enableTrails)(false)))(function () {
                            return discard1(it("enableCollisions is false")(shouldEqual1(Lattice_State_ParticleConfig.defaultPreferences.enableCollisions)(false)))(function () {
                                return it("is deterministic")(discard2(shouldEqual2(Lattice_State_ParticleConfig.defaultPreferences.maxParticles)(Lattice_State_ParticleConfig.defaultPreferences.maxParticles))(function () {
                                    return discard2(shouldEqual2(Lattice_State_ParticleConfig.defaultPreferences.targetFps)(Lattice_State_ParticleConfig.defaultPreferences.targetFps))(function () {
                                        return shouldEqual3(Lattice_State_ParticleConfig.defaultPreferences.backend)(Lattice_State_ParticleConfig.defaultPreferences.backend);
                                    });
                                }));
                            });
                        });
                    });
                });
            });
        });
    }));
})();
var spec = /* #__PURE__ */ describe("ParticleConfig")(/* #__PURE__ */ discard1(defaultTests)(function () {
    return discard1(presetTests)(function () {
        return discard1(updateTests)(function () {
            return discard1(validationTests)(function () {
                return invariantTests;
            });
        });
    });
}));
export {
    spec
};
//# sourceMappingURL=index.js.map
