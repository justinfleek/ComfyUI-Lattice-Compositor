// Generated by purs version 0.15.15
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as $$Math from "../Math/index.js";
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordNumber);
var primeY = 668265263;
var primeX = 374761393;
var mixConstant3 = 1540483477;
var mixConstant2 = /* #__PURE__ */ (function () {
    return -1028477387 | 0;
})();
var mixConstant1 = /* #__PURE__ */ (function () {
    return -2048144789 | 0;
})();
var lerp = function (a) {
    return function (b) {
        return function (t) {
            return a + t * (b - a);
        };
    };
};
var imul = function (a) {
    return function (b) {
        return (a * b | 0) & (-1 | 0);
    };
};
var hash = function (seed) {
    return function (px) {
        return function (py) {
            var h0 = seed & (-1 | 0);
            var h1 = h0 ^ h0 >> 16;
            var h2 = imul(h1)(mixConstant1);
            var h3 = h2 ^ h2 >> 13;
            var h4 = imul(h3)(mixConstant2);
            var h5 = h4 ^ h4 >> 16;
            var h6 = ((h5 + imul(px)(primeX) | 0) + imul(py)(primeY) | 0) & (-1 | 0);
            var h7 = h6 ^ h6 >> 13;
            var h8 = imul(h7)(mixConstant3);
            return h8 ^ h8 >> 15;
        };
    };
};
var grad = function (h) {
    return function (dx) {
        return function (dy) {
            var sel = h & 7;
            var u = (function () {
                var $13 = sel < 4;
                if ($13) {
                    return dx;
                };
                return dy;
            })();
            var signU = (function () {
                var $14 = (sel & 1) === 0;
                if ($14) {
                    return u;
                };
                return -u;
            })();
            var v = (function () {
                var $15 = sel < 4;
                if ($15) {
                    return dy;
                };
                return dx;
            })();
            var signV = (function () {
                var $16 = (sel & 2) === 0;
                if ($16) {
                    return 2.0 * v;
                };
                return -2.0 * v;
            })();
            return signU + signV;
        };
    };
};
var fade = function (t) {
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
};
var simplexNoise2D = function (x) {
    return function (y) {
        return function (seed) {
            var iy = Data_Int.floor(y);
            var ix = Data_Int.floor(x);
            var fy = y - Data_Int.toNumber(iy);
            var v = fade(fy);
            var fx = x - Data_Int.toNumber(ix);
            var n00 = grad(hash(seed)(ix)(iy))(fx)(fy);
            var n01 = grad(hash(seed)(ix)(iy + 1 | 0))(fx)(fy - 1.0);
            var n10 = grad(hash(seed)(ix + 1 | 0)(iy))(fx - 1.0)(fy);
            var n11 = grad(hash(seed)(ix + 1 | 0)(iy + 1 | 0))(fx - 1.0)(fy - 1.0);
            var u = fade(fx);
            var nx0 = lerp(n00)(n10)(u);
            var nx1 = lerp(n01)(n11)(u);
            var result = lerp(nx0)(nx1)(v);
            return result * 0.5 + 0.5;
        };
    };
};
var fbm = function (x) {
    return function (y) {
        return function (seed) {
            return function (octaves) {
                return function (persistence) {
                    return function (lacunarity) {
                        var go = function ($copy_i) {
                            return function ($copy_freq) {
                                return function ($copy_amp) {
                                    return function ($copy_total) {
                                        return function ($copy_maxVal) {
                                            var $tco_var_i = $copy_i;
                                            var $tco_var_freq = $copy_freq;
                                            var $tco_var_amp = $copy_amp;
                                            var $tco_var_total = $copy_total;
                                            var $tco_done = false;
                                            var $tco_result;
                                            function $tco_loop(i, freq, amp, total, maxVal) {
                                                if (i >= octaves) {
                                                    $tco_done = true;
                                                    return {
                                                        total: total,
                                                        maxVal: maxVal
                                                    };
                                                };
                                                if (Data_Boolean.otherwise) {
                                                    var noise = simplexNoise2D(x * freq)(y * freq)(seed);
                                                    var total$prime = total + noise * amp;
                                                    var maxVal$prime = maxVal + amp;
                                                    $tco_var_i = i + 1 | 0;
                                                    $tco_var_freq = freq * lacunarity;
                                                    $tco_var_amp = amp * persistence;
                                                    $tco_var_total = total$prime;
                                                    $copy_maxVal = maxVal$prime;
                                                    return;
                                                };
                                                throw new Error("Failed pattern match at Lattice.Services.Noise.SimplexNoise (line 163, column 7 - line 169, column 81): " + [ i.constructor.name, freq.constructor.name, amp.constructor.name, total.constructor.name, maxVal.constructor.name ]);
                                            };
                                            while (!$tco_done) {
                                                $tco_result = $tco_loop($tco_var_i, $tco_var_freq, $tco_var_amp, $tco_var_total, $copy_maxVal);
                                            };
                                            return $tco_result;
                                        };
                                    };
                                };
                            };
                        };
                        var result = go(0)(1.0)(1.0)(0.0)(0.0);
                        var $22 = result.maxVal > 0.0;
                        if ($22) {
                            return result.total / result.maxVal;
                        };
                        return 0.5;
                    };
                };
            };
        };
    };
};
var ridgeNoise = function (x) {
    return function (y) {
        return function (seed) {
            return function (octaves) {
                return function (persistence) {
                    return function (lacunarity) {
                        return function (gain) {
                            var go = function ($copy_i) {
                                return function ($copy_freq) {
                                    return function ($copy_amp) {
                                        return function ($copy_total) {
                                            return function ($copy_weight) {
                                                var $tco_var_i = $copy_i;
                                                var $tco_var_freq = $copy_freq;
                                                var $tco_var_amp = $copy_amp;
                                                var $tco_var_total = $copy_total;
                                                var $tco_done = false;
                                                var $tco_result;
                                                function $tco_loop(i, freq, amp, total, weight) {
                                                    if (i >= octaves) {
                                                        $tco_done = true;
                                                        return total;
                                                    };
                                                    if (Data_Boolean.otherwise) {
                                                        var noise = simplexNoise2D(x * freq)(y * freq)(seed);
                                                        var ridge = 1.0 - $$Math.abs(noise * 2.0 - 1.0);
                                                        var ridge$prime = ridge * ridge * weight;
                                                        var total$prime = total + ridge$prime * amp;
                                                        var weight$prime = min(1.0)(ridge$prime * gain);
                                                        $tco_var_i = i + 1 | 0;
                                                        $tco_var_freq = freq * lacunarity;
                                                        $tco_var_amp = amp * persistence;
                                                        $tco_var_total = total$prime;
                                                        $copy_weight = weight$prime;
                                                        return;
                                                    };
                                                    throw new Error("Failed pattern match at Lattice.Services.Noise.SimplexNoise (line 198, column 7 - line 206, column 81): " + [ i.constructor.name, freq.constructor.name, amp.constructor.name, total.constructor.name, weight.constructor.name ]);
                                                };
                                                while (!$tco_done) {
                                                    $tco_result = $tco_loop($tco_var_i, $tco_var_freq, $tco_var_amp, $tco_var_total, $copy_weight);
                                                };
                                                return $tco_result;
                                            };
                                        };
                                    };
                                };
                            };
                            return go(0)(1.0)(1.0)(0.0)(1.0);
                        };
                    };
                };
            };
        };
    };
};
var turbulence = function (x) {
    return function (y) {
        return function (seed) {
            return function (octaves) {
                return function (persistence) {
                    return function (lacunarity) {
                        var go = function ($copy_i) {
                            return function ($copy_freq) {
                                return function ($copy_amp) {
                                    return function ($copy_total) {
                                        return function ($copy_maxVal) {
                                            var $tco_var_i = $copy_i;
                                            var $tco_var_freq = $copy_freq;
                                            var $tco_var_amp = $copy_amp;
                                            var $tco_var_total = $copy_total;
                                            var $tco_done = false;
                                            var $tco_result;
                                            function $tco_loop(i, freq, amp, total, maxVal) {
                                                if (i >= octaves) {
                                                    $tco_done = true;
                                                    return {
                                                        total: total,
                                                        maxVal: maxVal
                                                    };
                                                };
                                                if (Data_Boolean.otherwise) {
                                                    var noise = simplexNoise2D(x * freq)(y * freq)(seed);
                                                    var maxVal$prime = maxVal + amp;
                                                    var absNoise = $$Math.abs(noise * 2.0 - 1.0);
                                                    var total$prime = total + absNoise * amp;
                                                    $tco_var_i = i + 1 | 0;
                                                    $tco_var_freq = freq * lacunarity;
                                                    $tco_var_amp = amp * persistence;
                                                    $tco_var_total = total$prime;
                                                    $copy_maxVal = maxVal$prime;
                                                    return;
                                                };
                                                throw new Error("Failed pattern match at Lattice.Services.Noise.SimplexNoise (line 178, column 7 - line 185, column 81): " + [ i.constructor.name, freq.constructor.name, amp.constructor.name, total.constructor.name, maxVal.constructor.name ]);
                                            };
                                            while (!$tco_done) {
                                                $tco_result = $tco_loop($tco_var_i, $tco_var_freq, $tco_var_amp, $tco_var_total, $copy_maxVal);
                                            };
                                            return $tco_result;
                                        };
                                    };
                                };
                            };
                        };
                        var result = go(0)(1.0)(1.0)(0.0)(0.0);
                        var $33 = result.maxVal > 0.0;
                        if ($33) {
                            return result.total / result.maxVal;
                        };
                        return 0.5;
                    };
                };
            };
        };
    };
};
export {
    simplexNoise2D,
    fbm,
    turbulence,
    ridgeNoise,
    hash,
    grad,
    fade,
    lerp
};
//# sourceMappingURL=index.js.map
