// Generated by purs version 0.15.15
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Number from "../Data.Number/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as $$Math from "../Math/index.js";
var smoothstep = function (edge0) {
    return function (edge1) {
        return function (x) {
            if (x <= edge0) {
                return 0.0;
            };
            if (x >= edge1) {
                return 1.0;
            };
            if (Data_Boolean.otherwise) {
                var t = (x - edge0) / (edge1 - edge0);
                return t * t * (3.0 - 2.0 * t);
            };
            throw new Error("Failed pattern match at Lattice.Services.Effects.ColorGlow (line 136, column 1 - line 136, column 51): " + [ edge0.constructor.name, edge1.constructor.name, x.constructor.name ]);
        };
    };
};
var vignetteAtPoint = function (params) {
    return function (x) {
        return function (y) {
            var feather = $$Math.max(1.0e-3)(params.feather);
            var innerEdge = params.midpoint - feather / 2.0;
            var outerEdge = params.midpoint + feather / 2.0;
            var cy = y - 0.5;
            var cx = x - 0.5;
            var dist = (function () {
                var $14 = params.roundness >= 0.0;
                if ($14) {
                    return Data_Number.sqrt(cx * cx + cy * cy);
                };
                return $$Math.max(Data_Number.abs(cx))(Data_Number.abs(cy));
            })();
            var vigFactor = smoothstep(innerEdge)(outerEdge)(dist);
            return vigFactor * params.amount;
        };
    };
};
var luminance = function (r) {
    return function (g) {
        return function (b) {
            return r * 0.299 + g * 0.587 + b * 0.114;
        };
    };
};
var lerp = function (a) {
    return function (b) {
        return function (t) {
            return a + (b - a) * t;
        };
    };
};
var glowIntensity = function (params) {
    return function (r) {
        return function (g) {
            return function (b) {
                var lum = luminance(r)(g)(b);
                var $15 = lum <= params.threshold;
                if ($15) {
                    return 0.0;
                };
                var excess = (lum - params.threshold) / $$Math.max(1.0e-3)(1.0 - params.threshold);
                var softExcess = (function () {
                    var $16 = params.softness > 0.0;
                    if ($16) {
                        return Data_Number.pow(excess)(1.0 / $$Math.max(0.1)(params.softness));
                    };
                    return excess;
                })();
                return softExcess * params.intensity;
            };
        };
    };
};
var dropShadowOffset = function (params) {
    return function (v) {
        return new Data_Tuple.Tuple(v.value0 - params.offsetX, v.value1 - params.offsetY);
    };
};
var distance2D = function (x1) {
    return function (y1) {
        return function (x2) {
            return function (y2) {
                var dy = y2 - y1;
                var dx = x2 - x1;
                return Data_Number.sqrt(dx * dx + dy * dy);
            };
        };
    };
};
var defaultVignetteParams = {
    amount: 0.5,
    midpoint: 0.5,
    roundness: 0.0,
    feather: 0.5,
    highlights: 0.0
};
var defaultGlowParams = {
    threshold: 0.8,
    intensity: 1.0,
    radius: 10.0,
    softness: 0.5,
    colorR: 1.0,
    colorG: 1.0,
    colorB: 1.0
};
var defaultDropShadowParams = {
    offsetX: 5.0,
    offsetY: 5.0,
    blur: 5.0,
    spread: 0.0,
    opacity: 0.5,
    colorR: 0.0,
    colorG: 0.0,
    colorB: 0.0,
    inner: false
};
var clamp01 = /* #__PURE__ */ (function () {
    var $36 = $$Math.max(0.0);
    var $37 = $$Math.min(1.0);
    return function ($38) {
        return $36($37($38));
    };
})();
var glowPixel = function (params) {
    return function (v) {
        return function (glowAmount) {
            var r$prime = v.value0 + params.colorR * glowAmount;
            var g$prime = v.value1.value0 + params.colorG * glowAmount;
            var b$prime = v.value1.value1 + params.colorB * glowAmount;
            return new Data_Tuple.Tuple(clamp01(r$prime), new Data_Tuple.Tuple(clamp01(g$prime), clamp01(b$prime)));
        };
    };
};
var applyVignette = function (params) {
    return function (x) {
        return function (y) {
            return function (v) {
                var vigFactor = vignetteAtPoint(params)(x)(y);
                var r$prime = v.value0 * (1.0 - vigFactor);
                var lum = luminance(v.value0)(v.value1.value0)(v.value1.value1);
                var highlightProtect = lum * params.highlights;
                var r$prime$prime = lerp(r$prime)(v.value0)(highlightProtect);
                var g$prime = v.value1.value0 * (1.0 - vigFactor);
                var g$prime$prime = lerp(g$prime)(v.value1.value0)(highlightProtect);
                var b$prime = v.value1.value1 * (1.0 - vigFactor);
                var b$prime$prime = lerp(b$prime)(v.value1.value1)(highlightProtect);
                return new Data_Tuple.Tuple(clamp01(r$prime$prime), new Data_Tuple.Tuple(clamp01(g$prime$prime), clamp01(b$prime$prime)));
            };
        };
    };
};
export {
    defaultGlowParams,
    defaultDropShadowParams,
    defaultVignetteParams,
    glowIntensity,
    glowPixel,
    dropShadowOffset,
    vignetteAtPoint,
    applyVignette,
    luminance,
    distance2D
};
//# sourceMappingURL=index.js.map
