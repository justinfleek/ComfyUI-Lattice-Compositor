// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Lattice_Schemas_SharedValidation from "../Lattice.Schemas.SharedValidation/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Either.bindEither);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_Either.applicativeEither);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(Data_Either.bindEither);
var traverse_ = /* #__PURE__ */ Data_Foldable.traverse_(Data_Either.applicativeEither)(Data_Foldable.foldableArray);
var maxSessionCountKeys = 1000;
var maxCallsPerSession = 100000;
var validateSessionCounts = function (sc) {
    if (Data_Array.length(sc.counts) > maxSessionCountKeys) {
        return new Data_Either.Left(Lattice_Schemas_SharedValidation.mkError("counts")("must have at most " + (show(maxSessionCountKeys) + " keys")));
    };
    if (Data_Boolean.otherwise) {
        var validateCount = function (v) {
            return bind(Lattice_Schemas_SharedValidation.validateString("counts.key")(Lattice_Schemas_SharedValidation.maxNameLength)(v.value0))(function () {
                return bind(Lattice_Schemas_SharedValidation.validateNonNegativeInt("counts.value")(maxCallsPerSession)(v.value1))(function () {
                    return pure(Data_Unit.unit);
                });
            });
        };
        return discard(traverse_(validateCount)(sc.counts))(function () {
            return pure(sc);
        });
    };
    throw new Error("Failed pattern match at Lattice.Schemas.Settings.SessionStorageSchema (line 55, column 1 - line 55, column 79): " + [ sc.constructor.name ]);
};
var safeValidateSessionCounts = function (sc) {
    var v = validateSessionCounts(sc);
    if (v instanceof Data_Either.Right) {
        return new Data_Maybe.Just(v.value0);
    };
    if (v instanceof Data_Either.Left) {
        return Data_Maybe.Nothing.value;
    };
    throw new Error("Failed pattern match at Lattice.Schemas.Settings.SessionStorageSchema (line 72, column 3 - line 74, column 22): " + [ v.constructor.name ]);
};
var isHexDigit = function (c) {
    return c >= "0" && c <= "9" || (c >= "a" && c <= "f" || c >= "A" && c <= "F");
};
var validateUUID = function (field) {
    return function (value) {
        if (Data_String_CodePoints.length(value) !== 36) {
            return new Data_Either.Left(Lattice_Schemas_SharedValidation.mkError(field)("must be valid UUID format"));
        };
        if (Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(8)(value)) !== "-" || (Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(13)(value)) !== "-" || (Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(18)(value)) !== "-" || Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(23)(value)) !== "-"))) {
            return new Data_Either.Left(Lattice_Schemas_SharedValidation.mkError(field)("must be valid UUID format"));
        };
        if (!Data_Array.all(isHexDigit)(Data_Array.filter(function (v) {
            return v !== "-";
        })(Data_String_CodeUnits.toCharArray(value)))) {
            return new Data_Either.Left(Lattice_Schemas_SharedValidation.mkError(field)("must be valid UUID format"));
        };
        if (Data_Boolean.otherwise) {
            return new Data_Either.Right(value);
        };
        throw new Error("Failed pattern match at Lattice.Schemas.Settings.SessionStorageSchema (line 88, column 1 - line 88, column 66): " + [ field.constructor.name, value.constructor.name ]);
    };
};
var validateAuditSessionId = /* #__PURE__ */ validateUUID("auditSessionId");
var safeValidateAuditSessionId = function (value) {
    var v = validateAuditSessionId(value);
    if (v instanceof Data_Either.Right) {
        return new Data_Maybe.Just(v.value0);
    };
    if (v instanceof Data_Either.Left) {
        return Data_Maybe.Nothing.value;
    };
    throw new Error("Failed pattern match at Lattice.Schemas.Settings.SessionStorageSchema (line 107, column 3 - line 109, column 22): " + [ v.constructor.name ]);
};
export {
    maxSessionCountKeys,
    maxCallsPerSession,
    validateSessionCounts,
    safeValidateSessionCounts,
    validateUUID,
    validateAuditSessionId,
    safeValidateAuditSessionId
};
//# sourceMappingURL=index.js.map
