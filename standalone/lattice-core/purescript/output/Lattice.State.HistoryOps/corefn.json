{"builtWith":"0.15.15","comments":[{"LineComment":" | Lattice.State.HistoryOps - Pure history/undo/redo state transitions"},{"LineComment":" |"},{"LineComment":" | Port of ui/src/stores/projectStore/history.ts (pure subset)"},{"LineComment":" | All functions are pure state transitions on a HistoryState record."}],"decls":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[48,36],"start":[48,35]}},"type":"Var","value":{"identifier":"add","moduleName":["Data","Semiring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[48,38],"start":[48,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"semiringInt","moduleName":["Data","Semiring"]}},"type":"App"},"identifier":"add"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[52,34],"start":[52,33]}},"type":"Var","value":{"identifier":"greaterThan","moduleName":["Data","Ord"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[52,49],"start":[52,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordInt","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"greaterThan"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[53,43],"start":[53,42]}},"type":"Var","value":{"identifier":"sub","moduleName":["Data","Ring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[53,58],"start":[53,27]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ringInt","moduleName":["Data","Ring"]}},"type":"App"},"identifier":"sub"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[85,30],"start":[85,29]}},"type":"Var","value":{"identifier":"lessThan","moduleName":["Data","Ord"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[85,53],"start":[85,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordInt","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"lessThan"},{"annotation":{"meta":null,"sourceSpan":{"end":[36,48],"start":[36,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[36,48],"start":[36,1]}},"argument":"initial","body":{"annotation":{"meta":null,"sourceSpan":{"end":[40,4],"start":[38,3]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["stack",{"annotation":{"meta":null,"sourceSpan":{"end":[38,21],"start":[38,12]}},"type":"Literal","value":{"literalType":"ArrayLiteral","value":[{"annotation":{"meta":null,"sourceSpan":{"end":[38,20],"start":[38,13]}},"type":"Var","value":{"identifier":"initial","sourcePos":[37,1]}}]}}],["index",{"annotation":{"meta":null,"sourceSpan":{"end":[39,13],"start":[39,12]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}}]]}},"type":"Abs"},"identifier":"mkHistoryState"},{"annotation":{"meta":null,"sourceSpan":{"end":[25,22],"start":[25,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[26,20],"start":[26,18]}},"type":"Literal","value":{"literalType":"IntLiteral","value":50}},"identifier":"maxHistorySize"},{"annotation":{"meta":null,"sourceSpan":{"end":[44,63],"start":[44,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[44,63],"start":[44,1]}},"argument":"snapshot","body":{"annotation":{"meta":null,"sourceSpan":{"end":[44,63],"start":[44,1]}},"argument":"state","body":{"annotation":{"meta":null,"sourceSpan":{"end":[57,7],"start":[46,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[48,51],"start":[48,5]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[48,21],"start":[48,17]}},"type":"Var","value":{"identifier":"take","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[48,39],"start":[48,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[48,38],"start":[48,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[48,34],"start":[48,23]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[48,28],"start":[48,23]}},"type":"Var","value":{"identifier":"state","sourcePos":[45,1]}},"fieldName":"index","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[48,38],"start":[48,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[48,38],"start":[48,37]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[48,51],"start":[48,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[48,51],"start":[48,40]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[48,45],"start":[48,40]}},"type":"Var","value":{"identifier":"state","sourcePos":[45,1]}},"fieldName":"stack","type":"Accessor"},"type":"App"},"identifier":"truncated"},{"annotation":{"meta":null,"sourceSpan":{"end":[50,38],"start":[50,5]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[50,19],"start":[50,15]}},"type":"Var","value":{"identifier":"snoc","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[50,29],"start":[50,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[50,29],"start":[50,20]}},"type":"Var","value":{"identifier":"truncated","sourcePos":[48,5]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[50,38],"start":[50,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[50,38],"start":[50,30]}},"type":"Var","value":{"identifier":"snapshot","sourcePos":[45,1]}},"type":"App"},"identifier":"withNew"},{"annotation":{"meta":null,"sourceSpan":{"end":[54,27],"start":[52,5]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[54,27],"start":[52,15]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[54,27],"start":[52,15]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[53,25],"start":[53,20]}},"type":"Var","value":{"identifier":"slice","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,59],"start":[53,20]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"sub","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,58],"start":[53,27]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[53,33],"start":[53,27]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,41],"start":[53,27]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[53,41],"start":[53,34]}},"type":"Var","value":{"identifier":"withNew","sourcePos":[50,5]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[53,58],"start":[53,27]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[53,58],"start":[53,44]}},"type":"Var","value":{"identifier":"maxHistorySize","moduleName":["Lattice","State","HistoryOps"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[53,76],"start":[53,20]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[53,67],"start":[53,61]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[53,75],"start":[53,61]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[53,75],"start":[53,68]}},"type":"Var","value":{"identifier":"withNew","sourcePos":[50,5]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[53,84],"start":[53,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[53,84],"start":[53,77]}},"type":"Var","value":{"identifier":"withNew","sourcePos":[50,5]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[54,27],"start":[52,15]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[54,27],"start":[54,20]}},"type":"Var","value":{"identifier":"withNew","sourcePos":[50,5]}},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"greaterThan","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[52,49],"start":[52,18]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[52,24],"start":[52,18]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[52,32],"start":[52,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[52,32],"start":[52,25]}},"type":"Var","value":{"identifier":"withNew","sourcePos":[50,5]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[52,49],"start":[52,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[52,49],"start":[52,35]}},"type":"Var","value":{"identifier":"maxHistorySize","moduleName":["Lattice","State","HistoryOps"]}},"type":"App"}],"type":"Case"},"identifier":"trimmed"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[57,7],"start":[55,6]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["stack",{"annotation":{"meta":null,"sourceSpan":{"end":[55,22],"start":[55,15]}},"type":"Var","value":{"identifier":"trimmed","sourcePos":[52,5]}}],["index",{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"sub","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[56,33],"start":[56,15]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[56,21],"start":[56,15]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[56,29],"start":[56,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,29],"start":[56,22]}},"type":"Var","value":{"identifier":"trimmed","sourcePos":[52,5]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[56,33],"start":[56,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,33],"start":[56,32]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"}]]}},"type":"Let"},"type":"Abs"},"type":"Abs"},"identifier":"pushHistory"},{"annotation":{"meta":null,"sourceSpan":{"end":[95,49],"start":[95,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[95,49],"start":[95,1]}},"argument":"state","body":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[96,29],"start":[96,23]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[96,41],"start":[96,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[96,41],"start":[96,30]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[96,35],"start":[96,30]}},"type":"Var","value":{"identifier":"state","sourcePos":[96,1]}},"fieldName":"stack","type":"Accessor"},"type":"App"},"type":"Abs"},"identifier":"historyLength"},{"annotation":{"meta":null,"sourceSpan":{"end":[88,59],"start":[88,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[88,59],"start":[88,1]}},"argument":"state","body":{"annotation":{"meta":null,"sourceSpan":{"end":[92,21],"start":[90,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[88,59],"start":[88,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[90,13],"start":[90,8]}},"type":"Var","value":{"identifier":"index","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[90,25],"start":[90,8]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,25],"start":[90,14]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[90,19],"start":[90,14]}},"type":"Var","value":{"identifier":"state","sourcePos":[89,1]}},"fieldName":"stack","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[90,37],"start":[90,8]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,37],"start":[90,26]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[90,31],"start":[90,26]}},"type":"Var","value":{"identifier":"state","sourcePos":[89,1]}},"fieldName":"index","type":"Accessor"},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[92,21],"start":[90,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[91,17],"start":[91,5]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[91,17],"start":[91,10]}},"binderType":"VarBinder","identifier":"current"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[91,35],"start":[91,21]}},"type":"Var","value":{"identifier":"mkHistoryState","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[91,43],"start":[91,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,43],"start":[91,36]}},"type":"Var","value":{"identifier":"current","sourcePos":[91,10]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[92,12],"start":[92,5]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[92,21],"start":[92,16]}},"type":"Var","value":{"identifier":"state","sourcePos":[89,1]}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[88,59],"start":[88,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"identifier":"clearHistory"},{"annotation":{"meta":null,"sourceSpan":{"end":[80,47],"start":[80,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[80,47],"start":[80,1]}},"argument":"state","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"greaterThan","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[81,32],"start":[81,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,28],"start":[81,17]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[81,22],"start":[81,17]}},"type":"Var","value":{"identifier":"state","sourcePos":[81,1]}},"fieldName":"index","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[81,32],"start":[81,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,32],"start":[81,31]}},"type":"Literal","value":{"literalType":"IntLiteral","value":0}},"type":"App"},"type":"Abs"},"identifier":"canUndo"},{"annotation":{"meta":null,"sourceSpan":{"end":[60,85],"start":[60,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[60,85],"start":[60,1]}},"argument":"state","body":{"annotation":{"meta":null,"sourceSpan":{"end":[67,43],"start":[62,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[67,43],"start":[62,3]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[66,63],"start":[64,5]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[64,33],"start":[64,9]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"sub","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[64,33],"start":[64,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[64,29],"start":[64,18]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[64,23],"start":[64,18]}},"type":"Var","value":{"identifier":"state","sourcePos":[61,1]}},"fieldName":"index","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[64,33],"start":[64,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[64,33],"start":[64,32]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"identifier":"newIdx"},{"annotation":{"meta":null,"sourceSpan":{"end":[65,44],"start":[65,9]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[65,44],"start":[65,20]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[67,43],"start":[61,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[65,25],"start":[65,20]}},"type":"Var","value":{"identifier":"state","sourcePos":[61,1]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[65,44],"start":[65,20]}},"copy":["stack"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[61,1]}},"type":"ObjectUpdate","updates":[["index",{"annotation":{"meta":null,"sourceSpan":{"end":[65,42],"start":[65,36]}},"type":"Var","value":{"identifier":"newIdx","sourcePos":[64,9]}}]]},"type":"Let"},"identifier":"newState"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[66,63],"start":[66,8]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["state",{"annotation":{"meta":null,"sourceSpan":{"end":[66,25],"start":[66,17]}},"type":"Var","value":{"identifier":"newState","sourcePos":[65,9]}}],["snapshot",{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[66,42],"start":[66,37]}},"type":"Var","value":{"identifier":"index","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[66,54],"start":[66,37]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,54],"start":[66,43]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[66,48],"start":[66,43]}},"type":"Var","value":{"identifier":"state","sourcePos":[61,1]}},"fieldName":"stack","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[66,61],"start":[66,37]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,61],"start":[66,55]}},"type":"Var","value":{"identifier":"newIdx","sourcePos":[64,9]}},"type":"App"}]]}},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[67,43],"start":[62,3]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[67,43],"start":[67,8]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["state",{"annotation":{"meta":null,"sourceSpan":{"end":[67,22],"start":[67,17]}},"type":"Var","value":{"identifier":"state","sourcePos":[61,1]}}],["snapshot",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[67,41],"start":[67,34]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}}]]}},"isGuarded":false}],"caseExpressions":[{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[62,13],"start":[62,6]}},"type":"Var","value":{"identifier":"canUndo","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[62,19],"start":[62,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[62,19],"start":[62,14]}},"type":"Var","value":{"identifier":"state","sourcePos":[61,1]}},"type":"App"}],"type":"Case"},"type":"Abs"},"identifier":"undo"},{"annotation":{"meta":null,"sourceSpan":{"end":[84,47],"start":[84,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[84,47],"start":[84,1]}},"argument":"state","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lessThan","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[85,53],"start":[85,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[85,28],"start":[85,17]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[85,22],"start":[85,17]}},"type":"Var","value":{"identifier":"state","sourcePos":[85,1]}},"fieldName":"index","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[85,53],"start":[85,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"sub","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[85,53],"start":[85,17]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[85,37],"start":[85,31]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[85,49],"start":[85,31]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[85,49],"start":[85,38]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[85,43],"start":[85,38]}},"type":"Var","value":{"identifier":"state","sourcePos":[85,1]}},"fieldName":"stack","type":"Accessor"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[85,53],"start":[85,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[85,53],"start":[85,52]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"App"},"type":"Abs"},"identifier":"canRedo"},{"annotation":{"meta":null,"sourceSpan":{"end":[70,85],"start":[70,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[70,85],"start":[70,1]}},"argument":"state","body":{"annotation":{"meta":null,"sourceSpan":{"end":[77,43],"start":[72,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[77,43],"start":[72,3]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[76,63],"start":[74,5]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[74,33],"start":[74,9]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[74,33],"start":[74,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[74,29],"start":[74,18]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[74,23],"start":[74,18]}},"type":"Var","value":{"identifier":"state","sourcePos":[71,1]}},"fieldName":"index","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[74,33],"start":[74,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[74,33],"start":[74,32]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"identifier":"newIdx"},{"annotation":{"meta":null,"sourceSpan":{"end":[75,44],"start":[75,9]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[75,44],"start":[75,20]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[77,43],"start":[71,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[75,25],"start":[75,20]}},"type":"Var","value":{"identifier":"state","sourcePos":[71,1]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[75,44],"start":[75,20]}},"copy":["stack"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[71,1]}},"type":"ObjectUpdate","updates":[["index",{"annotation":{"meta":null,"sourceSpan":{"end":[75,42],"start":[75,36]}},"type":"Var","value":{"identifier":"newIdx","sourcePos":[74,9]}}]]},"type":"Let"},"identifier":"newState"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[76,63],"start":[76,8]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["state",{"annotation":{"meta":null,"sourceSpan":{"end":[76,25],"start":[76,17]}},"type":"Var","value":{"identifier":"newState","sourcePos":[75,9]}}],["snapshot",{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[76,42],"start":[76,37]}},"type":"Var","value":{"identifier":"index","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[76,54],"start":[76,37]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[76,54],"start":[76,43]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[76,48],"start":[76,43]}},"type":"Var","value":{"identifier":"state","sourcePos":[71,1]}},"fieldName":"stack","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[76,61],"start":[76,37]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[76,61],"start":[76,55]}},"type":"Var","value":{"identifier":"newIdx","sourcePos":[74,9]}},"type":"App"}]]}},"type":"Let"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[77,43],"start":[72,3]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[77,43],"start":[77,8]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["state",{"annotation":{"meta":null,"sourceSpan":{"end":[77,22],"start":[77,17]}},"type":"Var","value":{"identifier":"state","sourcePos":[71,1]}}],["snapshot",{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[77,41],"start":[77,34]}},"type":"Var","value":{"identifier":"Nothing","moduleName":["Data","Maybe"]}}]]}},"isGuarded":false}],"caseExpressions":[{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[72,13],"start":[72,6]}},"type":"Var","value":{"identifier":"canRedo","moduleName":["Lattice","State","HistoryOps"]}},"annotation":{"meta":null,"sourceSpan":{"end":[72,19],"start":[72,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[72,19],"start":[72,14]}},"type":"Var","value":{"identifier":"state","sourcePos":[71,1]}},"type":"App"}],"type":"Case"},"type":"Abs"},"identifier":"redo"}],"exports":["mkHistoryState","pushHistory","undo","redo","canUndo","canRedo","clearHistory","historyLength","maxHistorySize"],"foreign":[],"imports":[{"annotation":{"meta":null,"sourceSpan":{"end":[96,41],"start":[6,1]}},"moduleName":["Data","Array"]},{"annotation":{"meta":null,"sourceSpan":{"end":[96,41],"start":[6,1]}},"moduleName":["Data","Maybe"]},{"annotation":{"meta":null,"sourceSpan":{"end":[96,41],"start":[6,1]}},"moduleName":["Data","Ord"]},{"annotation":{"meta":null,"sourceSpan":{"end":[96,41],"start":[6,1]}},"moduleName":["Data","Ring"]},{"annotation":{"meta":null,"sourceSpan":{"end":[96,41],"start":[6,1]}},"moduleName":["Data","Semiring"]},{"annotation":{"meta":null,"sourceSpan":{"end":[96,41],"start":[6,1]}},"moduleName":["Lattice","State","HistoryOps"]},{"annotation":{"meta":null,"sourceSpan":{"end":[19,15],"start":[19,1]}},"moduleName":["Prelude"]},{"annotation":{"meta":null,"sourceSpan":{"end":[96,41],"start":[6,1]}},"moduleName":["Prim"]}],"moduleName":["Lattice","State","HistoryOps"],"modulePath":"src/Lattice/State/HistoryOps.purs","reExports":{},"sourceSpan":{"end":[96,41],"start":[6,1]}}