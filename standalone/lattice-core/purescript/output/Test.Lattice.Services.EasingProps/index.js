// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Identity from "../Data.Identity/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as Lattice_Services_Easing from "../Lattice.Services.Easing/index.js";
import * as Test_Lattice_TestHelpers from "../Test.Lattice.TestHelpers/index.js";
import * as Test_QuickCheck from "../Test.QuickCheck/index.js";
import * as Test_QuickCheck_Arbitrary from "../Test.QuickCheck.Arbitrary/index.js";
import * as Test_QuickCheck_Gen from "../Test.QuickCheck.Gen/index.js";
import * as Test_Spec from "../Test.Spec/index.js";
import * as Test_Spec_Assertions from "../Test.Spec.Assertions/index.js";
var describe = /* #__PURE__ */ Test_Spec.describe(Data_Identity.monadIdentity);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(/* #__PURE__ */ Test_Spec.bindSpecT(Data_Identity.bindIdentity));
var it = /* #__PURE__ */ Test_Spec.it(Data_Identity.monadIdentity)(Test_Spec.exampleMUnit);
var for_ = /* #__PURE__ */ Data_Foldable.for_(Effect_Aff.applicativeAff)(Data_Foldable.foldableArray);
var shouldEqual = /* #__PURE__ */ Test_Spec_Assertions.shouldEqual(Effect_Aff.monadThrowAff)(Data_Show.showNumber)(Data_Eq.eqNumber);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect_Aff.applicativeAff);
var fail = /* #__PURE__ */ Test_Spec_Assertions.fail(Effect_Aff.monadThrowAff);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var assertEquals = /* #__PURE__ */ Test_QuickCheck.assertEquals(Data_Eq.eqBoolean)(Data_Show.showBoolean);
var symmetryProperties = /* #__PURE__ */ describe("Power Easing Symmetry")(/* #__PURE__ */ (function () {
    var families = [ {
        name: "Quad",
        eIn: Lattice_Services_Easing.easeInQuad,
        eOut: Lattice_Services_Easing.easeOutQuad,
        eInOut: Lattice_Services_Easing.easeInOutQuad
    }, {
        name: "Cubic",
        eIn: Lattice_Services_Easing.easeInCubic,
        eOut: Lattice_Services_Easing.easeOutCubic,
        eInOut: Lattice_Services_Easing.easeInOutCubic
    }, {
        name: "Quart",
        eIn: Lattice_Services_Easing.easeInQuart,
        eOut: Lattice_Services_Easing.easeOutQuart,
        eInOut: Lattice_Services_Easing.easeInOutQuart
    }, {
        name: "Quint",
        eIn: Lattice_Services_Easing.easeInQuint,
        eOut: Lattice_Services_Easing.easeOutQuint,
        eInOut: Lattice_Services_Easing.easeInOutQuint
    } ];
    return Data_Foldable.for_(Test_Spec.applicativeSpecT(Data_Identity.applicativeIdentity))(Data_Foldable.foldableArray)(families)(function (fam) {
        return discard(it(fam.name + ": easeIn(t) + easeOut(1-t) = 1")(for_([ 0.0, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0 ])(function (t) {
            var sum = fam.eIn(t) + fam.eOut(1.0 - t);
            return Test_Lattice_TestHelpers.assertCloseTo(1.0e-5)(1.0)(sum);
        })))(function () {
            return it(fam.name + ": easeInOut(0.5) = 0.5")(Test_Lattice_TestHelpers.assertCloseTo(1.0e-5)(0.5)(fam.eInOut(0.5)));
        });
    });
})());
var linearIdentityProperties = /* #__PURE__ */ describe("Linear is Identity")(/* #__PURE__ */ it("linear(t) = t for sample values")(/* #__PURE__ */ for_([ 0.0, 0.1, 0.25, 0.333, 0.5, 0.667, 0.75, 0.9, 1.0 ])(function (t) {
    return shouldEqual(Lattice_Services_Easing.linear(t))(t);
})));
var genValue = /* #__PURE__ */ (function () {
    return Test_QuickCheck_Gen.choose(-1000.0)(1000.0);
})();
var genT = /* #__PURE__ */ Test_QuickCheck_Gen.choose(0.0)(1.0);
var genExtendedT = /* #__PURE__ */ (function () {
    return Test_QuickCheck_Gen.choose(-2.0)(2.0);
})();
var expoProperties = /* #__PURE__ */ describe("Expo Boundary Handling")(/* #__PURE__ */ discard(/* #__PURE__ */ it("easeInExpo(0) = 0 exactly")(/* #__PURE__ */ shouldEqual(/* #__PURE__ */ Lattice_Services_Easing.easeInExpo(0.0))(0.0)))(function () {
    return it("easeOutExpo(1) = 1 exactly")(shouldEqual(Lattice_Services_Easing.easeOutExpo(1.0))(1.0));
}));
var epsilon = 1.0e-10;
var interpolationProperties = /* #__PURE__ */ (function () {
    return describe("interpolateWithEasing")(discard(it("at t=0 returns start")(for_([ 10.0, -50.0, 0.0, 999.0 ])(function (start) {
        return for_([ 20.0, 100.0, -100.0 ])(function (end_) {
            return Test_Lattice_TestHelpers.assertCloseTo(1.0e-5)(start)(Lattice_Services_Easing.interpolateWithEasing(start)(end_)(0.0)(Lattice_Services_Easing.EaseLinear.value));
        });
    })))(function () {
        return discard(it("at t=1 returns end")(for_([ 10.0, -50.0, 0.0 ])(function (start) {
            return for_([ 20.0, 100.0, -100.0 ])(function (end_) {
                return Test_Lattice_TestHelpers.assertCloseTo(1.0e-5)(end_)(Lattice_Services_Easing.interpolateWithEasing(start)(end_)(1.0)(Lattice_Services_Easing.EaseLinear.value));
            });
        })))(function () {
            return discard(it("linear interpolation is exact")(for_([ 0.0, 0.25, 0.5, 0.75, 1.0 ])(function (t) {
                var result = Lattice_Services_Easing.interpolateWithEasing(0.0)(100.0)(t)(Lattice_Services_Easing.EaseLinear.value);
                var expected = 100.0 * t;
                return Test_Lattice_TestHelpers.assertCloseTo(epsilon)(expected)(result);
            })))(function () {
                return it("interpolating same value gives that value")(for_([ 0.0, 42.0, -100.0, 999.0 ])(function (v) {
                    return for_([ 0.0, 0.25, 0.5, 0.75, 1.0 ])(function (t) {
                        return Test_Lattice_TestHelpers.assertCloseTo(1.0e-5)(v)(Lattice_Services_Easing.interpolateWithEasing(v)(v)(t)(Lattice_Services_Easing.EaseInQuad.value));
                    });
                }));
            });
        });
    }));
})();
var elasticProperties = /* #__PURE__ */ describe("Elastic Oscillation")(/* #__PURE__ */ discard(/* #__PURE__ */ it("easeInElastic oscillates below 0")(/* #__PURE__ */ (function () {
    var values = map(Lattice_Services_Easing.easeInElastic)([ 0.1, 0.2, 0.3, 0.4, 0.5 ]);
    var $46 = Data_Array.any(function (v) {
        return v < 0.0;
    })(values);
    if ($46) {
        return pure(Data_Unit.unit);
    };
    return fail("Expected easeInElastic to go below 0");
})()))(function () {
    return it("easeOutElastic oscillates above 1")((function () {
        var values = map(Lattice_Services_Easing.easeOutElastic)([ 0.5, 0.6, 0.7, 0.8, 0.9 ]);
        var $47 = Data_Array.any(function (v) {
            return v > 1.0;
        })(values);
        if ($47) {
            return pure(Data_Unit.unit);
        };
        return fail("Expected easeOutElastic to go above 1");
    })());
}));
var boundedEasingFns = [ {
    name: "linear",
    fn: Lattice_Services_Easing.linear
}, {
    name: "easeInQuad",
    fn: Lattice_Services_Easing.easeInQuad
}, {
    name: "easeOutQuad",
    fn: Lattice_Services_Easing.easeOutQuad
}, {
    name: "easeInOutQuad",
    fn: Lattice_Services_Easing.easeInOutQuad
}, {
    name: "easeInCubic",
    fn: Lattice_Services_Easing.easeInCubic
}, {
    name: "easeOutCubic",
    fn: Lattice_Services_Easing.easeOutCubic
}, {
    name: "easeInOutCubic",
    fn: Lattice_Services_Easing.easeInOutCubic
}, {
    name: "easeInQuart",
    fn: Lattice_Services_Easing.easeInQuart
}, {
    name: "easeOutQuart",
    fn: Lattice_Services_Easing.easeOutQuart
}, {
    name: "easeInOutQuart",
    fn: Lattice_Services_Easing.easeInOutQuart
}, {
    name: "easeInQuint",
    fn: Lattice_Services_Easing.easeInQuint
}, {
    name: "easeOutQuint",
    fn: Lattice_Services_Easing.easeOutQuint
}, {
    name: "easeInOutQuint",
    fn: Lattice_Services_Easing.easeInOutQuint
}, {
    name: "easeInExpo",
    fn: Lattice_Services_Easing.easeInExpo
}, {
    name: "easeOutExpo",
    fn: Lattice_Services_Easing.easeOutExpo
} ];
var monotonicEasingFns = boundedEasingFns;
var monotonicityProperties = /* #__PURE__ */ describe("Monotonicity")(/* #__PURE__ */ it("monotonic easings: smaller t gives smaller output")(/* #__PURE__ */ for_(monotonicEasingFns)(function (v) {
    return for_([ {
        t1: 0.0,
        t2: 0.25
    }, {
        t1: 0.25,
        t2: 0.5
    }, {
        t1: 0.5,
        t2: 0.75
    }, {
        t1: 0.75,
        t2: 1.0
    }, {
        t1: 0.1,
        t2: 0.9
    } ])(function (v1) {
        var r1 = v.fn(v1.t1);
        var r2 = v.fn(v1.t2);
        var $50 = r1 <= r2 + epsilon;
        if ($50) {
            return pure(Data_Unit.unit);
        };
        return fail(v.name + (": f(" + (show(v1.t1) + (")=" + (show(r1) + (" > f(" + (show(v1.t2) + (")=" + show(r2)))))))));
    });
})));
var backProperties = /* #__PURE__ */ describe("Back Overshoot")(/* #__PURE__ */ discard(/* #__PURE__ */ it("easeInBack goes negative")(/* #__PURE__ */ (function () {
    var values = map(Lattice_Services_Easing.easeInBack)([ 0.1, 0.2, 0.3 ]);
    var $55 = Data_Array.any(function (v) {
        return v < 0.0;
    })(values);
    if ($55) {
        return pure(Data_Unit.unit);
    };
    return fail("Expected easeInBack to go below 0");
})()))(function () {
    return it("easeOutBack goes above 1")((function () {
        var values = map(Lattice_Services_Easing.easeOutBack)([ 0.7, 0.8, 0.9 ]);
        var $56 = Data_Array.any(function (v) {
            return v > 1.0;
        })(values);
        if ($56) {
            return pure(Data_Unit.unit);
        };
        return fail("Expected easeOutBack to go above 1");
    })());
}));
var allEasingFns = [ {
    name: "linear",
    fn: Lattice_Services_Easing.linear
}, {
    name: "easeInQuad",
    fn: Lattice_Services_Easing.easeInQuad
}, {
    name: "easeOutQuad",
    fn: Lattice_Services_Easing.easeOutQuad
}, {
    name: "easeInOutQuad",
    fn: Lattice_Services_Easing.easeInOutQuad
}, {
    name: "easeInCubic",
    fn: Lattice_Services_Easing.easeInCubic
}, {
    name: "easeOutCubic",
    fn: Lattice_Services_Easing.easeOutCubic
}, {
    name: "easeInOutCubic",
    fn: Lattice_Services_Easing.easeInOutCubic
}, {
    name: "easeInQuart",
    fn: Lattice_Services_Easing.easeInQuart
}, {
    name: "easeOutQuart",
    fn: Lattice_Services_Easing.easeOutQuart
}, {
    name: "easeInOutQuart",
    fn: Lattice_Services_Easing.easeInOutQuart
}, {
    name: "easeInQuint",
    fn: Lattice_Services_Easing.easeInQuint
}, {
    name: "easeOutQuint",
    fn: Lattice_Services_Easing.easeOutQuint
}, {
    name: "easeInOutQuint",
    fn: Lattice_Services_Easing.easeInOutQuint
}, {
    name: "easeInExpo",
    fn: Lattice_Services_Easing.easeInExpo
}, {
    name: "easeOutExpo",
    fn: Lattice_Services_Easing.easeOutExpo
}, {
    name: "easeInBack",
    fn: Lattice_Services_Easing.easeInBack
}, {
    name: "easeOutBack",
    fn: Lattice_Services_Easing.easeOutBack
}, {
    name: "easeInElastic",
    fn: Lattice_Services_Easing.easeInElastic
}, {
    name: "easeOutElastic",
    fn: Lattice_Services_Easing.easeOutElastic
} ];
var boundaryProperties = /* #__PURE__ */ describe("Boundary Conditions")(/* #__PURE__ */ discard(/* #__PURE__ */ it("f(0) = 0 for all easings")(/* #__PURE__ */ for_(allEasingFns)(function (v) {
    return Test_Lattice_TestHelpers.assertCloseTo(epsilon)(0.0)(v.fn(0.0));
})))(function () {
    return it("f(1) = 1 for all easings")(for_(allEasingFns)(function (v) {
        return Test_Lattice_TestHelpers.assertCloseTo(epsilon)(1.0)(v.fn(1.0));
    }));
}));
var determinismProperties = /* #__PURE__ */ describe("Determinism")(/* #__PURE__ */ it("same input always produces same output")(/* #__PURE__ */ for_(allEasingFns)(function (v) {
    return for_([ 0.0, 0.25, 0.5, 0.75, 1.0 ])(function (t) {
        var r1 = v.fn(t);
        var r2 = v.fn(t);
        return shouldEqual(r1)(r2);
    });
})));
var outputRangeProperties = /* #__PURE__ */ describe("Output Range")(/* #__PURE__ */ discard(/* #__PURE__ */ it("bounded easings stay in [0, 1] for random t")(/* #__PURE__ */ Effect_Class.liftEffect(Effect_Aff.monadEffectAff)(/* #__PURE__ */ Test_QuickCheck.quickCheck(/* #__PURE__ */ Test_QuickCheck.testableFunction(Test_QuickCheck_Arbitrary.arbUnit)(Test_QuickCheck.testableResult))(function (v) {
    var results = map(function (v1) {
        return v1.fn(0.37);
    })(boundedEasingFns);
    var allInRange = !Data_Array.any(function (r) {
        return r < 0.0 - epsilon || r > 1.0 + epsilon;
    })(results);
    return assertEquals(allInRange)(true);
}))))(function () {
    return it("all easings produce finite output at t=0.5")(for_(allEasingFns)(function (v) {
        return Test_Lattice_TestHelpers.assertFinite(v.fn(0.5));
    }));
}));
var spec = /* #__PURE__ */ describe("PROPERTY: Easing Functions")(/* #__PURE__ */ discard(boundaryProperties)(function () {
    return discard(outputRangeProperties)(function () {
        return discard(monotonicityProperties)(function () {
            return discard(symmetryProperties)(function () {
                return discard(determinismProperties)(function () {
                    return discard(linearIdentityProperties)(function () {
                        return discard(interpolationProperties)(function () {
                            return discard(expoProperties)(function () {
                                return discard(elasticProperties)(function () {
                                    return backProperties;
                                });
                            });
                        });
                    });
                });
            });
        });
    });
}));
export {
    spec
};
//# sourceMappingURL=index.js.map
