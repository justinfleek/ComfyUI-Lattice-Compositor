// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_State_Class from "../Control.Monad.State.Class/index.js";
import * as DOM_HTML_Indexed_InputType from "../DOM.HTML.Indexed.InputType/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Halogen_Component from "../Halogen.Component/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Events from "../Halogen.HTML.Events/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Halogen_Query_HalogenM from "../Halogen.Query.HalogenM/index.js";
import * as Lattice_UI_Core from "../Lattice.UI.Core/index.js";
var pure = /* #__PURE__ */ Control_Applicative.pure(Halogen_Query_HalogenM.applicativeHalogenM);
var modify_ = /* #__PURE__ */ Control_Monad_State_Class.modify_(Halogen_Query_HalogenM.monadStateHalogenM);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(Halogen_Query_HalogenM.bindHalogenM);
var bind = /* #__PURE__ */ Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM);
var get = /* #__PURE__ */ Control_Monad_State_Class.get(Halogen_Query_HalogenM.monadStateHalogenM);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var type_ = /* #__PURE__ */ Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropInputType);
var value = /* #__PURE__ */ Halogen_HTML_Properties.value(Halogen_HTML_Core.isPropString);
var ColorChanged = /* #__PURE__ */ (function () {
    function ColorChanged(value0) {
        this.value0 = value0;
    };
    ColorChanged.create = function (value0) {
        return new ColorChanged(value0);
    };
    return ColorChanged;
})();
var Initialize = /* #__PURE__ */ (function () {
    function Initialize() {

    };
    Initialize.value = new Initialize();
    return Initialize;
})();
var Receive = /* #__PURE__ */ (function () {
    function Receive(value0) {
        this.value0 = value0;
    };
    Receive.create = function (value0) {
        return new Receive(value0);
    };
    return Receive;
})();
var ToggleOpen = /* #__PURE__ */ (function () {
    function ToggleOpen() {

    };
    ToggleOpen.value = new ToggleOpen();
    return ToggleOpen;
})();
var SetHue = /* #__PURE__ */ (function () {
    function SetHue(value0) {
        this.value0 = value0;
    };
    SetHue.create = function (value0) {
        return new SetHue(value0);
    };
    return SetHue;
})();
var SetSaturation = /* #__PURE__ */ (function () {
    function SetSaturation(value0) {
        this.value0 = value0;
    };
    SetSaturation.create = function (value0) {
        return new SetSaturation(value0);
    };
    return SetSaturation;
})();
var SetLightness = /* #__PURE__ */ (function () {
    function SetLightness(value0) {
        this.value0 = value0;
    };
    SetLightness.create = function (value0) {
        return new SetLightness(value0);
    };
    return SetLightness;
})();
var SetHex = /* #__PURE__ */ (function () {
    function SetHex(value0) {
        this.value0 = value0;
    };
    SetHex.create = function (value0) {
        return new SetHex(value0);
    };
    return SetHex;
})();
var swatchStyle = function (color) {
    return "width: 24px; height: 24px; border-radius: var(--lattice-radius-sm); " + ("background: " + (color + "; border: 1px solid var(--lattice-border-subtle); cursor: pointer;"));
};
var popoverStyle = /* #__PURE__ */ (function () {
    return "position: absolute; top: 100%; left: 0; z-index: 100; " + ("background: var(--lattice-surface-2); border-radius: var(--lattice-radius-md); " + "padding: var(--lattice-space-3); box-shadow: var(--lattice-shadow-lg);");
})();
var parseNumber = function (s) {
    return 0.0;
};
var initialState = function (input) {
    return {
        color: input.color,
        label: input.label,
        isOpen: false,
        hue: 0.0,
        saturation: 100.0,
        lightness: 50.0
    };
};
var hslToHex = function (_h) {
    return function (_s) {
        return function (_l) {
            return "#808080";
        };
    };
};
var handleAction = function (dictMonadAff) {
    return function (v) {
        if (v instanceof Initialize) {
            return pure(Data_Unit.unit);
        };
        if (v instanceof Receive) {
            return modify_(function (v1) {
                var $28 = {};
                for (var $29 in v1) {
                    if ({}.hasOwnProperty.call(v1, $29)) {
                        $28[$29] = v1[$29];
                    };
                };
                $28.color = v.value0.color;
                $28.label = v.value0.label;
                return $28;
            });
        };
        if (v instanceof ToggleOpen) {
            return modify_(function (s) {
                var $32 = {};
                for (var $33 in s) {
                    if ({}.hasOwnProperty.call(s, $33)) {
                        $32[$33] = s[$33];
                    };
                };
                $32.isOpen = !s.isOpen;
                return $32;
            });
        };
        if (v instanceof SetHue) {
            return discard(modify_(function (v1) {
                var $35 = {};
                for (var $36 in v1) {
                    if ({}.hasOwnProperty.call(v1, $36)) {
                        $35[$36] = v1[$36];
                    };
                };
                $35.hue = v.value0;
                return $35;
            }))(function () {
                return bind(get)(function (state) {
                    var newColor = hslToHex(state.hue)(state.saturation)(state.lightness);
                    return discard(modify_(function (v1) {
                        var $38 = {};
                        for (var $39 in v1) {
                            if ({}.hasOwnProperty.call(v1, $39)) {
                                $38[$39] = v1[$39];
                            };
                        };
                        $38.color = newColor;
                        return $38;
                    }))(function () {
                        return Halogen_Query_HalogenM.raise(new ColorChanged(newColor));
                    });
                });
            });
        };
        if (v instanceof SetSaturation) {
            return discard(modify_(function (v1) {
                var $42 = {};
                for (var $43 in v1) {
                    if ({}.hasOwnProperty.call(v1, $43)) {
                        $42[$43] = v1[$43];
                    };
                };
                $42.saturation = v.value0;
                return $42;
            }))(function () {
                return bind(get)(function (state) {
                    var newColor = hslToHex(state.hue)(state.saturation)(state.lightness);
                    return discard(modify_(function (v1) {
                        var $45 = {};
                        for (var $46 in v1) {
                            if ({}.hasOwnProperty.call(v1, $46)) {
                                $45[$46] = v1[$46];
                            };
                        };
                        $45.color = newColor;
                        return $45;
                    }))(function () {
                        return Halogen_Query_HalogenM.raise(new ColorChanged(newColor));
                    });
                });
            });
        };
        if (v instanceof SetLightness) {
            return discard(modify_(function (v1) {
                var $49 = {};
                for (var $50 in v1) {
                    if ({}.hasOwnProperty.call(v1, $50)) {
                        $49[$50] = v1[$50];
                    };
                };
                $49.lightness = v.value0;
                return $49;
            }))(function () {
                return bind(get)(function (state) {
                    var newColor = hslToHex(state.hue)(state.saturation)(state.lightness);
                    return discard(modify_(function (v1) {
                        var $52 = {};
                        for (var $53 in v1) {
                            if ({}.hasOwnProperty.call(v1, $53)) {
                                $52[$53] = v1[$53];
                            };
                        };
                        $52.color = newColor;
                        return $52;
                    }))(function () {
                        return Halogen_Query_HalogenM.raise(new ColorChanged(newColor));
                    });
                });
            });
        };
        if (v instanceof SetHex) {
            return discard(modify_(function (v1) {
                var $56 = {};
                for (var $57 in v1) {
                    if ({}.hasOwnProperty.call(v1, $57)) {
                        $56[$57] = v1[$57];
                    };
                };
                $56.color = v.value0;
                return $56;
            }))(function () {
                return Halogen_Query_HalogenM.raise(new ColorChanged(v.value0));
            });
        };
        throw new Error("Failed pattern match at Lattice.UI.Components.ColorPicker (line 128, column 16 - line 152, column 31): " + [ v.constructor.name ]);
    };
};
var gradientStyle = function (hue) {
    return "width: 200px; height: 150px; " + ("background: linear-gradient(to right, #fff, hsl(" + (show(hue) + ", 100%, 50%));"));
};
var renderPopover = function (state) {
    return Halogen_HTML_Elements.div([ Lattice_UI_Core.cls([ "lattice-color-popover" ]), Halogen_HTML_Properties.attr("style")(popoverStyle) ])([ Halogen_HTML_Elements.div([ Lattice_UI_Core.cls([ "lattice-color-gradient" ]) ])([ Halogen_HTML_Elements.div([ Lattice_UI_Core.cls([ "lattice-color-saturation" ]), Halogen_HTML_Properties.attr("style")(gradientStyle(state.hue)) ])([  ]) ]), Halogen_HTML_Elements.div([ Lattice_UI_Core.cls([ "lattice-color-hue-slider" ]) ])([ Halogen_HTML_Elements.input([ type_(DOM_HTML_Indexed_InputType.InputRange.value), Halogen_HTML_Properties.min(0.0), Halogen_HTML_Properties.max(360.0), value(show(state.hue)), Halogen_HTML_Events.onValueInput(function (v) {
        return new SetHue(parseNumber(v));
    }) ]) ]), Halogen_HTML_Elements.div([ Lattice_UI_Core.cls([ "lattice-color-hex" ]) ])([ Halogen_HTML_Elements.input([ Lattice_UI_Core.cls([ "lattice-input" ]), value(state.color), Halogen_HTML_Events.onValueInput(SetHex.create) ]) ]) ]);
};
var containerStyle = "display: flex; align-items: center; gap: var(--lattice-space-2);";
var render = function (state) {
    return Halogen_HTML_Elements.div([ Lattice_UI_Core.cls([ "lattice-color-picker" ]), Halogen_HTML_Properties.attr("style")(containerStyle) ])([ Halogen_HTML_Elements.span([ Lattice_UI_Core.cls([ "lattice-color-label" ]) ])([ Halogen_HTML_Core.text(state.label) ]), Halogen_HTML_Elements.button([ Lattice_UI_Core.cls([ "lattice-color-swatch" ]), Halogen_HTML_Properties.attr("style")(swatchStyle(state.color)), Halogen_HTML_Events.onClick(function (v) {
        return ToggleOpen.value;
    }) ])([  ]), (function () {
        if (state.isOpen) {
            return renderPopover(state);
        };
        return Halogen_HTML_Core.text("");
    })() ]);
};
var component = function (dictMonadAff) {
    return Halogen_Component.mkComponent({
        initialState: initialState,
        render: render,
        "eval": Halogen_Component.mkEval({
            handleQuery: Halogen_Component.defaultEval.handleQuery,
            finalize: Halogen_Component.defaultEval.finalize,
            handleAction: handleAction(dictMonadAff),
            initialize: new Data_Maybe.Just(Initialize.value),
            receive: function ($61) {
                return Data_Maybe.Just.create(Receive.create($61));
            }
        })
    });
};
export {
    ColorChanged,
    Initialize,
    Receive,
    ToggleOpen,
    SetHue,
    SetSaturation,
    SetLightness,
    SetHex,
    component,
    initialState,
    render,
    renderPopover,
    containerStyle,
    swatchStyle,
    popoverStyle,
    gradientStyle,
    parseNumber,
    handleAction,
    hslToHex
};
//# sourceMappingURL=index.js.map
