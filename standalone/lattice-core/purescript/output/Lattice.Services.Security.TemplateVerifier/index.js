// Generated by purs version 0.15.15
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Argonaut_Core from "../Data.Argonaut.Core/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Generic_Rep from "../Data.Generic.Rep/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Show_Generic from "../Data.Show.Generic/index.js";
import * as Foreign_Object from "../Foreign.Object/index.js";
var showRecord = /* #__PURE__ */ Data_Show.showRecord()();
var genericShowConstructor = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(Data_Show_Generic.genericShowArgsNoArguments);
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var foldl = /* #__PURE__ */ Data_Foldable.foldl(Data_Foldable.foldableArray);
var sort = /* #__PURE__ */ Data_Array.sort(Data_Ord.ordString);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var VerifySignatureRequest = /* #__PURE__ */ (function () {
    function VerifySignatureRequest(value0) {
        this.value0 = value0;
    };
    VerifySignatureRequest.create = function (value0) {
        return new VerifySignatureRequest(value0);
    };
    return VerifySignatureRequest;
})();
var VsOfficial = /* #__PURE__ */ (function () {
    function VsOfficial() {

    };
    VsOfficial.value = new VsOfficial();
    return VsOfficial;
})();
var VsThirdPartyValid = /* #__PURE__ */ (function () {
    function VsThirdPartyValid() {

    };
    VsThirdPartyValid.value = new VsThirdPartyValid();
    return VsThirdPartyValid;
})();
var VsThirdPartyInvalid = /* #__PURE__ */ (function () {
    function VsThirdPartyInvalid() {

    };
    VsThirdPartyInvalid.value = new VsThirdPartyInvalid();
    return VsThirdPartyInvalid;
})();
var VsUnsigned = /* #__PURE__ */ (function () {
    function VsUnsigned() {

    };
    VsUnsigned.value = new VsUnsigned();
    return VsUnsigned;
})();
var SignTemplateRequest = /* #__PURE__ */ (function () {
    function SignTemplateRequest(value0) {
        this.value0 = value0;
    };
    SignTemplateRequest.create = function (value0) {
        return new SignTemplateRequest(value0);
    };
    return SignTemplateRequest;
})();
var ColorGreen = /* #__PURE__ */ (function () {
    function ColorGreen() {

    };
    ColorGreen.value = new ColorGreen();
    return ColorGreen;
})();
var ColorYellow = /* #__PURE__ */ (function () {
    function ColorYellow() {

    };
    ColorYellow.value = new ColorYellow();
    return ColorYellow;
})();
var ColorRed = /* #__PURE__ */ (function () {
    function ColorRed() {

    };
    ColorRed.value = new ColorRed();
    return ColorRed;
})();
var ColorGray = /* #__PURE__ */ (function () {
    function ColorGray() {

    };
    ColorGray.value = new ColorGray();
    return ColorGray;
})();
var genericVerifySignatureReq = {
    to: function (x) {
        return new VerifySignatureRequest(x);
    },
    from: function (x) {
        return x.value0;
    }
};
var showVerifySignatureReques = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericVerifySignatureReq)(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(/* #__PURE__ */ showRecord(/* #__PURE__ */ Data_Show.showRecordFieldsCons({
        reflectSymbol: function () {
            return "message";
        }
    })(/* #__PURE__ */ Data_Show.showRecordFieldsCons({
        reflectSymbol: function () {
            return "publicKey";
        }
    })(/* #__PURE__ */ Data_Show.showRecordFieldsConsNil({
        reflectSymbol: function () {
            return "signature";
        }
    })(Data_Show.showString))(Data_Show.showString))(Data_Show.showString))))({
        reflectSymbol: function () {
            return "VerifySignatureRequest";
        }
    }))
};
var genericVerificationStatus = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return VsOfficial.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inl) {
            return VsThirdPartyValid.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inl)) {
            return VsThirdPartyInvalid.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inr)) {
            return VsUnsigned.value;
        };
        throw new Error("Failed pattern match at Lattice.Services.Security.TemplateVerifier (line 74, column 1 - line 74, column 45): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof VsOfficial) {
            return new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value);
        };
        if (x instanceof VsThirdPartyValid) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value));
        };
        if (x instanceof VsThirdPartyInvalid) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value)));
        };
        if (x instanceof VsUnsigned) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(Data_Generic_Rep.NoArguments.value)));
        };
        throw new Error("Failed pattern match at Lattice.Services.Security.TemplateVerifier (line 74, column 1 - line 74, column 45): " + [ x.constructor.name ]);
    }
};
var showVerificationStatus = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericVerificationStatus)(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "VsOfficial";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "VsThirdPartyValid";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "VsThirdPartyInvalid";
        }
    }))(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "VsUnsigned";
        }
    })))))
};
var genericSignTemplateReques = {
    to: function (x) {
        return new SignTemplateRequest(x);
    },
    from: function (x) {
        return x.value0;
    }
};
var showSignTemplateRequest = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericSignTemplateReques)(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(/* #__PURE__ */ showRecord(/* #__PURE__ */ Data_Show.showRecordFieldsCons({
        reflectSymbol: function () {
            return "canonicalJson";
        }
    })(/* #__PURE__ */ Data_Show.showRecordFieldsConsNil({
        reflectSymbol: function () {
            return "privateKey";
        }
    })(Data_Show.showString))(Data_Show.showString))))({
        reflectSymbol: function () {
            return "SignTemplateRequest";
        }
    }))
};
var genericBadgeColor_ = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return ColorGreen.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inl) {
            return ColorYellow.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inl)) {
            return ColorRed.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inr)) {
            return ColorGray.value;
        };
        throw new Error("Failed pattern match at Lattice.Services.Security.TemplateVerifier (line 92, column 1 - line 92, column 37): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof ColorGreen) {
            return new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value);
        };
        if (x instanceof ColorYellow) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value));
        };
        if (x instanceof ColorRed) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value)));
        };
        if (x instanceof ColorGray) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(Data_Generic_Rep.NoArguments.value)));
        };
        throw new Error("Failed pattern match at Lattice.Services.Security.TemplateVerifier (line 92, column 1 - line 92, column 37): " + [ x.constructor.name ]);
    }
};
var showBadgeColor = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericBadgeColor_)(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ColorGreen";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ColorYellow";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ColorRed";
        }
    }))(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ColorGray";
        }
    })))))
};
var eqVerifySignatureRequest = {
    eq: function (x) {
        return function (y) {
            return x.value0.message === y.value0.message && x.value0.publicKey === y.value0.publicKey && x.value0.signature === y.value0.signature;
        };
    }
};
var eqVerificationStatus = {
    eq: function (x) {
        return function (y) {
            if (x instanceof VsOfficial && y instanceof VsOfficial) {
                return true;
            };
            if (x instanceof VsThirdPartyValid && y instanceof VsThirdPartyValid) {
                return true;
            };
            if (x instanceof VsThirdPartyInvalid && y instanceof VsThirdPartyInvalid) {
                return true;
            };
            if (x instanceof VsUnsigned && y instanceof VsUnsigned) {
                return true;
            };
            return false;
        };
    }
};
var notEq1 = /* #__PURE__ */ Data_Eq.notEq(eqVerificationStatus);
var eqSignTemplateRequest = {
    eq: function (x) {
        return function (y) {
            return x.value0.canonicalJson === y.value0.canonicalJson && x.value0.privateKey === y.value0.privateKey;
        };
    }
};
var eqBadgeColor = {
    eq: function (x) {
        return function (y) {
            if (x instanceof ColorGreen && y instanceof ColorGreen) {
                return true;
            };
            if (x instanceof ColorYellow && y instanceof ColorYellow) {
                return true;
            };
            if (x instanceof ColorRed && y instanceof ColorRed) {
                return true;
            };
            if (x instanceof ColorGray && y instanceof ColorGray) {
                return true;
            };
            return false;
        };
    }
};
var supportedVersions = [ "1.0" ];
var shouldWarnBeforeLoading = function (result) {
    return notEq1(result.status)(VsOfficial.value);
};
var parseSignature = function (json) {
    return bind(Data_Argonaut_Core.toObject(json))(function (obj) {
        return bind(bind(Foreign_Object.lookup("algorithm")(obj))(Data_Argonaut_Core.toString))(function (algorithm) {
            return bind(bind(Foreign_Object.lookup("publicKey")(obj))(Data_Argonaut_Core.toString))(function (publicKey) {
                return bind(bind(Foreign_Object.lookup("signature")(obj))(Data_Argonaut_Core.toString))(function (signature) {
                    return bind(bind(Foreign_Object.lookup("signedAt")(obj))(Data_Argonaut_Core.toString))(function (signedAt) {
                        return bind(bind(Foreign_Object.lookup("version")(obj))(Data_Argonaut_Core.toString))(function (version) {
                            var $147 = algorithm !== "Ed25519";
                            if ($147) {
                                return Data_Maybe.Nothing.value;
                            };
                            return new Data_Maybe.Just({
                                algorithm: algorithm,
                                publicKey: publicKey,
                                signature: signature,
                                signedAt: signedAt,
                                version: version
                            });
                        });
                    });
                });
            });
        });
    });
};
var officialPublicKey = "xmCWXfRKw7DQLuyQdqQIJlAb+r0arpUu2oVjTdJgv/k=";
var mkUnsignedResult = function (message) {
    return {
        isSigned: false,
        isValid: false,
        isOfficial: false,
        status: VsUnsigned.value,
        message: message,
        signerPublicKey: Data_Maybe.Nothing.value,
        signedAt: Data_Maybe.Nothing.value
    };
};
var mkThirdPartyResult = function (publicKey) {
    return function (signedAt) {
        return {
            isSigned: true,
            isValid: true,
            isOfficial: false,
            status: VsThirdPartyValid.value,
            message: "Template is signed by a third party. Verify you trust the source.",
            signerPublicKey: new Data_Maybe.Just(publicKey),
            signedAt: new Data_Maybe.Just(signedAt)
        };
    };
};
var mkOfficialResult = function (publicKey) {
    return function (signedAt) {
        return {
            isSigned: true,
            isValid: true,
            isOfficial: true,
            status: VsOfficial.value,
            message: "Verified official Lattice template.",
            signerPublicKey: new Data_Maybe.Just(publicKey),
            signedAt: new Data_Maybe.Just(signedAt)
        };
    };
};
var mkInvalidResult = function (message) {
    return function (signerKey) {
        return function (signedTime) {
            return {
                isSigned: true,
                isValid: false,
                isOfficial: false,
                status: VsThirdPartyInvalid.value,
                message: message,
                signerPublicKey: signerKey,
                signedAt: signedTime
            };
        };
    };
};
var joinWith = function (sep) {
    return function (arr) {
        if (arr.length === 0) {
            return "";
        };
        if (arr.length === 1) {
            return arr[0];
        };
        return foldl(function (acc) {
            return function (x) {
                var $150 = acc === "";
                if ($150) {
                    return x;
                };
                return acc + (sep + x);
            };
        })("")(arr);
    };
};
var isOfficialKey = function (key) {
    return key === officialPublicKey;
};
var getVerificationBadge = function (result) {
    if (result.status instanceof VsOfficial) {
        return {
            label: "Verified by Lattice",
            color: ColorGreen.value,
            icon: "check"
        };
    };
    if (result.status instanceof VsThirdPartyValid) {
        return {
            label: "Third-party (valid signature)",
            color: ColorYellow.value,
            icon: "warning"
        };
    };
    if (result.status instanceof VsThirdPartyInvalid) {
        return {
            label: "Invalid signature",
            color: ColorRed.value,
            icon: "x"
        };
    };
    if (result.status instanceof VsUnsigned) {
        return {
            label: "Unsigned template",
            color: ColorGray.value,
            icon: "question"
        };
    };
    throw new Error("Failed pattern match at Lattice.Services.Security.TemplateVerifier (line 203, column 31 - line 223, column 6): " + [ result.status.constructor.name ]);
};
var getLoadingWarning = function (result) {
    if (result.status instanceof VsOfficial) {
        return new Data_Either.Left("No loading warning for official templates");
    };
    if (result.status instanceof VsThirdPartyValid) {
        return new Data_Either.Right("This template is signed by a third party. Only load templates from sources you trust.");
    };
    if (result.status instanceof VsThirdPartyInvalid) {
        return new Data_Either.Right("WARNING: This template has an invalid signature. It may have been tampered with. Do not load unless you trust the source.");
    };
    if (result.status instanceof VsUnsigned) {
        return new Data_Either.Right("This template is unsigned. Only load templates from sources you trust.");
    };
    throw new Error("Failed pattern match at Lattice.Services.Security.TemplateVerifier (line 231, column 28 - line 239, column 83): " + [ result.status.constructor.name ]);
};
var createCanonicalJson = function (obj) {
    var sortedKeys = sort(Foreign_Object.keys(obj));
    var pairs = map(function (k) {
        return "\"" + (k + ("\":" + (function () {
            var v = Foreign_Object.lookup(k)(obj);
            if (v instanceof Data_Maybe.Just) {
                return Data_Argonaut_Core.stringify(v.value0);
            };
            if (v instanceof Data_Maybe.Nothing) {
                return "null";
            };
            throw new Error("Failed pattern match at Lattice.Services.Security.TemplateVerifier (line 261, column 9 - line 263, column 28): " + [ v.constructor.name ]);
        })()));
    })(sortedKeys);
    var content = joinWith(",")(pairs);
    return "{" + (content + "}");
};
export {
    VsOfficial,
    VsThirdPartyValid,
    VsThirdPartyInvalid,
    VsUnsigned,
    ColorGreen,
    ColorYellow,
    ColorRed,
    ColorGray,
    VerifySignatureRequest,
    SignTemplateRequest,
    mkUnsignedResult,
    mkInvalidResult,
    mkOfficialResult,
    mkThirdPartyResult,
    isOfficialKey,
    getVerificationBadge,
    shouldWarnBeforeLoading,
    getLoadingWarning,
    parseSignature,
    createCanonicalJson,
    officialPublicKey,
    supportedVersions,
    eqVerificationStatus,
    genericVerificationStatus,
    showVerificationStatus,
    eqBadgeColor,
    genericBadgeColor_,
    showBadgeColor,
    eqVerifySignatureRequest,
    genericVerifySignatureReq,
    showVerifySignatureReques,
    eqSignTemplateRequest,
    genericSignTemplateReques,
    showSignTemplateRequest
};
//# sourceMappingURL=index.js.map
