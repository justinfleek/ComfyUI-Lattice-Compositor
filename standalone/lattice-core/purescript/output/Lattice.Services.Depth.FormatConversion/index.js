// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_EuclideanRing from "../Data.EuclideanRing/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as $$Math from "../Math/index.js";
var div = /* #__PURE__ */ Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt);
var FormatRaw = /* #__PURE__ */ (function () {
    function FormatRaw() {

    };
    FormatRaw.value = new FormatRaw();
    return FormatRaw;
})();
var FormatMidas = /* #__PURE__ */ (function () {
    function FormatMidas() {

    };
    FormatMidas.value = new FormatMidas();
    return FormatMidas;
})();
var FormatDepthAnything = /* #__PURE__ */ (function () {
    function FormatDepthAnything() {

    };
    FormatDepthAnything.value = new FormatDepthAnything();
    return FormatDepthAnything;
})();
var FormatZoeDepth = /* #__PURE__ */ (function () {
    function FormatZoeDepth() {

    };
    FormatZoeDepth.value = new FormatZoeDepth();
    return FormatZoeDepth;
})();
var FormatMarigold = /* #__PURE__ */ (function () {
    function FormatMarigold() {

    };
    FormatMarigold.value = new FormatMarigold();
    return FormatMarigold;
})();
var FormatGrayscale8 = /* #__PURE__ */ (function () {
    function FormatGrayscale8() {

    };
    FormatGrayscale8.value = new FormatGrayscale8();
    return FormatGrayscale8;
})();
var FormatGrayscale16 = /* #__PURE__ */ (function () {
    function FormatGrayscale16() {

    };
    FormatGrayscale16.value = new FormatGrayscale16();
    return FormatGrayscale16;
})();
var ColormapGrayscale = /* #__PURE__ */ (function () {
    function ColormapGrayscale() {

    };
    ColormapGrayscale.value = new ColormapGrayscale();
    return ColormapGrayscale;
})();
var ColormapViridis = /* #__PURE__ */ (function () {
    function ColormapViridis() {

    };
    ColormapViridis.value = new ColormapViridis();
    return ColormapViridis;
})();
var ColormapMagma = /* #__PURE__ */ (function () {
    function ColormapMagma() {

    };
    ColormapMagma.value = new ColormapMagma();
    return ColormapMagma;
})();
var ColormapPlasma = /* #__PURE__ */ (function () {
    function ColormapPlasma() {

    };
    ColormapPlasma.value = new ColormapPlasma();
    return ColormapPlasma;
})();
var ColormapInferno = /* #__PURE__ */ (function () {
    function ColormapInferno() {

    };
    ColormapInferno.value = new ColormapInferno();
    return ColormapInferno;
})();
var ColormapTurbo = /* #__PURE__ */ (function () {
    function ColormapTurbo() {

    };
    ColormapTurbo.value = new ColormapTurbo();
    return ColormapTurbo;
})();
var viridisColors = [ {
    r: 68,
    g: 1,
    b: 84
}, {
    r: 72,
    g: 40,
    b: 120
}, {
    r: 62,
    g: 74,
    b: 137
}, {
    r: 49,
    g: 104,
    b: 142
}, {
    r: 38,
    g: 130,
    b: 142
}, {
    r: 31,
    g: 158,
    b: 137
}, {
    r: 53,
    g: 183,
    b: 121
}, {
    r: 109,
    g: 205,
    b: 89
}, {
    r: 180,
    g: 222,
    b: 44
}, {
    r: 253,
    g: 231,
    b: 37
} ];
var uint16To8bit = function (value) {
    return div(value)(256);
};
var turboColors = [ {
    r: 48,
    g: 18,
    b: 59
}, {
    r: 70,
    g: 68,
    b: 172
}, {
    r: 62,
    g: 121,
    b: 229
}, {
    r: 38,
    g: 170,
    b: 225
}, {
    r: 31,
    g: 212,
    b: 182
}, {
    r: 76,
    g: 237,
    b: 123
}, {
    r: 149,
    g: 249,
    b: 67
}, {
    r: 212,
    g: 241,
    b: 31
}, {
    r: 253,
    g: 207,
    b: 37
}, {
    r: 252,
    g: 150,
    b: 38
}, {
    r: 239,
    g: 85,
    b: 33
}, {
    r: 205,
    g: 33,
    b: 28
}, {
    r: 122,
    g: 4,
    b: 3
} ];
var to8bit = function (normalized) {
    var scaled = normalized * 255.0;
    var clamped = $$Math.max(0.0)($$Math.min(255.0)(scaled));
    return Data_Int.round(clamped);
};
var to16bit = function (normalized) {
    var scaled = normalized * 65535.0;
    var clamped = $$Math.max(0.0)($$Math.min(65535.0)(scaled));
    return Data_Int.round(clamped);
};
var rgbToRGBA = function (rgb) {
    return function (alpha) {
        return {
            r: rgb.r,
            g: rgb.g,
            b: rgb.b,
            a: alpha
        };
    };
};
var plasmaColors = [ {
    r: 13,
    g: 8,
    b: 135
}, {
    r: 75,
    g: 3,
    b: 161
}, {
    r: 125,
    g: 3,
    b: 168
}, {
    r: 168,
    g: 34,
    b: 150
}, {
    r: 203,
    g: 70,
    b: 121
}, {
    r: 229,
    g: 107,
    b: 93
}, {
    r: 248,
    g: 148,
    b: 65
}, {
    r: 253,
    g: 195,
    b: 40
}, {
    r: 240,
    g: 249,
    b: 33
} ];
var pixelIndex = function (i) {
    return i * 4 | 0;
};
var parseColormap = function (s) {
    if (s === "viridis") {
        return ColormapViridis.value;
    };
    if (s === "magma") {
        return ColormapMagma.value;
    };
    if (s === "plasma") {
        return ColormapPlasma.value;
    };
    if (s === "inferno") {
        return ColormapInferno.value;
    };
    if (s === "turbo") {
        return ColormapTurbo.value;
    };
    return ColormapGrayscale.value;
};
var magmaColors = [ {
    r: 0,
    g: 0,
    b: 4
}, {
    r: 28,
    g: 16,
    b: 68
}, {
    r: 79,
    g: 18,
    b: 123
}, {
    r: 129,
    g: 37,
    b: 129
}, {
    r: 181,
    g: 54,
    b: 122
}, {
    r: 229,
    g: 80,
    b: 100
}, {
    r: 251,
    g: 135,
    b: 97
}, {
    r: 254,
    g: 194,
    b: 135
}, {
    r: 252,
    g: 253,
    b: 191
} ];
var lerpInt = function (a) {
    return function (b) {
        return function (t) {
            var result = Data_Int.toNumber(a) + (Data_Int.toNumber(b) - Data_Int.toNumber(a)) * t;
            var clamped = $$Math.max(0.0)($$Math.min(255.0)(result));
            return Data_Int.round(clamped);
        };
    };
};
var lerpRGB = function (c1) {
    return function (c2) {
        return function (t) {
            return {
                r: lerpInt(c1.r)(c2.r)(t),
                g: lerpInt(c1.g)(c2.g)(t),
                b: lerpInt(c1.b)(c2.b)(t)
            };
        };
    };
};
var invertDepth = function (normalized) {
    return 1.0 - normalized;
};
var infernoColors = [ {
    r: 0,
    g: 0,
    b: 4
}, {
    r: 22,
    g: 11,
    b: 57
}, {
    r: 66,
    g: 10,
    b: 104
}, {
    r: 106,
    g: 23,
    b: 110
}, {
    r: 147,
    g: 38,
    b: 103
}, {
    r: 188,
    g: 55,
    b: 84
}, {
    r: 221,
    g: 81,
    b: 58
}, {
    r: 243,
    g: 118,
    b: 27
}, {
    r: 252,
    g: 165,
    b: 10
}, {
    r: 246,
    g: 215,
    b: 70
}, {
    r: 252,
    g: 255,
    b: 164
} ];
var getFormatSpec = function (format) {
    if (format instanceof FormatRaw) {
        return {
            bitDepth: 32,
            nearClip: 0.1,
            farClip: 100.0,
            normalize: false,
            invert: false
        };
    };
    if (format instanceof FormatMidas) {
        return {
            bitDepth: 16,
            nearClip: 0.1,
            farClip: 100.0,
            normalize: true,
            invert: true
        };
    };
    if (format instanceof FormatDepthAnything) {
        return {
            bitDepth: 16,
            nearClip: 0.1,
            farClip: 100.0,
            normalize: true,
            invert: true
        };
    };
    if (format instanceof FormatZoeDepth) {
        return {
            bitDepth: 16,
            nearClip: 1.0e-3,
            farClip: 80.0,
            normalize: false,
            invert: false
        };
    };
    if (format instanceof FormatMarigold) {
        return {
            bitDepth: 16,
            nearClip: 0.1,
            farClip: 100.0,
            normalize: true,
            invert: false
        };
    };
    if (format instanceof FormatGrayscale8) {
        return {
            bitDepth: 8,
            nearClip: 0.1,
            farClip: 100.0,
            normalize: true,
            invert: false
        };
    };
    if (format instanceof FormatGrayscale16) {
        return {
            bitDepth: 16,
            nearClip: 0.1,
            farClip: 100.0,
            normalize: true,
            invert: false
        };
    };
    throw new Error("Failed pattern match at Lattice.Services.Depth.FormatConversion (line 109, column 24 - line 123, column 84): " + [ format.constructor.name ]);
};
var eqDepthMapFormat = {
    eq: function (x) {
        return function (y) {
            if (x instanceof FormatRaw && y instanceof FormatRaw) {
                return true;
            };
            if (x instanceof FormatMidas && y instanceof FormatMidas) {
                return true;
            };
            if (x instanceof FormatDepthAnything && y instanceof FormatDepthAnything) {
                return true;
            };
            if (x instanceof FormatZoeDepth && y instanceof FormatZoeDepth) {
                return true;
            };
            if (x instanceof FormatMarigold && y instanceof FormatMarigold) {
                return true;
            };
            if (x instanceof FormatGrayscale8 && y instanceof FormatGrayscale8) {
                return true;
            };
            if (x instanceof FormatGrayscale16 && y instanceof FormatGrayscale16) {
                return true;
            };
            return false;
        };
    }
};
var eqColormap = {
    eq: function (x) {
        return function (y) {
            if (x instanceof ColormapGrayscale && y instanceof ColormapGrayscale) {
                return true;
            };
            if (x instanceof ColormapViridis && y instanceof ColormapViridis) {
                return true;
            };
            if (x instanceof ColormapMagma && y instanceof ColormapMagma) {
                return true;
            };
            if (x instanceof ColormapPlasma && y instanceof ColormapPlasma) {
                return true;
            };
            if (x instanceof ColormapInferno && y instanceof ColormapInferno) {
                return true;
            };
            if (x instanceof ColormapTurbo && y instanceof ColormapTurbo) {
                return true;
            };
            return false;
        };
    }
};
var depthToGrayscalePixel = function (value) {
    return {
        r: value,
        g: value,
        b: value,
        a: 255
    };
};
var clamp01 = function (value) {
    return $$Math.max(0.0)($$Math.min(1.0)(value));
};
var float32To8bit = function ($29) {
    return to8bit(clamp01($29));
};
var invertForAIVisualization = function (normalized) {
    return 1.0 - clamp01(normalized);
};
var normalizeDepth = function (depth) {
    return function (minDepth) {
        return function (maxDepth) {
            var range = maxDepth - minDepth;
            var safeRange = (function () {
                var $22 = range > 0.0;
                if ($22) {
                    return range;
                };
                return 1.0;
            })();
            return clamp01((depth - minDepth) / safeRange);
        };
    };
};
var normalizeMetricDepth = function (depth) {
    return function (farClip) {
        return clamp01(depth / farClip);
    };
};
var convertDepthValue = function (depth) {
    return function (minDepth) {
        return function (maxDepth) {
            return function (spec) {
                var normalized = (function () {
                    if (spec.normalize) {
                        return normalizeDepth(depth)(minDepth)(maxDepth);
                    };
                    return normalizeMetricDepth(depth)(spec.farClip);
                })();
                if (spec.invert) {
                    return invertDepth(normalized);
                };
                return normalized;
            };
        };
    };
};
var depthTo16bit = function (depth) {
    return function (minDepth) {
        return function (maxDepth) {
            return function (spec) {
                var normalized = convertDepthValue(depth)(minDepth)(maxDepth)(spec);
                return to16bit(normalized);
            };
        };
    };
};
var depthTo8bit = function (depth) {
    return function (minDepth) {
        return function (maxDepth) {
            return function (spec) {
                var normalized = convertDepthValue(depth)(minDepth)(maxDepth)(spec);
                return to8bit(normalized);
            };
        };
    };
};
var sampleColormap = function (colors) {
    return function (t) {
        if (Data_Array.length(colors) === 0) {
            return {
                r: 0,
                g: 0,
                b: 0
            };
        };
        if (Data_Boolean.otherwise) {
            var n = Data_Array.length(colors);
            var clamped = clamp01(t);
            var idx = clamped * Data_Int.toNumber(n - 1 | 0);
            var i = Data_Int.floor(idx);
            var f = idx - Data_Int.toNumber(i);
            var c1 = Data_Maybe.fromMaybe({
                r: 0,
                g: 0,
                b: 0
            })(Data_Array.index(colors)(i));
            var c2 = Data_Maybe.fromMaybe(c1)(Data_Array.index(colors)(i + 1 | 0));
            var $27 = i >= (n - 1 | 0);
            if ($27) {
                return Data_Maybe.fromMaybe({
                    r: 0,
                    g: 0,
                    b: 0
                })(Data_Array.index(colors)(n - 1 | 0));
            };
            return lerpRGB(c1)(c2)(f);
        };
        throw new Error("Failed pattern match at Lattice.Services.Depth.FormatConversion (line 315, column 1 - line 315, column 45): " + [ colors.constructor.name, t.constructor.name ]);
    };
};
var getColormapColor = function (t) {
    return function (cmap) {
        if (cmap instanceof ColormapGrayscale) {
            var v = to8bit(clamp01(t));
            return {
                r: v,
                g: v,
                b: v
            };
        };
        if (cmap instanceof ColormapViridis) {
            return sampleColormap(viridisColors)(t);
        };
        if (cmap instanceof ColormapMagma) {
            return sampleColormap(magmaColors)(t);
        };
        if (cmap instanceof ColormapPlasma) {
            return sampleColormap(plasmaColors)(t);
        };
        if (cmap instanceof ColormapInferno) {
            return sampleColormap(infernoColors)(t);
        };
        if (cmap instanceof ColormapTurbo) {
            return sampleColormap(turboColors)(t);
        };
        throw new Error("Failed pattern match at Lattice.Services.Depth.FormatConversion (line 336, column 27 - line 344, column 50): " + [ cmap.constructor.name ]);
    };
};
export {
    FormatRaw,
    FormatMidas,
    FormatDepthAnything,
    FormatZoeDepth,
    FormatMarigold,
    FormatGrayscale8,
    FormatGrayscale16,
    ColormapGrayscale,
    ColormapViridis,
    ColormapMagma,
    ColormapPlasma,
    ColormapInferno,
    ColormapTurbo,
    getFormatSpec,
    clamp01,
    normalizeDepth,
    normalizeMetricDepth,
    invertDepth,
    to8bit,
    to16bit,
    uint16To8bit,
    float32To8bit,
    convertDepthValue,
    depthTo8bit,
    depthTo16bit,
    depthToGrayscalePixel,
    rgbToRGBA,
    pixelIndex,
    viridisColors,
    magmaColors,
    plasmaColors,
    infernoColors,
    turboColors,
    lerpInt,
    lerpRGB,
    sampleColormap,
    getColormapColor,
    parseColormap,
    invertForAIVisualization,
    eqDepthMapFormat,
    eqColormap
};
//# sourceMappingURL=index.js.map
