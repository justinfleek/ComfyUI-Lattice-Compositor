// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as $$Math from "../Math/index.js";
var updatePosition = function (p) {
    return function (deltaTime) {
        return {
            id: p.id,
            prevX: p.prevX,
            prevY: p.prevY,
            vx: p.vx,
            vy: p.vy,
            age: p.age,
            lifetime: p.lifetime,
            size: p.size,
            baseSize: p.baseSize,
            color: p.color,
            baseColor: p.baseColor,
            emitterId: p.emitterId,
            isSubParticle: p.isSubParticle,
            angularVelocity: p.angularVelocity,
            spriteIndex: p.spriteIndex,
            collisionCount: p.collisionCount,
            x: p.x + p.vx * deltaTime,
            y: p.y + p.vy * deltaTime,
            rotation: p.rotation + p.angularVelocity * deltaTime
        };
    };
};
var storePreviousPosition = function (p) {
    return {
        id: p.id,
        x: p.x,
        y: p.y,
        vx: p.vx,
        vy: p.vy,
        age: p.age,
        lifetime: p.lifetime,
        size: p.size,
        baseSize: p.baseSize,
        color: p.color,
        baseColor: p.baseColor,
        emitterId: p.emitterId,
        isSubParticle: p.isSubParticle,
        rotation: p.rotation,
        angularVelocity: p.angularVelocity,
        spriteIndex: p.spriteIndex,
        collisionCount: p.collisionCount,
        prevX: p.x,
        prevY: p.y
    };
};
var maxTrailLength = 20;
var pruneTrail = function (trail) {
    return Data_Array.take(maxTrailLength)(trail);
};
var lifeRatio = function (p) {
    var ratio = p.age / $$Math.max(1.0)(p.lifetime);
    return $$Math.max(0.0)($$Math.min(1.0)(ratio));
};
var isExpired = function (p) {
    return p.age > p.lifetime;
};
var incrementAge = function (p) {
    return function (deltaTime) {
        return {
            id: p.id,
            x: p.x,
            y: p.y,
            prevX: p.prevX,
            prevY: p.prevY,
            vx: p.vx,
            vy: p.vy,
            lifetime: p.lifetime,
            size: p.size,
            baseSize: p.baseSize,
            color: p.color,
            baseColor: p.baseColor,
            emitterId: p.emitterId,
            isSubParticle: p.isSubParticle,
            rotation: p.rotation,
            angularVelocity: p.angularVelocity,
            spriteIndex: p.spriteIndex,
            collisionCount: p.collisionCount,
            age: p.age + deltaTime
        };
    };
};
var createParticle = function (pid) {
    return function (x) {
        return function (y) {
            return function (vx) {
                return function (vy) {
                    return function (size) {
                        return function (lifetime) {
                            return function (v) {
                                return function (emitterId) {
                                    return function (rotation) {
                                        return function (angularVel) {
                                            return function (spriteIdx) {
                                                var safeSize = $$Math.max(1.0)(size);
                                                var safeLifetime = $$Math.max(1.0)(lifetime);
                                                var baseColor = {
                                                    r: v.value0,
                                                    g: v.value1.value0,
                                                    b: v.value1.value1,
                                                    a: 255.0
                                                };
                                                return {
                                                    id: pid,
                                                    x: x,
                                                    y: y,
                                                    prevX: x,
                                                    prevY: y,
                                                    vx: vx,
                                                    vy: vy,
                                                    age: 0.0,
                                                    lifetime: safeLifetime,
                                                    size: safeSize,
                                                    baseSize: safeSize,
                                                    color: baseColor,
                                                    baseColor: baseColor,
                                                    emitterId: emitterId,
                                                    isSubParticle: false,
                                                    rotation: rotation,
                                                    angularVelocity: angularVel,
                                                    spriteIndex: spriteIdx,
                                                    collisionCount: 0
                                                };
                                            };
                                        };
                                    };
                                };
                            };
                        };
                    };
                };
            };
        };
    };
};
var baseToCurrentSize = function (baseSize) {
    return function (sizeModulation) {
        return $$Math.max(1.0)(baseSize * $$Math.max(0.0)(sizeModulation));
    };
};
var baseToCurrentColor = function (base) {
    return function (v) {
        var clamp = function (v1) {
            return $$Math.max(0.0)($$Math.min(255.0)(v1));
        };
        return {
            r: clamp(base.r * v.value0),
            g: clamp(base.g * v.value1.value0),
            b: clamp(base.b * v.value1.value1.value0),
            a: clamp(base.a * v.value1.value1.value1)
        };
    };
};
var addTrailPoint = function (p) {
    return function (trail) {
        return Data_Array.cons({
            x: p.x,
            y: p.y
        })(trail);
    };
};
export {
    maxTrailLength,
    createParticle,
    storePreviousPosition,
    updatePosition,
    incrementAge,
    isExpired,
    lifeRatio,
    addTrailPoint,
    pruneTrail,
    baseToCurrentSize,
    baseToCurrentColor
};
//# sourceMappingURL=index.js.map
