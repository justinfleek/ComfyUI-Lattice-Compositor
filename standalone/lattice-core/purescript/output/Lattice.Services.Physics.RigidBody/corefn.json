{"builtWith":"0.15.15","comments":[{"LineComment":" | Lattice.Services.Physics.RigidBody - Rigid Body Physics Calculations"},{"LineComment":" |"},{"LineComment":" | Pure mathematical functions for rigid body dynamics:"},{"LineComment":" | - Moment of inertia for various shapes"},{"LineComment":" | - Impulse-based collision response"},{"LineComment":" | - Friction calculation (Coulomb's law)"},{"LineComment":" | - Position correction"},{"LineComment":" | - Semi-implicit Euler integration"},{"LineComment":" |"},{"LineComment":" | All functions are deterministic and side-effect free."},{"LineComment":" |"},{"LineComment":" | Source: ui/src/services/physics/PhysicsEngine.ts"}],"decls":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[171,18],"start":[171,17]}},"type":"Var","value":{"identifier":"lessThan","moduleName":["Data","Ord"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[171,25],"start":[171,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordNumber","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"lessThan"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[173,46],"start":[173,45]}},"type":"Var","value":{"identifier":"sub","moduleName":["Data","Ring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[173,51],"start":[173,39]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ringNumber","moduleName":["Data","Ring"]}},"type":"App"},"identifier":"sub"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[174,35],"start":[174,34]}},"type":"Var","value":{"identifier":"div","moduleName":["Data","EuclideanRing"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[174,46],"start":[174,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"euclideanRingNumber","moduleName":["Data","EuclideanRing"]}},"type":"App"},"identifier":"div"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[174,28],"start":[174,27]}},"type":"Var","value":{"identifier":"mul","moduleName":["Data","Semiring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[174,46],"start":[174,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"semiringNumber","moduleName":["Data","Semiring"]}},"type":"App"},"identifier":"mul"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[80,26],"start":[80,25]}},"type":"Var","value":{"identifier":"add","moduleName":["Data","Semiring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[80,38],"start":[80,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"semiringNumber","moduleName":["Data","Semiring"]}},"type":"App"},"identifier":"add"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[145,31],"start":[145,11]}},"type":"Var","value":{"identifier":"negate","moduleName":["Data","Ring"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[145,31],"start":[145,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ringNumber","moduleName":["Data","Ring"]}},"type":"App"},"identifier":"negate"},{"annotation":{"meta":null,"sourceSpan":{"end":[41,55],"start":[41,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[41,55],"start":[41,1]}},"constructorName":"CircleShape","fieldNames":[],"type":"Constructor","typeName":"ShapeType"},"identifier":"CircleShape"},{"annotation":{"meta":null,"sourceSpan":{"end":[41,55],"start":[41,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[41,55],"start":[41,1]}},"constructorName":"BoxShape","fieldNames":[],"type":"Constructor","typeName":"ShapeType"},"identifier":"BoxShape"},{"annotation":{"meta":null,"sourceSpan":{"end":[41,55],"start":[41,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[41,55],"start":[41,1]}},"constructorName":"CapsuleShape","fieldNames":[],"type":"Constructor","typeName":"ShapeType"},"identifier":"CapsuleShape"},{"annotation":{"meta":null,"sourceSpan":{"end":[169,69],"start":[169,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[169,69],"start":[169,1]}},"argument":"depth","body":{"annotation":{"meta":null,"sourceSpan":{"end":[169,69],"start":[169,1]}},"argument":"slop","body":{"annotation":{"meta":null,"sourceSpan":{"end":[169,69],"start":[169,1]}},"argument":"bias","body":{"annotation":{"meta":null,"sourceSpan":{"end":[169,69],"start":[169,1]}},"argument":"invMassSum","body":{"annotation":{"meta":null,"sourceSpan":{"end":[174,46],"start":[171,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[174,46],"start":[171,3]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[172,11],"start":[172,8]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":0}},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[174,46],"start":[171,3]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[174,46],"start":[173,8]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[173,52],"start":[173,12]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[173,33],"start":[173,30]}},"type":"Var","value":{"identifier":"max","moduleName":["Math"]}},"annotation":{"meta":null,"sourceSpan":{"end":[173,37],"start":[173,30]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[173,37],"start":[173,34]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":0}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[173,52],"start":[173,30]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"sub","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[173,51],"start":[173,39]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[173,44],"start":[173,39]}},"type":"Var","value":{"identifier":"depth","sourcePos":[170,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[173,51],"start":[173,39]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[173,51],"start":[173,47]}},"type":"Var","value":{"identifier":"slop","sourcePos":[170,1]}},"type":"App"},"type":"App"},"identifier":"correctionDepth"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[174,46],"start":[174,11]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[174,46],"start":[174,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[174,26],"start":[174,11]}},"type":"Var","value":{"identifier":"correctionDepth","sourcePos":[173,12]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[174,46],"start":[174,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[174,33],"start":[174,29]}},"type":"Var","value":{"identifier":"bias","sourcePos":[170,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[174,46],"start":[174,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[174,46],"start":[174,36]}},"type":"Var","value":{"identifier":"invMassSum","sourcePos":[170,1]}},"type":"App"},"type":"Let"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lessThan","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[171,25],"start":[171,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[171,16],"start":[171,6]}},"type":"Var","value":{"identifier":"invMassSum","sourcePos":[170,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[171,25],"start":[171,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[171,25],"start":[171,19]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":1.0e-4}},"type":"App"}],"type":"Case"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"positionCorrection"},{"annotation":{"meta":null,"sourceSpan":{"end":[64,52],"start":[64,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[64,52],"start":[64,1]}},"argument":"mass","body":{"annotation":{"meta":null,"sourceSpan":{"end":[64,52],"start":[64,1]}},"argument":"radius","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[66,33],"start":[66,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[66,26],"start":[66,4]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[66,26],"start":[66,4]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,8],"start":[66,4]}},"type":"Var","value":{"identifier":"mass","sourcePos":[65,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[66,26],"start":[66,4]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,17],"start":[66,11]}},"type":"Var","value":{"identifier":"radius","sourcePos":[65,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[66,26],"start":[66,4]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,26],"start":[66,20]}},"type":"Var","value":{"identifier":"radius","sourcePos":[65,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[66,33],"start":[66,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,33],"start":[66,30]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":2}},"type":"App"},"type":"Abs"},"type":"Abs"},"identifier":"momentOfInertiaCircle"},{"annotation":{"meta":null,"sourceSpan":{"end":[78,63],"start":[78,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[78,63],"start":[78,1]}},"argument":"mass","body":{"annotation":{"meta":null,"sourceSpan":{"end":[78,63],"start":[78,1]}},"argument":"radius","body":{"annotation":{"meta":null,"sourceSpan":{"end":[78,63],"start":[78,1]}},"argument":"len","body":{"annotation":{"meta":null,"sourceSpan":{"end":[85,21],"start":[80,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[80,38],"start":[80,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[80,38],"start":[80,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[80,24],"start":[80,21]}},"type":"Var","value":{"identifier":"len","sourcePos":[79,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[80,38],"start":[80,21]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[80,38],"start":[80,21]}},"argument":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[80,29],"start":[80,27]}},"type":"Var","value":{"identifier":"pi","moduleName":["Math"]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[80,38],"start":[80,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[80,38],"start":[80,32]}},"type":"Var","value":{"identifier":"radius","sourcePos":[79,1]}},"type":"App"},"type":"App"},"identifier":"totalLength"},{"annotation":{"meta":null,"sourceSpan":{"end":[81,44],"start":[81,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[81,44],"start":[81,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[81,29],"start":[81,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,23],"start":[81,19]}},"type":"Var","value":{"identifier":"mass","sourcePos":[79,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[81,29],"start":[81,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,29],"start":[81,26]}},"type":"Var","value":{"identifier":"len","sourcePos":[79,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[81,44],"start":[81,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,44],"start":[81,33]}},"type":"Var","value":{"identifier":"totalLength","sourcePos":[80,7]}},"type":"App"},"identifier":"rectMass"},{"annotation":{"meta":null,"sourceSpan":{"end":[83,70],"start":[83,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[83,70],"start":[83,15]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[83,62],"start":[83,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[83,24],"start":[83,16]}},"type":"Var","value":{"identifier":"rectMass","sourcePos":[81,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[83,62],"start":[83,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[83,61],"start":[83,28]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[83,61],"start":[83,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[83,31],"start":[83,28]}},"type":"Var","value":{"identifier":"len","sourcePos":[79,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[83,61],"start":[83,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[83,37],"start":[83,34]}},"type":"Var","value":{"identifier":"len","sourcePos":[79,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[83,61],"start":[83,28]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[83,61],"start":[83,28]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[83,61],"start":[83,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[83,43],"start":[83,40]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":4}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[83,61],"start":[83,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[83,52],"start":[83,46]}},"type":"Var","value":{"identifier":"radius","sourcePos":[79,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[83,61],"start":[83,28]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[83,61],"start":[83,55]}},"type":"Var","value":{"identifier":"radius","sourcePos":[79,1]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[83,70],"start":[83,15]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[83,70],"start":[83,66]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":12}},"type":"App"},"identifier":"rectI"},{"annotation":{"meta":null,"sourceSpan":{"end":[82,35],"start":[82,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"sub","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[82,35],"start":[82,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[82,24],"start":[82,20]}},"type":"Var","value":{"identifier":"mass","sourcePos":[79,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[82,35],"start":[82,20]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[82,35],"start":[82,27]}},"type":"Var","value":{"identifier":"rectMass","sourcePos":[81,7]}},"type":"App"},"identifier":"circleMass"},{"annotation":{"meta":null,"sourceSpan":{"end":[84,53],"start":[84,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[84,53],"start":[84,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[84,46],"start":[84,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[84,46],"start":[84,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[84,28],"start":[84,18]}},"type":"Var","value":{"identifier":"circleMass","sourcePos":[82,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[84,46],"start":[84,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[84,37],"start":[84,31]}},"type":"Var","value":{"identifier":"radius","sourcePos":[79,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[84,46],"start":[84,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[84,46],"start":[84,40]}},"type":"Var","value":{"identifier":"radius","sourcePos":[79,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[84,53],"start":[84,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[84,53],"start":[84,50]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":2}},"type":"App"},"identifier":"circleI"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[85,21],"start":[85,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[85,11],"start":[85,6]}},"type":"Var","value":{"identifier":"rectI","sourcePos":[83,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[85,21],"start":[85,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[85,21],"start":[85,14]}},"type":"Var","value":{"identifier":"circleI","sourcePos":[84,7]}},"type":"App"},"type":"Let"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"momentOfInertiaCapsule"},{"annotation":{"meta":null,"sourceSpan":{"end":[71,59],"start":[71,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[71,59],"start":[71,1]}},"argument":"mass","body":{"annotation":{"meta":null,"sourceSpan":{"end":[71,59],"start":[71,1]}},"argument":"width","body":{"annotation":{"meta":null,"sourceSpan":{"end":[71,59],"start":[71,1]}},"argument":"height","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[73,52],"start":[73,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[73,44],"start":[73,4]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[73,8],"start":[73,4]}},"type":"Var","value":{"identifier":"mass","sourcePos":[72,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[73,44],"start":[73,4]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[73,43],"start":[73,12]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[73,43],"start":[73,12]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[73,17],"start":[73,12]}},"type":"Var","value":{"identifier":"width","sourcePos":[72,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[73,43],"start":[73,12]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[73,25],"start":[73,20]}},"type":"Var","value":{"identifier":"width","sourcePos":[72,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[73,43],"start":[73,12]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[73,43],"start":[73,12]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[73,34],"start":[73,28]}},"type":"Var","value":{"identifier":"height","sourcePos":[72,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[73,43],"start":[73,12]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[73,43],"start":[73,37]}},"type":"Var","value":{"identifier":"height","sourcePos":[72,1]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[73,52],"start":[73,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[73,52],"start":[73,48]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":12}},"type":"App"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"momentOfInertiaBox"},{"annotation":{"meta":null,"sourceSpan":{"end":[88,69],"start":[88,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[88,69],"start":[88,1]}},"argument":"shapeType","body":{"annotation":{"meta":null,"sourceSpan":{"end":[88,69],"start":[88,1]}},"argument":"mass","body":{"annotation":{"meta":null,"sourceSpan":{"end":[88,69],"start":[88,1]}},"argument":"param1","body":{"annotation":{"meta":null,"sourceSpan":{"end":[88,69],"start":[88,1]}},"argument":"param2","body":{"annotation":{"meta":null,"sourceSpan":{"end":[92,60],"start":[89,48]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[90,14],"start":[90,3]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CircleShape","moduleName":["Lattice","Services","Physics","RigidBody"]},"typeName":{"identifier":"ShapeType","moduleName":["Lattice","Services","Physics","RigidBody"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[90,40],"start":[90,19]}},"type":"Var","value":{"identifier":"momentOfInertiaCircle","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[90,45],"start":[90,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,45],"start":[90,41]}},"type":"Var","value":{"identifier":"mass","sourcePos":[89,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[90,52],"start":[90,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,52],"start":[90,46]}},"type":"Var","value":{"identifier":"param1","sourcePos":[89,1]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[91,11],"start":[91,3]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"BoxShape","moduleName":["Lattice","Services","Physics","RigidBody"]},"typeName":{"identifier":"ShapeType","moduleName":["Lattice","Services","Physics","RigidBody"]}}],"expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[91,37],"start":[91,19]}},"type":"Var","value":{"identifier":"momentOfInertiaBox","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[91,42],"start":[91,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,42],"start":[91,38]}},"type":"Var","value":{"identifier":"mass","sourcePos":[89,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[91,49],"start":[91,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,49],"start":[91,43]}},"type":"Var","value":{"identifier":"param1","sourcePos":[89,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[91,56],"start":[91,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,56],"start":[91,50]}},"type":"Var","value":{"identifier":"param2","sourcePos":[89,1]}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[92,15],"start":[92,3]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CapsuleShape","moduleName":["Lattice","Services","Physics","RigidBody"]},"typeName":{"identifier":"ShapeType","moduleName":["Lattice","Services","Physics","RigidBody"]}}],"expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[92,41],"start":[92,19]}},"type":"Var","value":{"identifier":"momentOfInertiaCapsule","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[92,46],"start":[92,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[92,46],"start":[92,42]}},"type":"Var","value":{"identifier":"mass","sourcePos":[89,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[92,53],"start":[92,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[92,53],"start":[92,47]}},"type":"Var","value":{"identifier":"param1","sourcePos":[89,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[92,60],"start":[92,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[92,60],"start":[92,54]}},"type":"Var","value":{"identifier":"param2","sourcePos":[89,1]}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[89,62],"start":[89,53]}},"type":"Var","value":{"identifier":"shapeType","sourcePos":[89,1]}}],"type":"Case"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"momentOfInertia"},{"annotation":{"meta":null,"sourceSpan":{"end":[101,68],"start":[101,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[101,68],"start":[101,1]}},"argument":"vel","body":{"annotation":{"meta":null,"sourceSpan":{"end":[101,68],"start":[101,1]}},"argument":"accel","body":{"annotation":{"meta":null,"sourceSpan":{"end":[101,68],"start":[101,1]}},"argument":"damping","body":{"annotation":{"meta":null,"sourceSpan":{"end":[101,68],"start":[101,1]}},"argument":"dt","body":{"annotation":{"meta":null,"sourceSpan":{"end":[104,35],"start":[103,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[103,32],"start":[103,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[103,32],"start":[103,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[103,19],"start":[103,16]}},"type":"Var","value":{"identifier":"vel","sourcePos":[102,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[103,32],"start":[103,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[103,32],"start":[103,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[103,27],"start":[103,22]}},"type":"Var","value":{"identifier":"accel","sourcePos":[102,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[103,32],"start":[103,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[103,32],"start":[103,30]}},"type":"Var","value":{"identifier":"dt","sourcePos":[102,1]}},"type":"App"},"type":"App"},"identifier":"newVel"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[104,35],"start":[104,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[104,12],"start":[104,6]}},"type":"Var","value":{"identifier":"newVel","sourcePos":[103,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[104,35],"start":[104,6]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"sub","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[104,34],"start":[104,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[104,19],"start":[104,16]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":1}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[104,34],"start":[104,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[104,34],"start":[104,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[104,29],"start":[104,22]}},"type":"Var","value":{"identifier":"damping","sourcePos":[102,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[104,34],"start":[104,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[104,34],"start":[104,32]}},"type":"Var","value":{"identifier":"dt","sourcePos":[102,1]}},"type":"App"},"type":"App"},"type":"App"},"type":"Let"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"integrateVelocity"},{"annotation":{"meta":null,"sourceSpan":{"end":[107,58],"start":[107,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[107,58],"start":[107,1]}},"argument":"pos","body":{"annotation":{"meta":null,"sourceSpan":{"end":[107,58],"start":[107,1]}},"argument":"vel","body":{"annotation":{"meta":null,"sourceSpan":{"end":[107,58],"start":[107,1]}},"argument":"dt","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[108,46],"start":[108,32]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[108,35],"start":[108,32]}},"type":"Var","value":{"identifier":"pos","sourcePos":[108,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[108,46],"start":[108,32]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[108,46],"start":[108,32]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[108,41],"start":[108,38]}},"type":"Var","value":{"identifier":"vel","sourcePos":[108,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[108,46],"start":[108,32]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[108,46],"start":[108,44]}},"type":"Var","value":{"identifier":"dt","sourcePos":[108,1]}},"type":"App"},"type":"App"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"integratePosition"},{"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,1]}},"argument":"state","body":{"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,1]}},"argument":"forceX","body":{"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,1]}},"argument":"forceY","body":{"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,1]}},"argument":"torque","body":{"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,1]}},"argument":"linearDamping","body":{"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,1]}},"argument":"angularDamping","body":{"annotation":{"meta":null,"sourceSpan":{"end":[111,100],"start":[111,1]}},"argument":"dt","body":{"annotation":{"meta":null,"sourceSpan":{"end":[131,13],"start":[113,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[115,47],"start":[115,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[115,47],"start":[115,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[115,24],"start":[115,18]}},"type":"Var","value":{"identifier":"torque","sourcePos":[112,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[115,47],"start":[115,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[115,47],"start":[115,27]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[115,32],"start":[115,27]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"fieldName":"inverseInertia","type":"Accessor"},"type":"App"},"identifier":"angAccel"},{"annotation":{"meta":null,"sourceSpan":{"end":[119,85],"start":[119,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[119,36],"start":[119,19]}},"type":"Var","value":{"identifier":"integrateVelocity","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[119,58],"start":[119,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[119,58],"start":[119,37]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[119,42],"start":[119,37]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"fieldName":"angularVelocity","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[119,67],"start":[119,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[119,67],"start":[119,59]}},"type":"Var","value":{"identifier":"angAccel","sourcePos":[115,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[119,82],"start":[119,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[119,82],"start":[119,68]}},"type":"Var","value":{"identifier":"angularDamping","sourcePos":[112,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[119,85],"start":[119,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[119,85],"start":[119,83]}},"type":"Var","value":{"identifier":"dt","sourcePos":[112,1]}},"type":"App"},"identifier":"newAngVel"},{"annotation":{"meta":null,"sourceSpan":{"end":[123,60],"start":[123,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[123,35],"start":[123,18]}},"type":"Var","value":{"identifier":"integratePosition","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[123,47],"start":[123,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[123,47],"start":[123,36]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[123,41],"start":[123,36]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"fieldName":"angle","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[123,57],"start":[123,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[123,57],"start":[123,48]}},"type":"Var","value":{"identifier":"newAngVel","sourcePos":[119,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[123,60],"start":[123,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[123,60],"start":[123,58]}},"type":"Var","value":{"identifier":"dt","sourcePos":[112,1]}},"type":"App"},"identifier":"newAngle"},{"annotation":{"meta":null,"sourceSpan":{"end":[114,42],"start":[114,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[114,42],"start":[114,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[114,22],"start":[114,16]}},"type":"Var","value":{"identifier":"forceY","sourcePos":[112,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[114,42],"start":[114,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[114,42],"start":[114,25]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[114,30],"start":[114,25]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"fieldName":"inverseMass","type":"Accessor"},"type":"App"},"identifier":"accelY"},{"annotation":{"meta":null,"sourceSpan":{"end":[118,69],"start":[118,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[118,34],"start":[118,17]}},"type":"Var","value":{"identifier":"integrateVelocity","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[118,45],"start":[118,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,45],"start":[118,35]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[118,40],"start":[118,35]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"fieldName":"velY","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[118,52],"start":[118,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,52],"start":[118,46]}},"type":"Var","value":{"identifier":"accelY","sourcePos":[114,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[118,66],"start":[118,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,66],"start":[118,53]}},"type":"Var","value":{"identifier":"linearDamping","sourcePos":[112,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[118,69],"start":[118,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,69],"start":[118,67]}},"type":"Var","value":{"identifier":"dt","sourcePos":[112,1]}},"type":"App"},"identifier":"newVelY"},{"annotation":{"meta":null,"sourceSpan":{"end":[122,56],"start":[122,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[122,34],"start":[122,17]}},"type":"Var","value":{"identifier":"integratePosition","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[122,45],"start":[122,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[122,45],"start":[122,35]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[122,40],"start":[122,35]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"fieldName":"posY","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[122,53],"start":[122,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[122,53],"start":[122,46]}},"type":"Var","value":{"identifier":"newVelY","sourcePos":[118,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[122,56],"start":[122,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[122,56],"start":[122,54]}},"type":"Var","value":{"identifier":"dt","sourcePos":[112,1]}},"type":"App"},"identifier":"newPosY"},{"annotation":{"meta":null,"sourceSpan":{"end":[113,42],"start":[113,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[113,42],"start":[113,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[113,22],"start":[113,16]}},"type":"Var","value":{"identifier":"forceX","sourcePos":[112,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[113,42],"start":[113,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[113,42],"start":[113,25]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[113,30],"start":[113,25]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"fieldName":"inverseMass","type":"Accessor"},"type":"App"},"identifier":"accelX"},{"annotation":{"meta":null,"sourceSpan":{"end":[117,69],"start":[117,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[117,34],"start":[117,17]}},"type":"Var","value":{"identifier":"integrateVelocity","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[117,45],"start":[117,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,45],"start":[117,35]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[117,40],"start":[117,35]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"fieldName":"velX","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[117,52],"start":[117,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,52],"start":[117,46]}},"type":"Var","value":{"identifier":"accelX","sourcePos":[113,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[117,66],"start":[117,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,66],"start":[117,53]}},"type":"Var","value":{"identifier":"linearDamping","sourcePos":[112,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[117,69],"start":[117,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,69],"start":[117,67]}},"type":"Var","value":{"identifier":"dt","sourcePos":[112,1]}},"type":"App"},"identifier":"newVelX"},{"annotation":{"meta":null,"sourceSpan":{"end":[121,56],"start":[121,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[121,34],"start":[121,17]}},"type":"Var","value":{"identifier":"integratePosition","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[121,45],"start":[121,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[121,45],"start":[121,35]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[121,40],"start":[121,35]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"fieldName":"posX","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[121,53],"start":[121,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[121,53],"start":[121,46]}},"type":"Var","value":{"identifier":"newVelX","sourcePos":[117,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[121,56],"start":[121,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[121,56],"start":[121,54]}},"type":"Var","value":{"identifier":"dt","sourcePos":[112,1]}},"type":"App"},"identifier":"newPosX"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[131,13],"start":[125,6]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[131,13],"start":[112,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[125,11],"start":[125,6]}},"type":"Var","value":{"identifier":"state","sourcePos":[112,1]}},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[131,13],"start":[125,6]}},"copy":["inverseMass","inverseInertia"],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"v","sourcePos":[112,1]}},"type":"ObjectUpdate","updates":[["posX",{"annotation":{"meta":null,"sourceSpan":{"end":[125,28],"start":[125,21]}},"type":"Var","value":{"identifier":"newPosX","sourcePos":[121,7]}}],["posY",{"annotation":{"meta":null,"sourceSpan":{"end":[126,28],"start":[126,21]}},"type":"Var","value":{"identifier":"newPosY","sourcePos":[122,7]}}],["velX",{"annotation":{"meta":null,"sourceSpan":{"end":[127,28],"start":[127,21]}},"type":"Var","value":{"identifier":"newVelX","sourcePos":[117,7]}}],["velY",{"annotation":{"meta":null,"sourceSpan":{"end":[128,28],"start":[128,21]}},"type":"Var","value":{"identifier":"newVelY","sourcePos":[118,7]}}],["angle",{"annotation":{"meta":null,"sourceSpan":{"end":[129,30],"start":[129,22]}},"type":"Var","value":{"identifier":"newAngle","sourcePos":[123,7]}}],["angularVelocity",{"annotation":{"meta":null,"sourceSpan":{"end":[130,41],"start":[130,32]}},"type":"Var","value":{"identifier":"newAngVel","sourcePos":[119,7]}}]]},"type":"Let"},"type":"Let"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"integrateBody"},{"annotation":{"meta":null,"sourceSpan":{"end":[43,44],"start":[43,1]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsNewtype"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"Eq$Dict","moduleName":["Data","Eq"]}},"annotation":{"meta":null,"sourceSpan":{"end":[43,44],"start":[43,1]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"ObjectLiteral","value":[["eq",{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"x","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"argument":"y","body":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CircleShape","moduleName":["Lattice","Services","Physics","RigidBody"]},"typeName":{"identifier":"ShapeType","moduleName":["Lattice","Services","Physics","RigidBody"]}},{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CircleShape","moduleName":["Lattice","Services","Physics","RigidBody"]},"typeName":{"identifier":"ShapeType","moduleName":["Lattice","Services","Physics","RigidBody"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"BoxShape","moduleName":["Lattice","Services","Physics","RigidBody"]},"typeName":{"identifier":"ShapeType","moduleName":["Lattice","Services","Physics","RigidBody"]}},{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"BoxShape","moduleName":["Lattice","Services","Physics","RigidBody"]},"typeName":{"identifier":"ShapeType","moduleName":["Lattice","Services","Physics","RigidBody"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CapsuleShape","moduleName":["Lattice","Services","Physics","RigidBody"]},"typeName":{"identifier":"ShapeType","moduleName":["Lattice","Services","Physics","RigidBody"]}},{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"CapsuleShape","moduleName":["Lattice","Services","Physics","RigidBody"]},"typeName":{"identifier":"ShapeType","moduleName":["Lattice","Services","Physics","RigidBody"]}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"NullBinder"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"x","sourcePos":[0,0]}},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"y","sourcePos":[0,0]}}],"type":"Case"},"type":"Abs"},"type":"Abs"}]]}},"type":"App"},"identifier":"eqShapeType"},{"annotation":{"meta":null,"sourceSpan":{"end":[140,76],"start":[140,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[140,76],"start":[140,1]}},"argument":"normalVelocity","body":{"annotation":{"meta":null,"sourceSpan":{"end":[140,76],"start":[140,1]}},"argument":"restitution","body":{"annotation":{"meta":null,"sourceSpan":{"end":[140,76],"start":[140,1]}},"argument":"invMassSum","body":{"annotation":{"meta":null,"sourceSpan":{"end":[140,76],"start":[140,1]}},"argument":"angularTerm","body":{"annotation":{"meta":null,"sourceSpan":{"end":[145,62],"start":[142,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[142,45],"start":[142,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[142,45],"start":[142,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[142,31],"start":[142,21]}},"type":"Var","value":{"identifier":"invMassSum","sourcePos":[141,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[142,45],"start":[142,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[142,45],"start":[142,34]}},"type":"Var","value":{"identifier":"angularTerm","sourcePos":[141,1]}},"type":"App"},"identifier":"denominator"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[145,62],"start":[143,6]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[145,62],"start":[143,6]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[144,14],"start":[144,11]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":0}},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[145,62],"start":[143,6]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[145,62],"start":[145,11]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[145,62],"start":[145,11]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"negate","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[145,31],"start":[145,11]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[145,30],"start":[145,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,16],"start":[145,13]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":1}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[145,30],"start":[145,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,30],"start":[145,19]}},"type":"Var","value":{"identifier":"restitution","sourcePos":[141,1]}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[145,62],"start":[145,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,48],"start":[145,34]}},"type":"Var","value":{"identifier":"normalVelocity","sourcePos":[141,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[145,62],"start":[145,11]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,62],"start":[145,51]}},"type":"Var","value":{"identifier":"denominator","sourcePos":[142,7]}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lessThan","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[143,29],"start":[143,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[143,20],"start":[143,9]}},"type":"Var","value":{"identifier":"denominator","sourcePos":[142,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[143,29],"start":[143,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[143,29],"start":[143,23]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":1.0e-4}},"type":"App"}],"type":"Case"},"type":"Let"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"calculateImpulseMagnitude"},{"annotation":{"meta":null,"sourceSpan":{"end":[158,75],"start":[158,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[158,75],"start":[158,1]}},"argument":"tangentVelocity","body":{"annotation":{"meta":null,"sourceSpan":{"end":[158,75],"start":[158,1]}},"argument":"invMassSum","body":{"annotation":{"meta":null,"sourceSpan":{"end":[158,75],"start":[158,1]}},"argument":"normalImpulse","body":{"annotation":{"meta":null,"sourceSpan":{"end":[158,75],"start":[158,1]}},"argument":"friction","body":{"annotation":{"meta":null,"sourceSpan":{"end":[164,50],"start":[160,3]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[164,50],"start":[160,3]}},"binderType":"LiteralBinder","literal":{"literalType":"BooleanLiteral","value":true}}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[161,11],"start":[161,8]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":0}},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[164,50],"start":[160,3]}},"binderType":"NullBinder"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[164,50],"start":[162,8]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[163,50],"start":[163,12]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[163,50],"start":[163,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[163,39],"start":[163,26]}},"type":"Var","value":{"identifier":"normalImpulse","sourcePos":[159,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[163,50],"start":[163,26]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[163,50],"start":[163,42]}},"type":"Var","value":{"identifier":"friction","sourcePos":[159,1]}},"type":"App"},"identifier":"maxFriction"},{"annotation":{"meta":null,"sourceSpan":{"end":[162,46],"start":[162,12]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"div","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[162,46],"start":[162,17]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"negate","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[162,33],"start":[162,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[162,33],"start":[162,18]}},"type":"Var","value":{"identifier":"tangentVelocity","sourcePos":[159,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[162,46],"start":[162,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[162,46],"start":[162,36]}},"type":"Var","value":{"identifier":"invMassSum","sourcePos":[159,1]}},"type":"App"},"identifier":"jt"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[164,14],"start":[164,11]}},"type":"Var","value":{"identifier":"max","moduleName":["Math"]}},"annotation":{"meta":null,"sourceSpan":{"end":[164,29],"start":[164,11]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"negate","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[164,28],"start":[164,16]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,28],"start":[164,17]}},"type":"Var","value":{"identifier":"maxFriction","sourcePos":[163,12]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[164,50],"start":[164,11]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[164,34],"start":[164,31]}},"type":"Var","value":{"identifier":"min","moduleName":["Math"]}},"annotation":{"meta":null,"sourceSpan":{"end":[164,46],"start":[164,31]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,46],"start":[164,35]}},"type":"Var","value":{"identifier":"maxFriction","sourcePos":[163,12]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[164,49],"start":[164,31]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,49],"start":[164,47]}},"type":"Var","value":{"identifier":"jt","sourcePos":[162,12]}},"type":"App"},"type":"App"},"type":"Let"},"isGuarded":false}],"caseExpressions":[{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lessThan","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[160,25],"start":[160,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[160,16],"start":[160,6]}},"type":"Var","value":{"identifier":"invMassSum","sourcePos":[159,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[160,25],"start":[160,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[160,25],"start":[160,19]}},"type":"Literal","value":{"literalType":"NumberLiteral","value":1.0e-4}},"type":"App"}],"type":"Case"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"calculateFrictionImpulse"},{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"velX","body":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"velY","body":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"angVel","body":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"impulseX","body":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"impulseY","body":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"rx","body":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"ry","body":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"inverseMass","body":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"inverseInertia","body":{"annotation":{"meta":null,"sourceSpan":{"end":[180,51],"start":[179,1]}},"argument":"sign","body":{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[182,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[184,46],"start":[184,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"sub","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[184,46],"start":[184,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[184,46],"start":[184,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,19],"start":[184,17]}},"type":"Var","value":{"identifier":"rx","sourcePos":[181,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[184,46],"start":[184,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,30],"start":[184,22]}},"type":"Var","value":{"identifier":"impulseY","sourcePos":[181,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[184,46],"start":[184,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[184,46],"start":[184,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,35],"start":[184,33]}},"type":"Var","value":{"identifier":"ry","sourcePos":[181,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[184,46],"start":[184,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,46],"start":[184,38]}},"type":"Var","value":{"identifier":"impulseX","sourcePos":[181,1]}},"type":"App"},"type":"App"},"identifier":"rCrossI"},{"annotation":{"meta":null,"sourceSpan":{"end":[183,53],"start":[183,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[183,53],"start":[183,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,21],"start":[183,17]}},"type":"Var","value":{"identifier":"velY","sourcePos":[181,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[183,53],"start":[183,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[183,53],"start":[183,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[183,53],"start":[183,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,28],"start":[183,24]}},"type":"Var","value":{"identifier":"sign","sourcePos":[181,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[183,53],"start":[183,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,39],"start":[183,31]}},"type":"Var","value":{"identifier":"impulseY","sourcePos":[181,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[183,53],"start":[183,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,53],"start":[183,42]}},"type":"Var","value":{"identifier":"inverseMass","sourcePos":[181,1]}},"type":"App"},"type":"App"},"identifier":"newVelY"},{"annotation":{"meta":null,"sourceSpan":{"end":[182,53],"start":[182,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[182,53],"start":[182,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,21],"start":[182,17]}},"type":"Var","value":{"identifier":"velX","sourcePos":[181,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[182,53],"start":[182,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[182,53],"start":[182,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[182,53],"start":[182,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,28],"start":[182,24]}},"type":"Var","value":{"identifier":"sign","sourcePos":[181,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[182,53],"start":[182,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,39],"start":[182,31]}},"type":"Var","value":{"identifier":"impulseX","sourcePos":[181,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[182,53],"start":[182,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[182,53],"start":[182,42]}},"type":"Var","value":{"identifier":"inverseMass","sourcePos":[181,1]}},"type":"App"},"type":"App"},"identifier":"newVelX"},{"annotation":{"meta":null,"sourceSpan":{"end":[185,59],"start":[185,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"add","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,59],"start":[185,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,25],"start":[185,19]}},"type":"Var","value":{"identifier":"angVel","sourcePos":[181,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,59],"start":[185,19]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,59],"start":[185,19]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,59],"start":[185,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,32],"start":[185,28]}},"type":"Var","value":{"identifier":"sign","sourcePos":[181,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,59],"start":[185,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,42],"start":[185,35]}},"type":"Var","value":{"identifier":"rCrossI","sourcePos":[184,7]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,59],"start":[185,19]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,59],"start":[185,45]}},"type":"Var","value":{"identifier":"inverseInertia","sourcePos":[181,1]}},"type":"App"},"type":"App"},"identifier":"newAngVel"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":["value0","value1"],"metaType":"IsConstructor"},"sourceSpan":{"end":[186,11],"start":[186,6]}},"type":"Var","value":{"identifier":"Tuple","moduleName":["Data","Tuple"]}},"annotation":{"meta":null,"sourceSpan":{"end":[186,35],"start":[186,6]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"constructorType":"ProductType","identifiers":["value0","value1"],"metaType":"IsConstructor"},"sourceSpan":{"end":[186,18],"start":[186,13]}},"type":"Var","value":{"identifier":"Tuple","moduleName":["Data","Tuple"]}},"annotation":{"meta":null,"sourceSpan":{"end":[186,26],"start":[186,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,26],"start":[186,19]}},"type":"Var","value":{"identifier":"newVelX","sourcePos":[182,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[186,34],"start":[186,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,34],"start":[186,27]}},"type":"Var","value":{"identifier":"newVelY","sourcePos":[183,7]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[186,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[186,36]}},"type":"Var","value":{"identifier":"newAngVel","sourcePos":[185,7]}},"type":"App"},"type":"Let"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"applyImpulse"},{"annotation":{"meta":null,"sourceSpan":{"end":[150,79],"start":[150,1]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[150,79],"start":[150,1]}},"argument":"rx","body":{"annotation":{"meta":null,"sourceSpan":{"end":[150,79],"start":[150,1]}},"argument":"ry","body":{"annotation":{"meta":null,"sourceSpan":{"end":[150,79],"start":[150,1]}},"argument":"nx","body":{"annotation":{"meta":null,"sourceSpan":{"end":[150,79],"start":[150,1]}},"argument":"ny","body":{"annotation":{"meta":null,"sourceSpan":{"end":[150,79],"start":[150,1]}},"argument":"inverseInertia","body":{"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[152,3]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[152,34],"start":[152,7]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"sub","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[152,34],"start":[152,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[152,34],"start":[152,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[152,19],"start":[152,17]}},"type":"Var","value":{"identifier":"rx","sourcePos":[151,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[152,34],"start":[152,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[152,24],"start":[152,22]}},"type":"Var","value":{"identifier":"ny","sourcePos":[151,1]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[152,34],"start":[152,17]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[152,34],"start":[152,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[152,29],"start":[152,27]}},"type":"Var","value":{"identifier":"ry","sourcePos":[151,1]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[152,34],"start":[152,17]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[152,34],"start":[152,32]}},"type":"Var","value":{"identifier":"nx","sourcePos":[151,1]}},"type":"App"},"type":"App"},"identifier":"rCrossN"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,6]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"mul","moduleName":["Lattice","Services","Physics","RigidBody"]}},"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,13],"start":[153,6]}},"type":"Var","value":{"identifier":"rCrossN","sourcePos":[152,7]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,23],"start":[153,16]}},"type":"Var","value":{"identifier":"rCrossN","sourcePos":[152,7]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,6]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,26]}},"type":"Var","value":{"identifier":"inverseInertia","sourcePos":[151,1]}},"type":"App"},"type":"Let"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"type":"Abs"},"identifier":"angularImpulseTerm"}],"exports":["CircleShape","BoxShape","CapsuleShape","momentOfInertiaCircle","momentOfInertiaBox","momentOfInertiaCapsule","momentOfInertia","integrateVelocity","integratePosition","integrateBody","calculateImpulseMagnitude","angularImpulseTerm","calculateFrictionImpulse","positionCorrection","applyImpulse","eqShapeType"],"foreign":[],"imports":[{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[14,1]}},"moduleName":["Data","Eq"]},{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[14,1]}},"moduleName":["Data","EuclideanRing"]},{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[14,1]}},"moduleName":["Data","Ord"]},{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[14,1]}},"moduleName":["Data","Ring"]},{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[14,1]}},"moduleName":["Data","Semiring"]},{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[14,1]}},"moduleName":["Data","Tuple"]},{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[14,1]}},"moduleName":["Lattice","Services","Physics","RigidBody"]},{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[14,1]}},"moduleName":["Math"]},{"annotation":{"meta":null,"sourceSpan":{"end":[31,15],"start":[31,1]}},"moduleName":["Prelude"]},{"annotation":{"meta":null,"sourceSpan":{"end":[186,45],"start":[14,1]}},"moduleName":["Prim"]}],"moduleName":["Lattice","Services","Physics","RigidBody"],"modulePath":"src/Lattice/Services/Physics/RigidBody.purs","reExports":{},"sourceSpan":{"end":[186,45],"start":[14,1]}}