// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_EuclideanRing from "../Data.EuclideanRing/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordNumber);
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordNumber);
var mod = /* #__PURE__ */ Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt);
var Ordered = /* #__PURE__ */ (function () {
    function Ordered() {

    };
    Ordered.value = new Ordered();
    return Ordered;
})();
var FloydSteinberg = /* #__PURE__ */ (function () {
    function FloydSteinberg() {

    };
    FloydSteinberg.value = new FloydSteinberg();
    return FloydSteinberg;
})();
var Atkinson = /* #__PURE__ */ (function () {
    function Atkinson() {

    };
    Atkinson.value = new Atkinson();
    return Atkinson;
})();
var showDitherMethod = {
    show: function (v) {
        if (v instanceof Ordered) {
            return "Ordered";
        };
        if (v instanceof FloydSteinberg) {
            return "FloydSteinberg";
        };
        if (v instanceof Atkinson) {
            return "Atkinson";
        };
        throw new Error("Failed pattern match at Lattice.Services.Stylize.Dither (line 48, column 1 - line 51, column 29): " + [ v.constructor.name ]);
    }
};
var quantize = function (val) {
    return function (levels) {
        var step = 255.0 / Data_Int.toNumber(levels - 1 | 0);
        return Data_Int.toNumber(Data_Int.round(val / step)) * step;
    };
};
var floydSteinbergCoeffs = /* #__PURE__ */ (function () {
    return {
        right: 7.0 / 16.0,
        bottomLeft: 3.0 / 16.0,
        bottom: 5.0 / 16.0,
        bottomRight: 1.0 / 16.0
    };
})();
var eqDitherMethod = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Ordered && y instanceof Ordered) {
                return true;
            };
            if (x instanceof FloydSteinberg && y instanceof FloydSteinberg) {
                return true;
            };
            if (x instanceof Atkinson && y instanceof Atkinson) {
                return true;
            };
            return false;
        };
    }
};
var distributeErrorFS = function (err) {
    return {
        right: err * floydSteinbergCoeffs.right,
        bottomLeft: err * floydSteinbergCoeffs.bottomLeft,
        bottom: err * floydSteinbergCoeffs.bottom,
        bottomRight: err * floydSteinbergCoeffs.bottomRight
    };
};
var clamp255 = function (val) {
    return max(0.0)(min(255.0)(val));
};
var bayer8Matrix = [ [ 0, 32, 8, 40, 2, 34, 10, 42 ], [ 48, 16, 56, 24, 50, 18, 58, 26 ], [ 12, 44, 4, 36, 14, 46, 6, 38 ], [ 60, 28, 52, 20, 62, 30, 54, 22 ], [ 3, 35, 11, 43, 1, 33, 9, 41 ], [ 51, 19, 59, 27, 49, 17, 57, 25 ], [ 15, 47, 7, 39, 13, 45, 5, 37 ], [ 63, 31, 55, 23, 61, 29, 53, 21 ] ];
var bayer8 = function (x) {
    return function (y) {
        var row = mod(y)(8);
        var rowArr = Data_Maybe.fromMaybe([  ])(Data_Array.index(bayer8Matrix)(row));
        var col = mod(x)(8);
        return Data_Maybe.fromMaybe(0)(Data_Array.index(rowArr)(col));
    };
};
var bayer4Matrix = [ [ 0, 8, 2, 10 ], [ 12, 4, 14, 6 ], [ 3, 11, 1, 9 ], [ 15, 7, 13, 5 ] ];
var bayer4 = function (x) {
    return function (y) {
        var row = mod(y)(4);
        var rowArr = Data_Maybe.fromMaybe([  ])(Data_Array.index(bayer4Matrix)(row));
        var col = mod(x)(4);
        return Data_Maybe.fromMaybe(0)(Data_Array.index(rowArr)(col));
    };
};
var bayer2 = function (x) {
    return function (y) {
        var row = mod(y)(2);
        var col = mod(x)(2);
        var $16 = row === 0;
        if ($16) {
            var $17 = col === 0;
            if ($17) {
                return 0;
            };
            return 2;
        };
        var $18 = col === 0;
        if ($18) {
            return 3;
        };
        return 1;
    };
};
var bayerValue = function (matrixSize) {
    return function (x) {
        return function (y) {
            if (matrixSize === 2) {
                return bayer2(x)(y);
            };
            if (matrixSize === 8) {
                return bayer8(x)(y);
            };
            if (Data_Boolean.otherwise) {
                return bayer4(x)(y);
            };
            throw new Error("Failed pattern match at Lattice.Services.Stylize.Dither (line 105, column 1 - line 105, column 39): " + [ matrixSize.constructor.name, x.constructor.name, y.constructor.name ]);
        };
    };
};
var orderedThreshold = function (x) {
    return function (y) {
        return function (matrixSize) {
            return function (levels) {
                var matrixVal = Data_Int.toNumber(bayerValue(matrixSize)(x)(y));
                var matrixMax = Data_Int.toNumber(matrixSize * matrixSize | 0);
                return (matrixVal / matrixMax - 0.5) * (256.0 / Data_Int.toNumber(levels));
            };
        };
    };
};
var atkinsonOffsets = /* #__PURE__ */ (function () {
    return [ new Data_Tuple.Tuple(1, 0), new Data_Tuple.Tuple(2, 0), new Data_Tuple.Tuple(-1 | 0, 1), new Data_Tuple.Tuple(0, 1), new Data_Tuple.Tuple(1, 1), new Data_Tuple.Tuple(0, 2) ];
})();
var atkinsonErrorPerNeighbor = function (err) {
    return err / 8.0;
};
export {
    Ordered,
    FloydSteinberg,
    Atkinson,
    bayer2,
    bayer4,
    bayer8,
    bayerValue,
    orderedThreshold,
    quantize,
    clamp255,
    floydSteinbergCoeffs,
    distributeErrorFS,
    atkinsonErrorPerNeighbor,
    atkinsonOffsets,
    eqDitherMethod,
    showDitherMethod
};
//# sourceMappingURL=index.js.map
