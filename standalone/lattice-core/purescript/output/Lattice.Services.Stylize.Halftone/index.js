// Generated by purs version 0.15.15
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as $$Math from "../Math/index.js";
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordNumber);
var Grayscale = /* #__PURE__ */ (function () {
    function Grayscale() {

    };
    Grayscale.value = new Grayscale();
    return Grayscale;
})();
var RGB = /* #__PURE__ */ (function () {
    function RGB() {

    };
    RGB.value = new RGB();
    return RGB;
})();
var CMYK_Mode = /* #__PURE__ */ (function () {
    function CMYK_Mode() {

    };
    CMYK_Mode.value = new CMYK_Mode();
    return CMYK_Mode;
})();
var showColorMode = {
    show: function (v) {
        if (v instanceof Grayscale) {
            return "Grayscale";
        };
        if (v instanceof RGB) {
            return "RGB";
        };
        if (v instanceof CMYK_Mode) {
            return "CMYK";
        };
        throw new Error("Failed pattern match at Lattice.Services.Stylize.Halftone (line 50, column 1 - line 53, column 26): " + [ v.constructor.name ]);
    }
};
var rotatePoint = function (x) {
    return function (y) {
        return function (centerX) {
            return function (centerY) {
                return function (angle) {
                    var sinA = $$Math.sin(angle);
                    var dy = y - centerY;
                    var dx = x - centerX;
                    var cosA = $$Math.cos(angle);
                    return new Data_Tuple.Tuple((cosA * dx - sinA * dy) + centerX, sinA * dx + cosA * dy + centerY);
                };
            };
        };
    };
};
var rgbToCMYK = function (r) {
    return function (g) {
        return function (b) {
            var k = 1.0 - max(r)(max(g)(b));
            var $10 = k >= 1.0;
            if ($10) {
                return {
                    c: 0.0,
                    m: 0.0,
                    y: 0.0,
                    k: 1.0
                };
            };
            var invK = 1.0 - k;
            return {
                c: (1.0 - r - k) / invK,
                m: (1.0 - g - k) / invK,
                y: (1.0 - b - k) / invK,
                k: k
            };
        };
    };
};
var eqColorMode = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Grayscale && y instanceof Grayscale) {
                return true;
            };
            if (x instanceof RGB && y instanceof RGB) {
                return true;
            };
            if (x instanceof CMYK_Mode && y instanceof CMYK_Mode) {
                return true;
            };
            return false;
        };
    }
};
var dotRadius = function (value) {
    return function (dotSize) {
        return function (invert) {
            var normalized = (function () {
                if (invert) {
                    return 1.0 - value;
                };
                return value;
            })();
            return (normalized * dotSize) / 2.0;
        };
    };
};
var degreesToRadians = function (degrees) {
    return (degrees * $$Math.pi) / 180.0;
};
var cmykAngle = function (channel) {
    if (channel === 0) {
        return 15.0;
    };
    if (channel === 1) {
        return 75.0;
    };
    if (channel === 2) {
        return 0.0;
    };
    if (channel === 3) {
        return 45.0;
    };
    return 0.0;
};
var cmykDotOffset = function (channel) {
    return function (dotSize) {
        var offset = dotSize * 0.1;
        var angle = degreesToRadians(cmykAngle(channel));
        return new Data_Tuple.Tuple($$Math.cos(angle) * offset, $$Math.sin(angle) * offset);
    };
};
var brightness = function (r) {
    return function (g) {
        return function (b) {
            return (r + g + b) / 3.0;
        };
    };
};
var grayscaleDotRadius = function (r) {
    return function (g) {
        return function (b) {
            return function (dotSize) {
                var bright = brightness(r)(g)(b);
                return dotRadius(bright)(dotSize)(true);
            };
        };
    };
};
export {
    Grayscale,
    RGB,
    CMYK_Mode,
    rgbToCMYK,
    dotRadius,
    brightness,
    grayscaleDotRadius,
    cmykAngle,
    degreesToRadians,
    cmykDotOffset,
    rotatePoint,
    eqColorMode,
    showColorMode
};
//# sourceMappingURL=index.js.map
