{"builtWith":"0.15.15","comments":[{"LineComment":" | Port of ui/src/__tests__/security/urlValidator.test.ts"},{"LineComment":" |"},{"LineComment":" | Tests security validation for URLs to prevent XSS, code execution,"},{"LineComment":" | and other URL-based attacks."},{"LineComment":" |"},{"LineComment":" | 30 tests across 8 describe blocks:"},{"LineComment":" |   - validateURL - Blocked Protocols (7 tests)"},{"LineComment":" |   - validateURL - Data URLs (10 tests)"},{"LineComment":" |   - validateURL - Safe Protocols (6 tests)"},{"LineComment":" |   - validateURL - Edge Cases (5 tests)"},{"LineComment":" |   - sanitizeURLForHTML (2 tests)"},{"LineComment":" |   - validateURLs - Batch Validation (1 test)"},{"LineComment":" |   - isTrustedDomain (4 tests)"},{"LineComment":" |   - extractAndValidateURLs (2 tests)"}],"decls":[{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[40,11],"start":[40,3]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Spec"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[40,38],"start":[40,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadIdentity","moduleName":["Data","Identity"]}},"type":"App"},"identifier":"describe"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[82,51],"start":[45,5]}},"type":"Var","value":{"identifier":"discard","moduleName":["Control","Bind"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[82,51],"start":[45,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discardUnit","moduleName":["Control","Bind"]}},"type":"App"},"identifier":"discard"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[82,51],"start":[45,5]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"bindSpecT","moduleName":["Test","Spec"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[82,51],"start":[45,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"bindIdentity","moduleName":["Data","Identity"]}},"type":"App"},"type":"App"},"identifier":"discard1"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[46,9],"start":[46,7]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Spec"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[46,41],"start":[46,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadIdentity","moduleName":["Data","Identity"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[46,41],"start":[46,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"exampleMUnit","moduleName":["Test","Spec"]}},"type":"App"},"identifier":"it"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[48,41],"start":[48,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"bindAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"discard2"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[48,34],"start":[48,23]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Spec","Assertions"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[48,41],"start":[48,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadThrowAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"shouldEqual"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[48,41],"start":[48,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showBoolean","moduleName":["Data","Show"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[48,41],"start":[48,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqBoolean","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"shouldEqual1"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[49,51],"start":[49,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showURLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[49,51],"start":[49,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqURLRiskLevel","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"shouldEqual2"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[51,54],"start":[51,28]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Spec","Assertions","String"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[51,69],"start":[51,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadThrowAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"shouldContain"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[52,26],"start":[52,22]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Spec","Assertions"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[52,76],"start":[52,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadThrowAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"fail"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[149,47],"start":[149,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showString","moduleName":["Data","Show"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[149,47],"start":[149,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqString","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"shouldEqual3"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[196,23],"start":[196,21]}},"type":"Var","value":{"identifier":"append","moduleName":["Data","Semigroup"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"semigroupString","moduleName":["Data","Semigroup"]}},"type":"App"},"identifier":"append"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[229,53],"start":[229,24]}},"type":"Var","value":{"identifier":"shouldNotContain","moduleName":["Test","Spec","Assertions","String"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[229,58],"start":[229,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"monadThrowAff","moduleName":["Effect","Aff"]}},"type":"App"},"identifier":"shouldNotContain"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[248,24],"start":[248,14]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Data","Map","Internal"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[248,53],"start":[248,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"ordString","moduleName":["Data","Ord"]}},"type":"App"},"identifier":"lookup"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[292,45],"start":[292,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showInt","moduleName":["Data","Show"]}},"type":"App"},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[292,45],"start":[292,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"eqInt","moduleName":["Data","Eq"]}},"type":"App"},"identifier":"shouldEqual4"},{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[298,56],"start":[298,52]}},"type":"Var","value":{"identifier":"show","moduleName":["Data","Show"]}},"annotation":{"meta":{"metaType":"IsSyntheticApp"},"sourceSpan":{"end":[298,79],"start":[298,52]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"showInt","moduleName":["Data","Show"]}},"type":"App"},"identifier":"show"},{"annotation":{"meta":null,"sourceSpan":{"end":[38,18],"start":[38,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[40,38],"start":[40,3]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[40,38],"start":[40,12]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"URL Validator - Security"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[40,3]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[82,51],"start":[45,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[45,47],"start":[45,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[45,47],"start":[45,14]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"validateURL - Blocked Protocols"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[82,51],"start":[45,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[52,76],"start":[46,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[46,41],"start":[46,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[46,41],"start":[46,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK javascript: URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[52,76],"start":[46,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[47,64],"start":[47,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[47,64],"start":[47,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[47,33],"start":[47,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[47,55],"start":[47,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[47,55],"start":[47,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"javascript:alert(1)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[47,64],"start":[47,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[47,64],"start":[47,56]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[48,41],"start":[48,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[48,41],"start":[48,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[48,21],"start":[48,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[48,15],"start":[48,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[47,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[48,41],"start":[48,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[48,41],"start":[48,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[48,41],"start":[48,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[48,41],"start":[48,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[49,51],"start":[49,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[49,51],"start":[49,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[49,25],"start":[49,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[49,15],"start":[49,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[47,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[49,51],"start":[49,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[49,51],"start":[49,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[49,51],"start":[49,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[49,51],"start":[49,9]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[52,76],"start":[50,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[51,19],"start":[51,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[51,19],"start":[51,16]}},"binderType":"VarBinder","identifier":"err"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[51,69],"start":[51,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[51,26],"start":[51,23]}},"type":"Var","value":{"identifier":"err","sourcePos":[51,16]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[51,69],"start":[51,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[51,69],"start":[51,56]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"javascript:"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[52,18],"start":[52,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[52,76],"start":[52,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[52,76],"start":[52,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error message containing 'javascript:'"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[50,26],"start":[50,14]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[50,20],"start":[50,14]}},"type":"Var","value":{"identifier":"result","sourcePos":[47,13]}},"fieldName":"error","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[52,76],"start":[46,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[52,76],"start":[46,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[57,51],"start":[54,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[54,39],"start":[54,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[54,39],"start":[54,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK vbscript: URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[57,51],"start":[54,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[55,70],"start":[55,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[55,70],"start":[55,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[55,33],"start":[55,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[55,61],"start":[55,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[55,61],"start":[55,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"vbscript:msgbox(\"test\")"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[55,70],"start":[55,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[55,70],"start":[55,62]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[56,41],"start":[56,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[56,41],"start":[56,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,21],"start":[56,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[56,15],"start":[56,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[55,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[56,41],"start":[56,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,41],"start":[56,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[56,41],"start":[56,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[56,41],"start":[56,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[57,51],"start":[57,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[57,25],"start":[57,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[57,15],"start":[57,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[55,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[57,51],"start":[57,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[57,51],"start":[57,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[57,51],"start":[54,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[57,51],"start":[54,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[62,51],"start":[59,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[59,35],"start":[59,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[59,35],"start":[59,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK file: URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[62,51],"start":[59,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[60,63],"start":[60,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[60,63],"start":[60,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[60,33],"start":[60,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[60,54],"start":[60,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[60,54],"start":[60,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"file:///etc/passwd"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[60,63],"start":[60,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[60,63],"start":[60,55]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[61,41],"start":[61,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[61,41],"start":[61,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[61,21],"start":[61,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[61,15],"start":[61,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[60,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[61,41],"start":[61,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[61,41],"start":[61,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[61,41],"start":[61,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[61,41],"start":[61,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[62,51],"start":[62,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[62,25],"start":[62,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[62,15],"start":[62,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[60,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[62,51],"start":[62,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[62,51],"start":[62,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[62,51],"start":[59,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[62,51],"start":[59,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[67,51],"start":[64,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[64,34],"start":[64,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[64,34],"start":[64,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK ftp: URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[67,51],"start":[64,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[65,75],"start":[65,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[65,75],"start":[65,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[65,33],"start":[65,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[65,66],"start":[65,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[65,66],"start":[65,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"ftp://ftp.example.com/file.txt"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[65,75],"start":[65,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[65,75],"start":[65,67]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[66,41],"start":[66,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[66,41],"start":[66,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,21],"start":[66,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[66,15],"start":[66,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[65,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[66,41],"start":[66,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,41],"start":[66,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[66,41],"start":[66,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[66,41],"start":[66,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[67,51],"start":[67,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[67,25],"start":[67,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[67,15],"start":[67,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[65,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[67,51],"start":[67,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[67,51],"start":[67,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[67,51],"start":[64,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[67,51],"start":[64,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[72,51],"start":[69,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[69,37],"start":[69,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[69,37],"start":[69,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK chrome: URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[72,51],"start":[69,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[70,62],"start":[70,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[70,62],"start":[70,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[70,33],"start":[70,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[70,53],"start":[70,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[70,53],"start":[70,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"chrome://settings"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[70,62],"start":[70,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[70,62],"start":[70,54]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[71,41],"start":[71,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[71,41],"start":[71,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[71,21],"start":[71,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[71,15],"start":[71,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[70,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[71,41],"start":[71,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[71,41],"start":[71,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[71,41],"start":[71,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[71,41],"start":[71,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[72,51],"start":[72,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[72,25],"start":[72,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[72,15],"start":[72,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[70,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[72,51],"start":[72,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[72,51],"start":[72,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[72,51],"start":[69,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[72,51],"start":[69,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[77,51],"start":[74,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[74,36],"start":[74,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[74,36],"start":[74,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK about: URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[77,51],"start":[74,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[75,56],"start":[75,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[75,56],"start":[75,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[75,33],"start":[75,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[75,47],"start":[75,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[75,47],"start":[75,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"about:blank"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[75,56],"start":[75,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[75,56],"start":[75,48]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[76,41],"start":[76,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[76,41],"start":[76,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[76,21],"start":[76,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[76,15],"start":[76,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[75,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[76,41],"start":[76,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[76,41],"start":[76,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[76,41],"start":[76,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[76,41],"start":[76,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[77,51],"start":[77,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[77,25],"start":[77,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[77,15],"start":[77,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[75,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[77,51],"start":[77,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[77,51],"start":[77,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[77,51],"start":[74,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[77,51],"start":[74,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[79,54],"start":[79,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[79,54],"start":[79,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK ws: WebSocket URLs for assets"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[82,51],"start":[79,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[80,68],"start":[80,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[80,68],"start":[80,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[80,33],"start":[80,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[80,59],"start":[80,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[80,59],"start":[80,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"ws://example.com/socket"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[80,68],"start":[80,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[80,68],"start":[80,60]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[81,41],"start":[81,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[81,41],"start":[81,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,21],"start":[81,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[81,15],"start":[81,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[80,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[81,41],"start":[81,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,41],"start":[81,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[81,41],"start":[81,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[81,41],"start":[81,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[82,51],"start":[82,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[82,25],"start":[82,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[82,15],"start":[82,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[80,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[82,51],"start":[82,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[82,51],"start":[82,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[82,51],"start":[45,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[82,51],"start":[45,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[139,51],"start":[87,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[87,39],"start":[87,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[87,39],"start":[87,14]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"validateURL - Data URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[139,51],"start":[87,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[94,70],"start":[88,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[88,52],"start":[88,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[88,52],"start":[88,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK data:text/html (XSS vector)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[94,70],"start":[88,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[89,85],"start":[89,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[89,85],"start":[89,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[89,33],"start":[89,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[89,76],"start":[89,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[89,76],"start":[89,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:text/html,<script>alert(1)</script>"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[89,85],"start":[89,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[89,85],"start":[89,77]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[90,41],"start":[90,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[90,41],"start":[90,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,21],"start":[90,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[90,15],"start":[90,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[89,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[90,41],"start":[90,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,41],"start":[90,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[90,41],"start":[90,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[90,41],"start":[90,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[91,51],"start":[91,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[91,51],"start":[91,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,25],"start":[91,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[91,15],"start":[91,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[89,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[91,51],"start":[91,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[91,51],"start":[91,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[91,51],"start":[91,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[91,51],"start":[91,9]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[94,70],"start":[92,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[93,19],"start":[93,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[93,19],"start":[93,16]}},"binderType":"VarBinder","identifier":"err"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[93,78],"start":[93,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[93,26],"start":[93,23]}},"type":"Var","value":{"identifier":"err","sourcePos":[93,16]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[93,78],"start":[93,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[93,78],"start":[93,56]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"blocked content type"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[94,18],"start":[94,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[94,70],"start":[94,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[94,70],"start":[94,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about blocked content type"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[92,26],"start":[92,14]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[92,20],"start":[92,14]}},"type":"Var","value":{"identifier":"result","sourcePos":[89,13]}},"fieldName":"error","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[94,70],"start":[88,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[94,70],"start":[88,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[99,51],"start":[96,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[96,52],"start":[96,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[96,52],"start":[96,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK data:application/javascript"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[99,51],"start":[96,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[97,81],"start":[97,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[97,81],"start":[97,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[97,33],"start":[97,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[97,72],"start":[97,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[97,72],"start":[97,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:application/javascript,alert(1)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[97,81],"start":[97,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[97,81],"start":[97,73]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[98,41],"start":[98,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[98,41],"start":[98,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[98,21],"start":[98,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[98,15],"start":[98,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[97,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[98,41],"start":[98,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[98,41],"start":[98,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[98,41],"start":[98,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[98,41],"start":[98,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[99,51],"start":[99,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[99,25],"start":[99,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[99,15],"start":[99,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[97,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[99,51],"start":[99,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[99,51],"start":[99,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[99,51],"start":[96,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[99,51],"start":[96,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[104,51],"start":[101,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[101,60],"start":[101,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[101,60],"start":[101,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK data:image/svg+xml with script tags"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[104,51],"start":[101,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[102,100],"start":[102,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[102,100],"start":[102,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[102,33],"start":[102,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[102,91],"start":[102,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[102,91],"start":[102,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:image/svg+xml,<svg><script>alert(1)</script></svg>"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[102,100],"start":[102,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[102,100],"start":[102,92]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[103,41],"start":[103,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[103,41],"start":[103,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[103,21],"start":[103,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[103,15],"start":[103,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[102,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[103,41],"start":[103,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[103,41],"start":[103,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[103,41],"start":[103,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[103,41],"start":[103,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[104,51],"start":[104,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[104,25],"start":[104,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[104,15],"start":[104,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[102,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[104,51],"start":[104,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[104,51],"start":[104,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[104,51],"start":[101,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[104,51],"start":[101,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[109,48],"start":[106,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[106,39],"start":[106,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[106,39],"start":[106,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW data:image/png"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[109,48],"start":[106,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[107,79],"start":[107,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[107,79],"start":[107,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[107,33],"start":[107,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[107,70],"start":[107,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[107,70],"start":[107,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:image/png;base64,iVBORw0KGgo="}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[107,79],"start":[107,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[107,79],"start":[107,71]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[108,40],"start":[108,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[108,40],"start":[108,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[108,21],"start":[108,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[108,15],"start":[108,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[107,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[108,40],"start":[108,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[108,40],"start":[108,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[108,40],"start":[108,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[108,40],"start":[108,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[109,48],"start":[109,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[109,25],"start":[109,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[109,15],"start":[109,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[107,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[109,48],"start":[109,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[109,48],"start":[109,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[109,48],"start":[106,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[109,48],"start":[106,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[114,48],"start":[111,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[111,40],"start":[111,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[111,40],"start":[111,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW data:image/jpeg"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[114,48],"start":[111,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[112,76],"start":[112,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[112,76],"start":[112,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[112,33],"start":[112,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[112,67],"start":[112,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[112,67],"start":[112,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:image/jpeg;base64,/9j/4AAQ"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[112,76],"start":[112,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[112,76],"start":[112,68]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[113,40],"start":[113,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[113,40],"start":[113,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[113,21],"start":[113,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[113,15],"start":[113,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[112,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[113,40],"start":[113,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[113,40],"start":[113,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[113,40],"start":[113,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[113,40],"start":[113,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[114,48],"start":[114,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[114,25],"start":[114,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[114,15],"start":[114,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[112,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[114,48],"start":[114,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[114,48],"start":[114,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[114,48],"start":[111,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[114,48],"start":[111,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[119,48],"start":[116,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[116,58],"start":[116,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[116,58],"start":[116,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW data:image/svg+xml without script"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[119,48],"start":[116,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,111],"start":[117,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[117,111],"start":[117,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[117,33],"start":[117,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[117,102],"start":[117,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[117,102],"start":[117,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:image/svg+xml,<svg><rect width=\"100\" height=\"100\"/></svg>"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[117,111],"start":[117,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[117,111],"start":[117,103]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[118,40],"start":[118,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[118,40],"start":[118,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,21],"start":[118,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[118,15],"start":[118,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[117,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[118,40],"start":[118,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,40],"start":[118,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[118,40],"start":[118,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[118,40],"start":[118,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[119,48],"start":[119,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[119,25],"start":[119,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[119,15],"start":[119,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[117,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[119,48],"start":[119,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[119,48],"start":[119,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[119,48],"start":[116,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[119,48],"start":[116,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[124,48],"start":[121,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[121,39],"start":[121,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[121,39],"start":[121,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW data:audio/mp3"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[124,48],"start":[121,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[122,71],"start":[122,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[122,71],"start":[122,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[122,33],"start":[122,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[122,62],"start":[122,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[122,62],"start":[122,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:audio/mp3;base64,//uQ"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[122,71],"start":[122,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[122,71],"start":[122,63]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[123,40],"start":[123,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[123,40],"start":[123,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[123,21],"start":[123,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[123,15],"start":[123,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[122,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[123,40],"start":[123,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[123,40],"start":[123,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[123,40],"start":[123,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[123,40],"start":[123,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[124,48],"start":[124,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[124,25],"start":[124,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[124,15],"start":[124,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[122,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[124,48],"start":[124,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[124,48],"start":[124,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[124,48],"start":[121,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[124,48],"start":[121,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[129,48],"start":[126,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[126,39],"start":[126,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[126,39],"start":[126,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW data:video/mp4"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[129,48],"start":[126,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[127,71],"start":[127,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[127,71],"start":[127,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[127,33],"start":[127,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[127,62],"start":[127,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[127,62],"start":[127,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:video/mp4;base64,AAAA"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[127,71],"start":[127,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[127,71],"start":[127,63]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[128,40],"start":[128,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[128,40],"start":[128,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[128,21],"start":[128,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[128,15],"start":[128,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[127,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[128,40],"start":[128,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[128,40],"start":[128,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[128,40],"start":[128,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[128,40],"start":[128,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[129,48],"start":[129,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[129,25],"start":[129,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[129,15],"start":[129,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[127,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[129,48],"start":[129,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[129,48],"start":[129,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[129,48],"start":[126,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[129,48],"start":[126,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[134,48],"start":[131,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[131,46],"start":[131,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[131,46],"start":[131,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW data:application/json"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[134,48],"start":[131,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[132,82],"start":[132,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[132,82],"start":[132,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[132,33],"start":[132,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[132,73],"start":[132,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[132,73],"start":[132,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:application/json,{\"test\":true}"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[132,82],"start":[132,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[132,82],"start":[132,74]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[133,40],"start":[133,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[133,40],"start":[133,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[133,21],"start":[133,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[133,15],"start":[133,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[132,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[133,40],"start":[133,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[133,40],"start":[133,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[133,40],"start":[133,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[133,40],"start":[133,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[134,48],"start":[134,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[134,25],"start":[134,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[134,15],"start":[134,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[132,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[134,48],"start":[134,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[134,48],"start":[134,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[134,48],"start":[131,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[134,48],"start":[131,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[136,48],"start":[136,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[136,48],"start":[136,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK unknown data MIME types"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[139,51],"start":[136,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[137,76],"start":[137,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[137,76],"start":[137,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[137,33],"start":[137,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[137,67],"start":[137,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[137,67],"start":[137,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:application/x-unknown,test"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[137,76],"start":[137,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[137,76],"start":[137,68]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[138,41],"start":[138,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[138,41],"start":[138,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[138,21],"start":[138,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[138,15],"start":[138,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[137,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[138,41],"start":[138,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[138,41],"start":[138,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[138,41],"start":[138,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[138,41],"start":[138,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[139,51],"start":[139,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[139,25],"start":[139,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[139,15],"start":[139,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[137,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[139,51],"start":[139,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[139,51],"start":[139,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[139,51],"start":[87,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[139,51],"start":[87,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[178,48],"start":[144,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[144,44],"start":[144,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[144,44],"start":[144,14]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"validateURL - Safe Protocols"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[178,48],"start":[144,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[149,47],"start":[145,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[145,36],"start":[145,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[145,36],"start":[145,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW https: URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[149,47],"start":[145,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[146,74],"start":[146,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[146,74],"start":[146,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[146,33],"start":[146,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[146,65],"start":[146,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[146,65],"start":[146,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://example.com/image.png"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[146,74],"start":[146,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[146,74],"start":[146,66]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[147,40],"start":[147,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[147,40],"start":[147,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[147,21],"start":[147,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[147,15],"start":[147,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[146,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[147,40],"start":[147,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[147,40],"start":[147,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[147,40],"start":[147,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[147,40],"start":[147,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[148,48],"start":[148,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[148,48],"start":[148,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[148,25],"start":[148,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[148,15],"start":[148,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[146,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[148,48],"start":[148,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[148,48],"start":[148,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[148,48],"start":[148,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[148,48],"start":[148,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual3","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[149,47],"start":[149,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[149,24],"start":[149,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[149,15],"start":[149,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[146,13]}},"fieldName":"protocol","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[149,47],"start":[149,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[149,47],"start":[149,39]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https:"}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[149,47],"start":[145,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[149,47],"start":[145,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[157,74],"start":[151,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[151,48],"start":[151,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[151,48],"start":[151,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW http: URLs with warning"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[157,74],"start":[151,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[152,73],"start":[152,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[152,73],"start":[152,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[152,33],"start":[152,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[152,64],"start":[152,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[152,64],"start":[152,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"http://example.com/image.png"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[152,73],"start":[152,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[152,73],"start":[152,65]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,21],"start":[153,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[153,15],"start":[153,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[152,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[153,40],"start":[153,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[154,51],"start":[154,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[154,51],"start":[154,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[154,25],"start":[154,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[154,15],"start":[154,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[152,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[154,51],"start":[154,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[154,51],"start":[154,40]}},"type":"Var","value":{"identifier":"RiskWarning","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[154,51],"start":[154,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[154,51],"start":[154,9]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[157,74],"start":[155,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[156,20],"start":[156,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[156,20],"start":[156,16]}},"binderType":"VarBinder","identifier":"warn"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[156,71],"start":[156,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[156,28],"start":[156,24]}},"type":"Var","value":{"identifier":"warn","sourcePos":[156,16]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[156,71],"start":[156,24]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[156,71],"start":[156,58]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Unencrypted"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[157,18],"start":[157,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[157,74],"start":[157,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[157,74],"start":[157,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected warning about unencrypted connection"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[155,28],"start":[155,14]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[155,20],"start":[155,14]}},"type":"Var","value":{"identifier":"result","sourcePos":[152,13]}},"fieldName":"warning","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[157,74],"start":[151,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[157,74],"start":[151,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[162,48],"start":[159,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[159,35],"start":[159,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[159,35],"start":[159,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW blob: URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[162,48],"start":[159,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[160,77],"start":[160,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[160,77],"start":[160,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[160,33],"start":[160,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[160,68],"start":[160,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[160,68],"start":[160,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"blob:https://example.com/abc-123"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[160,77],"start":[160,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[160,77],"start":[160,69]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[161,40],"start":[161,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[161,40],"start":[161,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[161,21],"start":[161,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[161,15],"start":[161,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[160,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[161,40],"start":[161,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[161,40],"start":[161,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[161,40],"start":[161,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[161,40],"start":[161,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[162,48],"start":[162,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[162,25],"start":[162,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[162,15],"start":[162,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[160,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[162,48],"start":[162,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[162,48],"start":[162,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[162,48],"start":[159,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[162,48],"start":[159,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[168,49],"start":[164,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[164,54],"start":[164,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[164,54],"start":[164,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW relative URLs starting with /"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[168,49],"start":[164,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[165,62],"start":[165,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[165,62],"start":[165,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[165,33],"start":[165,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[165,53],"start":[165,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[165,53],"start":[165,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"/images/photo.png"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[165,62],"start":[165,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[165,62],"start":[165,54]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[166,40],"start":[166,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[166,40],"start":[166,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,21],"start":[166,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[166,15],"start":[166,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[165,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[166,40],"start":[166,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,40],"start":[166,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[166,40],"start":[166,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[166,40],"start":[166,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[167,48],"start":[167,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[167,48],"start":[167,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[167,25],"start":[167,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[167,15],"start":[167,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[165,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[167,48],"start":[167,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[167,48],"start":[167,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[167,48],"start":[167,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[167,48],"start":[167,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual3","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[168,49],"start":[168,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[168,24],"start":[168,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[168,15],"start":[168,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[165,13]}},"fieldName":"protocol","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[168,49],"start":[168,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[168,49],"start":[168,39]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"relative"}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[168,49],"start":[164,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[168,49],"start":[164,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[173,48],"start":[170,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[170,55],"start":[170,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[170,55],"start":[170,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW relative URLs starting with ./"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[173,48],"start":[170,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[171,63],"start":[171,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[171,63],"start":[171,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[171,33],"start":[171,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[171,54],"start":[171,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[171,54],"start":[171,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"./assets/image.png"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[171,63],"start":[171,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[171,63],"start":[171,55]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[172,40],"start":[172,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[172,40],"start":[172,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[172,21],"start":[172,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[172,15],"start":[172,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[171,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[172,40],"start":[172,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[172,40],"start":[172,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[172,40],"start":[172,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[172,40],"start":[172,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[173,48],"start":[173,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[173,25],"start":[173,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[173,15],"start":[173,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[171,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[173,48],"start":[173,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[173,48],"start":[173,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[173,48],"start":[170,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[173,48],"start":[170,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[175,56],"start":[175,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[175,56],"start":[175,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should ALLOW relative URLs starting with ../"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[178,48],"start":[175,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[176,64],"start":[176,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[176,64],"start":[176,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[176,33],"start":[176,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[176,55],"start":[176,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[176,55],"start":[176,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"../images/photo.png"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[176,64],"start":[176,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[176,64],"start":[176,56]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[177,40],"start":[177,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[177,40],"start":[177,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[177,21],"start":[177,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[177,15],"start":[177,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[176,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[177,40],"start":[177,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[177,40],"start":[177,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[177,40],"start":[177,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[177,40],"start":[177,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[178,48],"start":[178,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[178,25],"start":[178,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[178,15],"start":[178,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[176,13]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[178,48],"start":[178,9]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[178,48],"start":[178,40]}},"type":"Var","value":{"identifier":"RiskSafe","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[178,48],"start":[144,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[178,48],"start":[144,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[214,78],"start":[183,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[183,40],"start":[183,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[183,40],"start":[183,14]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"validateURL - Edge Cases"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[214,78],"start":[183,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[186,63],"start":[184,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[184,52],"start":[184,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[184,52],"start":[184,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK empty string and whitespace"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[186,63],"start":[184,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,60],"start":[185,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,60],"start":[185,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,40],"start":[185,9]}},"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[185,21],"start":[185,10]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[185,24],"start":[185,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,24],"start":[185,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,33],"start":[185,10]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[185,33],"start":[185,25]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,60],"start":[185,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,60],"start":[185,55]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[185,60],"start":[185,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[185,60],"start":[185,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[186,63],"start":[186,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,43],"start":[186,9]}},"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[186,21],"start":[186,10]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[186,27],"start":[186,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,27],"start":[186,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"   "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[186,36],"start":[186,10]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[186,36],"start":[186,28]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[186,63],"start":[186,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,63],"start":[186,58]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[186,63],"start":[184,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[186,63],"start":[184,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[190,63],"start":[188,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[188,37],"start":[188,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[188,37],"start":[188,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK empty string"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[190,63],"start":[188,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[189,60],"start":[189,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[189,60],"start":[189,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[189,40],"start":[189,9]}},"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[189,21],"start":[189,10]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[189,24],"start":[189,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[189,24],"start":[189,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":""}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[189,33],"start":[189,10]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[189,33],"start":[189,25]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[189,60],"start":[189,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[189,60],"start":[189,55]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[189,60],"start":[189,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[189,60],"start":[189,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[190,63],"start":[190,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,43],"start":[190,9]}},"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[190,21],"start":[190,10]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[190,27],"start":[190,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,27],"start":[190,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"   "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[190,36],"start":[190,10]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[190,36],"start":[190,28]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[190,63],"start":[190,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,63],"start":[190,58]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[190,63],"start":[188,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[190,63],"start":[188,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[202,65],"start":[192,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[192,61],"start":[192,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[192,61],"start":[192,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK extremely long URLs (DoS prevention)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[202,65],"start":[192,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[195,30],"start":[195,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[195,30],"start":[195,13]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[195,30],"start":[195,18]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"aaaaaaaaaa"}},"identifier":"a1"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,20],"start":[196,18]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,26],"start":[196,24]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,32],"start":[196,30]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,38],"start":[196,36]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,44],"start":[196,42]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,50],"start":[196,48]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,56],"start":[196,54]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,62],"start":[196,60]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,68],"start":[196,66]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[196,74],"start":[196,72]}},"type":"Var","value":{"identifier":"a1","sourcePos":[195,13]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"identifier":"a2"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,20],"start":[197,18]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,26],"start":[197,24]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,32],"start":[197,30]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,38],"start":[197,36]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,44],"start":[197,42]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,50],"start":[197,48]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,56],"start":[197,54]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,62],"start":[197,60]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,68],"start":[197,66]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[197,74],"start":[197,72]}},"type":"Var","value":{"identifier":"a2","sourcePos":[196,13]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"identifier":"a3"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,20],"start":[198,18]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,26],"start":[198,24]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,32],"start":[198,30]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,38],"start":[198,36]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,44],"start":[198,42]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,50],"start":[198,48]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,56],"start":[198,54]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,62],"start":[198,60]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,68],"start":[198,66]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[198,74],"start":[198,72]}},"type":"Var","value":{"identifier":"a3","sourcePos":[197,13]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"identifier":"a4"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,20],"start":[199,18]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,26],"start":[199,24]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,32],"start":[199,30]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,38],"start":[199,36]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,44],"start":[199,42]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,50],"start":[199,48]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,56],"start":[199,54]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,62],"start":[199,60]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,68],"start":[199,66]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[199,74],"start":[199,72]}},"type":"Var","value":{"identifier":"a4","sourcePos":[198,13]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"identifier":"a5"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,20],"start":[200,18]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,26],"start":[200,24]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,32],"start":[200,30]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,38],"start":[200,36]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,44],"start":[200,42]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,50],"start":[200,48]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,56],"start":[200,54]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,62],"start":[200,60]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,68],"start":[200,66]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,18]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[200,74],"start":[200,72]}},"type":"Var","value":{"identifier":"a5","sourcePos":[199,13]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"identifier":"a6"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[201,63],"start":[201,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[201,63],"start":[201,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[201,63],"start":[201,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[201,45],"start":[201,23]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://example.com/"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[201,63],"start":[201,23]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[201,63],"start":[201,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[201,51],"start":[201,49]}},"type":"Var","value":{"identifier":"a6","sourcePos":[200,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[201,63],"start":[201,23]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[201,63],"start":[201,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[201,57],"start":[201,55]}},"type":"Var","value":{"identifier":"a6","sourcePos":[200,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[201,63],"start":[201,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[201,63],"start":[201,61]}},"type":"Var","value":{"identifier":"a6","sourcePos":[200,13]}},"type":"App"},"type":"App"},"type":"App"},"identifier":"longUrl"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[202,65],"start":[202,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[202,45],"start":[202,9]}},"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[202,21],"start":[202,10]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[202,29],"start":[202,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[202,29],"start":[202,22]}},"type":"Var","value":{"identifier":"longUrl","sourcePos":[201,13]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[202,38],"start":[202,10]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[202,38],"start":[202,30]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[202,65],"start":[202,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[202,65],"start":[202,60]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[202,65],"start":[192,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[202,65],"start":[192,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[209,66],"start":[204,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[204,42],"start":[204,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[204,42],"start":[204,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should BLOCK unknown protocols"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,66],"start":[204,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[205,63],"start":[205,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[205,63],"start":[205,13]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[205,33],"start":[205,22]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[205,54],"start":[205,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[205,54],"start":[205,34]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"custom://something"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[205,63],"start":[205,22]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[205,63],"start":[205,55]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[206,41],"start":[206,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[206,41],"start":[206,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[206,21],"start":[206,9]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[206,15],"start":[206,9]}},"type":"Var","value":{"identifier":"result","sourcePos":[205,13]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[206,41],"start":[206,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[206,41],"start":[206,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[206,41],"start":[206,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[206,41],"start":[206,9]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[209,66],"start":[207,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[208,19],"start":[208,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[208,19],"start":[208,16]}},"binderType":"VarBinder","identifier":"err"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[208,74],"start":[208,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[208,26],"start":[208,23]}},"type":"Var","value":{"identifier":"err","sourcePos":[208,16]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[208,74],"start":[208,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[208,74],"start":[208,56]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Unknown protocol"}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[209,18],"start":[209,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[209,66],"start":[209,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,66],"start":[209,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected error about unknown protocol"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[207,26],"start":[207,14]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[207,20],"start":[207,14]}},"type":"Var","value":{"identifier":"result","sourcePos":[205,13]}},"fieldName":"error","type":"Accessor"}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[209,66],"start":[204,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[209,66],"start":[204,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[211,57],"start":[211,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[211,57],"start":[211,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should handle case-insensitive protocol check"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[214,78],"start":[211,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[212,79],"start":[212,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[212,79],"start":[212,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[212,59],"start":[212,9]}},"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[212,21],"start":[212,10]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[212,43],"start":[212,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[212,43],"start":[212,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"JAVASCRIPT:alert(1)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[212,52],"start":[212,10]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[212,52],"start":[212,44]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[212,79],"start":[212,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[212,79],"start":[212,74]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[212,79],"start":[212,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[212,79],"start":[212,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[213,79],"start":[213,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[213,79],"start":[213,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[213,59],"start":[213,9]}},"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[213,21],"start":[213,10]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[213,43],"start":[213,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[213,43],"start":[213,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"JavaScript:alert(1)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[213,52],"start":[213,10]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[213,52],"start":[213,44]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[213,79],"start":[213,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[213,79],"start":[213,74]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[213,79],"start":[213,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[213,79],"start":[213,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[214,78],"start":[214,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[214,59],"start":[214,9]}},"expression":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[214,21],"start":[214,10]}},"type":"Var","value":{"identifier":"validateURL","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[214,43],"start":[214,10]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[214,43],"start":[214,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"HTTPS://example.com"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[214,52],"start":[214,10]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[214,52],"start":[214,44]}},"type":"Var","value":{"identifier":"CtxAsset","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[214,78],"start":[214,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[214,78],"start":[214,74]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[214,78],"start":[183,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[214,78],"start":[183,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[234,60],"start":[219,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[219,34],"start":[219,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[219,34],"start":[219,14]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"sanitizeURLForHTML"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[234,60],"start":[219,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[222,41],"start":[220,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[220,47],"start":[220,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[220,47],"start":[220,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should return Left for blocked URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[222,41],"start":[220,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[221,62],"start":[221,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[221,62],"start":[221,13]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[221,40],"start":[221,22]}},"type":"Var","value":{"identifier":"sanitizeURLForHTML","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[221,62],"start":[221,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[221,62],"start":[221,41]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"javascript:alert(1)"}},"type":"App"},"identifier":"result"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[222,41],"start":[222,9]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[222,15],"start":[222,9]}},"type":"Var","value":{"identifier":"isLeft","moduleName":["Data","Either"]}},"annotation":{"meta":null,"sourceSpan":{"end":[222,22],"start":[222,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[222,22],"start":[222,16]}},"type":"Var","value":{"identifier":"result","sourcePos":[221,13]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[222,41],"start":[222,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[222,41],"start":[222,37]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[222,41],"start":[220,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[222,41],"start":[220,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[224,49],"start":[224,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[224,49],"start":[224,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should escape HTML special characters"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[234,60],"start":[224,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[225,83],"start":[225,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[225,83],"start":[225,13]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[225,40],"start":[225,22]}},"type":"Var","value":{"identifier":"sanitizeURLForHTML","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[225,83],"start":[225,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[225,83],"start":[225,41]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://example.com?foo=<bar>&x=\"test\""}},"type":"App"},"identifier":"result"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[234,60],"start":[226,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[227,19],"start":[227,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[227,19],"start":[227,16]}},"binderType":"VarBinder","identifier":"err"}],"constructorName":{"identifier":"Left","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[227,68],"start":[227,23]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[227,67],"start":[227,29]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[227,60],"start":[227,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected Right but got Left: "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[227,67],"start":[227,29]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[227,67],"start":[227,64]}},"type":"Var","value":{"identifier":"err","sourcePos":[227,16]}},"type":"App"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[228,26],"start":[228,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[228,26],"start":[228,17]}},"binderType":"VarBinder","identifier":"sanitized"}],"constructorName":{"identifier":"Right","moduleName":["Data","Either"]},"typeName":{"identifier":"Either","moduleName":["Data","Either"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[229,58],"start":[229,13]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldNotContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[229,58],"start":[229,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[229,22],"start":[229,13]}},"type":"Var","value":{"identifier":"sanitized","sourcePos":[228,17]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[229,58],"start":[229,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[229,58],"start":[229,55]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"<"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[229,58],"start":[229,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[229,58],"start":[229,13]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[230,58],"start":[230,13]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldNotContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[230,58],"start":[230,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[230,22],"start":[230,13]}},"type":"Var","value":{"identifier":"sanitized","sourcePos":[228,17]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[230,58],"start":[230,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[230,58],"start":[230,55]}},"type":"Literal","value":{"literalType":"StringLiteral","value":">"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[230,58],"start":[230,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[230,58],"start":[230,13]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[231,59],"start":[231,13]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldNotContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[231,59],"start":[231,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[231,22],"start":[231,13]}},"type":"Var","value":{"identifier":"sanitized","sourcePos":[228,17]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[231,59],"start":[231,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[231,59],"start":[231,55]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"\""}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[231,59],"start":[231,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[231,59],"start":[231,13]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[232,58],"start":[232,13]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[232,58],"start":[232,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[232,22],"start":[232,13]}},"type":"Var","value":{"identifier":"sanitized","sourcePos":[228,17]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[232,58],"start":[232,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[232,58],"start":[232,52]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"&lt;"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[232,58],"start":[232,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[232,58],"start":[232,13]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[233,58],"start":[233,13]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[233,58],"start":[233,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[233,22],"start":[233,13]}},"type":"Var","value":{"identifier":"sanitized","sourcePos":[228,17]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[233,58],"start":[233,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[233,58],"start":[233,52]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"&gt;"}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[233,58],"start":[233,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[233,58],"start":[233,13]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldContain","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[234,60],"start":[234,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,22],"start":[234,13]}},"type":"Var","value":{"identifier":"sanitized","sourcePos":[228,17]}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[234,60],"start":[234,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,60],"start":[234,52]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"&quot;"}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[226,20],"start":[226,14]}},"type":"Var","value":{"identifier":"result","sourcePos":[225,13]}}],"type":"Case"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[234,60],"start":[219,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[234,60],"start":[219,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[258,74],"start":[239,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[239,47],"start":[239,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[239,47],"start":[239,14]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"validateURLs - Batch Validation"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[258,74],"start":[239,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[240,56],"start":[240,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[240,56],"start":[240,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should validate multiple URLs and return map"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[258,74],"start":[240,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[245,16],"start":[241,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[245,16],"start":[241,13]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[245,16],"start":[242,15]}},"type":"Literal","value":{"literalType":"ArrayLiteral","value":[{"annotation":{"meta":null,"sourceSpan":{"end":[242,45],"start":[242,17]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://safe.com/image.png"}},{"annotation":{"meta":null,"sourceSpan":{"end":[243,38],"start":[243,17]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"javascript:alert(1)"}},{"annotation":{"meta":null,"sourceSpan":{"end":[244,44],"start":[244,17]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:image/png;base64,ABC"}}]}},"identifier":"urls"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[246,40],"start":[246,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[246,40],"start":[246,13]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[246,35],"start":[246,23]}},"type":"Var","value":{"identifier":"validateURLs","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[246,40],"start":[246,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[246,40],"start":[246,36]}},"type":"Var","value":{"identifier":"urls","sourcePos":[241,13]}},"type":"App"},"identifier":"results"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[248,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[248,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[38,18],"start":[38,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[248,53],"start":[248,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[248,53],"start":[248,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://safe.com/image.png"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[248,61],"start":[248,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[248,61],"start":[248,54]}},"type":"Var","value":{"identifier":"results","sourcePos":[246,13]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[248,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[249,17],"start":[249,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[249,17],"start":[249,16]}},"binderType":"VarBinder","identifier":"r"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[249,47],"start":[249,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[249,28],"start":[249,21]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[249,22],"start":[249,21]}},"type":"Var","value":{"identifier":"r","sourcePos":[249,16]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[249,47],"start":[249,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[249,47],"start":[249,43]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[250,18],"start":[250,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[250,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[250,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result for https://safe.com/image.png"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[38,18],"start":[38,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[248,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[250,75],"start":[248,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[254,68],"start":[252,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[254,68],"start":[252,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[38,18],"start":[38,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[252,46],"start":[252,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[252,46],"start":[252,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"javascript:alert(1)"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[252,54],"start":[252,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[252,54],"start":[252,47]}},"type":"Var","value":{"identifier":"results","sourcePos":[246,13]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[254,68],"start":[252,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[253,17],"start":[253,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[253,17],"start":[253,16]}},"binderType":"VarBinder","identifier":"r"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[253,48],"start":[253,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[253,28],"start":[253,21]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[253,22],"start":[253,21]}},"type":"Var","value":{"identifier":"r","sourcePos":[253,16]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[253,48],"start":[253,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[253,48],"start":[253,43]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[254,18],"start":[254,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[254,68],"start":[254,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[254,68],"start":[254,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result for javascript:alert(1)"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[38,18],"start":[38,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[254,68],"start":[252,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[254,68],"start":[252,9]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[258,74],"start":[256,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[38,18],"start":[38,1]}},"bindType":"NonRec","expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"lookup","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[256,52],"start":[256,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[256,52],"start":[256,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:image/png;base64,ABC"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[256,60],"start":[256,14]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[256,60],"start":[256,53]}},"type":"Var","value":{"identifier":"results","sourcePos":[246,13]}},"type":"App"},"identifier":"v"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[258,74],"start":[256,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":["value0"],"metaType":"IsConstructor"},"sourceSpan":{"end":[257,17],"start":[257,11]}},"binderType":"ConstructorBinder","binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[257,17],"start":[257,16]}},"binderType":"VarBinder","identifier":"r"}],"constructorName":{"identifier":"Just","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[257,47],"start":[257,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[257,28],"start":[257,21]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[257,22],"start":[257,21]}},"type":"Var","value":{"identifier":"r","sourcePos":[257,16]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[257,47],"start":[257,21]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[257,47],"start":[257,43]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[258,18],"start":[258,11]}},"binderType":"ConstructorBinder","binders":[],"constructorName":{"identifier":"Nothing","moduleName":["Data","Maybe"]},"typeName":{"identifier":"Maybe","moduleName":["Data","Maybe"]}}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[258,74],"start":[258,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[258,74],"start":[258,27]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected result for data:image/png;base64,ABC"}},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[38,18],"start":[38,1]}},"type":"Var","value":{"identifier":"v","sourcePos":[0,0]}}],"type":"Case"},"type":"Let"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[258,74],"start":[239,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[258,74],"start":[239,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[282,30],"start":[263,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[263,31],"start":[263,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[263,31],"start":[263,14]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"isTrustedDomain"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[282,30],"start":[263,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[264,62],"start":[264,7]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[264,62],"start":[264,11]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[264,62],"start":[264,28]}},"type":"Literal","value":{"literalType":"ArrayLiteral","value":[{"annotation":{"meta":null,"sourceSpan":{"end":[264,42],"start":[264,29]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"example.com"}},{"annotation":{"meta":null,"sourceSpan":{"end":[264,61],"start":[264,44]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"cdn.trusted.org"}}]}},"identifier":"trustedDomains"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[268,29],"start":[266,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[266,37],"start":[266,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[266,37],"start":[266,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should match exact domain"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[268,29],"start":[266,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[268,29],"start":[267,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[267,24],"start":[267,9]}},"type":"Var","value":{"identifier":"isTrustedDomain","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[267,51],"start":[267,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[267,51],"start":[267,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://example.com/path"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[267,66],"start":[267,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[267,66],"start":[267,52]}},"type":"Var","value":{"identifier":"trustedDomains","sourcePos":[264,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[268,29],"start":[267,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[268,29],"start":[268,25]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[268,29],"start":[266,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[268,29],"start":[266,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[274,29],"start":[270,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[270,34],"start":[270,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[270,34],"start":[270,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should match subdomain"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[274,29],"start":[270,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[272,29],"start":[271,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[272,29],"start":[271,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[271,24],"start":[271,9]}},"type":"Var","value":{"identifier":"isTrustedDomain","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[271,55],"start":[271,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[271,55],"start":[271,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://api.example.com/path"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[271,70],"start":[271,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[271,70],"start":[271,56]}},"type":"Var","value":{"identifier":"trustedDomains","sourcePos":[264,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[272,29],"start":[271,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[272,29],"start":[272,25]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[272,29],"start":[271,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[272,29],"start":[271,9]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[274,29],"start":[273,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[273,24],"start":[273,9]}},"type":"Var","value":{"identifier":"isTrustedDomain","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[273,62],"start":[273,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[273,62],"start":[273,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://static.cdn.trusted.org/file"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[273,77],"start":[273,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[273,77],"start":[273,63]}},"type":"Var","value":{"identifier":"trustedDomains","sourcePos":[264,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[274,29],"start":[273,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[274,29],"start":[274,25]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[274,29],"start":[270,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[274,29],"start":[270,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[278,30],"start":[276,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[276,48],"start":[276,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[276,48],"start":[276,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should NOT match partial domain name"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[278,30],"start":[276,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[278,30],"start":[277,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[277,24],"start":[277,9]}},"type":"Var","value":{"identifier":"isTrustedDomain","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[277,55],"start":[277,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[277,55],"start":[277,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"https://fakeexample.com/path"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[277,70],"start":[277,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[277,70],"start":[277,56]}},"type":"Var","value":{"identifier":"trustedDomains","sourcePos":[264,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[278,30],"start":[277,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[278,30],"start":[278,25]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[278,30],"start":[276,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[278,30],"start":[276,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[280,48],"start":[280,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[280,48],"start":[280,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should return false for invalid URLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[282,30],"start":[280,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[282,30],"start":[281,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[281,24],"start":[281,9]}},"type":"Var","value":{"identifier":"isTrustedDomain","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[281,36],"start":[281,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[281,36],"start":[281,25]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"not-a-url"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[281,51],"start":[281,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[281,51],"start":[281,37]}},"type":"Var","value":{"identifier":"trustedDomains","sourcePos":[264,11]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[282,30],"start":[281,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[282,30],"start":[282,25]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[282,30],"start":[263,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[282,30],"start":[263,5]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"describe","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[287,38],"start":[287,5]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[287,38],"start":[287,14]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"extractAndValidateURLs"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[287,5]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[298,80],"start":[288,7]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[288,54],"start":[288,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[288,54],"start":[288,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should extract and validate URLs from text"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[298,80],"start":[288,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[289,135],"start":[289,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[289,135],"start":[289,13]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[289,135],"start":[289,20]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Check out https://safe.com/image.png and also http://another.com/video.mp4 Also here is data:image/png;base64,ABC"}},"identifier":"text"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[290,50],"start":[290,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[290,50],"start":[290,13]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[290,45],"start":[290,23]}},"type":"Var","value":{"identifier":"extractAndValidateURLs","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[290,50],"start":[290,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[290,50],"start":[290,46]}},"type":"Var","value":{"identifier":"text","sourcePos":[289,13]}},"type":"App"},"identifier":"results"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[292,45],"start":[292,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual4","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[292,45],"start":[292,9]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[292,21],"start":[292,9]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[292,29],"start":[292,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[292,29],"start":[292,22]}},"type":"Var","value":{"identifier":"results","sourcePos":[290,13]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[292,45],"start":[292,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[292,45],"start":[292,44]}},"type":"Literal","value":{"literalType":"IntLiteral","value":3}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[292,45],"start":[292,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[292,45],"start":[292,9]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[298,80],"start":[293,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[294,23],"start":[294,11]}},"binderType":"LiteralBinder","literal":{"literalType":"ArrayLiteral","value":[{"annotation":{"meta":null,"sourceSpan":{"end":[294,14],"start":[294,12]}},"binderType":"VarBinder","identifier":"r0"},{"annotation":{"meta":null,"sourceSpan":{"end":[294,18],"start":[294,16]}},"binderType":"VarBinder","identifier":"r1"},{"annotation":{"meta":null,"sourceSpan":{"end":[294,22],"start":[294,20]}},"binderType":"VarBinder","identifier":"r2"}]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[295,40],"start":[295,13]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[295,40],"start":[295,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[295,21],"start":[295,13]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[295,15],"start":[295,13]}},"type":"Var","value":{"identifier":"r0","sourcePos":[294,12]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[295,40],"start":[295,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[295,40],"start":[295,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[295,40],"start":[295,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[295,40],"start":[295,13]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[296,40],"start":[296,13]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[296,40],"start":[296,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[296,21],"start":[296,13]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[296,15],"start":[296,13]}},"type":"Var","value":{"identifier":"r1","sourcePos":[294,16]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[296,40],"start":[296,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[296,40],"start":[296,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[296,40],"start":[296,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[296,40],"start":[296,13]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[297,40],"start":[297,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[297,21],"start":[297,13]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[297,15],"start":[297,13]}},"type":"Var","value":{"identifier":"r2","sourcePos":[294,20]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[297,40],"start":[297,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[297,40],"start":[297,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":true}},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[298,12],"start":[298,11]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[298,80],"start":[298,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[298,79],"start":[298,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[298,48],"start":[298,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 3 results, got "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[298,79],"start":[298,22]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"show","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[298,79],"start":[298,52]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[298,70],"start":[298,58]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[298,78],"start":[298,58]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[298,78],"start":[298,71]}},"type":"Var","value":{"identifier":"results","sourcePos":[290,13]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[293,21],"start":[293,14]}},"type":"Var","value":{"identifier":"results","sourcePos":[290,13]}}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[298,80],"start":[288,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[298,80],"start":[288,7]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"it","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[300,62],"start":[300,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[300,62],"start":[300,10]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"should identify dangerous data URLs when extracted"}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[300,7]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[301,62],"start":[301,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[301,62],"start":[301,13]}},"bindType":"NonRec","expression":{"annotation":{"meta":null,"sourceSpan":{"end":[301,62],"start":[301,20]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"data:text/html,<script>alert(1)</script>"}},"identifier":"text"}],"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[302,50],"start":[302,9]}},"binds":[{"annotation":{"meta":null,"sourceSpan":{"end":[302,50],"start":[302,13]}},"bindType":"NonRec","expression":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[302,45],"start":[302,23]}},"type":"Var","value":{"identifier":"extractAndValidateURLs","moduleName":["Lattice","Services","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[302,50],"start":[302,23]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[302,50],"start":[302,46]}},"type":"Var","value":{"identifier":"text","sourcePos":[301,13]}},"type":"App"},"identifier":"results"}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[303,45],"start":[303,9]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual4","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[303,45],"start":[303,9]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[303,21],"start":[303,9]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[303,29],"start":[303,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[303,29],"start":[303,22]}},"type":"Var","value":{"identifier":"results","sourcePos":[302,13]}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[303,45],"start":[303,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[303,45],"start":[303,44]}},"type":"Literal","value":{"literalType":"IntLiteral","value":1}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[303,45],"start":[303,9]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[303,45],"start":[303,9]}},"argument":"$__unused","body":{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[304,9]}},"caseAlternatives":[{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[305,15],"start":[305,11]}},"binderType":"LiteralBinder","literal":{"literalType":"ArrayLiteral","value":[{"annotation":{"meta":null,"sourceSpan":{"end":[305,14],"start":[305,12]}},"binderType":"VarBinder","identifier":"r0"}]}}],"expression":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"discard2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[306,41],"start":[306,13]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual1","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[306,41],"start":[306,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[306,21],"start":[306,13]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[306,15],"start":[306,13]}},"type":"Var","value":{"identifier":"r0","sourcePos":[305,12]}},"fieldName":"valid","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[306,41],"start":[306,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[306,41],"start":[306,36]}},"type":"Literal","value":{"literalType":"BooleanLiteral","value":false}},"type":"App"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[306,41],"start":[306,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[306,41],"start":[306,13]}},"argument":"$__unused","body":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"shouldEqual2","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[307,51],"start":[307,13]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[307,25],"start":[307,13]}},"expression":{"annotation":{"meta":null,"sourceSpan":{"end":[307,15],"start":[307,13]}},"type":"Var","value":{"identifier":"r0","sourcePos":[305,12]}},"fieldName":"riskLevel","type":"Accessor"},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[307,51],"start":[307,13]}},"argument":{"annotation":{"meta":{"constructorType":"SumType","identifiers":[],"metaType":"IsConstructor"},"sourceSpan":{"end":[307,51],"start":[307,40]}},"type":"Var","value":{"identifier":"RiskBlocked","moduleName":["Lattice","Services","Security","UrlValidator"]}},"type":"App"},"type":"Abs"},"type":"App"},"isGuarded":false},{"binders":[{"annotation":{"meta":null,"sourceSpan":{"end":[308,12],"start":[308,11]}},"binderType":"NullBinder"}],"expression":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"fail","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[308,16]}},"argument":{"abstraction":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"append","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[308,78],"start":[308,22]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[308,47],"start":[308,22]}},"type":"Literal","value":{"literalType":"StringLiteral","value":"Expected 1 result, got "}},"type":"App"},"annotation":{"meta":null,"sourceSpan":{"end":[308,78],"start":[308,22]}},"argument":{"abstraction":{"annotation":{"meta":null,"sourceSpan":{"end":[0,0],"start":[0,0]}},"type":"Var","value":{"identifier":"show","moduleName":["Test","Lattice","Security","UrlValidator"]}},"annotation":{"meta":null,"sourceSpan":{"end":[308,78],"start":[308,51]}},"argument":{"abstraction":{"annotation":{"meta":{"metaType":"IsForeign"},"sourceSpan":{"end":[308,69],"start":[308,57]}},"type":"Var","value":{"identifier":"length","moduleName":["Data","Array"]}},"annotation":{"meta":null,"sourceSpan":{"end":[308,77],"start":[308,57]}},"argument":{"annotation":{"meta":null,"sourceSpan":{"end":[308,77],"start":[308,70]}},"type":"Var","value":{"identifier":"results","sourcePos":[302,13]}},"type":"App"},"type":"App"},"type":"App"},"type":"App"},"isGuarded":false}],"caseExpressions":[{"annotation":{"meta":null,"sourceSpan":{"end":[304,21],"start":[304,14]}},"type":"Var","value":{"identifier":"results","sourcePos":[302,13]}}],"type":"Case"},"type":"Abs"},"type":"App"},"type":"Let"},"type":"Let"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"Abs"},"type":"App"},"type":"App"},"identifier":"spec"}],"exports":["spec"],"foreign":[],"imports":[{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Control","Bind"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Data","Array"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Data","Either"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Data","Eq"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Data","Identity"]},{"annotation":{"meta":null,"sourceSpan":{"end":[22,23],"start":[22,1]}},"moduleName":["Data","Map"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Data","Map","Internal"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Data","Maybe"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Data","Ord"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Data","Semigroup"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Data","Show"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Effect","Aff"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Lattice","Services","Security","UrlValidator"]},{"annotation":{"meta":null,"sourceSpan":{"end":[18,15],"start":[18,1]}},"moduleName":["Prelude"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Prim"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Test","Spec"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Test","Spec","Assertions"]},{"annotation":{"meta":null,"sourceSpan":{"end":[308,79],"start":[16,1]}},"moduleName":["Test","Spec","Assertions","String"]}],"moduleName":["Test","Lattice","Security","UrlValidator"],"modulePath":"test/Lattice/Security/UrlValidator.purs","reExports":{},"sourceSpan":{"end":[308,79],"start":[16,1]}}