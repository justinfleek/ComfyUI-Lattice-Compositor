// Generated by purs version 0.15.15
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as $$Math from "../Math/index.js";
var Arc = /* #__PURE__ */ (function () {
    function Arc() {

    };
    Arc.value = new Arc();
    return Arc;
})();
var Bulge = /* #__PURE__ */ (function () {
    function Bulge() {

    };
    Bulge.value = new Bulge();
    return Bulge;
})();
var Wave = /* #__PURE__ */ (function () {
    function Wave() {

    };
    Wave.value = new Wave();
    return Wave;
})();
var Fisheye = /* #__PURE__ */ (function () {
    function Fisheye() {

    };
    Fisheye.value = new Fisheye();
    return Fisheye;
})();
var Twist = /* #__PURE__ */ (function () {
    function Twist() {

    };
    Twist.value = new Twist();
    return Twist;
})();
var waveWarp = function (x) {
    return function (y) {
        return function (nx) {
            return function (ny) {
                return function (width) {
                    return function (height) {
                        return function (bend) {
                            var waveAmplitude = bend * 0.1;
                            return {
                                srcX: x + $$Math.sin(ny * $$Math.pi * 2.0) * waveAmplitude * width,
                                srcY: y + $$Math.sin(nx * $$Math.pi * 2.0) * waveAmplitude * height
                            };
                        };
                    };
                };
            };
        };
    };
};
var twistWarp = function (v) {
    return function (v1) {
        return function (nx) {
            return function (ny) {
                return function (centerX) {
                    return function (centerY) {
                        return function (r) {
                            return function (bend) {
                                var angle = bend * $$Math.pi * (1.0 - r);
                                var cosA = $$Math.cos(angle);
                                var sinA = $$Math.sin(angle);
                                return {
                                    srcX: centerX + (nx * cosA - ny * sinA) * centerX,
                                    srcY: centerY + (nx * sinA + ny * cosA) * centerY
                                };
                            };
                        };
                    };
                };
            };
        };
    };
};
var showWarpStyle = {
    show: function (v) {
        if (v instanceof Arc) {
            return "Arc";
        };
        if (v instanceof Bulge) {
            return "Bulge";
        };
        if (v instanceof Wave) {
            return "Wave";
        };
        if (v instanceof Fisheye) {
            return "Fisheye";
        };
        if (v instanceof Twist) {
            return "Twist";
        };
        throw new Error("Failed pattern match at Lattice.Services.Distort.Warp (line 45, column 1 - line 50, column 23): " + [ v.constructor.name ]);
    }
};
var normalizeCoord = function (coord) {
    return function (center) {
        if (center < 1.0e-4) {
            return 0.0;
        };
        if (Data_Boolean.otherwise) {
            return (coord - center) / center;
        };
        throw new Error("Failed pattern match at Lattice.Services.Distort.Warp (line 67, column 1 - line 67, column 45): " + [ coord.constructor.name, center.constructor.name ]);
    };
};
var fisheyeWarp = function (x) {
    return function (y) {
        return function (nx) {
            return function (ny) {
                return function (centerX) {
                    return function (centerY) {
                        return function (r) {
                            return function (bend) {
                                if (r <= 0.0) {
                                    return {
                                        srcX: x,
                                        srcY: y
                                    };
                                };
                                if (r >= 1.0) {
                                    return {
                                        srcX: x,
                                        srcY: y
                                    };
                                };
                                if (Data_Boolean.otherwise) {
                                    var theta = $$Math.atan2(ny)(nx);
                                    var newR = $$Math.pow(r)(1.0 + bend);
                                    return {
                                        srcX: centerX + newR * $$Math.cos(theta) * centerX,
                                        srcY: centerY + newR * $$Math.sin(theta) * centerY
                                    };
                                };
                                throw new Error("Failed pattern match at Lattice.Services.Distort.Warp (line 160, column 1 - line 160, column 106): " + [ x.constructor.name, y.constructor.name, nx.constructor.name, ny.constructor.name, centerX.constructor.name, centerY.constructor.name, r.constructor.name, bend.constructor.name ]);
                            };
                        };
                    };
                };
            };
        };
    };
};
var eqWarpStyle = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Arc && y instanceof Arc) {
                return true;
            };
            if (x instanceof Bulge && y instanceof Bulge) {
                return true;
            };
            if (x instanceof Wave && y instanceof Wave) {
                return true;
            };
            if (x instanceof Fisheye && y instanceof Fisheye) {
                return true;
            };
            if (x instanceof Twist && y instanceof Twist) {
                return true;
            };
            return false;
        };
    }
};
var bulgeWarp = function (x) {
    return function (y) {
        return function (centerX) {
            return function (centerY) {
                return function (r) {
                    return function (bend) {
                        if (r >= 1.0) {
                            return {
                                srcX: x,
                                srcY: y
                            };
                        };
                        if (Data_Boolean.otherwise) {
                            var factor = 1.0 + bend * (1.0 - r * r);
                            var safeFactor = (function () {
                                var $31 = $$Math.abs(factor) < 1.0e-4;
                                if ($31) {
                                    return 1.0e-4;
                                };
                                return factor;
                            })();
                            return {
                                srcX: centerX + (x - centerX) / safeFactor,
                                srcY: centerY + (y - centerY) / safeFactor
                            };
                        };
                        throw new Error("Failed pattern match at Lattice.Services.Distort.Warp (line 108, column 1 - line 108, column 84): " + [ x.constructor.name, y.constructor.name, centerX.constructor.name, centerY.constructor.name, r.constructor.name, bend.constructor.name ]);
                    };
                };
            };
        };
    };
};
var arcWarpX = function (x) {
    return function (nx) {
        return function (ny) {
            return function (centerX) {
                return function (bend) {
                    var arcBend = bend * ny * ny;
                    return x + arcBend * centerX * nx;
                };
            };
        };
    };
};
var applyWarp = function (style) {
    return function (x) {
        return function (y) {
            return function (width) {
                return function (height) {
                    return function (bend) {
                        var centerY = height / 2.0;
                        var ny = normalizeCoord(y)(centerY);
                        var centerX = width / 2.0;
                        var nx = normalizeCoord(x)(centerX);
                        var r = $$Math.sqrt(nx * nx + ny * ny);
                        if (style instanceof Arc) {
                            return {
                                srcX: arcWarpX(x)(nx)(ny)(centerX)(bend),
                                srcY: y
                            };
                        };
                        if (style instanceof Bulge) {
                            return bulgeWarp(x)(y)(centerX)(centerY)(r)(bend);
                        };
                        if (style instanceof Wave) {
                            return waveWarp(x)(y)(nx)(ny)(width)(height)(bend);
                        };
                        if (style instanceof Fisheye) {
                            return fisheyeWarp(x)(y)(nx)(ny)(centerX)(centerY)(r)(bend);
                        };
                        if (style instanceof Twist) {
                            return twistWarp(x)(y)(nx)(ny)(centerX)(centerY)(r)(bend);
                        };
                        throw new Error("Failed pattern match at Lattice.Services.Distort.Warp (line 219, column 6 - line 224, column 60): " + [ style.constructor.name ]);
                    };
                };
            };
        };
    };
};
var applyHVDistortion = function (srcX) {
    return function (srcY) {
        return function (nx) {
            return function (ny) {
                return function (centerX) {
                    return function (centerY) {
                        return function (hDistort) {
                            return function (vDistort) {
                                return {
                                    srcX: srcX + hDistort * centerX * (1.0 - ny * ny),
                                    srcY: srcY + vDistort * centerY * (1.0 - nx * nx)
                                };
                            };
                        };
                    };
                };
            };
        };
    };
};
export {
    Arc,
    Bulge,
    Wave,
    Fisheye,
    Twist,
    normalizeCoord,
    arcWarpX,
    bulgeWarp,
    waveWarp,
    fisheyeWarp,
    twistWarp,
    applyWarp,
    applyHVDistortion,
    eqWarpStyle,
    showWarpStyle
};
//# sourceMappingURL=index.js.map
