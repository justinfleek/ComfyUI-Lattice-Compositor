// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Char from "../Data.Char/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Data_String_Common from "../Data.String.Common/index.js";
import * as Lattice_Utils_Uuid5_EntityType from "../Lattice.Utils.Uuid5.EntityType/index.js";
import * as Lattice_Utils_Uuid5_SHA1 from "../Lattice.Utils.Uuid5.SHA1/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var uUID5_NAMESPACE_X500 = "6ba7b814-9dad-11d1-80b4-00c04fd430c8";
var uUID5_NAMESPACE_URL = "6ba7b811-9dad-11d1-80b4-00c04fd430c8";
var uUID5_NAMESPACE_OID = "6ba7b812-9dad-11d1-80b4-00c04fd430c8";
var uUID5_NAMESPACE_DNS = "6ba7b810-9dad-11d1-80b4-00c04fd430c8";
var stringToBytes = function (s) {
    return map(Data_Char.toCharCode)(Data_String_CodeUnits.toCharArray(s));
};
var lATTICE_NAMESPACE = "a1b2c3d4-e5f6-4789-a012-3456789abcde";
var hexCharToInt = function (c) {
    if (c >= "0" && c <= "9") {
        return Data_Char.toCharCode(c) - Data_Char.toCharCode("0") | 0;
    };
    if (c >= "a" && c <= "f") {
        return (Data_Char.toCharCode(c) - Data_Char.toCharCode("a") | 0) + 10 | 0;
    };
    if (c >= "A" && c <= "F") {
        return (Data_Char.toCharCode(c) - Data_Char.toCharCode("A") | 0) + 10 | 0;
    };
    if (Data_Boolean.otherwise) {
        return 0;
    };
    throw new Error("Failed pattern match at Lattice.Utils.Uuid5.Core (line 64, column 1 - line 64, column 28): " + [ c.constructor.name ]);
};
var uuidToBytes = function (uuid) {
    var pairs = Data_Array.range(0)(15);
    var hex = Data_String_Common.replaceAll("-")("")(uuid);
    var chars = Data_String_CodeUnits.toCharArray(hex);
    var toByte = function (i) {
        var c2 = Data_Maybe.fromMaybe("0")(Data_Array.index(chars)((i * 2 | 0) + 1 | 0));
        var c1 = Data_Maybe.fromMaybe("0")(Data_Array.index(chars)(i * 2 | 0));
        return (hexCharToInt(c1) * 16 | 0) + hexCharToInt(c2) | 0;
    };
    return map(toByte)(pairs);
};
var getByte = function (arr) {
    return function (idx) {
        return Data_Maybe.fromMaybe(0)(Data_Array.index(arr)(idx));
    };
};
var byteToHex = function (b) {
    var hex = Data_Int.toStringAs(Data_Int.hexadecimal)(b);
    var $11 = Data_String_CodePoints.length(hex) === 1;
    if ($11) {
        return "0" + hex;
    };
    return hex;
};
var bytesToUuid = function (bytes) {
    var hex = Data_String_Common.joinWith("")(map(byteToHex)(bytes));
    return Data_String_CodePoints.take(8)(hex) + ("-" + (Data_String_CodePoints.take(4)(Data_String_CodePoints.drop(8)(hex)) + ("-" + (Data_String_CodePoints.take(4)(Data_String_CodePoints.drop(12)(hex)) + ("-" + (Data_String_CodePoints.take(4)(Data_String_CodePoints.drop(16)(hex)) + ("-" + Data_String_CodePoints.drop(20)(hex))))))));
};
var uuid5 = function (name) {
    return function (namespace) {
        var namespaceBytes = uuidToBytes(namespace);
        var nameBytes = stringToBytes(name);
        var combined = append1(namespaceBytes)(nameBytes);
        var hash = Lattice_Utils_Uuid5_SHA1.sha1(combined);
        var uuidBytes = Data_Array.take(16)(hash);
        var byte8 = getByte(uuidBytes)(8) & 63 | 128;
        var byte6 = getByte(uuidBytes)(6) & 15 | 80;
        var uuidBytes$prime = append1(Data_Array.take(6)(uuidBytes))(append1([ byte6 ])(append1([ getByte(uuidBytes)(7) ])(append1([ byte8 ])(Data_Array.drop(9)(uuidBytes)))));
        return bytesToUuid(uuidBytes$prime);
    };
};
var generateId = function (entityType) {
    return function (parts) {
        var name = Data_String_Common.joinWith(":")(append1([ Lattice_Utils_Uuid5_EntityType.entityTypeToPrefix(entityType) ])(parts));
        return uuid5(name)(lATTICE_NAMESPACE);
    };
};
var uuid5Default = function (name) {
    return uuid5(name)(lATTICE_NAMESPACE);
};
export {
    uUID5_NAMESPACE_DNS,
    uUID5_NAMESPACE_URL,
    uUID5_NAMESPACE_OID,
    uUID5_NAMESPACE_X500,
    lATTICE_NAMESPACE,
    uuid5,
    uuid5Default,
    generateId,
    uuidToBytes,
    bytesToUuid
};
//# sourceMappingURL=index.js.map
