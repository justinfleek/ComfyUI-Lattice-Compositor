// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Generic_Rep from "../Data.Generic.Rep/index.js";
import * as Data_HeytingAlgebra from "../Data.HeytingAlgebra/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Set from "../Data.Set/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Show_Generic from "../Data.Show.Generic/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Data_String_Common from "../Data.String.Common/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showBoolean);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var show2 = /* #__PURE__ */ Data_Show.show(Data_Show.showString);
var genericShowConstructor = /* #__PURE__ */ Data_Show_Generic.genericShowConstructor(Data_Show_Generic.genericShowArgsNoArguments);
var eqTuple = /* #__PURE__ */ Data_Tuple.eqTuple(Data_Eq.eqString);
var foldl = /* #__PURE__ */ Data_Foldable.foldl(Data_Foldable.foldableArray);
var eq3 = /* #__PURE__ */ Data_Eq.eq(Data_String_CodePoints.eqCodePoint);
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordInt);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var show3 = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var any = /* #__PURE__ */ Data_Foldable.any(Data_Foldable.foldableArray)(Data_HeytingAlgebra.heytingAlgebraBoolean);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(Data_Either.bindEither);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_Either.applicativeEither);
var ParseError = /* #__PURE__ */ (function () {
    function ParseError() {

    };
    ParseError.value = new ParseError();
    return ParseError;
})();
var SizeExceeded = /* #__PURE__ */ (function () {
    function SizeExceeded() {

    };
    SizeExceeded.value = new SizeExceeded();
    return SizeExceeded;
})();
var DepthExceeded = /* #__PURE__ */ (function () {
    function DepthExceeded() {

    };
    DepthExceeded.value = new DepthExceeded();
    return DepthExceeded;
})();
var StringLengthExceeded = /* #__PURE__ */ (function () {
    function StringLengthExceeded() {

    };
    StringLengthExceeded.value = new StringLengthExceeded();
    return StringLengthExceeded;
})();
var ArrayLengthExceeded = /* #__PURE__ */ (function () {
    function ArrayLengthExceeded() {

    };
    ArrayLengthExceeded.value = new ArrayLengthExceeded();
    return ArrayLengthExceeded;
})();
var PrototypePollution = /* #__PURE__ */ (function () {
    function PrototypePollution() {

    };
    PrototypePollution.value = new PrototypePollution();
    return PrototypePollution;
})();
var SchemaValidation = /* #__PURE__ */ (function () {
    function SchemaValidation() {

    };
    SchemaValidation.value = new SchemaValidation();
    return SchemaValidation;
})();
var JSONNull = /* #__PURE__ */ (function () {
    function JSONNull() {

    };
    JSONNull.value = new JSONNull();
    return JSONNull;
})();
var JSONBool = /* #__PURE__ */ (function () {
    function JSONBool(value0) {
        this.value0 = value0;
    };
    JSONBool.create = function (value0) {
        return new JSONBool(value0);
    };
    return JSONBool;
})();
var JSONNumber = /* #__PURE__ */ (function () {
    function JSONNumber(value0) {
        this.value0 = value0;
    };
    JSONNumber.create = function (value0) {
        return new JSONNumber(value0);
    };
    return JSONNumber;
})();
var JSONString = /* #__PURE__ */ (function () {
    function JSONString(value0) {
        this.value0 = value0;
    };
    JSONString.create = function (value0) {
        return new JSONString(value0);
    };
    return JSONString;
})();
var JSONArray = /* #__PURE__ */ (function () {
    function JSONArray(value0) {
        this.value0 = value0;
    };
    JSONArray.create = function (value0) {
        return new JSONArray(value0);
    };
    return JSONArray;
})();
var JSONObject = /* #__PURE__ */ (function () {
    function JSONObject(value0) {
        this.value0 = value0;
    };
    JSONObject.create = function (value0) {
        return new JSONObject(value0);
    };
    return JSONObject;
})();
var showJSONValue = {
    show: function (v) {
        if (v instanceof JSONNull) {
            return "JSONNull";
        };
        if (v instanceof JSONBool) {
            return "(JSONBool " + (show(v.value0) + ")");
        };
        if (v instanceof JSONNumber) {
            return "(JSONNumber " + (show1(v.value0) + ")");
        };
        if (v instanceof JSONString) {
            return "(JSONString " + (show2(v.value0) + ")");
        };
        if (v instanceof JSONArray) {
            var showItems = function (v1) {
                if (v1.length === 0) {
                    return "";
                };
                var v2 = Data_Array.uncons(v1);
                if (v2 instanceof Data_Maybe.Nothing) {
                    return "";
                };
                if (v2 instanceof Data_Maybe.Just && v2.value0.tail.length === 0) {
                    return Data_Show.show(showJSONValue)(v2.value0.head);
                };
                if (v2 instanceof Data_Maybe.Just) {
                    return Data_Show.show(showJSONValue)(v2.value0.head) + (", " + showItems(v2.value0.tail));
                };
                throw new Error("Failed pattern match at Lattice.Utils.SchemaValidation (line 160, column 23 - line 163, column 69): " + [ v2.constructor.name ]);
            };
            return "(JSONArray [" + (showItems(v.value0) + "])");
        };
        if (v instanceof JSONObject) {
            var showFields = function (v1) {
                if (v1.length === 0) {
                    return "";
                };
                var v2 = Data_Array.uncons(v1);
                if (v2 instanceof Data_Maybe.Nothing) {
                    return "";
                };
                if (v2 instanceof Data_Maybe.Just && v2.value0.tail.length === 0) {
                    return "(Tuple " + (show2(v2.value0.head.value0) + (" " + (Data_Show.show(showJSONValue)(v2.value0.head.value1) + ")")));
                };
                if (v2 instanceof Data_Maybe.Just) {
                    return "(Tuple " + (show2(v2.value0.head.value0) + (" " + (Data_Show.show(showJSONValue)(v2.value0.head.value1) + ("), " + showFields(v2.value0.tail)))));
                };
                throw new Error("Failed pattern match at Lattice.Utils.SchemaValidation (line 167, column 24 - line 170, column 111): " + [ v2.constructor.name ]);
            };
            return "(JSONObject [" + (showFields(v.value0) + "])");
        };
        throw new Error("Failed pattern match at Lattice.Utils.SchemaValidation (line 152, column 1 - line 170, column 111): " + [ v.constructor.name ]);
    }
};
var genericParseErrorCode_ = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return ParseError.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inl) {
            return SizeExceeded.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inl)) {
            return DepthExceeded.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0 instanceof Data_Generic_Rep.Inl))) {
            return StringLengthExceeded.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl)))) {
            return ArrayLengthExceeded.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl))))) {
            return PrototypePollution.value;
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr))))) {
            return SchemaValidation.value;
        };
        throw new Error("Failed pattern match at Lattice.Utils.SchemaValidation (line 120, column 1 - line 120, column 41): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof ParseError) {
            return new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value);
        };
        if (x instanceof SizeExceeded) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value));
        };
        if (x instanceof DepthExceeded) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value)));
        };
        if (x instanceof StringLengthExceeded) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value))));
        };
        if (x instanceof ArrayLengthExceeded) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value)))));
        };
        if (x instanceof PrototypePollution) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(Data_Generic_Rep.NoArguments.value))))));
        };
        if (x instanceof SchemaValidation) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(Data_Generic_Rep.NoArguments.value))))));
        };
        throw new Error("Failed pattern match at Lattice.Utils.SchemaValidation (line 120, column 1 - line 120, column 41): " + [ x.constructor.name ]);
    }
};
var showParseErrorCode = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericParseErrorCode_)(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ParseError";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "SizeExceeded";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "DepthExceeded";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "StringLengthExceeded";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "ArrayLengthExceeded";
        }
    }))(/* #__PURE__ */ Data_Show_Generic.genericShowSum(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "PrototypePollution";
        }
    }))(/* #__PURE__ */ genericShowConstructor({
        reflectSymbol: function () {
            return "SchemaValidation";
        }
    }))))))))
};
var eqParseErrorCode = {
    eq: function (x) {
        return function (y) {
            if (x instanceof ParseError && y instanceof ParseError) {
                return true;
            };
            if (x instanceof SizeExceeded && y instanceof SizeExceeded) {
                return true;
            };
            if (x instanceof DepthExceeded && y instanceof DepthExceeded) {
                return true;
            };
            if (x instanceof StringLengthExceeded && y instanceof StringLengthExceeded) {
                return true;
            };
            if (x instanceof ArrayLengthExceeded && y instanceof ArrayLengthExceeded) {
                return true;
            };
            if (x instanceof PrototypePollution && y instanceof PrototypePollution) {
                return true;
            };
            if (x instanceof SchemaValidation && y instanceof SchemaValidation) {
                return true;
            };
            return false;
        };
    }
};
var eqJSONValue = {
    eq: function (x) {
        return function (y) {
            if (x instanceof JSONNull && y instanceof JSONNull) {
                return true;
            };
            if (x instanceof JSONBool && y instanceof JSONBool) {
                return x.value0 === y.value0;
            };
            if (x instanceof JSONNumber && y instanceof JSONNumber) {
                return x.value0 === y.value0;
            };
            if (x instanceof JSONString && y instanceof JSONString) {
                return x.value0 === y.value0;
            };
            if (x instanceof JSONArray && y instanceof JSONArray) {
                return Data_Eq.eq(Data_Eq.eqArray(eqJSONValue))(x.value0)(y.value0);
            };
            if (x instanceof JSONObject && y instanceof JSONObject) {
                return Data_Eq.eq(Data_Eq.eqArray(eqTuple(eqJSONValue)))(x.value0)(y.value0);
            };
            return false;
        };
    }
};
var unicodeOverrides = [ "\u202a", "\u202b", "\u202c", "\u202d", "\u202e", "\u2066", "\u2067", "\u2068", "\u2069" ];
var sanitizeString = function (input) {
    return function (opts) {
        var s1 = Data_String_Common.replaceAll("\x00")("")(input);
        var s2 = foldl(function (acc) {
            return function (c) {
                return Data_String_Common.replaceAll(c)("")(acc);
            };
        })(s1)(unicodeOverrides);
        var s3 = Data_String_Common.trim(s2);
        var s4 = Data_String_CodePoints.take(opts.maxLength)(s3);
        return s4;
    };
};
var normalizePath = /* #__PURE__ */ Data_String_Common.replaceAll("\\")("/");
var sanitizePath = function (basePath) {
    return function (userPath) {
        var normalizedUser = Data_String_CodePoints.dropWhile(function (v) {
            return eq3(v)(Data_String_CodePoints.codePointFromChar("/"));
        })(normalizePath(userPath));
        var normalizedBase = Data_String_CodePoints.dropWhile(function (v) {
            return eq3(v)(Data_String_CodePoints.codePointFromChar("/"));
        })(normalizePath(basePath));
        var $161 = Data_String_CodeUnits.contains("\x00")(normalizedUser);
        if ($161) {
            return new Data_Either.Left("Null byte detected in path");
        };
        var $162 = Data_String_CodeUnits.contains("..")(normalizedUser);
        if ($162) {
            return new Data_Either.Left("Path traversal pattern detected");
        };
        return new Data_Either.Right(normalizedBase + ("/" + normalizedUser));
    };
};
var mkParseError = function (code) {
    return function (message) {
        return function (context) {
            return {
                code: code,
                message: message,
                context: context
            };
        };
    };
};
var maxStringLength = function (v) {
    if (v instanceof JSONNull) {
        return 0;
    };
    if (v instanceof JSONBool) {
        return 0;
    };
    if (v instanceof JSONNumber) {
        return 0;
    };
    if (v instanceof JSONString) {
        return Data_String_CodePoints.length(v.value0);
    };
    if (v instanceof JSONArray) {
        var $167 = Data_Array["null"](v.value0);
        if ($167) {
            return 0;
        };
        return foldl(max)(0)(map(maxStringLength)(v.value0));
    };
    if (v instanceof JSONObject) {
        var $169 = Data_Array["null"](v.value0);
        if ($169) {
            return 0;
        };
        return foldl(max)(0)(map(function (v1) {
            return max(Data_String_CodePoints.length(v1.value0))(maxStringLength(v1.value1));
        })(v.value0));
    };
    throw new Error("Failed pattern match at Lattice.Utils.SchemaValidation (line 199, column 19 - line 209, column 94): " + [ v.constructor.name ]);
};
var validateStringLengths = function (val) {
    return function (opts) {
        var maxLen = maxStringLength(val);
        var $174 = maxLen > opts.maxStringLength;
        if ($174) {
            return new Data_Either.Left(mkParseError(StringLengthExceeded.value)("String length " + (show3(maxLen) + (" exceeds maximum " + show3(opts.maxStringLength))))(opts.context));
        };
        return new Data_Either.Right(Data_Unit.unit);
    };
};
var maxArrayLength = function (v) {
    if (v instanceof JSONNull) {
        return 0;
    };
    if (v instanceof JSONBool) {
        return 0;
    };
    if (v instanceof JSONNumber) {
        return 0;
    };
    if (v instanceof JSONString) {
        return 0;
    };
    if (v instanceof JSONArray) {
        var nested = (function () {
            var $179 = Data_Array["null"](v.value0);
            if ($179) {
                return 0;
            };
            return foldl(max)(0)(map(maxArrayLength)(v.value0));
        })();
        return max(Data_Array.length(v.value0))(nested);
    };
    if (v instanceof JSONObject) {
        var $181 = Data_Array["null"](v.value0);
        if ($181) {
            return 0;
        };
        return foldl(max)(0)(map(function ($205) {
            return maxArrayLength(Data_Tuple.snd($205));
        })(v.value0));
    };
    throw new Error("Failed pattern match at Lattice.Utils.SchemaValidation (line 213, column 18 - line 223, column 59): " + [ v.constructor.name ]);
};
var validateArrayLengths = function (val) {
    return function (opts) {
        var maxLen = maxArrayLength(val);
        var $183 = maxLen > opts.maxArrayLength;
        if ($183) {
            return new Data_Either.Left(mkParseError(ArrayLengthExceeded.value)("Array length " + (show3(maxLen) + (" exceeds maximum " + show3(opts.maxArrayLength))))(opts.context));
        };
        return new Data_Either.Right(Data_Unit.unit);
    };
};
var looksLikeMaliciousPayload = function (value) {
    var lower = Data_String_Common.toLower(value);
    return Data_String_CodeUnits.contains("<script")(lower) || (Data_String_CodeUnits.contains("javascript:")(lower) || (Data_String_CodeUnits.contains("' or '")(lower) || (Data_String_CodeUnits.contains("; drop table")(lower) || (Data_String_CodeUnits.contains("; delete from")(lower) || (Data_String_CodeUnits.contains("; rm -rf")(lower) || (Data_String_CodeUnits.contains("| cat ")(lower) || (Data_String_CodeUnits.contains("../")(value) || Data_String_CodeUnits.contains("..\\")(value))))))));
};
var jsonDepth = function (v) {
    if (v instanceof JSONNull) {
        return 0;
    };
    if (v instanceof JSONBool) {
        return 0;
    };
    if (v instanceof JSONNumber) {
        return 0;
    };
    if (v instanceof JSONString) {
        return 0;
    };
    if (v instanceof JSONArray) {
        var $188 = Data_Array["null"](v.value0);
        if ($188) {
            return 1;
        };
        return 1 + foldl(max)(0)(map(jsonDepth)(v.value0)) | 0;
    };
    if (v instanceof JSONObject) {
        var $190 = Data_Array["null"](v.value0);
        if ($190) {
            return 1;
        };
        return 1 + foldl(max)(0)(map(function ($206) {
            return jsonDepth(Data_Tuple.snd($206));
        })(v.value0)) | 0;
    };
    throw new Error("Failed pattern match at Lattice.Utils.SchemaValidation (line 185, column 13 - line 195, column 58): " + [ v.constructor.name ]);
};
var validateDepth = function (val) {
    return function (opts) {
        var depth = jsonDepth(val);
        var $192 = depth > opts.maxDepth;
        if ($192) {
            return new Data_Either.Left(mkParseError(DepthExceeded.value)("Depth " + (show3(depth) + (" exceeds maximum " + show3(opts.maxDepth))))(opts.context));
        };
        return new Data_Either.Right(Data_Unit.unit);
    };
};
var invalidFilenameChars = [ "/", "\\", "\x00", "<", ">", ":", "\"", "|", "?", "*", ";", "&", "`", "$", "(", ")", "{", "}", "[", "]", "!", "#", "'" ];
var sanitizeFilename = function (filename) {
    var s1 = foldl(function (acc) {
        return function (c) {
            return Data_String_Common.replaceAll(c)("_")(acc);
        };
    })(filename)(invalidFilenameChars);
    var s2 = Data_String_Common.replaceAll("..")("_")(s1);
    var s3 = (function () {
        var $193 = Data_String_CodePoints.take(1)(s2) === ".";
        if ($193) {
            return "_" + Data_String_CodePoints.drop(1)(s2);
        };
        return s2;
    })();
    var s4 = Data_String_CodePoints.take(200)(s3);
    var $194 = Data_String_Common["null"](s4) || s4 === "_";
    if ($194) {
        return "unnamed";
    };
    return s4;
};
var defaultSanitizeStringOptions = {
    maxLength: 10000,
    allowNewlines: true
};
var defaultSafeParseOptions = /* #__PURE__ */ (function () {
    return {
        maxDepth: 100,
        maxSize: (50 * 1024 | 0) * 1024 | 0,
        maxStringLength: 1024 * 1024 | 0,
        maxArrayLength: 100000,
        context: "JSON"
    };
})();
var dangerousPathPrefixes = [ "/etc/", "/var/", "/usr/", "/bin/", "/sbin/", "/root/", "/home/", "/tmp/" ];
var isPathSafe = function (path) {
    return !Data_String_CodeUnits.contains("\x00")(path) && (!Data_String_CodeUnits.contains("..")(path) && !any(function (prefix) {
        return Data_String_CodeUnits.contains(prefix)(Data_String_Common.toLower(path));
    })(dangerousPathPrefixes));
};
var dangerousKeys = /* #__PURE__ */ Data_Set.fromFoldable(Data_Foldable.foldableArray)(Data_Ord.ordString)([ "__proto__", "constructor", "prototype", "__defineGetter__", "__defineSetter__", "__lookupGetter__", "__lookupSetter__" ]);
var isDangerousKey = /* #__PURE__ */ Data_Function.flip(/* #__PURE__ */ Data_Set.member(Data_Ord.ordString))(dangerousKeys);
var hasPrototypePollution = function (v) {
    if (v instanceof JSONNull) {
        return false;
    };
    if (v instanceof JSONBool) {
        return false;
    };
    if (v instanceof JSONNumber) {
        return false;
    };
    if (v instanceof JSONString) {
        return false;
    };
    if (v instanceof JSONArray) {
        return any(hasPrototypePollution)(v.value0);
    };
    if (v instanceof JSONObject) {
        return any(function (v1) {
            return isDangerousKey(v1.value0) || hasPrototypePollution(v1.value1);
        })(v.value0);
    };
    throw new Error("Failed pattern match at Lattice.Utils.SchemaValidation (line 174, column 25 - line 181, column 77): " + [ v.constructor.name ]);
};
var validateJSON = function (val) {
    return function (opts) {
        return discard((function () {
            var $204 = hasPrototypePollution(val);
            if ($204) {
                return new Data_Either.Left(mkParseError(PrototypePollution.value)("Dangerous key detected")(opts.context));
            };
            return pure(Data_Unit.unit);
        })())(function () {
            return discard(validateDepth(val)(opts))(function () {
                return discard(validateStringLengths(val)(opts))(function () {
                    return validateArrayLengths(val)(opts);
                });
            });
        });
    };
};
export {
    defaultSafeParseOptions,
    dangerousKeys,
    isDangerousKey,
    ParseError,
    SizeExceeded,
    DepthExceeded,
    StringLengthExceeded,
    ArrayLengthExceeded,
    PrototypePollution,
    SchemaValidation,
    mkParseError,
    JSONNull,
    JSONBool,
    JSONNumber,
    JSONString,
    JSONArray,
    JSONObject,
    hasPrototypePollution,
    jsonDepth,
    maxStringLength,
    maxArrayLength,
    validateDepth,
    validateStringLengths,
    validateArrayLengths,
    validateJSON,
    isPathSafe,
    sanitizePath,
    dangerousPathPrefixes,
    defaultSanitizeStringOptions,
    sanitizeString,
    sanitizeFilename,
    looksLikeMaliciousPayload,
    genericParseErrorCode_,
    eqParseErrorCode,
    showParseErrorCode,
    eqJSONValue,
    showJSONValue
};
//# sourceMappingURL=index.js.map
