// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Identity from "../Data.Identity/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as Lattice_Services_Security_TemplateVerifier from "../Lattice.Services.Security.TemplateVerifier/index.js";
import * as Test_Spec from "../Test.Spec/index.js";
import * as Test_Spec_Assertions from "../Test.Spec.Assertions/index.js";
var describe = /* #__PURE__ */ Test_Spec.describe(Data_Identity.monadIdentity);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit);
var discard1 = /* #__PURE__ */ discard(/* #__PURE__ */ Test_Spec.bindSpecT(Data_Identity.bindIdentity));
var it = /* #__PURE__ */ Test_Spec.it(Data_Identity.monadIdentity)(Test_Spec.exampleMUnit);
var shouldEqual = /* #__PURE__ */ Test_Spec_Assertions.shouldEqual(Effect_Aff.monadThrowAff);
var shouldEqual1 = /* #__PURE__ */ shouldEqual(Data_Show.showBoolean)(Data_Eq.eqBoolean);
var for_ = /* #__PURE__ */ Data_Foldable.for_(Effect_Aff.applicativeAff)(Data_Foldable.foldableArray);
var discard2 = /* #__PURE__ */ discard(Effect_Aff.bindAff);
var shouldEqual2 = /* #__PURE__ */ shouldEqual(Lattice_Services_Security_TemplateVerifier.showBadgeColor)(Lattice_Services_Security_TemplateVerifier.eqBadgeColor);
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect_Aff.applicativeAff);
var fail = /* #__PURE__ */ Test_Spec_Assertions.fail(Effect_Aff.monadThrowAff);
var shouldEqual3 = /* #__PURE__ */ shouldEqual(Data_Show.showString)(Data_Eq.eqString);
var elem = /* #__PURE__ */ Data_Array.elem(Data_Eq.eqString);
var mkResult = function (status) {
    return function (isSigned) {
        return function (isValid) {
            return function (isOfficial) {
                return function (message) {
                    return {
                        isSigned: isSigned,
                        isValid: isValid,
                        isOfficial: isOfficial,
                        status: status,
                        message: message,
                        signerPublicKey: Data_Maybe.Nothing.value,
                        signedAt: Data_Maybe.Nothing.value
                    };
                };
            };
        };
    };
};
var shouldWarnBeforeLoadingTests = /* #__PURE__ */ describe("shouldWarnBeforeLoading")(/* #__PURE__ */ discard1(/* #__PURE__ */ it("should not warn for official templates")(/* #__PURE__ */ (function () {
    var result = mkResult(Lattice_Services_Security_TemplateVerifier.VsOfficial.value)(true)(true)(true)("OK");
    return shouldEqual1(Lattice_Services_Security_TemplateVerifier.shouldWarnBeforeLoading(result))(false);
})()))(function () {
    return it("should warn for all non-official templates")((function () {
        var nonOfficialStatuses = [ {
            status: Lattice_Services_Security_TemplateVerifier.VsThirdPartyValid.value,
            isSigned: true,
            isValid: true
        }, {
            status: Lattice_Services_Security_TemplateVerifier.VsThirdPartyInvalid.value,
            isSigned: true,
            isValid: false
        }, {
            status: Lattice_Services_Security_TemplateVerifier.VsUnsigned.value,
            isSigned: false,
            isValid: false
        } ];
        return for_(nonOfficialStatuses)(function (entry) {
            var result = mkResult(entry.status)(entry.isSigned)(entry.isValid)(false)("Test");
            return shouldEqual1(Lattice_Services_Security_TemplateVerifier.shouldWarnBeforeLoading(result))(true);
        });
    })());
}));
var getVerificationBadgeTests = /* #__PURE__ */ describe("getVerificationBadge")(/* #__PURE__ */ discard1(/* #__PURE__ */ it("should return green badge for official templates")(/* #__PURE__ */ (function () {
    var result = mkResult(Lattice_Services_Security_TemplateVerifier.VsOfficial.value)(true)(true)(true)("Verified");
    var badge = Lattice_Services_Security_TemplateVerifier.getVerificationBadge(result);
    return discard2(shouldEqual2(badge.color)(Lattice_Services_Security_TemplateVerifier.ColorGreen.value))(function () {
        return discard2((function () {
            var $20 = Data_String_CodeUnits.contains("Verified")(badge.label);
            if ($20) {
                return pure(Data_Unit.unit);
            };
            return fail("Expected badge label to contain 'Verified', got: " + badge.label);
        })())(function () {
            return shouldEqual3(badge.icon)("check");
        });
    });
})()))(function () {
    return discard1(it("should return yellow badge for third-party valid")((function () {
        var result = mkResult(Lattice_Services_Security_TemplateVerifier.VsThirdPartyValid.value)(true)(true)(false)("Third party");
        var badge = Lattice_Services_Security_TemplateVerifier.getVerificationBadge(result);
        return discard2(shouldEqual2(badge.color)(Lattice_Services_Security_TemplateVerifier.ColorYellow.value))(function () {
            return shouldEqual3(badge.icon)("warning");
        });
    })()))(function () {
        return discard1(it("should return red badge for invalid signatures")((function () {
            var result = mkResult(Lattice_Services_Security_TemplateVerifier.VsThirdPartyInvalid.value)(true)(false)(false)("Invalid");
            var badge = Lattice_Services_Security_TemplateVerifier.getVerificationBadge(result);
            return discard2(shouldEqual2(badge.color)(Lattice_Services_Security_TemplateVerifier.ColorRed.value))(function () {
                return shouldEqual3(badge.icon)("x");
            });
        })()))(function () {
            return it("should return gray badge for unsigned")((function () {
                var result = mkResult(Lattice_Services_Security_TemplateVerifier.VsUnsigned.value)(false)(false)(false)("Unsigned");
                var badge = Lattice_Services_Security_TemplateVerifier.getVerificationBadge(result);
                return discard2(shouldEqual2(badge.color)(Lattice_Services_Security_TemplateVerifier.ColorGray.value))(function () {
                    return shouldEqual3(badge.icon)("question");
                });
            })());
        });
    });
}));
var getLoadingWarningTests = /* #__PURE__ */ describe("getLoadingWarning")(/* #__PURE__ */ discard1(/* #__PURE__ */ it("should return Left for official templates")(/* #__PURE__ */ (function () {
    var result = mkResult(Lattice_Services_Security_TemplateVerifier.VsOfficial.value)(true)(true)(true)("OK");
    var warning = Lattice_Services_Security_TemplateVerifier.getLoadingWarning(result);
    var $21 = Data_Either.isLeft(warning);
    if ($21) {
        return pure(Data_Unit.unit);
    };
    return fail("Expected Left for official template, got Right");
})()))(function () {
    return discard1(it("should return Right with message for third-party valid")((function () {
        var result = mkResult(Lattice_Services_Security_TemplateVerifier.VsThirdPartyValid.value)(true)(true)(false)("Third party");
        var warning = Lattice_Services_Security_TemplateVerifier.getLoadingWarning(result);
        if (warning instanceof Data_Either.Right) {
            var $23 = Data_String_CodeUnits.contains("third party")(warning.value0);
            if ($23) {
                return pure(Data_Unit.unit);
            };
            return fail("Expected warning to contain 'third party', got: " + warning.value0);
        };
        if (warning instanceof Data_Either.Left) {
            return fail("Expected Right for third-party valid template, got Left");
        };
        throw new Error("Failed pattern match at Test.Lattice.Security.TemplateVerifier (line 120, column 7 - line 126, column 73): " + [ warning.constructor.name ]);
    })()))(function () {
        return discard1(it("should return Right with WARNING for invalid")((function () {
            var result = mkResult(Lattice_Services_Security_TemplateVerifier.VsThirdPartyInvalid.value)(true)(false)(false)("Invalid");
            var warning = Lattice_Services_Security_TemplateVerifier.getLoadingWarning(result);
            if (warning instanceof Data_Either.Right) {
                var $27 = Data_String_CodeUnits.contains("WARNING")(warning.value0);
                if ($27) {
                    return pure(Data_Unit.unit);
                };
                return fail("Expected warning to contain 'WARNING', got: " + warning.value0);
            };
            if (warning instanceof Data_Either.Left) {
                return fail("Expected Right for invalid template, got Left");
            };
            throw new Error("Failed pattern match at Test.Lattice.Security.TemplateVerifier (line 131, column 7 - line 137, column 63): " + [ warning.constructor.name ]);
        })()))(function () {
            return it("should return Right for unsigned")((function () {
                var result = mkResult(Lattice_Services_Security_TemplateVerifier.VsUnsigned.value)(false)(false)(false)("Unsigned");
                var warning = Lattice_Services_Security_TemplateVerifier.getLoadingWarning(result);
                if (warning instanceof Data_Either.Right) {
                    var $31 = Data_String_CodeUnits.contains("unsigned")(warning.value0);
                    if ($31) {
                        return pure(Data_Unit.unit);
                    };
                    return fail("Expected warning to contain 'unsigned', got: " + warning.value0);
                };
                if (warning instanceof Data_Either.Left) {
                    return fail("Expected Right for unsigned template, got Left");
                };
                throw new Error("Failed pattern match at Test.Lattice.Security.TemplateVerifier (line 142, column 7 - line 148, column 64): " + [ warning.constructor.name ]);
            })());
        });
    });
}));
var constantTests = /* #__PURE__ */ describe("Constants")(/* #__PURE__ */ discard1(/* #__PURE__ */ it("officialPublicKey should be the expected value")(/* #__PURE__ */ shouldEqual3(Lattice_Services_Security_TemplateVerifier.officialPublicKey)("xmCWXfRKw7DQLuyQdqQIJlAb+r0arpUu2oVjTdJgv/k=")))(function () {
    return it("supportedVersions should contain 1.0")((function () {
        var $34 = elem("1.0")(Lattice_Services_Security_TemplateVerifier.supportedVersions);
        if ($34) {
            return pure(Data_Unit.unit);
        };
        return fail("Expected supportedVersions to contain \"1.0\"");
    })());
}));
var spec = /* #__PURE__ */ describe("Template Signature Verification")(/* #__PURE__ */ discard1(getVerificationBadgeTests)(function () {
    return discard1(shouldWarnBeforeLoadingTests)(function () {
        return discard1(getLoadingWarningTests)(function () {
            return constantTests;
        });
    });
}));
export {
    spec
};
//# sourceMappingURL=index.js.map
