// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Number from "../Data.Number/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Show_Generic from "../Data.Show.Generic/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Lattice_Services_Math3D_Vec3 from "../Lattice.Services.Math3D.Vec3/index.js";
var wIsSymbol = {
    reflectSymbol: function () {
        return "w";
    }
};
var xIsSymbol = {
    reflectSymbol: function () {
        return "x";
    }
};
var yIsSymbol = {
    reflectSymbol: function () {
        return "y";
    }
};
var zIsSymbol = {
    reflectSymbol: function () {
        return "z";
    }
};
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordNumber);
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordNumber);
var Quat = function (x) {
    return x;
};
var genericQuat_ = {
    to: function (x) {
        return x;
    },
    from: function (x) {
        return x;
    }
};
var showQuat = {
    show: /* #__PURE__ */ Data_Show_Generic.genericShow(genericQuat_)(/* #__PURE__ */ Data_Show_Generic.genericShowConstructor(/* #__PURE__ */ Data_Show_Generic.genericShowArgsArgument(/* #__PURE__ */ Data_Show.showRecord()()(/* #__PURE__ */ Data_Show.showRecordFieldsCons(wIsSymbol)(/* #__PURE__ */ Data_Show.showRecordFieldsCons(xIsSymbol)(/* #__PURE__ */ Data_Show.showRecordFieldsCons(yIsSymbol)(/* #__PURE__ */ Data_Show.showRecordFieldsConsNil(zIsSymbol)(Data_Show.showNumber))(Data_Show.showNumber))(Data_Show.showNumber))(Data_Show.showNumber))))({
        reflectSymbol: function () {
            return "Quat";
        }
    }))
};
var eqQuat = /* #__PURE__ */ Data_Eq.eqRec()(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(Data_Eq.eqRowNil)()(zIsSymbol)(Data_Eq.eqNumber))()(yIsSymbol)(Data_Eq.eqNumber))()(xIsSymbol)(Data_Eq.eqNumber))()(wIsSymbol)(Data_Eq.eqNumber));
var toArray = function (v) {
    return [ v.x, v.y, v.z, v.w ];
};
var quatFromComponents = function (x) {
    return function (y) {
        return function (z) {
            return function (w) {
                return {
                    x: x,
                    y: y,
                    z: z,
                    w: w
                };
            };
        };
    };
};
var multiply = function (v) {
    return function (v1) {
        return {
            x: (v.w * v1.x + v.x * v1.w + v.y * v1.z) - v.z * v1.y,
            y: (v.w * v1.y - v.x * v1.z) + v.y * v1.w + v.z * v1.x,
            z: ((v.w * v1.z + v.x * v1.y) - v.y * v1.x) + v.z * v1.w,
            w: v.w * v1.w - v.x * v1.x - v.y * v1.y - v.z * v1.z
        };
    };
};
var lerpQuat = function (v) {
    return function (v1) {
        return function (t) {
            return {
                x: v.x + t * (v1.x - v.x),
                y: v.y + t * (v1.y - v.y),
                z: v.z + t * (v1.z - v.z),
                w: v.w + t * (v1.w - v.w)
            };
        };
    };
};
var lengthSq = function (v) {
    return v.x * v.x + v.y * v.y + v.z * v.z + v.w * v.w;
};
var lengthQuat = function (q) {
    return Data_Number.sqrt(lengthSq(q));
};
var toEuler = function (q) {
    var len = lengthQuat(q);
    var $83 = len === 0.0;
    if ($83) {
        return Lattice_Services_Math3D_Vec3.zero;
    };
    var qzn = q.z / len;
    var sqz = qzn * qzn;
    var qyn = q.y / len;
    var sqy = qyn * qyn;
    var qxn = q.x / len;
    var sqx = qxn * qxn;
    var qwn = q.w / len;
    var sqw = qwn * qwn;
    var m33 = (sqw - sqx - sqy) + sqz;
    var m32 = 2.0 * (qyn * qzn + qwn * qxn);
    var m23 = 2.0 * (qyn * qzn - qwn * qxn);
    var m22 = ((sqw - sqx) + sqy) - sqz;
    var m13 = 2.0 * (qxn * qzn + qwn * qyn);
    var sinY = max(-1.0)(min(1.0)(m13));
    var m12 = 2.0 * (qxn * qyn - qwn * qzn);
    var m11 = (sqw + sqx) - sqy - sqz;
    var $85 = Data_Number.abs(sinY) > 0.9999999;
    if ($85) {
        return {
            x: Data_Number.atan2(-m32)(m22),
            y: Data_Number.asin(sinY),
            z: 0.0
        };
    };
    return {
        x: Data_Number.atan2(-m23)(m33),
        y: Data_Number.asin(sinY),
        z: Data_Number.atan2(-m12)(m11)
    };
};
var identity = {
    x: 0.0,
    y: 0.0,
    z: 0.0,
    w: 1.0
};
var invert = function (q) {
    var lenSq$prime = lengthSq(q);
    var $86 = lenSq$prime === 0.0;
    if ($86) {
        return identity;
    };
    return {
        x: -q.x / lenSq$prime,
        y: -q.y / lenSq$prime,
        z: -q.z / lenSq$prime,
        w: q.w / lenSq$prime
    };
};
var normalize = function (q) {
    var len = lengthQuat(q);
    var $88 = len === 0.0;
    if ($88) {
        return identity;
    };
    return {
        x: q.x / len,
        y: q.y / len,
        z: q.z / len,
        w: q.w / len
    };
};
var nlerp = function (a) {
    return function (b) {
        return function (t) {
            return normalize(lerpQuat(a)(b)(t));
        };
    };
};
var toAxisAngle = function (q) {
    var v = normalize(q);
    var angle = 2.0 * Data_Number.acos(max(-1.0)(min(1.0)(v.w)));
    var sinHalfAngle = Data_Number.sin(angle / 2.0);
    var $91 = Data_Number.abs(sinHalfAngle) < 1.0e-4;
    if ($91) {
        return new Data_Tuple.Tuple(Lattice_Services_Math3D_Vec3.unitX, 0.0);
    };
    return new Data_Tuple.Tuple({
        x: v.x / sinHalfAngle,
        y: v.y / sinHalfAngle,
        z: v.z / sinHalfAngle
    }, angle);
};
var fromEuler = function (x) {
    return function (y) {
        return function (z) {
            var s3 = Data_Number.sin(z / 2.0);
            var s2 = Data_Number.sin(y / 2.0);
            var s1 = Data_Number.sin(x / 2.0);
            var c3 = Data_Number.cos(z / 2.0);
            var c2 = Data_Number.cos(y / 2.0);
            var c1 = Data_Number.cos(x / 2.0);
            return {
                x: s1 * c2 * c3 + c1 * s2 * s3,
                y: c1 * s2 * c3 - s1 * c2 * s3,
                z: c1 * c2 * s3 + s1 * s2 * c3,
                w: c1 * c2 * c3 - s1 * s2 * s3
            };
        };
    };
};
var fromAxisAngle = function (axis) {
    return function (angle) {
        var normalizedAxis = Lattice_Services_Math3D_Vec3.normalize(axis);
        var halfAngle = angle / 2.0;
        var s = Data_Number.sin(halfAngle);
        return {
            x: Lattice_Services_Math3D_Vec3.getX(normalizedAxis) * s,
            y: Lattice_Services_Math3D_Vec3.getY(normalizedAxis) * s,
            z: Lattice_Services_Math3D_Vec3.getZ(normalizedAxis) * s,
            w: Data_Number.cos(halfAngle)
        };
    };
};
var fromArray = function (arr) {
    var v = Data_Array.index(arr)(3);
    var v1 = Data_Array.index(arr)(2);
    var v2 = Data_Array.index(arr)(1);
    var v3 = Data_Array.index(arr)(0);
    if (v3 instanceof Data_Maybe.Just && (v2 instanceof Data_Maybe.Just && (v1 instanceof Data_Maybe.Just && v instanceof Data_Maybe.Just))) {
        return {
            x: v3.value0,
            y: v2.value0,
            z: v1.value0,
            w: v.value0
        };
    };
    return identity;
};
var dotQuat = function (v) {
    return function (v1) {
        return v.x * v1.x + v.y * v1.y + v.z * v1.z + v.w * v1.w;
    };
};
var slerp = function (a) {
    return function (b) {
        return function (t) {
            var d = dotQuat(a)(b);
            var v = (function () {
                var $104 = d < 0.0;
                if ($104) {
                    return new Data_Tuple.Tuple({
                        x: -b.x,
                        y: -b.y,
                        z: -b.z,
                        w: -b.w
                    }, -d);
                };
                return new Data_Tuple.Tuple(b, d);
            })();
            var $106 = v.value1 > 0.9995;
            if ($106) {
                return normalize(lerpQuat(a)(v.value0)(t));
            };
            var theta0 = Data_Number.acos(v.value1);
            var theta = theta0 * t;
            var sinTheta0 = Data_Number.sin(theta0);
            var sinTheta = Data_Number.sin(theta);
            var s1 = sinTheta / sinTheta0;
            var s0 = Data_Number.cos(theta) - (v.value1 * sinTheta) / sinTheta0;
            return {
                x: s0 * a.x + s1 * v.value0.x,
                y: s0 * a.y + s1 * v.value0.y,
                z: s0 * a.z + s1 * v.value0.z,
                w: s0 * a.w + s1 * v.value0.w
            };
        };
    };
};
var conjugate = function (v) {
    return {
        x: -v.x,
        y: -v.y,
        z: -v.z,
        w: v.w
    };
};
var rotateVec3 = function (q) {
    return function (v) {
        var qv = {
            x: v.x,
            y: v.y,
            z: v.z,
            w: 0.0
        };
        var qConj = conjugate(q);
        var v2 = multiply(multiply(q)(qv))(qConj);
        return {
            x: v2.x,
            y: v2.y,
            z: v2.z
        };
    };
};
export {
    Quat,
    identity,
    quatFromComponents,
    lengthQuat,
    lengthSq,
    normalize,
    conjugate,
    invert,
    multiply,
    dotQuat,
    fromEuler,
    toEuler,
    fromAxisAngle,
    toAxisAngle,
    slerp,
    lerpQuat,
    nlerp,
    rotateVec3,
    toArray,
    fromArray,
    genericQuat_,
    eqQuat,
    showQuat
};
//# sourceMappingURL=index.js.map
