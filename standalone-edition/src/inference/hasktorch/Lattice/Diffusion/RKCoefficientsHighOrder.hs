{-# LANGUAGE RecordWildCards #-}
-- | High-order Radau IIA tableaux (5s, 7s, 9s, 11s)
-- Ported from RES4LYF rk_coefficients_beta.py
module Lattice.Diffusion.RKCoefficientsHighOrder where

import Data.Map.Strict (Map)
import qualified Data.Map.Strict as M
import Lattice.Diffusion.RKCoefficients (RKTableau(..))

-- Radau IIA 5-stage (9th order)
radauIIA5s :: RKTableau
radauIIA5s = RKTableau
  { rkA = [ [0.07299886431790333, -0.02673533110794557, 0.018676929763984353, -0.01287910609330644, 0.005042839233882015]
          , [0.15377523147918246, 0.14621486784749352, -0.03644456890512809, 0.02123306311930472, -0.007935579902728777]
          , [0.14006304568480987, 0.29896712949128346, 0.16758507013524895, -0.03396910168661774, 0.010944288744192253]
          , [0.14489430810953477, 0.2765000687601592, 0.32579792291042103, 0.12875675325490976, -0.015708917378805327]
          , [0.14371356079122594, 0.28135601514946207, 0.31182652297574126, 0.22310390108357075, 0.04]
          ]
  , rkB = [[0.14371356079122594, 0.28135601514946207, 0.31182652297574126, 0.22310390108357075, 0.04]]
  , rkC = [0.05710419611451768, 0.2768430136381238, 0.5835904323689168, 0.8602401356562195, 1.0]
  }

-- Radau IIA 7-stage (13th order)
radauIIA7s :: RKTableau
radauIIA7s = RKTableau
  { rkA = [ [0.03754626499392133, -0.0140393345564604, 0.0103527896007423, -0.008158322540275011, 0.006388413879534685, -0.004602326779148656, 0.0018289425614706437]
          , [0.08014759651561897, 0.08106206398589154, -0.021237992120711036, 0.014000291238817119, -0.010234185730090163, 0.0071534651513645905, -0.0028126393724067235]
          , [0.0720638469418819, 0.17106835498388662, 0.10961456404007211, -0.024619871728984055, 0.014760377043950817, -0.009575259396791401, 0.0036726783971383057]
          , [0.07570512581982441, 0.15409015514217114, 0.2271077366732024, 0.11747818703702478, -0.023810827153044174, 0.012709985533661206, -0.004608844281289633]
          , [0.07391234216319184, 0.16135560761594242, 0.2068672415521042, 0.23700711534269422, 0.10308679353381345, -0.018854139152580447, 0.0058589009748887914]
          , [0.07470556205979623, 0.1583072238724687, 0.21415342326720002, 0.21987784703186003, 0.19875212168063527, 0.06926550160550914, -0.00811600819772829]
          , [0.07449423555601031, 0.15910211573365074, 0.21235188950297781, 0.22355491450728324, 0.19047493682211558, 0.1196137446126562, 0.02040816326530612]
          ]
  , rkB = [[0.07449423555601031, 0.15910211573365074, 0.21235188950297781, 0.22355491450728324, 0.19047493682211558, 0.1196137446126562, 0.02040816326530612]]
  , rkC = [0.029316427159784893, 0.1480785996684843, 0.3369846902811543, 0.5586715187715501, 0.7692338620300545, 0.9269456713197411, 1.0]
  }

-- Radau IIA 9-stage (17th order)
radauIIA9s :: RKTableau
radauIIA9s = RKTableau
  { rkA = [ [0.022788378793458776, -0.008589639752938945, 0.0064510291769951465, -0.00525752869975012, 0.004388833809361376, -0.0036512155536904674, 0.0029404882137526148, -0.002149274163882554, 0.0008588433240576261]
          , [0.04890795244749932, 0.05070205048082808, -0.013523807196021316, 0.009209373774305071, -0.0071557133175369604, 0.005747246699432309, -0.004542582976394536, 0.003288161681791406, -0.0013090736941094112]
          , [0.04374276009157137, 0.10830189290274023, 0.07291956593742897, -0.016879877210016055, 0.010704551844802781, -0.007901946479238777, 0.005991406942179993, -0.0042480244399873135, 0.0016781498061495626]
          , [0.04624923745394712, 0.09656073072680009, 0.1542987697900386, 0.0867193693031384, -0.018451639643617873, 0.011036658729835513, -0.007673280940281649, 0.005228224999889903, -0.00203590583647778]
          , [0.044834436586910234, 0.10230684968594175, 0.13821763419236816, 0.18126393468214014, 0.09043360059943564, -0.018085063366782478, 0.010193387903855565, -0.006405265418866323, 0.0024271699384239612]
          , [0.045658755719323395, 0.09914547048938806, 0.14574704049699233, 0.16364828123387398, 0.18594458734451902, 0.08361326023153276, -0.015809936146309538, 0.00813825269404473, -0.002910469207795258]
          , [0.045200600187797244, 0.10085370671832047, 0.1419422367945749, 0.17118947183876332, 0.1697833861700019, 0.16776829117327952, 0.06707903432249304, -0.011792230536025322, 0.0036092462886493657]
          , [0.045416516657427734, 0.10006040244594375, 0.143652840987038, 0.16801908098069296, 0.17556076841841367, 0.15588627045003361, 0.12889391351650395, 0.04281082602522101, -0.004934574771244536]
          , [0.04535725246164146, 0.10027664901227598, 0.1431933481786156, 0.16884698348796479, 0.1741365013864833, 0.158421887835219, 0.12359468910229653, 0.0738270095231577, 0.012345679012345678]
          ]
  , rkB = [[0.04535725246164146, 0.10027664901227598, 0.1431933481786156, 0.16884698348796479, 0.1741365013864833, 0.158421887835219, 0.12359468910229653, 0.0738270095231577, 0.012345679012345678]]
  , rkC = [0.01777991514736345, 0.09132360789979396, 0.21430847939563075, 0.37193216458327233, 0.5451866848034267, 0.7131752428555694, 0.8556337429578544, 0.9553660447100302, 1.0]
  }

-- Radau IIA 11-stage (21st order)
radauIIA11s :: RKTableau
radauIIA11s = RKTableau
  { rkA = [ [0.015280520789530369, -0.0057824996781311875, 0.00438010324638053, -0.0036210375473319026, 0.003092977042211754, -0.0026728314041491816, 0.0023050911672361017, -0.001955651803123845, 0.001593873849612843, -0.0011728625554916522, 0.00046993032567176855]
          , [0.03288397668119629, 0.03451351173940448, -0.009285420023734383, 0.00641324617083941, -0.005095455838865143, 0.0042460913690415955, -0.0035876743372353984, 0.003006834900018004, -0.0024326697483255453, 0.0017827773828584467, -0.0007131464180496306]
          , [0.029332502147155125, 0.0741624250777296, 0.0511486756872502, -0.012005023334430185, 0.00777794727524923, -0.005944695307870806, 0.004802655736401176, -0.003923600687657003, 0.003127328539609814, -0.0022731432208609507, 0.0009063777304940358]
          , [0.03111455337650569, 0.06578995121943092, 0.10929962691877611, 0.06381051663919307, -0.013853591907177828, 0.008557435524870741, -0.0063076358492939275, 0.004913357548166058, -0.0038139969541068734, 0.0027334306074068546, -0.0010839711153145738]
          , [0.03005269275666326, 0.07011284530154153, 0.09714692306747527, 0.1353916024839275, 0.07147107644479529, -0.014710238851905252, 0.008733191499420551, -0.00619941303527863, 0.004591640852897801, -0.003213330884490774, 0.001262857250740274]
          , [0.030728073929609766, 0.06751925856657341, 0.10334060375222286, 0.12083525997663601, 0.1503267876654705, 0.07350931976920085, -0.014512880052768446, 0.008296645645701008, -0.0056128275038367864, 0.003766229774466616, -0.001457705807615146]
          , [0.030292022376401242, 0.06914472100762357, 0.09972096441656238, 0.12801064060853223, 0.13493180383303127, 0.15289670039157693, 0.06975993047996924, -0.013274545709987746, 0.007258767272883859, -0.0044843888202694155, 0.0016878458203415244]
          , [0.03056654381836576, 0.06813851028407998, 0.10188107030389015, 0.12403361149690655, 0.14211431622263265, 0.13829395377418516, 0.14289135336320447, 0.06052636121446275, -0.011077739682117822, 0.005598667203856668, -0.0019877269625674446]
          , [0.030406629901865028, 0.06871880785022819, 0.10066095698900927, 0.12619527453091425, 0.13848875677027936, 0.14450773783254642, 0.13065188915037962, 0.1211140113707743, 0.046555483263607714, -0.008026200095719123, 0.002437640226261747]
          , [0.030484119381553945, 0.06843924691254653, 0.10124184869598654, 0.1251873187759311, 0.14011843430039864, 0.14190386755377057, 0.13500342651951197, 0.11262869537051934, 0.08930604389562254, 0.028969664972192485, -0.0033116985395201413]
          , [0.03046254890606557, 0.06851684106660112, 0.10108155427001221, 0.1254626888485642, 0.13968066655169153, 0.14258278197050367, 0.1339335430948421, 0.11443306192448831, 0.08565880960332992, 0.04992304095398403, 0.008264462809917356]
          ]
  , rkB = [[0.03046254890606557, 0.06851684106660112, 0.10108155427001221, 0.1254626888485642, 0.13968066655169153, 0.14258278197050367, 0.1339335430948421, 0.11443306192448831, 0.08565880960332992, 0.04992304095398403, 0.008264462809917356]]
  , rkC = [0.011917613432415597, 0.061732071877148124, 0.14711144964307024, 0.26115967600845624, 0.39463984688578685, 0.5367387657156606, 0.6759444616766651, 0.8009789210368988, 0.9017109877901468, 0.9699709678385136, 1.0]
  }

-- Constants for Lobatto 4s
sqrt5 :: Double
sqrt5 = sqrt 5

-- Lobatto IIIA 4-stage (6th order)
lobattoIIIA4s :: RKTableau
lobattoIIIA4s = RKTableau
  { rkA = [ [0, 0, 0, 0]
          , [(11+sqrt5)/120, (25-sqrt5)/120, (25-13*sqrt5)/120, (-1+sqrt5)/120]
          , [(11-sqrt5)/120, (25+13*sqrt5)/120, (25+sqrt5)/120, (-1-sqrt5)/120]
          , [1/12, 5/12, 5/12, 1/12]
          ]
  , rkB = [[1/12, 5/12, 5/12, 1/12]]
  , rkC = [0, (5-sqrt5)/10, (5+sqrt5)/10, 1]
  }

-- Lobatto IIIB 4-stage (6th order)
lobattoIIIB4s :: RKTableau
lobattoIIIB4s = RKTableau
  { rkA = [ [1/12, (-1-sqrt5)/24, (-1+sqrt5)/24, 0]
          , [1/12, (25+sqrt5)/120, (25-13*sqrt5)/120, 0]
          , [1/12, (25+13*sqrt5)/120, (25-sqrt5)/120, 0]
          , [1/12, (11-sqrt5)/24, (11+sqrt5)/24, 0]
          ]
  , rkB = [[1/12, 5/12, 5/12, 1/12]]
  , rkC = [0, (5-sqrt5)/10, (5+sqrt5)/10, 1]
  }

-- Lobatto IIIC 4-stage (6th order)
lobattoIIIC4s :: RKTableau
lobattoIIIC4s = RKTableau
  { rkA = [ [1/12, (-sqrt5)/12, sqrt5/12, -1/12]
          , [1/12, 1/4, (10-7*sqrt5)/60, sqrt5/60]
          , [1/12, (10+7*sqrt5)/60, 1/4, (-sqrt5)/60]
          , [1/12, 5/12, 5/12, 1/12]
          ]
  , rkB = [[1/12, 5/12, 5/12, 1/12]]
  , rkC = [0, (5-sqrt5)/10, (5+sqrt5)/10, 1]
  }

-- | All high-order tableaux by name
highOrderTableaux :: Map String RKTableau
highOrderTableaux = M.fromList
  [ ("radau_iia_5s", radauIIA5s)
  , ("radau_iia_7s", radauIIA7s)
  , ("radau_iia_9s", radauIIA9s)
  , ("radau_iia_11s", radauIIA11s)
  , ("lobatto_iiia_4s", lobattoIIIA4s)
  , ("lobatto_iiib_4s", lobattoIIIB4s)
  , ("lobatto_iiic_4s", lobattoIIIC4s)
  ]
